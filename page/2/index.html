<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>KezhanW</title><meta name="author" content="Kezhan Wang"><meta name="copyright" content="Kezhan Wang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Life is a fucking movie">
<meta property="og:type" content="website">
<meta property="og:title" content="KezhanW">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="KezhanW">
<meta property="og:description" content="Life is a fucking movie">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.png">
<meta property="article:author" content="Kezhan Wang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/page/2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-11-28 14:00:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/index"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/index.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">KezhanW</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/index"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">KezhanW</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/KezhanW" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1771257773&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://weibo.com/u/5895223990" target="_blank" title="weibo"><i class="fab fa-weibo"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/01/11/NPOIreadExcel/" title="NPOI读取Excel">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/28/roEMpq.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NPOI读取Excel"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/01/11/NPOIreadExcel/" title="NPOI读取Excel">NPOI读取Excel</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-01-11T10:10:25.000Z" title="发表于 2021-01-11 18:10:25">2021-01-11</time></span></div><div class="content">读取Excel
本文导出Excel表格是基于NPOI

NPOI是指构建在POI 3.x版本之上的一个程序，NPOI可以在没有安装Office的情况下对Word或Excel文档进行读写操作。
NPOI的下载与引用:https://kezhanw.github.io/2020/12/30/ExportExcel/
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122&#x2F;&#x2F;&#x2F; &lt;summary&gt;  &#x2F;&#x2F;&#x2F; 将excel导入到datatable  &#x2F;&#x2 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/30/ExportExcel/" title="NPOI导出Excel">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/28/roE1XT.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NPOI导出Excel"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/30/ExportExcel/" title="NPOI导出Excel">NPOI导出Excel</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-30T11:48:01.000Z" title="发表于 2020-12-30 19:48:01">2020-12-30</time></span></div><div class="content">
本文导出Excel表格是基于NPOI

NPOI是指构建在POI 3.x版本之上的一个程序，NPOI可以在没有安装Office的情况下对Word或Excel文档进行读写操作。
NPOI的下载、引用下载地址https://github.com/KezhanW/NPOI然后我们打开解压好的文件，看到有dotnet2和dotnet4文件夹，这里我们打开dotnet4，引入全部的dll接下来using
1234567using NPOI;using NPOI.SS.UserModel;using NPOI.HSSF.UserModel;using NPOI.XSSF.UserModel;using NPOI.HSSF.Util;using NPOI.SS.Util;
下面就可以开始我们的项目了
导出Excel表格
注：可以添加单元格样式、合并单元格等操作 如无需删除即可

123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/28/numzab/" title=".NET数字与字母的相互转换">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/28/roE8nU.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt=".NET数字与字母的相互转换"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/28/numzab/" title=".NET数字与字母的相互转换">.NET数字与字母的相互转换</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-28T13:14:24.000Z" title="发表于 2020-12-28 21:14:24">2020-12-28</time></span></div><div class="content">字母转换成数字
byte[] array = new byte[1];   //定义一组数组arrayarray = System.Text.Encoding.ASCII.GetBytes(string); //string转换的字母int asciicode = (short)(array[0]);ASCII码 = Convert.ToString(asciicode); //将转换一的ASCII码转换成string型

数字转换成字母
byte[] array = new byte[1];array[0] = (byte)(Convert.ToInt32(ASCII码)); //ASCII码强制转换二进制转换后的字母= Convert.ToString(System.Text.Encoding.ASCII.GetString(array));

在编码的过程中很多时候会用到将某些数字的索引转化为字母，比方说Excel的单元格的列数在Excel中就用大写字母来表示，要把数字转换成字母可以使用C#的ASCIIEncoding类里的GetString方法。请参见以下示例：
1234567 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/28/netSmallMethod/" title=".NET小方法">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/28/roEuhn.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt=".NET小方法"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/28/netSmallMethod/" title=".NET小方法">.NET小方法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-28T02:58:33.000Z" title="发表于 2020-12-28 10:58:33">2020-12-28</time></span></div><div class="content">List取并集、交集、差集
并集：Union
交集：Intersect
差集：Except

1234567891011121314List&lt;T&gt; list1 &#x3D; new List&lt;T&gt;();List&lt;T&gt; list2 &#x3D; new List&lt;T&gt;();List&lt;T&gt; list &#x3D; new List&lt;T&gt;();&#x2F;&#x2F;并集, 包含1、2全部list &#x3D; list1.Union(list2);&#x2F;&#x2F;交集，1、2相同部分list &#x3D; list1.Intersect(list2);&#x2F;&#x2F;差集，1中存在但2中不存在list &#x3D; list1.Except(list2)
Trim()–去除首尾字符
Trim() 删除字符串头部及尾部出现的空格
TrimStart() 只删除字符串的头部的空格
TrimEnd() 只删除字符串尾部的空格

定义和用法:

Trim() 方法删除字符串头部及尾部出现的空格，删除的过程为从外 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/26/lrjfGrid/" title="力软框架--表格">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIEfU.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架--表格"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/lrjfGrid/" title="力软框架--表格">力软框架--表格</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T10:43:04.000Z" title="发表于 2020-12-26 18:43:04">2020-12-26</time></span></div><div class="content">获取数据渲染数据
获取表格全部数据：$(&#39;#&#39;+id).jfGridGet(&#39;rowdatas&#39;);
获取表格选中行数据：$(&#39;#&#39;+id).jfGridGet(&#39;rowdata&#39;);
渲染表格数据： $(&#39;#&#39;+id).jfGridSet(&#39;refreshdata&#39;, data);
刷新表格一行数据  $(&#39;#&#39;+id).jfGridSet(&#39;updateRow&#39;, index);
刷新表格数据   $(&#39;#&#39;+id).jfGridSet(&#39;reload&#39;);
获取选中行某字段值   $(&#39;#&#39;+id).jfGridValue(&#39;Id&#39;);

初始化方法：$(&#39;#&#39;+id).jfGrid(op);参数说明：



参数
说明
默认



url
数据服务地址



param
请求参数



rowdatas
列表数据



datatype
数据类型
array


headD ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/26/lrselect/" title="力软框架--选择框">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIZpF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架--选择框"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/lrselect/" title="力软框架--选择框">力软框架--选择框</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T10:40:36.000Z" title="发表于 2020-12-26 18:40:36">2020-12-26</time></span></div><div class="content">下拉选择
获取值：$(‘#’+id).lrselectGet();赋值：$(‘#’+id).lrselectSet(“”);重新渲染：$(‘#’+id).lrselectRefresh(op);

方法：$(&#39;#&#39;+id).lrselect(op);参数说明：



参数
说明
默认



placeholder
占位符
请选择


type
数据展示类型：1.default：普通；2.tree：树形数据；3. treemultiple：树形多选；multiple：普通多选
default


value
数据值字段名
id


text
数据显示字段名
text


title
数据标题字段名
title


maxHeight
下拉框最大高度
200


width
下拉框宽度
跟随输入框宽度


allowSearch
是否允许搜索
false


url
获取数据地址
false


data
下拉选择数据
false


param
请求后台参数
Null


method
请求后台方法：GET、POST
GET


select
选择后触发方法
false
 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/26/learun/" title="力软框架">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIPwq.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/learun/" title="力软框架">力软框架</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T10:13:34.000Z" title="发表于 2020-12-26 18:13:34">2020-12-26</time></span></div><div class="content">null转义符1&amp;nbsp;
Loading遮罩层12learun.loading(true, &#39;Loading……&#39;);learun.loading(false);
打开新的iframe界面
F_ModuleId : 页面IDF_FullName : 页面名称F_UrlAddress : 页面地址

1learun.frameTab.open(&#123; F_ModuleId: learun.newGuid(), F_FullName: &#39;通用制单&#39;, F_UrlAddress: &#39;&#x2F;Fly_ZD&#x2F;Fly_ZD_Head&#x2F;Form&#39;&#125;);
时间查询框方法：$(&#39;#&#39;+id).lrdate(op);参数说明：



参数
说明
默认



dfdata
自定义数据
[]


mShow
是否显示当月按钮
true


premShow
是否显示上月按钮
true


jShow
是否显示当季度按钮
true


prejShow
是否显示上季度按钮
true


ysSho ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/26/RecoveryHexo/" title="重裝系統後重新部署恢復 Hexo blog">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rhK6Gn.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="重裝系統後重新部署恢復 Hexo blog"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/RecoveryHexo/" title="重裝系統後重新部署恢復 Hexo blog">重裝系統後重新部署恢復 Hexo blog</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T04:55:56.000Z" title="发表于 2020-12-26 12:55:56">2020-12-26</time></span></div><div class="content">
以下方法只适用于没有删除 hexo blog文件夹

因为重装系统后，Hexo 相关依赖插件/软件和在 C 盘的缓存资料都会被删除，以至于 Hexo 的相关命令都无法运行。所有，在重装系统后，都要重新部署 Hexo。但是重新部署并不难，只需要几个步骤就行。因为我的 hexo blog 文件夹不存储于 C 盘，并没有因为重装系统被删掉。所有重新部署很容易。
安裝 git 和 node
git for windows: https://git-scm.com/
Node.js: https://nodejs.org/en/

生成 ssh 密钥配置 git 个人信息和生成 ssh 密钥打开 git bash，输入
123git config --global user.name &quot;xxxxx&quot;git config --global user.email &quot;xxxxxx@xx.com&quot;ssh-keygen -t rsa -C &quot;xxxxxx@xx.com&quot;
把上面的 xxxx 换成自己的资料，然后一直 Enter 就行。
设置 G ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/25/AlipayPayment/" title="支付宝PC网站支付">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/25/rflvB8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="支付宝PC网站支付"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/25/AlipayPayment/" title="支付宝PC网站支付">支付宝PC网站支付</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-25T15:16:07.000Z" title="发表于 2020-12-25 23:16:07">2020-12-25</time></span></div><div class="content">生成秘钥可以去支付宝开放平台-开发文档下载秘钥生成器运行可以直接生成长度为2048标准为PKCS1的公钥和私钥。
设置应用公钥我们生成密钥之后，需要到支付宝后台设置应用公钥，就是我们生成的公钥。设置之后，支付宝会给我们一个支付宝公钥，保存这个支付宝公钥这个支付宝公钥和我们自己生成的公钥是不一样的，我们在配置SDK时用的公钥就是支付宝公钥
配置SDK新建一个Config类，在里面存储我们的配置。其他信息不变只需要配置

应用ID
商户私钥
支付宝公钥

1234567891011121314151617181920212223&#x2F;&#x2F;&#x2F; &lt;summary&gt;&#x2F;&#x2F;&#x2F; SDK配置&#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;public class ZFBPayconfig&#123;    &#x2F;&#x2F; 应用ID,您的APPID    public static string app_id &#x3D; &quot;&quot;;    &#x2F;&#x2F; 支付宝网关    ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/25/WXSendMessage/" title="微信小程序给用户发送消息">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/25/rW4nJg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微信小程序给用户发送消息"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/25/WXSendMessage/" title="微信小程序给用户发送消息">微信小程序给用户发送消息</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-25T10:26:45.000Z" title="发表于 2020-12-25 18:26:45">2020-12-25</time></span></div><div class="content">基本参数
用户的openid
access_token
公众号和小程序的appid
模板ID


openid获取方法之前的文章有提到过公众号和小程序的appid和模板ID都可以在微信公众号平台获取到
下面我们就讲讲access_token的获取方式将AppID和AppSecret(小程序密钥)调用接口即可注意：access_token是有时间限制的最好存到缓存里
12345678910111213141516171819202122&#x2F;&#x2F;&#x2F; &lt;summary&gt;&#x2F;&#x2F;&#x2F; 获取accessToken&#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;&#x2F;&#x2F;&#x2F; &lt;returns&gt;&lt;&#x2F;returns&gt;public static string JsCode2Session()&#123;    string appid &#x3D; &quot;wx************&quot;;    string secret &#x3D; & ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Kezhan Wang</div><div class="author-info__description">Life is a fucking movie</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">23</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KezhanW"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/KezhanW" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1771257773&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://weibo.com/u/5895223990" target="_blank" title="weibo"><i class="fab fa-weibo"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">Welcome to my Blog</div></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/22/rules/" title="表单验证rules"><img data-lazy-src="https://s3.ax1x.com/2020/12/27/r5Em79.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="表单验证rules"/></a><div class="content"><a class="title" href="/2022/05/22/rules/" title="表单验证rules">表单验证rules</a><time datetime="2022-05-22T04:27:33.000Z" title="发表于 2022-05-22 12:27:33">2022-05-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/07/SendEmail/" title="发送邮件"><img data-lazy-src="https://s3.ax1x.com/2020/12/28/roE1XT.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="发送邮件"/></a><div class="content"><a class="title" href="/2022/05/07/SendEmail/" title="发送邮件">发送邮件</a><time datetime="2022-05-07T03:11:00.000Z" title="发表于 2022-05-07 11:11:00">2022-05-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/03/SqlDate/" title="sql server 字符串转成日期格式"><img data-lazy-src="https://s3.ax1x.com/2020/12/28/roEJ74.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sql server 字符串转成日期格式"/></a><div class="content"><a class="title" href="/2022/03/03/SqlDate/" title="sql server 字符串转成日期格式">sql server 字符串转成日期格式</a><time datetime="2022-03-03T06:44:58.000Z" title="发表于 2022-03-03 14:44:58">2022-03-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/19/httpRequest/" title="C#发送Get、Post请求(带参数)"><img data-lazy-src="https://s3.ax1x.com/2020/12/27/r5Em79.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C#发送Get、Post请求(带参数)"/></a><div class="content"><a class="title" href="/2022/02/19/httpRequest/" title="C#发送Get、Post请求(带参数)">C#发送Get、Post请求(带参数)</a><time datetime="2022-02-19T11:37:50.000Z" title="发表于 2022-02-19 19:37:50">2022-02-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/18/CefSharpResourceRequest/" title="CefSharp请求资源拦截及自定义处理"><img data-lazy-src="https://s3.ax1x.com/2020/12/28/roEtAJ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CefSharp请求资源拦截及自定义处理"/></a><div class="content"><a class="title" href="/2022/02/18/CefSharpResourceRequest/" title="CefSharp请求资源拦截及自定义处理">CefSharp请求资源拦截及自定义处理</a><time datetime="2022-02-18T13:04:31.000Z" title="发表于 2022-02-18 21:04:31">2022-02-18</time></div></div></div></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E6%94%AF%E4%BB%98%E5%AE%9D/" style="font-size: 1.1em; color: rgb(10, 114, 158)">支付宝</a><a href="/tags/%E6%94%AF%E4%BB%98/" style="font-size: 1.1em; color: rgb(141, 121, 37)">支付</a><a href="/tags/Excel/" style="font-size: 1.37em; color: rgb(80, 164, 128)">Excel</a><a href="/tags/NET/" style="font-size: 1.5em; color: rgb(36, 124, 112)">.NET</a><a href="/tags/%E5%BE%AE%E4%BF%A1/" style="font-size: 1.23em; color: rgb(68, 19, 166)">微信</a><a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.23em; color: rgb(166, 195, 197)">小程序</a><a href="/tags/Hexo/" style="font-size: 1.1em; color: rgb(79, 5, 41)">Hexo</a><a href="/tags/JS/" style="font-size: 1.1em; color: rgb(111, 172, 188)">JS</a><a href="/tags/%E5%8A%9B%E8%BD%AF/" style="font-size: 1.37em; color: rgb(58, 147, 128)">力软</a><a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 1.1em; color: rgb(66, 102, 65)">正则表达式</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">五月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span class="card-archive-list-date">一月 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/12/"><span class="card-archive-list-date">十二月 2020</span><span class="card-archive-list-count">12</span></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">23</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">25.1k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-11-28T06:00:36.900Z"></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/index.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Kezhan Wang</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://api.btstu.cn/yan/api.php?charset=utf-8&encode=json')
    .then(response => response.json())
    .then(data => {
      if (true) {
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.text)
        typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.text
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script></div></body></html>