<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>KezhanW</title><meta name="author" content="Kezhan Wang"><meta name="copyright" content="Kezhan Wang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Life is a fucking movie">
<meta property="og:type" content="website">
<meta property="og:title" content="KezhanW">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="KezhanW">
<meta property="og:description" content="Life is a fucking movie">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.png">
<meta property="article:author" content="Kezhan Wang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2020-12-27 19:10:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/index"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/index.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">KezhanW</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/index"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">KezhanW</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/KezhanW" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1771257773&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://weibo.com/u/5895223990" target="_blank" title="weibo"><i class="fab fa-weibo"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/26/lrjfGrid/" title="力软框架--表格">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIEfU.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架--表格"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/lrjfGrid/" title="力软框架--表格">力软框架--表格</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T10:43:04.000Z" title="发表于 2020-12-26 18:43:04">2020-12-26</time></span></div><div class="content">获取数据渲染数据
获取表格全部数据：$(&#39;#&#39;+id).jfGridGet(&#39;rowdatas&#39;);
获取表格选中行数据：$(&#39;#&#39;+id).jfGridGet(&#39;rowdata&#39;);
渲染表格数据： $(&#39;#&#39;+id).jfGridSet(&#39;refreshdata&#39;, data);
刷新表格一行数据  $(&#39;#&#39;+id).jfGridSet(&#39;updateRow&#39;, index);
刷新表格数据   $(&#39;#&#39;+id).jfGridSet(&#39;reload&#39;);
获取选中行某字段值   $(&#39;#&#39;+id).jfGridValue(&#39;Id&#39;);

初始化方法：$(&#39;#&#39;+id).jfGrid(op);参数说明：



参数
说明
默认



url
数据服务地址



param
请求参数



rowdatas
列表数据



datatype
数据类型
array


headD ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/26/lrselect/" title="力软框架--选择框">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIZpF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架--选择框"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/lrselect/" title="力软框架--选择框">力软框架--选择框</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T10:40:36.000Z" title="发表于 2020-12-26 18:40:36">2020-12-26</time></span></div><div class="content">下拉选择
获取值：$(‘#’+id).lrselectGet();赋值：$(‘#’+id).lrselectSet(“”);

方法：$(&#39;#&#39;+id).lrselect(op);参数说明：



参数
说明
默认



placeholder
占位符
请选择


type
数据展示类型：1.default：普通；2.tree：树形数据；3. treemultiple：树形多选；multiple：普通多选
default


value
数据值字段名
id


text
数据显示字段名
text


title
数据标题字段名
title


maxHeight
下拉框最大高度
200


width
下拉框宽度
跟随输入框宽度


allowSearch
是否允许搜索
false


url
获取数据地址
false


data
下拉选择数据
false


param
请求后台参数
Null


method
请求后台方法：GET、POST
GET


select
选择后触发方法
false


示例：
1234567$(&#x27;#customerId&#x ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/26/learun/" title="力软框架">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIPwq.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/learun/" title="力软框架">力软框架</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T10:13:34.000Z" title="发表于 2020-12-26 18:13:34">2020-12-26</time></span></div><div class="content">Loading遮罩层12learun.loading(true, &#39;Loading……&#39;);learun.loading(false);
打开新的iform界面
F_ModuleId : 页面IDF_FullName : 页面名称F_UrlAddress : 页面地址

1learun.frameTab.open(&#123; F_ModuleId: learun.newGuid(), F_FullName: &#39;通用制单&#39;, F_UrlAddress: &#39;&#x2F;Fly_ZD&#x2F;Fly_ZD_Head&#x2F;Form&#39;&#125;);
时间查询框方法：$(&#39;#&#39;+id).lrdate(op);参数说明：



参数
说明
默认



dfdata
自定义数据
[]


mShow
是否显示当月按钮
true


premShow
是否显示上月按钮
true


jShow
是否显示当季度按钮
true


prejShow
是否显示上季度按钮
true


ysShow
是否显示上半年按钮
true


y ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/26/RecoveryHexo/" title="重裝系統後重新部署恢復 Hexo blog">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/26/rhK6Gn.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="重裝系統後重新部署恢復 Hexo blog"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/26/RecoveryHexo/" title="重裝系統後重新部署恢復 Hexo blog">重裝系統後重新部署恢復 Hexo blog</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-26T04:55:56.000Z" title="发表于 2020-12-26 12:55:56">2020-12-26</time></span></div><div class="content">
以下方法只适用于没有删除 hexo blog文件夹

因为重装系统后，Hexo 相关依赖插件/软件和在 C 盘的缓存资料都会被删除，以至于 Hexo 的相关命令都无法运行。所有，在重装系统后，都要重新部署 Hexo。但是重新部署并不难，只需要几个步骤就行。因为我的 hexo blog 文件夹不存储于 C 盘，并没有因为重装系统被删掉。所有重新部署很容易。
安裝 git 和 node
git for windows: https://git-scm.com/
Node.js: https://nodejs.org/en/

生成 ssh 密钥配置 git 个人信息和生成 ssh 密钥打开 git bash，输入
123git config --global user.name &quot;xxxxx&quot;git config --global user.email &quot;xxxxxx@xx.com&quot;ssh-keygen -t rsa -C &quot;xxxxxx@xx.com&quot;
把上面的 xxxx 换成自己的资料，然后一直 Enter 就行。
设置 G ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/25/AlipayPayment/" title="支付宝PC网站支付">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/25/rflvB8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="支付宝PC网站支付"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/25/AlipayPayment/" title="支付宝PC网站支付">支付宝PC网站支付</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-25T15:16:07.000Z" title="发表于 2020-12-25 23:16:07">2020-12-25</time></span></div><div class="content">生成秘钥可以去支付宝开放平台-开发文档下载秘钥生成器运行可以直接生成长度为2048标准为PKCS1的公钥和私钥。
设置应用公钥我们生成密钥之后，需要到支付宝后台设置应用公钥，就是我们生成的公钥。设置之后，支付宝会给我们一个支付宝公钥，保存这个支付宝公钥这个支付宝公钥和我们自己生成的公钥是不一样的，我们在配置SDK时用的公钥就是支付宝公钥
配置SDK新建一个Config类，在里面存储我们的配置。其他信息不变只需要配置

应用ID
商户私钥
支付宝公钥

1234567891011121314151617181920212223&#x2F;&#x2F;&#x2F; &lt;summary&gt;&#x2F;&#x2F;&#x2F; SDK配置&#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;public class ZFBPayconfig&#123;    &#x2F;&#x2F; 应用ID,您的APPID    public static string app_id &#x3D; &quot;&quot;;    &#x2F;&#x2F; 支付宝网关    ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/25/WXSendMessage/" title="微信小程序给用户发送消息">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/25/rW4nJg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="微信小程序给用户发送消息"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/25/WXSendMessage/" title="微信小程序给用户发送消息">微信小程序给用户发送消息</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-25T10:26:45.000Z" title="发表于 2020-12-25 18:26:45">2020-12-25</time></span></div><div class="content">基本参数
用户的openid
access_token
公众号和小程序的appid
模板ID


openid获取方法之前的文章有提到过公众号和小程序的appid和模板ID都可以在微信公众号平台获取到
下面我们就讲讲access_token的获取方式将AppID和AppSecret(小程序密钥)调用接口即可注意：access_token是有时间限制的最好存到缓存里
12345678910111213141516171819202122&#x2F;&#x2F;&#x2F; &lt;summary&gt;&#x2F;&#x2F;&#x2F; 获取accessToken&#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;&#x2F;&#x2F;&#x2F; &lt;returns&gt;&lt;&#x2F;returns&gt;public static string JsCode2Session()&#123;    string appid &#x3D; &quot;wx************&quot;;    string secret &#x3D; & ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/25/regular/" title="常用正则表达式">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/25/rWVIV1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常用正则表达式"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/25/regular/" title="常用正则表达式">常用正则表达式</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-25T07:10:02.000Z" title="发表于 2020-12-25 15:10:02">2020-12-25</time></span></div><div class="content">校验数字的表达式12345678910111213141516171819数字：^[0-9]*$n位的数字：^\d&#123;n&#125;$至少n位的数字：^\d&#123;n,&#125;$m-n位的数字：^\d&#123;m,n&#125;$零和非零开头的数字：^(0|[1-9][0-9]*)$非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$带1-2位小数的正数或负数：^(\-)?\d+(\.\d&#123;1,2&#125;)?$正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^\+?[1-9][0-9]*$非零的负整数：^\-[1-9][]0-9&quot;*$ 或 ^-[1-9]\d*$非负整数：^\d+$ 或 ^[1-9]\d ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/12/25/GetWXOpenId/" title="获取微信小程序OpenId">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/25/rWSFij.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="获取微信小程序OpenId"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/25/GetWXOpenId/" title="获取微信小程序OpenId">获取微信小程序OpenId</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-25T05:22:01.000Z" title="发表于 2020-12-25 13:22:01">2020-12-25</time></span></div><div class="content">基本参数
获取appid及secret
获取登录凭证code


登陆你的微信小程序在开发设置里面可以直接看到appid和secret获取登录凭证
12345678910111213141516171819//获取openiduni.login(&#123;	success: res =&gt; &#123;		var code=res.code;//登录凭证		 if(code) &#123;			 uni.request(&#123;			 	url: that.apiRoot + &#x27;/Fly_Fp/Fly_Fp_ApplyFor/getuseropenid&#x27;,			 	method: &#x27;POST&#x27;,			 	data: &#123; ...that.auth,			 		data: res.code			 	&#125;,			 	success: (res) =&gt; &#123;			 		//openid			 		var openId = res.data;			 	&#125;			 &#125;)		&#125;	&#125; ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/12/24/ReadExcel/" title="上传/读取不规则数据的Excel">     <img class="post_bg" data-lazy-src="https://s3.ax1x.com/2020/12/25/rWSkJs.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="上传/读取不规则数据的Excel"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/12/24/ReadExcel/" title="上传/读取不规则数据的Excel">上传/读取不规则数据的Excel</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-12-24T12:25:43.000Z" title="发表于 2020-12-24 20:25:43">2020-12-24</time></span></div><div class="content">上传文件
定义一个文件选择器隐藏和一个导入按钮
12&lt;a id=&quot;lr_import&quot; class=&quot;btn btn-default&quot;&gt;&lt;i class=&quot;fa fa-sign-in&quot;&gt;&lt;/i&gt;&amp;nbsp;导入&lt;/a&gt;&lt;input id=&quot;filed&quot; name=&quot;filed&quot; type=&quot;file&quot; style=&quot;display:none&quot; accept=&quot;.xls,.xlsx&quot;&gt;
重新定义一个导入按钮的目的在于便于添加额外逻辑  例如：选择不同的模板向后台传参
12345678910111213141516171819202122232425262728293031323334353637383940414243//导入           $(&quot;#lr_import&quot;).click(function () &#123;          ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Kezhan Wang</div><div class="author-info__description">Life is a fucking movie</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KezhanW"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/KezhanW" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1771257773&amp;site=qq&amp;menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://weibo.com/u/5895223990" target="_blank" title="weibo"><i class="fab fa-weibo"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">Welcome to my Blog</div></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/lrjfGrid/" title="力软框架--表格"><img data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIEfU.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架--表格"/></a><div class="content"><a class="title" href="/2020/12/26/lrjfGrid/" title="力软框架--表格">力软框架--表格</a><time datetime="2020-12-26T10:43:04.000Z" title="发表于 2020-12-26 18:43:04">2020-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/lrselect/" title="力软框架--选择框"><img data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIZpF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架--选择框"/></a><div class="content"><a class="title" href="/2020/12/26/lrselect/" title="力软框架--选择框">力软框架--选择框</a><time datetime="2020-12-26T10:40:36.000Z" title="发表于 2020-12-26 18:40:36">2020-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/learun/" title="力软框架"><img data-lazy-src="https://s3.ax1x.com/2020/12/26/rfIPwq.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="力软框架"/></a><div class="content"><a class="title" href="/2020/12/26/learun/" title="力软框架">力软框架</a><time datetime="2020-12-26T10:13:34.000Z" title="发表于 2020-12-26 18:13:34">2020-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/26/RecoveryHexo/" title="重裝系統後重新部署恢復 Hexo blog"><img data-lazy-src="https://s3.ax1x.com/2020/12/26/rhK6Gn.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="重裝系統後重新部署恢復 Hexo blog"/></a><div class="content"><a class="title" href="/2020/12/26/RecoveryHexo/" title="重裝系統後重新部署恢復 Hexo blog">重裝系統後重新部署恢復 Hexo blog</a><time datetime="2020-12-26T04:55:56.000Z" title="发表于 2020-12-26 12:55:56">2020-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/25/AlipayPayment/" title="支付宝PC网站支付"><img data-lazy-src="https://s3.ax1x.com/2020/12/25/rflvB8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="支付宝PC网站支付"/></a><div class="content"><a class="title" href="/2020/12/25/AlipayPayment/" title="支付宝PC网站支付">支付宝PC网站支付</a><time datetime="2020-12-25T15:16:07.000Z" title="发表于 2020-12-25 23:16:07">2020-12-25</time></div></div></div></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E6%94%AF%E4%BB%98%E5%AE%9D/" style="font-size: 1.1em; color: rgb(71, 54, 103)">支付宝</a><a href="/tags/%E6%94%AF%E4%BB%98/" style="font-size: 1.1em; color: rgb(52, 63, 159)">支付</a><a href="/tags/%E5%BE%AE%E4%BF%A1/" style="font-size: 1.3em; color: rgb(24, 82, 68)">微信</a><a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.3em; color: rgb(171, 189, 47)">小程序</a><a href="/tags/%E5%8A%9B%E8%BD%AF/" style="font-size: 1.5em; color: rgb(46, 82, 64)">力软</a><a href="/tags/%E4%B8%8A%E4%BC%A0/" style="font-size: 1.1em; color: rgb(154, 107, 146)">上传</a><a href="/tags/Excel/" style="font-size: 1.1em; color: rgb(54, 16, 108)">Excel</a><a href="/tags/Hexo/" style="font-size: 1.1em; color: rgb(67, 86, 63)">Hexo</a><a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 1.1em; color: rgb(156, 10, 153)">正则表达式</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/12/"><span class="card-archive-list-date">十二月 2020</span><span class="card-archive-list-count">9</span></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">9</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">9.7k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2020-12-27T11:10:24.378Z"></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/index.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 By Kezhan Wang</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://api.btstu.cn/yan/api.php?charset=utf-8&encode=json')
    .then(response => response.json())
    .then(data => {
      if (true) {
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.text)
        typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.text
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script></div></body></html>