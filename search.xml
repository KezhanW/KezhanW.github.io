<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SQLite操作</title>
      <link href="2024/01/25/SQLite/"/>
      <url>2024/01/25/SQLite/</url>
      
        <content type="html"><![CDATA[<h1 id="关于SQLite的connection-string"><a href="#关于SQLite的connection-string" class="headerlink" title="关于SQLite的connection string"></a>关于SQLite的connection string</h1><p><a href="http://www.connectionstrings.com/sqlite/">http://www.connectionstrings.com/sqlite/</a></p><p>基本方式：Data Source=c:\mydb.db;Version=3;</p><h1 id="C-下SQLite操作"><a href="#C-下SQLite操作" class="headerlink" title="C#下SQLite操作"></a>C#下SQLite操作</h1><p>驱动dll下载：<a href="https://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki">System.Data.SQLite</a><br>也Nuget 直接搜索安装：System.Data.SQLite.Core</p><p>C#使用SQLite步骤：</p><p>（1）新建一个project</p><p>（2）添加SQLite操作驱动dll引用:System.Data.SQLite.dll</p><p>（3）使用API操作SQLite DataBase</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Data.SQLite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">SQLiteSamples</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//数据库连接</span></span><br><span class="line">        SQLiteConnection m_dbConnection;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Program p = <span class="keyword">new</span> Program();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Program</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            createNewDatabase();</span><br><span class="line">            connectToDatabase();</span><br><span class="line">            createTable();</span><br><span class="line">            fillTable();</span><br><span class="line">            printHighscores();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建一个空的数据库</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">createNewDatabase</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            SQLiteConnection.CreateFile(<span class="string">&quot;MyDatabase.db&quot;</span>);<span class="comment">//可以不要此句</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建一个连接到指定数据库</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">connectToDatabase</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            m_dbConnection = <span class="keyword">new</span> SQLiteConnection(<span class="string">&quot;Data Source=MyDatabase.db;Version=3;&quot;</span>);<span class="comment">//没有数据库则自动创建</span></span><br><span class="line">            m_dbConnection.Open();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//在指定数据库中创建一个table</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">createTable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="built_in">string</span> sql = <span class="string">&quot;create table  if not exists highscores (name varchar(20), score int)&quot;</span>;</span><br><span class="line">            SQLiteCommand command = <span class="keyword">new</span> SQLiteCommand(sql, m_dbConnection);</span><br><span class="line">            command.ExecuteNonQuery();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//插入一些数据</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">fillTable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="built_in">string</span> sql = <span class="string">&quot;insert into highscores (name, score) values (&#x27;Me&#x27;, 3000)&quot;</span>;</span><br><span class="line">            SQLiteCommand command = <span class="keyword">new</span> SQLiteCommand(sql, m_dbConnection);</span><br><span class="line">            command.ExecuteNonQuery();</span><br><span class="line"></span><br><span class="line">            sql = <span class="string">&quot;insert into highscores (name, score) values (&#x27;Myself&#x27;, 6000)&quot;</span>;</span><br><span class="line">            command = <span class="keyword">new</span> SQLiteCommand(sql, m_dbConnection);</span><br><span class="line">            command.ExecuteNonQuery();</span><br><span class="line"></span><br><span class="line">            sql = <span class="string">&quot;insert into highscores (name, score) values (&#x27;And I&#x27;, 9001)&quot;</span>;</span><br><span class="line">            command = <span class="keyword">new</span> SQLiteCommand(sql, m_dbConnection);</span><br><span class="line">            command.ExecuteNonQuery();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用sql查询语句，并显示结果</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">printHighscores</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="built_in">string</span> sql = <span class="string">&quot;select * from highscores order by score desc&quot;</span>;</span><br><span class="line">            SQLiteCommand command = <span class="keyword">new</span> SQLiteCommand(sql, m_dbConnection);</span><br><span class="line">            SQLiteDataReader reader = command.ExecuteReader();</span><br><span class="line">            <span class="keyword">while</span> (reader.Read())</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Name: &quot;</span> + reader[<span class="string">&quot;name&quot;</span>] + <span class="string">&quot;\tScore: &quot;</span> + reader[<span class="string">&quot;score&quot;</span>]);</span><br><span class="line">            Console.ReadLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Winform打包成安装程序</title>
      <link href="2023/07/28/WinformInstall/"/>
      <url>2023/07/28/WinformInstall/</url>
      
        <content type="html"><![CDATA[<p>1.打开Visual Studio，选择菜单栏“扩展”，在“管理扩展页面”搜索“installer”，选择 Microsoft Visual Studio Installer Projects 下载安装。</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdiNt.png"></p><p>2.安装完成后。右击解决方案，选择“添加”，“新建项目</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdZjg.png"></p><p>3.在添加新项目框中，搜索“Setup Project”，添加启动项目，然后设置启动项目的名称和位置</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdl40.png"><br><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdQNq.png"></p><p>4.右键Application Foluder-&gt;Add-&gt;文件</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdJvF.png"></p><p>5.debug文件夹中的所有文件ctrl+a全选，点击“打开”，会自动添加到目录</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdNDJ.png"><br><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxddER.png"></p><p>6.注意：ctrl+a导入之后，debug文件夹中文件会全部导进来，但是文件夹不会粘贴进来，需要我们手动新建对应文件夹，挨个将文件导入，如下(项目里没有文件夹的跳过此步骤)</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdDC6.png"><br><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdsgO.png"></p><p>建完文件夹后需要将Debug里面每个文件夹的文件导入</p><p> 在新建的文件夹右键→Add→文件</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdJvF.png"></p><p>将文件夹里面的文件全选，然后“打开”。</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdWVA.png"></p><p> 其他文件以此类推，debug里面有几个文件夹，我们这里就需要新建几个文件夹，然后将debug文件挨个导入。</p><p>7.添加“项目输出”，选择软件的主输出页面文件</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdj5q.png"><br><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxdzGV.png"><br><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxwPr4.png"></p><p>8.为主输出创建快捷方式，右键这个主输出-&gt;Create Shortcut to 创建一个快捷方式</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxwkZ9.png"><br> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxwEI1.png"></p><p>9.添加卸载程序</p><p> Application Folder右键→add→文件→在打开的面板中搜索“msiexec.exe”，点击打开</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxsJv6.png"><br> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxsyxP.png"></p><p>10.点击Setup1（您建的项目）将ProductCode 属性的值复制</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxsTx0.png"></p><p> 点击Shortcut to msiexec.exe =&gt; 将复制的ProductCode 属性值 粘贴在Arguments 属性中，然后在最前面加上 /X （注：/X后有一个空格）</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxsbrT.png"></p><p>11.最后将卸载拖动到User’s Programs Menu（用户的程序菜单）</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCx6pkQ.png"></p><p>12.添加程序图标</p><p> 右键点击“User’s Destop”中主输出文件的快捷方式，然后再其属性中找到，Icon属性，浏览选取你所要添加的图标（记住，应该先将图标放在打包的文件夹中，不然无法进行指定）</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxyZid.png"></p><p>13.设置安装环境</p><p> 右击Setup1（您建的项目）=&gt; 属性</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxyiqO.png"></p><p> 点击Prerequisites…</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxyKQP.png"></p><p> 选择如下选项 =&gt; 确定**<em>（此处选择所使用的.net的版本，此处我选用的是.NET桌面运行5.0.7（x86）.NET桌面运行5.0.7（x84））**</em></p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxyQL8.png"></p><p>14、生成安装包及卸载程序</p><p> 右键打包程序，点击“生成”</p><p> <img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxyJij.png"></p><p>15.合成</p><p>1.将要打在一起的文件及文件夹全部选中，右键 →“添加到压缩文件”，在打开的压缩面板的“常规”选项卡中勾选“创建自解压格式压缩文件”，此时会发现默认的压缩文件名编程了  .exe 后缀名了；压缩方式最好选择“存储”，这样打包后的程序会很快解压缩并运行。如图：</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxycWR.png"></p><p>2.设置运行文件：再切换到“高级”选项卡，点击“自解压选项”，“常规”→设置→设置程序→提取后运行和提取前运行里写入setup.exe 如图：</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxy2S1.png"></p><p>3.设置安装程序文件的图标</p><p>切换到“文本和图标”，点击“从文件加载自解压文件图标”后的“浏览”按钮，选择安装程序文件的图标，如图：</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxyWy6.png"></p><p>4.切换到“模式”下，勾选“解包到临时文件夹”和“隐藏全部”，再切换到“更新”下，勾选“覆盖所有文件”，一路点击“确定”，大功告成！！</p><p><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2023/07/28/pCxyO6P.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>流水号生成</title>
      <link href="2023/07/21/SoftNumericalOrder/"/>
      <url>2023/07/21/SoftNumericalOrder/</url>
      
        <content type="html"><![CDATA[<p>流水号组件所有的功能类都在 HslCommunication.BasicFramework 命名空间，所以再使用之前先添加</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> HslCommunication.BasicFramework</span><br></pre></td></tr></table></figure><p> 首先，流水号的类就应该设置在服务器端，这样就能对所有的客户端进行掌控申请。服务器端的实例化如下所示：<br> <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FormSeqTest_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   HslCommunication.BasicFramework.SoftNumericalOrder softNumericalOrder = <span class="keyword">new</span> HslCommunication.BasicFramework.SoftNumericalOrder(</span><br><span class="line">        <span class="string">&quot;ABC&quot;</span>,              <span class="comment">// &quot;ABC201711090000001&quot; 中的ABC前缀，代码中仍然可以更改ABC</span></span><br><span class="line">        <span class="string">&quot;yyyyMMdd&quot;</span>,         <span class="comment">// &quot;ABC201711090000001&quot; 中的20171109，可以格式化时间，也可以为&quot;&quot;，也可以设置为&quot;yyyyMMddHHmmss&quot;;</span></span><br><span class="line">        <span class="number">7</span>,                  <span class="comment">// &quot;ABC201711090000001&quot; 中的0000001，总位数为7，然后不停的累加，即使日期时间变了，也不停的累加，最好长度设置大一些</span></span><br><span class="line">        Application.StartupPath + <span class="string">@&quot;\numericalOrder.txt&quot;</span>  <span class="comment">// 该生成器会自动存储当前值到文件去，实例化时从文件加载，自动实现数据同步</span></span><br><span class="line">        );</span><br><span class="line"> </span><br><span class="line">   <span class="comment">// 获取流水号，带有默认的数据头，也即实例化中的&quot;ABC&quot;</span></span><br><span class="line">   <span class="built_in">string</span> seqNumber = softNumericalOrder.GetNumericalOrder();</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 获取流水号，带有自定义的数据头</span></span><br><span class="line">   <span class="built_in">string</span> seqNumber = softNumericalOrder.GetNumericalOrder(<span class="string">&quot;XYZ&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p>注意：序号的位数最高可以设置为20位，即2的64次方，任何系统都够用了，一秒钟生成1亿个，可以使用5800年</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Autojs介绍及案例</title>
      <link href="2023/07/18/AutojsExample/"/>
      <url>2023/07/18/AutojsExample/</url>
      
        <content type="html"><![CDATA[<h1 id="全局"><a href="#全局" class="headerlink" title="全局"></a>全局</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">waitForPackage(package[, period = <span class="number">200</span>])<span class="comment">//等待指定的应用出现。</span></span><br><span class="line">waitForPackage(<span class="string">&quot;com.tencent.mm&quot;</span>)<span class="comment">//例如等待当前界面为微信</span></span><br><span class="line">waitForActivity(activity[, period = <span class="number">200</span>])<span class="comment">//等待指定的Activity出现，period为检查Activity的间隔。</span></span><br><span class="line">waitForActivity(<span class="string">&quot;com.ss.android.ugc.aweme.following.ui.FollowRelationTabActivity&quot;</span>)<span class="comment">//等待抖音其他用户的关注列表页面出现：</span></span><br><span class="line">sleep(n)<span class="comment">//毫秒数</span></span><br><span class="line">log(<span class="string">&quot;message&quot;</span>)<span class="comment">//打印日志</span></span><br><span class="line">toast(<span class="string">&quot;message&quot;</span>)<span class="comment">//气泡提示</span></span><br><span class="line">toastLog(<span class="string">&quot;message&quot;</span>)<span class="comment">//打印日志并气泡提示</span></span><br><span class="line">setClip(<span class="string">&quot;text&quot;</span>)<span class="comment">//设置剪贴板内容</span></span><br><span class="line">exit()<span class="comment">//立即停止脚本运行</span></span><br><span class="line">random(min, max)<span class="comment">//随机数</span></span><br></pre></td></tr></table></figure><h1 id="应用-App"><a href="#应用-App" class="headerlink" title="应用(App)"></a>应用(App)</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">launch(<span class="string">&quot;包名&quot;</span>)<span class="comment">//通过包名启动应用</span></span><br><span class="line">launchPackage(<span class="string">&quot;包名&quot;</span>)<span class="comment">//通过包名启动应用</span></span><br><span class="line">launchApp(appName)<span class="comment">//通过名称启动应用</span></span><br><span class="line">getPackageName(appName)<span class="comment">//获取应用名称对应的已安装的应用的包名</span></span><br><span class="line">getAppName(<span class="string">&quot;包名&quot;</span>)<span class="comment">//获取应用包名对应的已安装的应用的名称</span></span><br><span class="line">app.openAppSetting(<span class="string">&quot;包名&quot;</span>)<span class="comment">//打开应用的详情页(设置页)。返回false; 否则返回true(全局)</span></span><br><span class="line">app.editFile(<span class="string">&quot;/sdcard/1.txt/);//用其他应用编辑文件文本文件</span></span><br><span class="line"><span class="string">app.uninstall(&quot;</span>com.tencent.mobileqq<span class="string">&quot;);//卸载应用</span></span><br><span class="line"><span class="string">app.openUrl(&quot;</span>包名<span class="string">&quot;);//浏览器打开网站，Url，如果不以&quot;</span>http:<span class="comment">//&quot;或&quot;https://“开头则默认是&quot;http://”</span></span><br></pre></td></tr></table></figure><h1 id="坐标"><a href="#坐标" class="headerlink" title="坐标"></a>坐标</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">setScreenMetrics(width, height)在width*height的设备中，坐标操作自适应</span><br><span class="line">width &#123;number&#125; <span class="comment">//屏幕宽度，单位像素</span></span><br><span class="line">height &#123;number&#125; <span class="comment">//屏幕高度，单位像素</span></span><br><span class="line">click(x, y)<span class="comment">//点击</span></span><br><span class="line">longClick(x, y)<span class="comment">//长按</span></span><br><span class="line">press(x, y, duration)<span class="comment">//按住</span></span><br><span class="line">swipe(x1, y1, x2, y2, duration)<span class="comment">//滑动</span></span><br><span class="line">swipeEx(x1, y1, x2, y2, duration)<span class="comment">//仿真随机曲线滑动</span></span><br><span class="line">gesture(duration, [x1, y1], [x2, y2], …)<span class="comment">//手势路径，时长2s</span></span><br><span class="line">gestures([delay1, duration1, [x1, y1], [x2, y2], …], [delay2, duration2, [x3, y3], [x4, y4], …], …)<span class="comment">//延时多点手势路径</span></span><br></pre></td></tr></table></figure><h1 id="控件"><a href="#控件" class="headerlink" title="控件"></a>控件</h1><h2 id="文本控件"><a href="#文本控件" class="headerlink" title="文本控件"></a>文本控件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">setText([i, ]text)<span class="comment">//输入框的文本置为text//返回是否输入成功。当找不到对应的文本框时返回false。//i表示i + 1个输入框</span></span><br><span class="line">input([i, ]text)<span class="comment">//输入框文本追加内容text//返回是否输入成功。当找不到对应的文本框时返回false。//i表示i + 1个输入框</span></span><br><span class="line">click(text[, i])<span class="comment">//点击大部分包含文字的按钮</span></span><br><span class="line"><span class="keyword">while</span>(!click(<span class="string">&quot;扫一扫&quot;</span>));<span class="comment">//通常与while同时使用以便点击按钮直至成功</span></span><br><span class="line">longClick(text[, i]))<span class="comment">//长按文本</span></span><br></pre></td></tr></table></figure><h2 id="滑动控件"><a href="#滑动控件" class="headerlink" title="滑动控件"></a>滑动控件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scrollUp([i])<span class="comment">//找到第i+1个可滑动控件上滑或左滑。</span></span><br><span class="line">scrollDown([i])<span class="comment">//找到第i+1个可滑动控件下滑或右滑</span></span><br><span class="line">className(<span class="string">&quot;ImageView&quot;</span>).depth(<span class="number">10</span>).findOne().click()<span class="comment">//多条件定位点击</span></span><br></pre></td></tr></table></figure><h2 id="方形控件"><a href="#方形控件" class="headerlink" title="方形控件"></a>方形控件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Rect<span class="comment">//UiObject.bounds(), UiObject.boundsInParent()返回的对象。//表示一个长方形(范围)。</span></span><br><span class="line">Rect.left<span class="comment">//长方形左边界的x坐标</span></span><br><span class="line">Rect.right<span class="comment">//长方形右边界的x坐标</span></span><br><span class="line">Rect.top<span class="comment">//长方形上边界的y坐标</span></span><br><span class="line">Rect.bottom<span class="comment">//长方形下边界的y坐标</span></span><br><span class="line">Rect.centerX()<span class="comment">//长方形中点x坐标</span></span><br><span class="line">Rect.centerY()<span class="comment">//长方形中点y坐标</span></span><br><span class="line">Rect.width()<span class="comment">//长方形宽度。通常可以作为控件宽度</span></span><br><span class="line">Rect.height()<span class="comment">//长方形高度。通常可以作为控件高度</span></span><br><span class="line">device.width来获取屏幕宽度</span><br><span class="line">device.height来获取屏幕高度</span><br><span class="line">Rect.contains(Rect)<span class="comment">//返回是否包含另一个长方形r。包含指的是，长方形r在该长方形的里面(包含边界重叠的情况)。</span></span><br><span class="line">Rect.intersect(Rect)<span class="comment">//返回是否和另一个长方形相交。</span></span><br></pre></td></tr></table></figure><h1 id="选择器进阶"><a href="#选择器进阶" class="headerlink" title="选择器进阶"></a>选择器进阶</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">UiSelector.text(str)<span class="comment">//text控件str</span></span><br><span class="line">UiSelector.textContains(包含)<span class="comment">//包含</span></span><br><span class="line">UiSelector.textStartsWith(前缀)<span class="comment">//前缀</span></span><br><span class="line">UiSelector.textEndsWith(后缀)<span class="comment">//后缀</span></span><br><span class="line">UiSelector.textMatches(正则)<span class="comment">//正则</span></span><br><span class="line">UiSelector.desc(str)<span class="comment">//desc控件str</span></span><br><span class="line">UiSelector.descContains(前缀)<span class="comment">//前缀</span></span><br><span class="line">UiSelector.descStartsWith(prefix)<span class="comment">//</span></span><br><span class="line">UiSelector.descEndsWith(suffix)<span class="comment">//</span></span><br><span class="line">UiSelector.descMatches(正则)<span class="comment">//正则</span></span><br><span class="line">UiSelector.id(str)<span class="comment">//id控件str</span></span><br><span class="line">UiSelector.idContains(包含)<span class="comment">//包含</span></span><br><span class="line">UiSelector.idStartsWith(前缀)<span class="comment">//前缀</span></span><br><span class="line">UiSelector.idEndsWith(后缀)<span class="comment">//后缀</span></span><br><span class="line">UiSelector.idMatches(正则)<span class="comment">//正则</span></span><br><span class="line">UiSelector.className(str)<span class="comment">//className控件str</span></span><br><span class="line">UiSelector.classNameContains(包含)包含</span><br><span class="line">UiSelector.classNameStartsWith(前缀)<span class="comment">//前缀</span></span><br><span class="line">UiSelector.classNameEndsWith(后缀)<span class="comment">//后缀</span></span><br><span class="line">UiSelector.classNameMatches(正则)为正则</span><br><span class="line">UiSelector.packageName(str)packageName控件str</span><br><span class="line">UiSelector.packageNameContains(包含)包含</span><br><span class="line">UiSelector.packageNameStartsWith(前缀)<span class="comment">//前缀</span></span><br><span class="line">UiSelector.packageNameEndsWith(后缀)<span class="comment">//后缀</span></span><br><span class="line">UiSelector.packageNameMatches(正则)<span class="comment">//正则</span></span><br><span class="line"></span><br><span class="line">(左边距；上边距；下边距；右边距)</span><br><span class="line">UiSelector.bounds(left, top, right, buttom)<span class="comment">//定位控件的bounds属性为屏幕上显示的范围。</span></span><br><span class="line">UiSelector.boundsInside(left, top, right, buttom)在参数构成的范围里面查找符合条件的控件。用于限制选择器在某一个区域选择控件。</span><br><span class="line">UiSelector.boundsContains(left, top, right, buttom)在参数构成的范围里面查找符合条件的控件。用于限制控件的范围必须包含所给定的范围。</span><br><span class="line">UiSelector.drawingOrder(number)<span class="comment">//为一个控件在父控件中的绘制顺序，通常可以用于区分同一层次的控件。为当前选择器附加控件&quot;drawingOrder等于order&quot;的条件。</span></span><br><span class="line">UiSelector.clickable([b = <span class="literal">true</span>])为当前选择器附加控件是否可点击的条件。类名为android.view.View的控件大多可点击</span><br><span class="line">UiSelector.longClickable([b = <span class="literal">true</span>])为当前选择器附加控件是否可长按的条件。</span><br><span class="line">UiSelector.checkable([b = <span class="literal">true</span>])为当前选择器附加控件是否可勾选的条件。</span><br><span class="line">UiSelector.selected([b = <span class="literal">true</span>])为当前选择器附加控件是否已选中的条件。</span><br><span class="line">UiSelector.enabled([b = <span class="literal">true</span>])为当前选择器附加控件是否已启用的条件。</span><br><span class="line">UiSelector.scrollable([b = <span class="literal">true</span>])为当前选择器附加控件是否可滑动的条件。可以用这个条件来寻找可滑动控件来滑动界面。</span><br><span class="line"></span><br><span class="line">UiSelector.editable([b = <span class="literal">true</span>])为当前选择器附加控件是否可编辑的条件；一般来说可编辑的控件为输入框(EditText)但不是所有</span><br><span class="line">UiSelector.multiLine([b = <span class="literal">true</span>])为当前选择器附加控件是否文本或输入框控件是否是多行显示的条件。</span><br><span class="line">UiSelector.findOne()对屏幕上的控件进行搜索，找不到控件，当屏幕内容发生变化时会重新寻找，直到屏幕上出现并返回该控件。未出现则阻塞</span><br><span class="line">UiSelector.findOne(timeout)毫秒的时间内没有找到终止搜索并返回<span class="literal">null</span></span><br><span class="line">UiSelector.findOnce()对屏幕上的控件进行搜索，只找一次；返回第<span class="number">1</span>个符合条件的控件；否则返回<span class="literal">null</span></span><br><span class="line">UiSelector.findOnce(i)对屏幕上的控件进行搜索，只找一次；返回第 i + <span class="number">1</span> 个符合条件的控件；否则返回<span class="literal">null</span></span><br><span class="line">UiSelector.find()对屏幕上的控件进行搜索，找到所有满足条件的控件集合并返回。只进行一次</span><br><span class="line">empty()函数判断找到的是否为空</span><br><span class="line">UiSelector.untilFind()对屏幕上的控件进行搜索，直到找到至少一个满足条件的控件为止，并返回所有满足条件的控件集合。</span><br><span class="line">UiSelector.exists()判断屏幕上是否存在控件符合选择器所确定的条件；一般搭配<span class="keyword">if</span>使用</span><br><span class="line">UiSelector.waitFor()等待屏幕上出现符合条件的控件；在满足该条件的控件出现之前，该函数会一直保持阻塞。</span><br><span class="line">UiSelector.filter(f)为当前选择器附加自定义的过滤条件。</span><br></pre></td></tr></table></figure><h1 id="UiSelector选择器"><a href="#UiSelector选择器" class="headerlink" title="UiSelector选择器"></a>UiSelector选择器</h1><h2 id="控件属性"><a href="#控件属性" class="headerlink" title="控件属性"></a>控件属性</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">className 类名。类名表示一个控件的类型，例如文本控件为<span class="string">&quot;android.widget.TextView&quot;</span>, 图片控件为<span class="string">&quot;android.widget.ImageView&quot;</span>等。</span><br><span class="line">packageName 包名。包名表示控件所在的应用包名，例如QQ界面的控件的包名为<span class="string">&quot;com.tencent.mobileqq&quot;</span>。</span><br><span class="line">bounds 控件在屏幕上的范围。</span><br><span class="line">drawingOrder 控件在父控件的绘制顺序。</span><br><span class="line">indexInParent 控件在父控件的位置。</span><br><span class="line">clickable 控件是否可点击。</span><br><span class="line">longClickable 控件是否可长按。</span><br><span class="line">checkable 控件是否可勾选。</span><br><span class="line">checked 控件是否可已勾选。</span><br><span class="line">scrollable 控件是否可滑动。</span><br><span class="line">selected 控件是否已选择。</span><br><span class="line">editable 控件是否可编辑。</span><br><span class="line">visibleToUser 控件是否可见，可以筛选在屏幕可视范围内的组件。</span><br><span class="line">enabled 控件是否已启用。</span><br><span class="line">depth 控件的布局深度。</span><br></pre></td></tr></table></figure><h2 id="控件类型"><a href="#控件类型" class="headerlink" title="控件类型"></a>控件类型</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">android.widget.TextView<span class="comment">//文本控件</span></span><br><span class="line">android.widget.ImageView<span class="comment">//图片控件</span></span><br><span class="line">android.widget.Button<span class="comment">//按钮控件</span></span><br><span class="line">android.widget.EditText<span class="comment">//输入框控件</span></span><br><span class="line">android.widget.AbsListView<span class="comment">//列表控件</span></span><br><span class="line">android.widget.LinearLayout<span class="comment">//线性布局</span></span><br><span class="line">android.widget.FrameLayout<span class="comment">//帧布局</span></span><br><span class="line">android.widget.RelativeLayout<span class="comment">//相对布局</span></span><br><span class="line">android.widget.RelativeLayout<span class="comment">//相对布局</span></span><br><span class="line">android.support.v7.widget.RecyclerView<span class="comment">//通常也是列表控件</span></span><br></pre></td></tr></table></figure><h1 id="选择器操作"><a href="#选择器操作" class="headerlink" title="选择器操作"></a>选择器操作</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">exits() 判断控件是否存在</span><br><span class="line">waitFor() 等待控件出现</span><br><span class="line">UiObject.click()<span class="comment">//点击该控件，并返回是否点击成功。</span></span><br><span class="line">UiObject.longClick()<span class="comment">//长按该控件，并返回是否点击成功。</span></span><br><span class="line">UiObject.setText(text)<span class="comment">//设置输入框控件的文本内容，并返回是否设置成功。</span></span><br><span class="line">UiObject.copy()<span class="comment">//对输入框文本的选中内容进行复制，并返回是否操作成功。</span></span><br><span class="line">UiObject.cut()<span class="comment">//对输入框文本的选中内容进行剪切，并返回是否操作成功。</span></span><br><span class="line">UiObject.paste()<span class="comment">//对输入框控件进行粘贴操作，把剪贴板内容粘贴到输入框中，并返回是否操作成功。</span></span><br><span class="line">UiObject.setSelection(start, end)<span class="comment">//对输入框控件设置选中的文字内容，并返回是否操作成功。</span></span><br><span class="line">UiObject.scrollForward()<span class="comment">//对控件执行向前滑动的操作，并返回是否操作成功。</span></span><br><span class="line">UiObject.scrollBackward()<span class="comment">//对控件执行向后滑动的操作，并返回是否操作成功。</span></span><br><span class="line">UiObject.select()<span class="comment">//对控件执行&quot;选中&quot;操作，并返回是否操作成功。&quot;选中&quot;和isSelected()的属性相关</span></span><br><span class="line">UiObject.collapse()<span class="comment">//对控件执行折叠操作，并返回是否操作成功。</span></span><br><span class="line">UiObject.expand()<span class="comment">//对控件执行操作，并返回是否操作成功。</span></span><br><span class="line">UiObject.show()<span class="comment">//对集合中所有控件执行显示操作，并返回是否全部操作成功。</span></span><br><span class="line">UiObject.scrollUp()<span class="comment">//对集合中所有控件执行向上滑的操作，并返回是否全部操作成功。</span></span><br><span class="line">UiObject.scrollDown()<span class="comment">//对集合中所有控件执行向下滑的操作，并返回是否全部操作成功。</span></span><br><span class="line">UiObject.scrollLeft()<span class="comment">//对集合中所有控件执行向左滑的操作，并返回是否全部操作成功。</span></span><br><span class="line">UiObject.scrollRight()<span class="comment">//对集合中所有控件执行向右滑的操作，并返回是否全部操作成功。</span></span><br><span class="line">children()<span class="comment">//返回该控件的所有子控件组成的控件集合。可以用于遍历一个控件的子控件</span></span><br><span class="line">childCount()<span class="comment">//返回子控件数目。</span></span><br><span class="line">parent()<span class="comment">//返回该控件的父控件。如果该控件没有父控件，返回null。</span></span><br><span class="line">bounds()<span class="comment">//返回控件在屏幕上的范围，其值是一个Rect对象。</span></span><br><span class="line">boundsInParent()<span class="comment">//返回控件在父控件中的范围，其值是一个Rect对象。</span></span><br><span class="line">drawingOrder()<span class="comment">//返回控件在父控件中的绘制次序。</span></span><br><span class="line">id()<span class="comment">//获取控件的id，如果一个控件没有id，则返回null。</span></span><br><span class="line">text()<span class="comment">//获取控件的文本，如果控件没有文本，返回&quot;&quot;。</span></span><br><span class="line">findByText(str)<span class="comment">//根据文本text在子控件中递归地寻找并返回文本或描述(desc)包含这段文本str的控件，返回它们组成的集合。</span></span><br><span class="line">findOne(selector)<span class="comment">//根据选择器selector在该控件的子控件、孙控件…中搜索符合该选择器条件的控件，并返回找到的第一个控件；如果没有找到符合条件的控件则返回null。</span></span><br><span class="line">find(selector)<span class="comment">//根据选择器selector在该控件的子控件、孙控件…中搜索符合该选择器条件的控件，并返回它们组合的集合。</span></span><br><span class="line">UiCollection<span class="comment">//控件集合, 通过选择器的find(), untilFind()方法返回的对象。</span></span><br><span class="line">UiCollection.size()<span class="comment">//返回集合中的控件数。历史遗留函数，相当于属性length。</span></span><br><span class="line">UiCollection.get(i)<span class="comment">//返回集合中第i+1个控件(UiObject)。历史遗留函数，建议直接使用数组下标的方式访问元素。</span></span><br><span class="line">UiCollection.each(func)<span class="comment">//遍历集合。历史遗留函数，相当于forEach。参考forEach。</span></span><br><span class="line">empty()<span class="comment">//返回控件集合是否为空。</span></span><br><span class="line">nonEmpty()<span class="comment">//返回控件集合是否非空。</span></span><br><span class="line">UiCollection.find(selector)<span class="comment">//根据selector所确定的条件在该控件集合的控件、子控件、孙控件…中找到所有符合条件的控件并返回找到的控件集合。</span></span><br><span class="line">UiCollection.findOne(selector)<span class="comment">//根据选择器selector在该控件集合的控件的子控件、孙控件…中搜索符合该选择器条件的控件，并返回找到的第一个控件；如果没有找到符合条件的控件则返回null。</span></span><br></pre></td></tr></table></figure><h1 id="模拟按键"><a href="#模拟按键" class="headerlink" title="模拟按键"></a>模拟按键</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">back()返回</span><br><span class="line">home()Home键</span><br><span class="line">recents()显示最近任务。</span><br><span class="line">powerDialog()电源键菜单</span><br><span class="line">notifications()拉出通知栏。</span><br><span class="line">quickSettings()显示快速设置(下拉通知栏到底)。</span><br><span class="line">splitScreen()分屏。</span><br></pre></td></tr></table></figure><blockquote><p>示例:</p></blockquote><h2 id="一般排序"><a href="#一般排序" class="headerlink" title="一般排序"></a>一般排序</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id(<span class="string">&quot;recent_chat_list&quot;</span>).className(<span class="string">&quot;AbsListView&quot;</span>).findOne().scrollForward();</span><br></pre></td></tr></table></figure><h2 id="在屏幕上半部分寻找文本控件TextView"><a href="#在屏幕上半部分寻找文本控件TextView" class="headerlink" title="在屏幕上半部分寻找文本控件TextView"></a>在屏幕上半部分寻找文本控件TextView</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> w = className(<span class="string">&quot;TextView&quot;</span>).boundsInside(<span class="number">0</span>, <span class="number">0</span>, device.width, device.height / <span class="number">2</span>).findOne();</span><br><span class="line">log(w.text());</span><br></pre></td></tr></table></figure><h2 id="findOne设置延时寻找控件"><a href="#findOne设置延时寻找控件" class="headerlink" title="findOne设置延时寻找控件"></a>findOne设置延时寻找控件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//启动Auto.js</span></span><br><span class="line">launchApp(<span class="string">&quot;Auto.js&quot;</span>);</span><br><span class="line"><span class="comment">//在6秒内找出日志图标的控件</span></span><br><span class="line"><span class="keyword">var</span> object = id(<span class="string">&quot;action_log&quot;</span>).findOne(<span class="number">6000</span>);</span><br><span class="line"><span class="comment">//如果找到控件则点击</span></span><br><span class="line"><span class="keyword">if</span>(object != <span class="literal">null</span>)&#123;</span><br><span class="line">object.click();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//否则提示没有找到</span></span><br><span class="line">toast(<span class="string">&quot;没有找到日志图标&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="findOnce"><a href="#findOnce" class="headerlink" title="findOnce"></a>findOnce</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> object = text(<span class="string">&quot;抖音号&quot;</span>).findOnce()</span><br><span class="line">log(object)</span><br><span class="line"><span class="keyword">if</span> (object != <span class="literal">null</span>) &#123;</span><br><span class="line">log(<span class="string">&quot;已找到&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">log(<span class="string">&quot;Error:未找到&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="findOnce-1"><a href="#findOnce-1" class="headerlink" title="findOnce()"></a>findOnce()</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">object = text(<span class="string">&quot;在线&quot;</span>).findOnce();</span><br><span class="line"><span class="keyword">if</span> (object != <span class="literal">null</span>) &#123;</span><br><span class="line">log(object.parent().parent().click()) <span class="comment">//点击元素</span></span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//错误处理</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="setText"><a href="#setText" class="headerlink" title="setText"></a>setText</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//刷屏-------------------</span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">className(<span class="string">&quot;EditText&quot;</span>).findOne().setText(<span class="string">&quot;刷屏...&quot;</span>);</span><br><span class="line">text(<span class="string">&quot;发送&quot;</span>).findOne().clicK();</span><br><span class="line">sleep(<span class="number">500</span>); </span><br><span class="line">&#125;</span><br><span class="line">或者</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">className(<span class="string">&quot;EditText&quot;</span>).setText(<span class="string">&quot;刷屏...&quot;</span>);</span><br><span class="line">text(<span class="string">&quot;发送&quot;</span>).clicK();</span><br><span class="line">sleep(<span class="number">500</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="App"><a href="#App" class="headerlink" title="App"></a>App</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//启动APP------</span></span><br><span class="line"><span class="keyword">if</span> (currentPackage() != <span class="string">&quot;com.chaoxing.mobile&quot;</span>) &#123;<span class="comment">//是否不在APP界面toast(&quot;即将打开超星！&quot;); //直接打开学习通app.launchApp(&quot;学习通&quot;);//不在则打开&#125; else &#123;//否则就是在页面toast(&quot;已经在学习通中，即将开始进行下一步操作！&quot;);//不执行操作&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//强制停止应用------</span></span><br><span class="line"><span class="string">&quot;auto&quot;</span>;<span class="keyword">var</span> appName = rawInput(<span class="string">&quot;请输入应用名称&quot;</span>);openAppSetting(getPackageName(appName));<span class="keyword">while</span>(!click(<span class="string">&quot;强制停止&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="发送意图"><a href="#发送意图" class="headerlink" title="发送意图"></a>发送意图</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送意图-文本消息分享------</span></span><br><span class="line"><span class="keyword">var</span> content = rawInput(<span class="string">&#x27;请输入要分享的文本&#x27;</span>);</span><br><span class="line">app.startActivity(&#123;</span><br><span class="line">action: <span class="string">&quot;android.intent.action.SEND&quot;</span>,</span><br><span class="line">type: <span class="string">&quot;text/*&quot;</span>,</span><br><span class="line">extras: &#123;</span><br><span class="line"><span class="string">&quot;android.intent.extra.TEXT&quot;</span>: content</span><br><span class="line">&#125;,</span><br><span class="line">packageName: <span class="string">&quot;com.tencent.mobileqq&quot;</span>,</span><br><span class="line">className: <span class="string">&quot;com.tencent.mobileqq.activity.JumpActivity&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="事件监听"><a href="#事件监听" class="headerlink" title="事件监听"></a>事件监听</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">events.onKeyDown(keyName, listener);  <span class="comment">// keyName:要监听的按键名称，listener：按键监听器</span></span><br><span class="line">- volume_up 音量上键</span><br><span class="line">- volume_down 音量下键</span><br><span class="line">- home 主屏幕键</span><br><span class="line">- back 返回键</span><br><span class="line">- menu 菜单键</span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">//启用按键监听</span></span><br><span class="line">events.observeKey();</span><br><span class="line"><span class="comment">//监听&quot;主屏幕键按下</span></span><br><span class="line">events.onKeyDown(<span class="string">&quot;home&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;主屏幕键被按下了&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//监听返回键按下</span></span><br><span class="line">events.onKeyDown(<span class="string">&quot;back&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;返回键被按下了&quot;</span>);</span><br><span class="line">    exit();</span><br><span class="line">&#125;);</span><br><span class="line">events.onKeyUp(keyName, listener);  <span class="comment">// keyName:要监听的按键名称，listener：按键监听器 </span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">//启用按键监听</span></span><br><span class="line">events.observeKey();</span><br><span class="line"><span class="comment">//监听音量下键弹起</span></span><br><span class="line">events.onKeyDown(<span class="string">&quot;volume_down&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;音量上键弹起&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//监听Home键弹起</span></span><br><span class="line">events.onKeyDown(<span class="string">&quot;home&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;Home键弹起&quot;</span>);</span><br><span class="line">    exit();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="悬浮窗"><a href="#悬浮窗" class="headerlink" title="悬浮窗"></a>悬浮窗</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">floaty.window(layout);   <span class="comment">// 指定悬浮窗的布局，创建并显示一个悬浮窗</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> w = floaty.window(</span><br><span class="line">    &lt;frame gravity=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line">        &lt;text id=<span class="string">&quot;text&quot;</span>&gt;悬浮文字&lt;/text&gt;</span><br><span class="line">    &lt;/frame&gt;</span><br><span class="line">);</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123; &#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">floaty.rawWindow(layout); <span class="comment">// 指定悬浮窗的布局，创建并显示一个原始悬浮窗，您可以根据自己需要编写任何布局</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> w = floaty.rawWindow(</span><br><span class="line">    &lt;frame gravity=<span class="string">&quot;center&quot;</span>&gt;</span><br><span class="line">        &lt;text id=<span class="string">&quot;text&quot;</span>&gt;悬浮文字&lt;/text&gt;</span><br><span class="line">    &lt;/frame&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">w.setPosition(<span class="number">500</span>, <span class="number">500</span>);   设置悬浮窗位置。</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    w.close();</span><br><span class="line">&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure><h2 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">files.createWithDirs(path);  <span class="comment">// 创建一个文件或文件夹并返回是否创建成功。如果文件所在文件夹不存在，则先创建他所在的一系列文件夹</span></span><br><span class="line">举个例子：</span><br><span class="line">files.createWithDirs(<span class="string">&quot;/sdcard/新文件夹/新文件夹/新文件夹/1.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">files.exists(path);   <span class="comment">// 返回在路径path处的文件是否存在。</span></span><br><span class="line">举个例子：</span><br><span class="line">log(files.exists(<span class="string">&quot;/sdcard/新文件夹/新文件夹/新文件夹/1.txt&quot;</span>));</span><br><span class="line"></span><br><span class="line">files.read(path[, encoding = <span class="string">&quot;utf-8&quot;</span>]);  <span class="comment">// 读取文本文件path的所有内容并返回</span></span><br><span class="line">举个例子：</span><br><span class="line">log(files.read(<span class="string">&quot;/sdcard/1.txt&quot;</span>, encoding = <span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">files.write(path, text);   <span class="comment">// 把text写入到文件path中。 新的text会覆盖以前的</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> text = <span class="string">&quot;这是一个文件内容&quot;</span>;</span><br><span class="line"><span class="comment">// 判断是否有此文件，如果没就创建一个</span></span><br><span class="line">files.createWithDirs(<span class="string">&quot;/sdcard/1.txt&quot;</span>);</span><br><span class="line"><span class="comment">//写入文件</span></span><br><span class="line">files.write(<span class="string">&quot;/sdcard/1.txt&quot;</span>, text);</span><br><span class="line"><span class="comment">//用其他应用查看文件</span></span><br><span class="line">app.viewFile(<span class="string">&quot;/sdcard/1.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">files.append(path, text);  <span class="comment">// 把text追加到文件path的末尾</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> text = <span class="string">&quot;追加的文件内容&quot;</span>;</span><br><span class="line">files.append(<span class="string">&quot;/sdcard/1.txt&quot;</span>, text);</span><br><span class="line">files.append(<span class="string">&quot;/sdcard/1.txt&quot;</span>, text);</span><br><span class="line"><span class="comment">//用其他应用查看文件</span></span><br><span class="line">app.viewFile(<span class="string">&quot;/sdcard/1.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">files.copy(fromPath, toPath);  <span class="comment">// 复制文件，返回是否复制成功</span></span><br><span class="line">举个例子：</span><br><span class="line">files.copy(<span class="string">&quot;/sdcard/1.txt&quot;</span>, <span class="string">&quot;/sdcard/Download/1.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">files.move(fromPath, toPath);  <span class="comment">// 移动文件，返回是否移动成功也可改名</span></span><br><span class="line">举个例子：</span><br><span class="line">files.move(<span class="string">&quot;/sdcard/1.txt&quot;</span>, <span class="string">&quot;/sdcard/Download/1.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">files.getName(path);  <span class="comment">// 返回文件的文件名</span></span><br><span class="line">举个例子：</span><br><span class="line">log(files.getName(<span class="string">&quot;/sdcard/1.txt&quot;</span>));</span><br><span class="line"></span><br><span class="line">files.remove(path);  <span class="comment">// 删除文件或空文件夹，返回是否删除成功</span></span><br><span class="line">举个例子：</span><br><span class="line">log(files.remove(<span class="string">&quot;/sdcard/1.txt&quot;</span>));</span><br><span class="line"></span><br><span class="line">files.removeDir(path);  <span class="comment">// 删除文件夹，如果文件夹不为空，则删除该文件夹的所有内容再删除该文件夹</span></span><br><span class="line">举个例子：</span><br><span class="line">log(files.removeDir(<span class="string">&quot;/sdcard/1.txt&quot;</span>));</span><br><span class="line"></span><br><span class="line">files.getSdcardPath();  <span class="comment">// 返回SD卡路径</span></span><br><span class="line">举个例子：</span><br><span class="line">log(files.getSdcardPath());   <span class="comment">// 返回结果：/storage/emulated/0</span></span><br><span class="line"></span><br><span class="line">close();  <span class="comment">// 关闭该文件</span></span><br></pre></td></tr></table></figure><h2 id="全局函数"><a href="#全局函数" class="headerlink" title="全局函数"></a>全局函数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">sleep(n);  <span class="comment">// n:暂停运行n毫秒的时间。1秒等于1000毫秒。</span></span><br><span class="line">举个例子：</span><br><span class="line">sleep(<span class="number">1000</span>);  <span class="comment">// 暂停运行1秒</span></span><br><span class="line"></span><br><span class="line">currentPackage(); <span class="comment">// 返回正在运行的应用的包名</span></span><br><span class="line">举个例子：</span><br><span class="line">log(currentPackage());  <span class="comment">// 返回：org.autojs.autojspro</span></span><br><span class="line"></span><br><span class="line">currentActivity();  <span class="comment">// 返回正在运行的Activity的名称</span></span><br><span class="line">举个例子：</span><br><span class="line">log(currentActivity());  <span class="comment">// 返回：org.autojs.autojs.ui.main.MainActivity</span></span><br><span class="line"></span><br><span class="line">toast(message);  <span class="comment">// 以气泡显示信息message几秒</span></span><br><span class="line">举个例子：</span><br><span class="line">toast(<span class="string">&quot;你好autoJS&quot;</span>); <span class="comment">// 屏幕出现  你好autoJS 字样，几秒后消失</span></span><br><span class="line"></span><br><span class="line">toastLog(message);  <span class="comment">// 显示信息message并在控制台中输出</span></span><br><span class="line">举个例子：</span><br><span class="line">toastLog(<span class="string">&quot;你好autoJS&quot;</span>);  <span class="comment">// 屏幕和控制台同时出现 你好autoJS 字样</span></span><br><span class="line"></span><br><span class="line">waitForActivity(activity]); <span class="comment">// activity:等待指定的Activity出现，period:为检查Activity的间隔。</span></span><br><span class="line">举个例子：</span><br><span class="line">log(waitForActivity(<span class="string">&quot;org.autojs.autojs.ui.main.MainActivity&quot;</span>)); </span><br><span class="line"></span><br><span class="line">waitForPackage(package);  <span class="comment">// 等待指定的应用出现</span></span><br><span class="line">举个例子：</span><br><span class="line">waitForPackage(<span class="string">&quot;org.autojs.autojspro&quot;</span>); </span><br><span class="line"></span><br><span class="line">exit();   <span class="comment">// 立即停止脚本运行。</span></span><br><span class="line"></span><br><span class="line">random(min, max);   <span class="comment">// 返回一个在[min...max]之间的随机数</span></span><br><span class="line">举个例子：</span><br><span class="line">log(random(<span class="number">0</span>, <span class="number">2</span>));   <span class="comment">// 返回可能时0，1，2</span></span><br><span class="line"></span><br><span class="line">random();   <span class="comment">// 返回一个[0，1)的随机浮点数</span></span><br></pre></td></tr></table></figure><h2 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">http.get(url,options,callback);   <span class="comment">// 对地址url进行一次GET请求，option：加入请求头，callback:回调函数</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="built_in">console</span>.show();</span><br><span class="line"><span class="keyword">var</span> r = http.get(<span class="string">&quot;www.baidu.com&quot;</span>);</span><br><span class="line">log(<span class="string">&quot;code = &quot;</span> + r.statusCode);</span><br><span class="line">log(<span class="string">&quot;html = &quot;</span> + r.body.string());</span><br><span class="line"></span><br><span class="line">option：</span><br><span class="line"><span class="built_in">console</span>.show();</span><br><span class="line"><span class="keyword">var</span> r = http.get(<span class="string">&quot;www.baidu.com&quot;</span>, &#123;</span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-cn,zh;q=0.5&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0(Macintosh;IntelMacOSX10_7_0)AppleWebKit/535.11(KHTML,likeGecko)Chrome/17.0.963.56Safari/535.11&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">log(<span class="string">&quot;code = &quot;</span> + r.statusCode);</span><br><span class="line">log(<span class="string">&quot;html = &quot;</span> + r.body.string());</span><br><span class="line"></span><br><span class="line">回调函数：</span><br><span class="line"><span class="built_in">console</span>.show();</span><br><span class="line">http.get(<span class="string">&quot;www.baidu.com&quot;</span>, &#123;&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">res, err</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    log(<span class="string">&quot;code = &quot;</span> + res.statusCode);</span><br><span class="line">    log(<span class="string">&quot;html = &quot;</span> + res.body.string());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">http.post(url, data, options, callback);  <span class="comment">// 对地址url进行一次GET请求，data:POST数据，option：加入请求头，callback:回调函数</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;https://login.taobao.com/member/login.jhtml&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> username = <span class="string">&quot;你的用户名&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> password = <span class="string">&quot;你的密码&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> res = http.post(url, &#123;</span><br><span class="line">    <span class="string">&quot;TPL_username&quot;</span>: username,</span><br><span class="line">    <span class="string">&quot;TPL_password&quot;</span>: password</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> html = res.body.string();</span><br><span class="line"><span class="keyword">if</span>(html.contains(<span class="string">&quot;页面跳转中&quot;</span>))&#123;</span><br><span class="line">    toast(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http.postJson(url, data, options, callback); <span class="comment">// 以JSON格式向目标Url发起POST请求。</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;http://www.tuling123.com/openapi/api&quot;</span>;</span><br><span class="line">r = http.postJson(url, &#123;</span><br><span class="line">    key: <span class="string">&quot;65458a5df537443b89b31f1c03202a80&quot;</span>,</span><br><span class="line">    info: <span class="string">&quot;你好啊&quot;</span>,</span><br><span class="line">    userid: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line">toastLog(r.body.string());</span><br><span class="line"></span><br><span class="line">http.request(url, options, callback);  <span class="comment">// 对目标地址url发起一次HTTP请求</span></span><br><span class="line">____待补充</span><br><span class="line"></span><br><span class="line">Response  <span class="comment">// HTTP请求的响应。</span></span><br><span class="line">Response.statusCode  <span class="comment">// 当前响应的HTTP状态码。例如200(OK), 404(Not Found)等。</span></span><br><span class="line">Response.statusMessage <span class="comment">// 当前响应的HTTP状态信息。例如&quot;OK&quot;, &quot;Bad Request&quot;, &quot;Forbidden&quot;。</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> res = http.get(<span class="string">&quot;www.baidu.com&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(res.statusCode &gt;= <span class="number">200</span> &amp;&amp; res.statusCode &lt; <span class="number">300</span>)&#123;</span><br><span class="line">    toast(<span class="string">&quot;页面获取成功!&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(res.statusCode == <span class="number">404</span>)&#123;</span><br><span class="line">    toast(<span class="string">&quot;页面没找到哦...&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;错误: &quot;</span> + res.statusCode + <span class="string">&quot; &quot;</span> + res.statusMessage);</span><br><span class="line">&#125;</span><br><span class="line">Response.headers  <span class="comment">// 当前响应的HTTP头部信息。</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="built_in">console</span>.show();</span><br><span class="line"><span class="keyword">var</span> res = http.get(<span class="string">&quot;www.qq.com&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;HTTP Headers:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> headerName <span class="keyword">in</span> res.headers)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;%s: %s&quot;</span>, headerName, res.headers[headerName]);</span><br><span class="line">&#125;</span><br><span class="line">Response.body  <span class="comment">// 当前响应的内容</span></span><br><span class="line">Response.request  <span class="comment">// 当前响应所对应的请求</span></span><br><span class="line">Response.url  <span class="comment">// 当前响应所对应的请求URL</span></span><br><span class="line">Response.method  <span class="comment">// 当前响应所对应的HTTP请求的方法。例如&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;等。</span></span><br></pre></td></tr></table></figure><h2 id="图片与颜色"><a href="#图片与颜色" class="headerlink" title="图片与颜色"></a>图片与颜色</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">找图找色</span><br><span class="line">images.requestScreenCapture([landscape])  <span class="comment">// 申请截图权限（只需执行一次）</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">//请求截图</span></span><br><span class="line"><span class="keyword">if</span>(!requestScreenCapture())&#123;</span><br><span class="line">    toast(<span class="string">&quot;请求截图失败&quot;</span>);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//连续截图10张图片(间隔1秒)并保存到存储卡目录</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">    captureScreen(<span class="string">&quot;/sdcard/screen_capture_&quot;</span> + i + <span class="string">&quot;.png&quot;</span>);</span><br><span class="line">    sleep(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">images.captureScreen()  <span class="comment">// 截图当前屏幕返回一个Image对象</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">// 请求横屏截图</span></span><br><span class="line">requestScreenCapture(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">// 截图</span></span><br><span class="line"><span class="keyword">var</span> img = captureScreen();</span><br><span class="line"><span class="comment">// 获取在点(100, 100)的颜色值</span></span><br><span class="line"><span class="keyword">var</span> color = images.pixel(img, <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line"><span class="comment">// 显示该颜色值</span></span><br><span class="line">toast(colors.toString(color));</span><br><span class="line"></span><br><span class="line">images.captureScreen(path);  <span class="comment">// path:截图保存路径</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">// 请求截图</span></span><br><span class="line"><span class="keyword">if</span>(!requestScreenCapture())&#123;</span><br><span class="line">    toast(<span class="string">&quot;请求截图失败&quot;</span>);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 截图保存在指定path</span></span><br><span class="line">images.captureScreen(<span class="string">&quot;/sdcard/DCIM/新建文件夹/1.png&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在图片img指定区域中找到颜色和color完全相等的某个点</span></span><br><span class="line">images.findColorEquals(img, color[, x, y, width, height]); </span><br><span class="line">举个例子：</span><br><span class="line">requestScreenCapture();  <span class="comment">//请求截图</span></span><br><span class="line">launchApp(<span class="string">&quot;QQ&quot;</span>);   <span class="comment">// 启动QQ</span></span><br><span class="line">sleep(<span class="number">1200</span>);   <span class="comment">// 等待1.2秒</span></span><br><span class="line"><span class="keyword">var</span> p = findColorEquals(captureScreen(), <span class="string">&quot;#f64d30&quot;</span>);    </span><br><span class="line"><span class="keyword">if</span>(p)&#123;</span><br><span class="line">    toast(<span class="string">&quot;有未读消息&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;没有未读消息&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">// 请求截图</span></span><br><span class="line"><span class="keyword">var</span> 获取截图权限 = requestScreenCapture();</span><br><span class="line"><span class="comment">// console.log(&quot;获取截图权限===&gt;&quot;, 获取截图权限);</span></span><br><span class="line"><span class="comment">// 截图屏幕图片 并放指定位置</span></span><br><span class="line">images.captureScreen(<span class="string">&quot;/sdcard/屏幕大图&quot;</span> + <span class="string">&quot;.png&quot;</span>);</span><br><span class="line"><span class="comment">// 扣小图片</span></span><br><span class="line"><span class="keyword">var</span> 读取图片 = images.read(<span class="string">&quot;/sdcard/屏幕大图.png&quot;</span>);    <span class="comment">// 读取大图</span></span><br><span class="line"><span class="keyword">var</span> 小心心 = images.clip(读取图片, <span class="number">923</span>, <span class="number">828</span>, <span class="number">109</span>, <span class="number">115</span>);   <span class="comment">// 根据大图进行xyz裁剪</span></span><br><span class="line">images.save(小心心, <span class="string">&quot;/sdcard/小心心.png&quot;</span>);    <span class="comment">// 将图片存储指定位置</span></span><br><span class="line"><span class="keyword">var</span> 小图片 = images.read(<span class="string">&quot;/sdcard/小心心.png&quot;</span>);   <span class="comment">// 读取小图片</span></span><br><span class="line"><span class="comment">// var 是否找到 = images.findImage(读取图片, 小图片);   // 根据大图找小图</span></span><br><span class="line"><span class="keyword">var</span> 是否找到 = images.findImageInRegion(读取图片, 小图片, <span class="number">921</span>, <span class="number">830</span>, <span class="number">116</span>, <span class="number">113</span>);   <span class="comment">// 根据区域找图</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;是否找到===&gt;&quot;</span>, 是否找到);</span><br></pre></td></tr></table></figure><h2 id="基于控件的操作"><a href="#基于控件的操作" class="headerlink" title="基于控件的操作"></a>基于控件的操作</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">auto.waitFor(); <span class="comment">// 检查无障碍服务是否已经启用，如果没有启用则跳转到无障碍服务启用界面，并等待无障碍服务启动；</span></span><br><span class="line">click(<span class="string">&quot;小红书&quot;</span>);   <span class="comment">// 点击文本</span></span><br><span class="line">click(<span class="string">&quot;啦啦啦&quot;</span>, <span class="number">0</span>);   <span class="comment">// 点击文本 点击第一个文本</span></span><br><span class="line">longClick(<span class="string">&quot;小红书&quot;</span>);  <span class="comment">// 长按文本</span></span><br><span class="line">longClick(<span class="string">&quot;啦啦啦&quot;</span>, <span class="number">0</span>);  <span class="comment">// 长按文本 点击第一个文本</span></span><br><span class="line">scrollUp(<span class="number">0</span>); <span class="comment">//  找到上滑或左滑</span></span><br><span class="line">setText(<span class="string">&quot;测试&quot;</span>);  <span class="comment">// 输入文本 会清除</span></span><br><span class="line">input(<span class="string">&quot;测试一下&quot;</span>); <span class="comment">// 输入文本 会追加后面</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sendButton = text(<span class="string">&quot;小红书&quot;</span>).findOne().click(); <span class="comment">// 定义这个元件  根据文本</span></span><br><span class="line">sendButton.click();  <span class="comment">// 元件点击</span></span><br><span class="line">desc(<span class="string">&quot;搜索&quot;</span>).findOne().click();  <span class="comment">// 根据desc进行点击</span></span><br><span class="line">id(<span class="string">&quot;action_search&quot;</span>).findOne().click();  <span class="comment">// 根据id进行点击</span></span><br><span class="line">className(<span class="string">&quot;ImageView&quot;</span>).depth(<span class="number">10</span>).findOne().click();  <span class="comment">// 组合来完成定位</span></span><br><span class="line">click(); <span class="comment">// 控件clickable为true，才能使用</span></span><br><span class="line">longClick(); <span class="comment">// 控件longClickable属性为true</span></span><br><span class="line">setText();  <span class="comment">// 设置文本，用于编辑控件设置文本  id(&quot;search_edit_text&quot;).findOne().setText(&quot;测试&quot;);</span></span><br><span class="line">exits(); <span class="comment">// 判断控件是否存在</span></span><br><span class="line">waitFor(); <span class="comment">// 等待控件出现</span></span><br><span class="line">scrollForward(); <span class="comment">// id(&quot;music_list&quot;).findOne().scrollForward(); 上滑 如果控件scrollForward属性为true</span></span><br><span class="line">scrollBackward(); <span class="comment">// id(&quot;music_list&quot;).findOne().scrollBackward();  下滑 scrollBackward属性为true</span></span><br><span class="line"></span><br><span class="line">举个例子：</span><br><span class="line">className(<span class="string">&quot;android.widget.EditText&quot;</span>).findOne().setText(<span class="string">&quot;狐狸&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> 搜索 = text(<span class="string">&quot;搜索&quot;</span>).findOne().click();</span><br><span class="line">搜索.click();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果控件名以“android.widget.”开头 可以直接省略,例如文本控件可以直接使用</span></span><br><span class="line">className(<span class="string">&quot;TextView&quot;</span>); </span><br><span class="line">常见控件的类名如下：</span><br><span class="line">android.widget.TextView 文本控件</span><br><span class="line">android.widget.ImageView 图片控件</span><br><span class="line">android.widget.Button 按钮控件</span><br><span class="line">android.widget.EditText 输入框控件</span><br><span class="line">android.widget.AbsListView 列表控件</span><br><span class="line">android.widget.LinearLayout 线性布局</span><br><span class="line">android.widget.FrameLayout 帧布局</span><br><span class="line">android.widget.RelativeLayout 相对布局</span><br><span class="line">android.widget.RelativeLayout 相对布局</span><br><span class="line">android.support.v7.widget.RecyclerView 通常也是列表控件</span><br><span class="line"></span><br><span class="line">UiSelector.findOne(timeout);  <span class="comment">// 对屏幕上的控件进行搜索，直到屏幕上出现满足条件的一个控件为止</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">//启动Auto.js</span></span><br><span class="line">launchApp(<span class="string">&quot;Auto.js&quot;</span>);</span><br><span class="line"><span class="comment">//在6秒内找出日志图标的控件</span></span><br><span class="line"><span class="keyword">var</span> w = id(<span class="string">&quot;action_log&quot;</span>).findOne(<span class="number">6000</span>);</span><br><span class="line"><span class="comment">//如果找到控件则点击</span></span><br><span class="line"><span class="keyword">if</span>(w != <span class="literal">null</span>)&#123;</span><br><span class="line">    w.click();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//否则提示没有找到</span></span><br><span class="line">    toast(<span class="string">&quot;没有找到日志图标&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UiSelector.findOnce(i);  <span class="comment">// 对屏幕上的控件进行搜索，如果找到符合条件的控件则返回该控件 i:索引</span></span><br><span class="line"></span><br><span class="line">UiSelector.find();  <span class="comment">// 找出所有满足条件的控件并返回一个控件集合</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> c = className(<span class="string">&quot;AbsListView&quot;</span>).find();</span><br><span class="line"><span class="keyword">if</span>(c.empty())&#123;   <span class="comment">// empty() 返回控件集合是否为空</span></span><br><span class="line">    toast(<span class="string">&quot;找到啦&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;没找到╭(╯^╰)╮&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UiSelector.untilFind();  <span class="comment">// 对屏幕上的控件进行搜索，直到找到至少一个满足条件的控件为止  没找到会一直卡在那儿</span></span><br><span class="line"></span><br><span class="line">UiSelector.exists(); <span class="comment">// 判断屏幕上是否存在控件</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">if</span>(text(<span class="string">&quot;某个文本&quot;</span>).exists())&#123;</span><br><span class="line">    <span class="comment">//要支持的动作</span></span><br><span class="line">    toast(<span class="string">&quot;这是某个文本&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UiSelector.waitFor();  <span class="comment">// 等待屏幕上出现符合条件的控件</span></span><br><span class="line">举个例子：</span><br><span class="line">textContains(<span class="string">&quot;退出&quot;</span>).waitFor();   <span class="comment">// textContains(str) 为当前选择器附加控件&quot;text需要包含字符串str&quot;的筛选条件</span></span><br><span class="line">click(<span class="string">&quot;退出&quot;</span>);</span><br><span class="line"></span><br><span class="line">UiSelector.filter(f)  <span class="comment">// 为当前选择器附加自定义的过滤条件。</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="comment">// 要找出屏幕上所有文本长度为10的文本控件的代码为：</span></span><br><span class="line"><span class="keyword">var</span> uc = className(<span class="string">&quot;TextView&quot;</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">w</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> w.text().length == <span class="number">10</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">UiObject.click(); <span class="comment">// 点击该控件  需要控件的clickable为true才可使用</span></span><br><span class="line"></span><br><span class="line">UiObject.longClick();  <span class="comment">// 长按该控件  需要控件的longClickable为true才可使用</span></span><br><span class="line"></span><br><span class="line">UiObject.setText(text);  <span class="comment">// 设置输入框控件的文本内容  需要控件的editable为true才可使用</span></span><br><span class="line"></span><br><span class="line">UiObject.copy();  <span class="comment">// 对输入框文本的选中内容进行复制 该函数只能用于输入框控件，并且当前输入框控件有选中的文本</span></span><br><span class="line">举个例子：</span><br><span class="line"><span class="keyword">var</span> et = className(<span class="string">&quot;EditText&quot;</span>).findOne();</span><br><span class="line"><span class="comment">//选中前两个字</span></span><br><span class="line">et.setSelection(<span class="number">0</span>, <span class="number">2</span>);  <span class="comment">// setSelection()  设置输入框选中的内容</span></span><br><span class="line"><span class="comment">//对选中内容进行复制</span></span><br><span class="line"><span class="keyword">if</span>(et.copy())&#123;</span><br><span class="line">    toast(<span class="string">&quot;复制成功&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    toast(<span class="string">&quot;复制失败&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NPOI Excel DataTable操作类</title>
      <link href="2023/07/17/ExcelHelper/"/>
      <url>2023/07/17/ExcelHelper/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ExcelConfig</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：Excel导入导出设置</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ExcelConfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 文件名</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FileName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 标题</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 前景色</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> Color ForeColor &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 背景色</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> Color Background &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">short</span> _titlepoint;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 标题字号</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">short</span> TitlePoint</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_titlepoint == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _titlepoint;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _titlepoint = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">short</span> _headpoint;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 列头字号</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">short</span> HeadPoint</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_headpoint == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _headpoint;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _headpoint = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 标题高度</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">short</span> TitleHeight &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 列标题高度</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">short</span> HeadHeight &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _titlefont;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 标题字体</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> TitleFont</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_titlefont == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;微软雅黑&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _titlefont;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _titlefont = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _headfont;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 列头字体</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> HeadFont</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_headfont == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;微软雅黑&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _headfont;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _headfont = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否按内容长度来适应表格宽度</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsAllSizeColumn &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 列设置</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> List&lt;ColumnModel&gt; ColumnEntity &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ExcelHelper</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：NPOI Excel DataTable操作类</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ExcelHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> Excel导出方法 ExcelDownload</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Excel导出下载</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dtSource&quot;&gt;</span>DataTable数据源<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;excelConfig&quot;&gt;</span>导出设置包含文件名、标题、列设置<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ExcelDownload</span>(<span class="params">DataTable dtSource, ExcelConfig excelConfig</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        HttpContext curContext = HttpContext.Current;</span><br><span class="line">        <span class="comment">// 设置编码和附件格式</span></span><br><span class="line">        curContext.Response.ContentType = <span class="string">&quot;application/ms-excel&quot;</span>;</span><br><span class="line">        curContext.Response.ContentEncoding = Encoding.UTF8;</span><br><span class="line">        curContext.Response.Charset = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        curContext.Response.AppendHeader(<span class="string">&quot;Content-Disposition&quot;</span>,</span><br><span class="line">            <span class="string">&quot;attachment;filename=&quot;</span> + HttpUtility.UrlEncode(excelConfig.FileName, Encoding.UTF8));</span><br><span class="line">        <span class="comment">//调用导出具体方法Export()</span></span><br><span class="line">        curContext.Response.BinaryWrite(ExportMemoryStream(dtSource, excelConfig).GetBuffer());</span><br><span class="line">        curContext.Response.End();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Excel导出下载</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;list&quot;&gt;</span>数据源<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;templdateName&quot;&gt;</span>模板文件名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;newFileName&quot;&gt;</span>文件名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ExcelDownload</span>(<span class="params">List&lt;TemplateDataModel&gt; list, <span class="built_in">string</span> templdateName, <span class="built_in">string</span> newFileName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        HttpResponse response = System.Web.HttpContext.Current.Response;</span><br><span class="line">        response.Clear();</span><br><span class="line">        response.Charset = <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">        response.ContentType = <span class="string">&quot;application/vnd-excel&quot;</span>;<span class="comment">//&quot;application/vnd.ms-excel&quot;;</span></span><br><span class="line">        System.Web.HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="built_in">string</span>.Format(<span class="string">&quot;attachment; filename=&quot;</span> + newFileName));</span><br><span class="line">        System.Web.HttpContext.Current.Response.BinaryWrite(ExportListByTempale(list, templdateName).ToArray());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> DataTable导出到Excel文件excelConfig中FileName设置为全路径</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> DataTable导出到Excel文件 Export()</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dtSource&quot;&gt;</span>DataTable数据源<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;excelConfig&quot;&gt;</span>导出设置包含文件名、标题、列设置<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ExcelExport</span>(<span class="params">DataTable dtSource, ExcelConfig excelConfig</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">using</span> (MemoryStream ms = ExportMemoryStream(dtSource, excelConfig))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (FileStream fs = <span class="keyword">new</span> FileStream(excelConfig.FileName, FileMode.Create, FileAccess.Write))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] data = ms.ToArray();</span><br><span class="line">                fs.Write(data, <span class="number">0</span>, data.Length);</span><br><span class="line">                fs.Flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> DataTable导出到Excel的MemoryStream</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> DataTable导出到Excel的MemoryStream Export()</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dtSource&quot;&gt;</span>DataTable数据源<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;excelConfig&quot;&gt;</span>导出设置包含文件名、标题、列设置<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MemoryStream <span class="title">ExportMemoryStream</span>(<span class="params">DataTable dtSource, ExcelConfig excelConfig</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//int colint = 0;</span></span><br><span class="line">        <span class="comment">//for (int i = 0; i &lt; dtSource.Columns.Count;)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    DataColumn column = dtSource.Columns[i];</span></span><br><span class="line">        <span class="comment">//    if (excelConfig.ColumnEntity[colint].Column != column.ColumnName)</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        dtSource.Columns.Remove(column.ColumnName);</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    else</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        i++;</span></span><br><span class="line">        <span class="comment">//        if (colint &lt; excelConfig.ColumnEntity.Count - 1)</span></span><br><span class="line">        <span class="comment">//        &#123;</span></span><br><span class="line">        <span class="comment">//            colint++;</span></span><br><span class="line">        <span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        DataTable dt = dtSource.Clone();</span><br><span class="line">        <span class="keyword">var</span> columns = dt.Columns;</span><br><span class="line">        <span class="keyword">foreach</span> (DataColumn column <span class="keyword">in</span> columns)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">bool</span> v = excelConfig.ColumnEntity.Exists(t =&gt; t.Column == column.ColumnName);</span><br><span class="line">            <span class="keyword">if</span> (!v)</span><br><span class="line">            &#123;</span><br><span class="line">                dtSource.Columns.Remove(column.ColumnName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">        ISheet sheet = workbook.CreateSheet();</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 右击文件 属性信息</span></span><br><span class="line">        &#123;</span><br><span class="line">            DocumentSummaryInformation dsi = PropertySetFactory.CreateDocumentSummaryInformation();</span><br><span class="line">            dsi.Company = <span class="string">&quot;NPOI&quot;</span>;</span><br><span class="line">            workbook.DocumentSummaryInformation = dsi;</span><br><span class="line"></span><br><span class="line">            SummaryInformation si = PropertySetFactory.CreateSummaryInformation();</span><br><span class="line">            si.Author = <span class="string">&quot;刘晓雷&quot;</span>; <span class="comment">//填加xls文件作者信息</span></span><br><span class="line">            si.ApplicationName = <span class="string">&quot;力软信息&quot;</span>; <span class="comment">//填加xls文件创建程序信息</span></span><br><span class="line">            si.LastAuthor = <span class="string">&quot;刘晓雷&quot;</span>; <span class="comment">//填加xls文件最后保存者信息</span></span><br><span class="line">            si.Comments = <span class="string">&quot;刘晓雷&quot;</span>; <span class="comment">//填加xls文件作者信息</span></span><br><span class="line">            si.Title = <span class="string">&quot;标题信息&quot;</span>; <span class="comment">//填加xls文件标题信息</span></span><br><span class="line">            si.Subject = <span class="string">&quot;主题信息&quot;</span>;<span class="comment">//填加文件主题信息</span></span><br><span class="line">            si.CreateDateTime = System.DateTime.Now;</span><br><span class="line">            workbook.SummaryInformation = si;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 设置标题样式</span></span><br><span class="line">        ICellStyle headStyle = workbook.CreateCellStyle();</span><br><span class="line">        <span class="built_in">int</span>[] arrColWidth = <span class="keyword">new</span> <span class="built_in">int</span>[dtSource.Columns.Count];</span><br><span class="line">        <span class="built_in">string</span>[] arrColName = <span class="keyword">new</span> <span class="built_in">string</span>[dtSource.Columns.Count];<span class="comment">//列名</span></span><br><span class="line">        ICellStyle[] arryColumStyle = <span class="keyword">new</span> ICellStyle[dtSource.Columns.Count];<span class="comment">//样式表</span></span><br><span class="line">        headStyle.Alignment = HorizontalAlignment.Center; <span class="comment">// ------------------</span></span><br><span class="line">        <span class="keyword">if</span> (excelConfig.Background != <span class="keyword">new</span> Color())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (excelConfig.Background != <span class="keyword">new</span> Color())</span><br><span class="line">            &#123;</span><br><span class="line">                headStyle.FillPattern = FillPattern.SolidForeground;</span><br><span class="line">                headStyle.FillForegroundColor = GetXLColour(workbook, excelConfig.Background);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        IFont font = workbook.CreateFont();</span><br><span class="line">        font.FontHeightInPoints = excelConfig.TitlePoint;</span><br><span class="line">        <span class="keyword">if</span> (excelConfig.ForeColor != <span class="keyword">new</span> Color())</span><br><span class="line">        &#123;</span><br><span class="line">            font.Color = GetXLColour(workbook, excelConfig.ForeColor);</span><br><span class="line">        &#125;</span><br><span class="line">        font.Boldweight = <span class="number">700</span>;</span><br><span class="line">        headStyle.SetFont(font);</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 列头及样式</span></span><br><span class="line">        ICellStyle cHeadStyle = workbook.CreateCellStyle();</span><br><span class="line">        cHeadStyle.Alignment = HorizontalAlignment.Center; <span class="comment">// ------------------</span></span><br><span class="line">        IFont cfont = workbook.CreateFont();</span><br><span class="line">        cfont.FontHeightInPoints = excelConfig.HeadPoint;</span><br><span class="line">        cHeadStyle.SetFont(cfont);</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 设置内容单元格样式</span></span><br><span class="line">        <span class="keyword">foreach</span> (DataColumn item <span class="keyword">in</span> dtSource.Columns)</span><br><span class="line">        &#123;</span><br><span class="line">            ICellStyle columnStyle = workbook.CreateCellStyle();</span><br><span class="line">            columnStyle.Alignment = HorizontalAlignment.Center;</span><br><span class="line">            arrColWidth[item.Ordinal] = Encoding.GetEncoding(<span class="number">936</span>).GetBytes(item.ColumnName.ToString()).Length;</span><br><span class="line">            arrColName[item.Ordinal] = item.ColumnName.ToString();</span><br><span class="line">            <span class="keyword">if</span> (excelConfig.ColumnEntity != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ColumnModel columnentity = excelConfig.ColumnEntity.Find(t =&gt; t.Column == item.ColumnName);</span><br><span class="line">                <span class="keyword">if</span> (columnentity != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    arrColName[item.Ordinal] = columnentity.ExcelColumn;</span><br><span class="line">                    <span class="keyword">if</span> (columnentity.Width != <span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        arrColWidth[item.Ordinal] = columnentity.Width;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (columnentity.Background != <span class="keyword">new</span> Color())</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (columnentity.Background != <span class="keyword">new</span> Color())</span><br><span class="line">                        &#123;</span><br><span class="line">                            columnStyle.FillPattern = FillPattern.SolidForeground;</span><br><span class="line">                            columnStyle.FillForegroundColor = GetXLColour(workbook, columnentity.Background);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (columnentity.Font != <span class="literal">null</span> || columnentity.Point != <span class="number">0</span> || columnentity.ForeColor != <span class="keyword">new</span> Color())</span><br><span class="line">                    &#123;</span><br><span class="line">                        IFont columnFont = workbook.CreateFont();</span><br><span class="line">                        columnFont.FontHeightInPoints = <span class="number">10</span>;</span><br><span class="line">                        <span class="keyword">if</span> (columnentity.Font != <span class="literal">null</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            columnFont.FontName = columnentity.Font;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (columnentity.Point != <span class="number">0</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            columnFont.FontHeightInPoints = columnentity.Point;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (columnentity.ForeColor != <span class="keyword">new</span> Color())</span><br><span class="line">                        &#123;</span><br><span class="line">                            columnFont.Color = GetXLColour(workbook, columnentity.ForeColor);</span><br><span class="line">                        &#125;</span><br><span class="line">                        columnStyle.SetFont(font);</span><br><span class="line">                    &#125;</span><br><span class="line">                    columnStyle.Alignment = getAlignment(columnentity.Alignment);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            arryColumStyle[item.Ordinal] = columnStyle;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (excelConfig.IsAllSizeColumn)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">region</span> 根据列中最长列的长度取得列宽</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; dtSource.Rows.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; dtSource.Columns.Count; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (arrColWidth[j] != <span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">int</span> intTemp = Encoding.GetEncoding(<span class="number">936</span>).GetBytes(dtSource.Rows[i][j].ToString()).Length;</span><br><span class="line">                        <span class="keyword">if</span> (intTemp &gt; arrColWidth[j])</span><br><span class="line">                        &#123;</span><br><span class="line">                            arrColWidth[j] = intTemp;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">int</span> rowIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 表头及样式</span></span><br><span class="line">        <span class="keyword">if</span> (excelConfig.Title != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            IRow headerRow = sheet.CreateRow(rowIndex);</span><br><span class="line">            rowIndex++;</span><br><span class="line">            <span class="keyword">if</span> (excelConfig.TitleHeight != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                headerRow.Height = (<span class="built_in">short</span>)(excelConfig.TitleHeight * <span class="number">20</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            headerRow.HeightInPoints = <span class="number">25</span>;</span><br><span class="line">            headerRow.CreateCell(<span class="number">0</span>).SetCellValue(excelConfig.Title);</span><br><span class="line">            headerRow.GetCell(<span class="number">0</span>).CellStyle = headStyle;</span><br><span class="line">            sheet.AddMergedRegion(<span class="keyword">new</span> NPOI.SS.Util.CellRangeAddress(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, dtSource.Columns.Count - <span class="number">1</span>)); <span class="comment">// ------------------</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 列头及样式</span></span><br><span class="line">        &#123;</span><br><span class="line">            IRow headerRow = sheet.CreateRow(rowIndex);</span><br><span class="line">            rowIndex++;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">region</span> 如果设置了列标题就按列标题定义列头，没定义直接按字段名输出</span></span><br><span class="line">            <span class="keyword">foreach</span> (DataColumn column <span class="keyword">in</span> dtSource.Columns)</span><br><span class="line">            &#123;</span><br><span class="line">                headerRow.CreateCell(column.Ordinal).SetCellValue(arrColName[column.Ordinal]);</span><br><span class="line">                headerRow.GetCell(column.Ordinal).CellStyle = cHeadStyle;</span><br><span class="line">                <span class="comment">//设置列宽</span></span><br><span class="line">                <span class="comment">//sheet.SetColumnWidth(column.Ordinal, (arrColWidth[column.Ordinal] + 1) * 256);</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">int</span> colWidth = (arrColWidth[column.Ordinal] + <span class="number">1</span>) * <span class="number">256</span>;</span><br><span class="line">                <span class="keyword">if</span> (colWidth &lt; <span class="number">255</span> * <span class="number">256</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    sheet.SetColumnWidth(column.Ordinal, colWidth &lt; <span class="number">5000</span> ? <span class="number">5000</span> : colWidth);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    sheet.SetColumnWidth(column.Ordinal, <span class="number">6000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        ICellStyle dateStyle = workbook.CreateCellStyle();</span><br><span class="line">        IDataFormat format = workbook.CreateDataFormat();</span><br><span class="line">        dateStyle.DataFormat = format.GetFormat(<span class="string">&quot;yyyy-mm-dd&quot;</span>);</span><br><span class="line">        <span class="built_in">bool</span> isStyle = <span class="literal">false</span>;</span><br><span class="line">        ICellStyle rowStyle = workbook.CreateCellStyle();</span><br><span class="line">        <span class="keyword">foreach</span> (DataRow row <span class="keyword">in</span> dtSource.Rows)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">region</span> 新建表，填充表头，填充列头，样式</span></span><br><span class="line">            <span class="keyword">if</span> (rowIndex == <span class="number">65535</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sheet = workbook.CreateSheet();</span><br><span class="line">                rowIndex = <span class="number">0</span>;</span><br><span class="line">                <span class="meta">#<span class="meta-keyword">region</span> 表头及样式</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (excelConfig.Title != <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        IRow headerRow = sheet.CreateRow(rowIndex);</span><br><span class="line">                        rowIndex++;</span><br><span class="line">                        <span class="keyword">if</span> (excelConfig.TitleHeight != <span class="number">0</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            headerRow.Height = (<span class="built_in">short</span>)(excelConfig.TitleHeight * <span class="number">20</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        headerRow.HeightInPoints = <span class="number">25</span>;</span><br><span class="line">                        headerRow.CreateCell(<span class="number">0</span>).SetCellValue(excelConfig.Title);</span><br><span class="line">                        sheet.AddMergedRegion(<span class="keyword">new</span> NPOI.SS.Util.CellRangeAddress(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, dtSource.Columns.Count - <span class="number">1</span>)); <span class="comment">// ------------------</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">                <span class="meta">#<span class="meta-keyword">region</span> 列头及样式</span></span><br><span class="line">                &#123;</span><br><span class="line">                    IRow headerRow = sheet.CreateRow(rowIndex);</span><br><span class="line">                    rowIndex++;</span><br><span class="line">                    <span class="meta">#<span class="meta-keyword">region</span> 如果设置了列标题就按列标题定义列头，没定义直接按字段名输出</span></span><br><span class="line">                    <span class="keyword">foreach</span> (DataColumn column <span class="keyword">in</span> dtSource.Columns)</span><br><span class="line">                    &#123;</span><br><span class="line">                        headerRow.CreateCell(column.Ordinal).SetCellValue(arrColName[column.Ordinal]);</span><br><span class="line">                        headerRow.GetCell(column.Ordinal).CellStyle = cHeadStyle;</span><br><span class="line">                        <span class="comment">//设置列宽</span></span><br><span class="line">                        sheet.SetColumnWidth(column.Ordinal, (arrColWidth[column.Ordinal] + <span class="number">1</span>) * <span class="number">256</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">            <span class="meta">#<span class="meta-keyword">region</span> 填充内容</span></span><br><span class="line">            IRow dataRow = sheet.CreateRow(rowIndex);</span><br><span class="line">            <span class="keyword">if</span> (dtSource.Columns.Contains(<span class="string">&quot;重复物料提示&quot;</span>) &amp;&amp; row[<span class="string">&quot;重复物料提示&quot;</span>].ToString() == <span class="string">&quot;更新前数据&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                rowStyle.FillPattern = FillPattern.SolidForeground;</span><br><span class="line">                rowStyle.FillForegroundColor = GetXLColour(workbook, Color.Yellow);</span><br><span class="line">                dataRow.RowStyle = rowStyle;</span><br><span class="line">                isStyle = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">foreach</span> (DataColumn column <span class="keyword">in</span> dtSource.Columns)</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                ICell newCell = dataRow.CreateCell(column.Ordinal);</span><br><span class="line">                newCell.CellStyle = isStyle?rowStyle: arryColumStyle[column.Ordinal];</span><br><span class="line">                <span class="built_in">string</span> drValue = row[column].ToString();</span><br><span class="line">                SetCell(newCell, dateStyle, column.DataType, drValue);</span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line">            <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">            rowIndex++;</span><br><span class="line">            isStyle=<span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">using</span> (MemoryStream ms = <span class="keyword">new</span> MemoryStream())</span><br><span class="line">        &#123;</span><br><span class="line">            workbook.Write(ms);</span><br><span class="line">            ms.Flush();</span><br><span class="line">            ms.Position = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> ms;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ListExcel导出(加载模板)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> List根据模板导出ExcelMemoryStream</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;list&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;templdateName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MemoryStream <span class="title">ExportListByTempale</span>(<span class="params">List&lt;TemplateDataModel&gt; list, <span class="built_in">string</span> templdateName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">string</span> templatePath = HttpContext.Current.Server.MapPath(<span class="string">&quot;/&quot;</span>) + <span class="string">&quot;/Resource/ExcelTemplate/&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> templdateName1 = <span class="built_in">string</span>.Format(<span class="string">&quot;&#123;0&#125;&#123;1&#125;&quot;</span>, templatePath, templdateName);</span><br><span class="line"></span><br><span class="line">            FileStream fileStream = <span class="keyword">new</span> FileStream(templdateName1, FileMode.Open, FileAccess.Read);</span><br><span class="line">            ISheet sheet = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (templdateName.IndexOf(<span class="string">&quot;.xlsx&quot;</span>) == <span class="number">-1</span>)<span class="comment">//2003</span></span><br><span class="line">            &#123;</span><br><span class="line">                HSSFWorkbook hssfworkbook = <span class="keyword">new</span> HSSFWorkbook(fileStream);</span><br><span class="line">                sheet = hssfworkbook.GetSheetAt(<span class="number">0</span>);</span><br><span class="line">                SetPurchaseOrder(sheet, list);</span><br><span class="line">                sheet.ForceFormulaRecalculation = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">using</span> (MemoryStream ms = <span class="keyword">new</span> MemoryStream())</span><br><span class="line">                &#123;</span><br><span class="line">                    hssfworkbook.Write(ms);</span><br><span class="line">                    ms.Flush();</span><br><span class="line">                    <span class="keyword">return</span> ms;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span><span class="comment">//2007</span></span><br><span class="line">            &#123;</span><br><span class="line">                XSSFWorkbook xssfworkbook = <span class="keyword">new</span> XSSFWorkbook(fileStream);</span><br><span class="line">                sheet = xssfworkbook.GetSheetAt(<span class="number">0</span>);</span><br><span class="line">                SetPurchaseOrder(sheet, list);</span><br><span class="line">                sheet.ForceFormulaRecalculation = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">using</span> (MemoryStream ms = <span class="keyword">new</span> MemoryStream())</span><br><span class="line">                &#123;</span><br><span class="line">                    xssfworkbook.Write(ms);</span><br><span class="line">                    ms.Flush();</span><br><span class="line">                    <span class="keyword">return</span> ms;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 赋值单元格</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sheet&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;list&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SetPurchaseOrder</span>(<span class="params">ISheet sheet, List&lt;TemplateDataModel&gt; list</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> list)</span><br><span class="line">            &#123;</span><br><span class="line">                IRow row = <span class="literal">null</span>;</span><br><span class="line">                ICell cell = <span class="literal">null</span>;</span><br><span class="line">                row = sheet.GetRow(item.row);</span><br><span class="line">                <span class="keyword">if</span> (row == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    row = sheet.CreateRow(item.row);</span><br><span class="line">                &#125;</span><br><span class="line">                cell = row.GetCell(item.cell);</span><br><span class="line">                <span class="keyword">if</span> (cell == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    cell = row.CreateCell(item.cell);</span><br><span class="line">                &#125;</span><br><span class="line">                cell.SetCellValue(item.<span class="keyword">value</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 设置表格内容</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SetCell</span>(<span class="params">ICell newCell, ICellStyle dateStyle, Type dataType, <span class="built_in">string</span> drValue</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (dataType.ToString())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.String&quot;</span>:<span class="comment">//字符串类型</span></span><br><span class="line">                newCell.SetCellValue(drValue);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.DateTime&quot;</span>:<span class="comment">//日期类型</span></span><br><span class="line">                System.DateTime dateV;</span><br><span class="line">                <span class="keyword">if</span> (System.DateTime.TryParse(drValue, <span class="keyword">out</span> dateV))</span><br><span class="line">                &#123;</span><br><span class="line">                    newCell.SetCellValue(dateV);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    newCell.SetCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                newCell.CellStyle = dateStyle;<span class="comment">//格式化显示</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.Boolean&quot;</span>:<span class="comment">//布尔型</span></span><br><span class="line">                <span class="built_in">bool</span> boolV = <span class="literal">false</span>;</span><br><span class="line">                <span class="built_in">bool</span>.TryParse(drValue, <span class="keyword">out</span> boolV);</span><br><span class="line">                newCell.SetCellValue(boolV);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.Int16&quot;</span>:<span class="comment">//整型</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.Int32&quot;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.Int64&quot;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.Byte&quot;</span>:</span><br><span class="line">                <span class="built_in">int</span> intV = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">int</span>.TryParse(drValue, <span class="keyword">out</span> intV);</span><br><span class="line">                newCell.SetCellValue(intV);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.Decimal&quot;</span>:<span class="comment">//浮点型</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.Double&quot;</span>:</span><br><span class="line">                <span class="built_in">double</span> doubV = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">double</span>.TryParse(drValue, <span class="keyword">out</span> doubV);</span><br><span class="line">                newCell.SetCellValue(doubV);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;System.DBNull&quot;</span>:<span class="comment">//空值处理</span></span><br><span class="line">                newCell.SetCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="literal">default</span>:</span><br><span class="line">                newCell.SetCellValue(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 从Excel导入</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 读取excel ,默认第一行为标头</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;strFileName&quot;&gt;</span>excel文档路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataTable <span class="title">ExcelImport</span>(<span class="params"><span class="built_in">string</span> strFileName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        DataTable dt = <span class="keyword">new</span> DataTable();</span><br><span class="line"></span><br><span class="line">        ISheet sheet = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">using</span> (FileStream file = <span class="keyword">new</span> FileStream(strFileName, FileMode.Open, FileAccess.Read))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (strFileName.IndexOf(<span class="string">&quot;.xlsx&quot;</span>) == <span class="number">-1</span>)<span class="comment">//2003</span></span><br><span class="line">            &#123;</span><br><span class="line">                HSSFWorkbook hssfworkbook = <span class="keyword">new</span> HSSFWorkbook(file);</span><br><span class="line">                sheet = hssfworkbook.GetSheetAt(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span><span class="comment">//2007</span></span><br><span class="line">            &#123;</span><br><span class="line">                XSSFWorkbook xssfworkbook = <span class="keyword">new</span> XSSFWorkbook(file);</span><br><span class="line">                sheet = xssfworkbook.GetSheetAt(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.Collections.IEnumerator rows = sheet.GetRowEnumerator();</span><br><span class="line"></span><br><span class="line">        IRow headerRow = sheet.GetRow(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">int</span> cellCount = headerRow.LastCellNum;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; cellCount; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            ICell cell = headerRow.GetCell(j);</span><br><span class="line">            dt.Columns.Add(cell.ToString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = (sheet.FirstRowNum + <span class="number">1</span>); i &lt;= sheet.LastRowNum; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            IRow row = sheet.GetRow(i);</span><br><span class="line">            <span class="keyword">if</span>(!row.IsEmpty())  </span><br><span class="line">            &#123;</span><br><span class="line">                DataRow dataRow = dt.NewRow();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> j = row.FirstCellNum; j &lt; cellCount; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (row.GetCell(j) != <span class="literal">null</span>)</span><br><span class="line">                        dataRow[j] = row.GetCell(j).ToString();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                dt.Rows.Add(dataRow);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 读取excel ,默认第一行为标头 </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileStream&quot;&gt;</span>文件数据流<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataTable <span class="title">ExcelImport</span>(<span class="params">Stream fileStream, <span class="built_in">string</span> flieType</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        DataTable dt = <span class="keyword">new</span> DataTable();</span><br><span class="line">        ISheet sheet = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (flieType == <span class="string">&quot;.xls&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            HSSFWorkbook hssfworkbook = <span class="keyword">new</span> HSSFWorkbook(fileStream);</span><br><span class="line">            sheet = hssfworkbook.GetSheetAt(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            XSSFWorkbook xssfworkbook = <span class="keyword">new</span> XSSFWorkbook(fileStream);</span><br><span class="line">            sheet = xssfworkbook.GetSheetAt(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.Collections.IEnumerator rows = sheet.GetRowEnumerator();</span><br><span class="line">        IRow headerRow = sheet.GetRow(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">int</span> cellCount = headerRow.LastCellNum;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; cellCount; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            ICell cell = headerRow.GetCell(j);</span><br><span class="line">            dt.Columns.Add(cell.ToString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = (sheet.FirstRowNum + <span class="number">1</span>); i &lt;= sheet.LastRowNum; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            IRow row = sheet.GetRow(i);</span><br><span class="line">            DataRow dataRow = dt.NewRow();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> j = row.FirstCellNum; j &lt; cellCount; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (row.GetCell(j) != <span class="literal">null</span>)</span><br><span class="line">                    dataRow[j] = row.GetCell(j).ToString();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            dt.Rows.Add(dataRow);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> RGB颜色转NPOI颜色</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">short</span> <span class="title">GetXLColour</span>(<span class="params">HSSFWorkbook workbook, Color SystemColour</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">short</span> s = <span class="number">0</span>;</span><br><span class="line">        HSSFPalette XlPalette = workbook.GetCustomPalette();</span><br><span class="line">        NPOI.HSSF.Util.HSSFColor XlColour = XlPalette.FindColor(SystemColour.R, SystemColour.G, SystemColour.B);</span><br><span class="line">        <span class="keyword">if</span> (XlColour == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (NPOI.HSSF.Record.PaletteRecord.STANDARD_PALETTE_SIZE &lt; <span class="number">255</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                XlColour = XlPalette.FindSimilarColor(SystemColour.R, SystemColour.G, SystemColour.B);</span><br><span class="line">                s = XlColour.Indexed;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            s = XlColour.Indexed;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 设置列的对齐方式</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 设置对齐方式</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;style&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> HorizontalAlignment <span class="title">getAlignment</span>(<span class="params"><span class="built_in">string</span> style</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (style)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;center&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> HorizontalAlignment.Center;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;left&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> HorizontalAlignment.Left;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;right&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> HorizontalAlignment.Right;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;fill&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> HorizontalAlignment.Fill;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;justify&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> HorizontalAlignment.Justify;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;centerselection&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> HorizontalAlignment.CenterSelection;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;distributed&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> HorizontalAlignment.Distributed;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> NPOI.SS.UserModel.HorizontalAlignment.General;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>获取验证码图片</title>
      <link href="2023/07/17/VerifyCode/"/>
      <url>2023/07/17/VerifyCode/</url>
      
        <content type="html"><![CDATA[<h1 id="获取验证码图片"><a href="#获取验证码图片" class="headerlink" title="获取验证码图片"></a>获取验证码图片</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> VerifyCode</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：获取验证码图片</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">VerifyCode</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 缓存定义</span></span><br><span class="line">    <span class="keyword">private</span> ICache cache = CacheFactory.CaChe();</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> cacheKey = <span class="string">&quot;session_verifycode&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> cacheKeyIp = Net.Ip;       <span class="comment">// +用户IP</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 生成验证码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">byte</span>[] <span class="title">GetVerifyCode</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">int</span> codeW = <span class="number">80</span>;</span><br><span class="line">        <span class="built_in">int</span> codeH = <span class="number">30</span>;</span><br><span class="line">        <span class="built_in">int</span> fontSize = <span class="number">16</span>;</span><br><span class="line">        <span class="built_in">string</span> chkCode = <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="comment">//颜色列表，用于验证码、噪线、噪点 </span></span><br><span class="line">        Color[] color = &#123; Color.Black, Color.Red, Color.Blue, Color.Green, Color.Orange, Color.Brown, Color.Brown, Color.DarkBlue &#125;;</span><br><span class="line">        <span class="comment">//字体列表，用于验证码 </span></span><br><span class="line">        <span class="built_in">string</span>[] font = &#123; <span class="string">&quot;Times New Roman&quot;</span> &#125;;</span><br><span class="line">        <span class="comment">//验证码的字符集，去掉了一些容易混淆的字符 </span></span><br><span class="line">        <span class="built_in">char</span>[] character = &#123; <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span> &#125;;</span><br><span class="line">        Random rnd = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="comment">//生成验证码字符串 </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            chkCode += character[rnd.Next(character.Length)];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span>/写入Session、验证码加密</span></span><br><span class="line">        <span class="comment">//WebHelper.WriteSession(&quot;session_verifycode&quot;, Md5Helper.Encrypt(chkCode.ToLower(), 16));</span></span><br><span class="line">        <span class="comment">//tip:session存读存在问题改为缓存  2021-10-27   wkz</span></span><br><span class="line">        cache.Write&lt;<span class="built_in">string</span>&gt;(cacheKey + cacheKeyIp, Md5Helper.Encrypt(chkCode.ToLower(), <span class="number">16</span>), TimeSpan.FromMinutes(<span class="number">3</span>), CacheId.loginInfo);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建画布</span></span><br><span class="line">        Bitmap bmp = <span class="keyword">new</span> Bitmap(codeW, codeH);</span><br><span class="line">        Graphics g = Graphics.FromImage(bmp);</span><br><span class="line">        g.Clear(Color.White);</span><br><span class="line">        <span class="comment">//画噪线 </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> x1 = rnd.Next(codeW);</span><br><span class="line">            <span class="built_in">int</span> y1 = rnd.Next(codeH);</span><br><span class="line">            <span class="built_in">int</span> x2 = rnd.Next(codeW);</span><br><span class="line">            <span class="built_in">int</span> y2 = rnd.Next(codeH);</span><br><span class="line">            Color clr = color[rnd.Next(color.Length)];</span><br><span class="line">            g.DrawLine(<span class="keyword">new</span> Pen(clr), x1, y1, x2, y2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//画验证码字符串 </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; chkCode.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> fnt = font[rnd.Next(font.Length)];</span><br><span class="line">            Font ft = <span class="keyword">new</span> Font(fnt, fontSize);</span><br><span class="line">            Color clr = color[rnd.Next(color.Length)];</span><br><span class="line">            g.DrawString(chkCode[i].ToString(), ft, <span class="keyword">new</span> SolidBrush(clr), (<span class="built_in">float</span>)i * <span class="number">18</span>, (<span class="built_in">float</span>)<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将验证码图片写入内存流，并将其以 &quot;image/Png&quot; 格式输出 </span></span><br><span class="line">        MemoryStream ms = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            bmp.Save(ms, ImageFormat.Png);</span><br><span class="line">            <span class="keyword">return</span> ms.ToArray();</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span></span><br><span class="line">        &#123;</span><br><span class="line">            g.Dispose();</span><br><span class="line">            bmp.Dispose();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字符串工具方法</title>
      <link href="2023/07/17/ConstStr/"/>
      <url>2023/07/17/ConstStr/</url>
      
        <content type="html"><![CDATA[<h1 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Const</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：常量</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 汉字及拼音首字母</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">const</span> <span class="built_in">string</span> ChinesePinYin = <span class="string">&quot;丂k丄s丅x丆m丏m丒c丗s丢d丠q両l丣y并b丩j丮j丯j丱g丳c丵z丷b丼j乀f乁y讈l乆j乑y乕h乗c乚h乛w乢g乣j乤h乧d乨s乪n乫g乬g乭d乮m乯o乲c乴x乵y乶p乷s乸n乹q乺s乻e乼z乽z乿z亀g亁q乱l亃l亄y亅j亇m亊s亐y亖s亗s亘g亜y亝q亚y亣d亪y亯x亰j亱y亴y亶d亷l亸d亹m亼j亽j亾w仈b仌b仏f仐j仒e仚x仛t仜h仢b仦c仧c仩c仭r仮f仯c仱q仴w仸y仹f仺c仼w仾d伀z伂p伃y伄d伅d伆w伇y伈x汲j伌a伒j伓p伔d伖t伜c伝y伡c伣q伨x伩x伬c伭x伮n伱n伳x伵x伷z伹q伻b伾p伿z佀s佁a佄h佅m伫z布b佉q佊b佋z佌c佒y占z佖b佡x佢q佦s佨b徊h佫h佭x佮g佱f佲m佷h佸h佺q佽c侁s侂t侅g来l侇y侊g侌y侎m侐x侒a侓l侕e仑l侘c侙c侚x侜z侞r侟c価s侢d侤t侫n侭j侰j侱c侲z侳z侴h侣l局j侸s侹t侺s侻t侾x俀t俣y系j俆x俇g俈k俉w俋y俌f俍l俒h俓j俔q俕s俖p俙x俛f侠x俢x俤d俥c俧z俫l俬s俰h俲x俴j俵b俶c俷f俹y俻b俼y俽x俿h伥c倁z倂b倃j倅c俩l倇w倈l仓c倊z个g倎t倐s们m倓t倕c幸x倗p倛q倝g倞j倠s倢j仿f値z倧z伦l倯s倰l倱h倲d倳z倴b倵w倶j倷n倸c倹j倻y倽s倿n偀y偁c偂q偄r偅z偆c伟w偊y偋b偍t偐y偑f偒t偓w偔e偖c偗s偘k偙d偛c偝b偞x偠y偡z偢c偣a偦x偧z偨c偩f偪b偫z偭m偮j偯y偰x偱x偲c偳d侧c侦z偸t偹b咱z偼j伪w傁s傂z傃s傄x傆y傇r傉n傊y傋j傌m傎d傏t傐h杰j傒x傓s傔q傕j伧c傗c伞s备b傚x傛r傜y傝t傞s傟y傠f傡b家j傤z傦g傪c傫l佣y傮z偬z傰p傱s传c伛y债z伤s傹j傼h傽z倾q傿y僀d僁x偻l僃b僄b仅j僆l戮l僈m佥q僊x僋t僌y働d僎z僐s侨q僒j僓t僔z仆p僗l僘c僙g僛q僜d僝c僞w僟j僠b僡h僢c僣t僤d侥j偾f僩x僪y僫e僯l僰b雇g僲x僴x僶m僷y僸j价j僺q僼f僽z僾a僿s仪y儁j侬n儃c亿y当d侩k俭j儊c儌j儍s儎z儏c傧b儑a儓t俦c侪c儖l儗y尽j儙q儚m儛w儜n儝q儞n偿c儠l儢l儣k儤b儥y儦b儧z儨z儩s优y儫h儬q儭c儮l儯t儰w儱l储c儳c儴x儵s儶h俪l罗l儹z傩n傥t俨y儽l儾n兂z凶x兊d兑d兎t兏c児e儿e兖y兘s兟s兡b兤h兦w内n两l兪y兯h兲t兾j兿y冃m冄r円y冇m册c冋j冎g冏j冐m胄z冓g冔x冘y冚k冝y冞s冟s冡m冣z冦k冧l冨f冩x幂m冭t冮g冴y冸p冹f冺m冾q冿j凁s凂m凃t凅g净j凊q冻d凎g凐y凒a凓l凔c凕m凖z凗c凘s凙d凚j凛l凞x凟d凢f凣f凥j処c凧y凨f凩k凪n凬f凮f凯k凲g凴p凷k凾h刄r刅c刉j刋q刌c刏j刐d刓w刔j刕l刜f刞q刟d刡m刢l刣z别b刦j刧j删s刬c刯g刱c刲k刴d刵e刼j刾c刭j剅d剆l则z剈y剉c克k刹c剒c剓l剕f剗c剘q剙c剚z刚g剥b剟d剠q剢d剣j剤j剦y剨h剫d剬z剭w剐g剰s剱j剳d剀k创c剶c铲c剸t剹l剺l剻p剼s剾k劀g划h劄z劅z劆l剧j刘l刽g劋j刿g剑j劎j劏t剂j劒j劔j劕z劖c劗z劘m劙l劚z劜y劤j劥k劦x劧z劮y劯z劰m労l劵j劶k劷y劸w効x劺m匡k劼j劽l勀k劲j勂g勄m勅c勆l勈y勊k勌j勍q勎l勏b勑c勓k勔m动d勖x务w勚y勋x勜w胜s劳l勠l勡p势s积j勥j剿c勧q勨x勪q勫f勬j勭t勮j勯d劢m勲x勳x勴l励l勶c勷x劝q匀y勼j勽b匁m匂x匃g匄g匇y匉p匊j匋t匌g匎e匑g匒d匓j匔g匘n匛j匜y匞j匟k匢h匤q匥f匧q匨z匩k匫h匬y匦g汇h匰d匮k匲l匳l匴s匵d匶j匷j匸x匼k匽y区o卂x卄n卆z卋s卌x卍w卐w协x単d卙j卛s卝g卥x卨x卪j卬a卭q卲s卶c恤x却q卼w卽j卾e厀x厁s厃w厇z厈h厊y厎d厏z厐p厑y厒q厓y厔z厖m厗t厍s厛t厜z厞f厡y厤l厧d厪j厫a厬g厌y厯l厰c厱q厉l厳y厣y厵y厷g厸l厹r厺q厼k厽l厾d叀z参c叄c叅c叆a叇d収s叏g叐b叒r叓l叕z叚j叜s叝j叞w叡r丛c叧g叴q叺c叾d叿h吀m吂m吅x吇z寸c吔y吘o吙h吚y吜c吢q吤j吥b吪e吰h吴w呐n吷x吺d吽h吿g呁j吕l呄g呅w呇q呉w呌j呍h尺c呏s呑t呚h呝e呞s呟j呠p呡w呣m呥r呧d呪z呫t呬x呭y呮q呯p呰z呴g呹y呺x呾d呿q咁x咃t咅p咇b咈f咉y咊h咍h咑d咓w咗z咘b咜t咞x咟h咠q咡e咢e咥d咮z咰s咲x咵k咶g咷t咹e咺x呙g咾l哃t哅x哊y哋d哖n哘x哛p哠h员y哢l哣p哤m哫z哬h哯x哰l哱b哴l哵b哶m哸s哹f哻h哾c唀y唂g唃g呗b含h唈y唊j唋t唌d唍w唎l唒q唓c唕z唖y唗d唘q唙d唚q唜m唝g唞d唟g唡l唥l唦s唨z唩w唫j唭q唲e唴q唵a唶j念n唹y唺t唻l唽x啀a啂g啇d啈h啋c啌q啍z啎w问w啑s啒g啓q啔q啗d啘w啚b啝h哑y启q啠z啢l衔x啨q啩g啫z啯g啰l啱y啲d啳q啴c啹j啺t啽a啿d喅y喆z喌z喍c喎w喐h喒z喓y喕m喖h喗y唤h喛h喞j喠z喡w喢s喣x喤h喥d喦y喨l喩y丧s吃c乔q喭y单c喯p喰c哟y喴w営y喸p喺x喼j喿z嗀h嗁t嗂y嗃h呛q啬s嗈y嗊g嗋x吗m嗏c嗐h嗕r嗗w嗙p呜w嗛q嗞z嗠l嗢w嗧j唢s嗭z嗮s嗰g嗱n嗴q哔b嗸a嗹l嗺z嗻z嗼m嗿t嘂j嘃c嘄j嘅k叹t嘇s嘊a嘋x喽l嘐x嘑h嘒h呕o嘕x啧z尝c嘙p嘚d唛m嘝h嘠g嘡t嘢y嘥s嘦j嘨x哗h嘪m嘫r唠l啸x叽j嘳k哓x嘷h呒m嘺q嘼c嘽t嘾d噀x恶e噂z噃f噄c噅h噆z噇c噈c噉d噊j噋t噏x噐q噑h噒l嘘s噕h噖y噚x噛n噝s噞y噟y哒d噡z噣z哝n哕y噧x噭j噮y嗳a噰y哙k噳y喷p噷x吨d噺h噽p噾y噿z咛n嚁d嚂l嚃t嚄h吓h嚈y嚉d嚊x嚋z哜j嚑x嚔t噜l嚖h嚗b嚘y啮n嚚y嚛h嚜m嚝h嚞z嚟l嚠l嚡x嚢n嚤m咽y呖l嚧l咙l嚩p嚪d嚫c嚬p嚭p向x嚰m嚱x嚲d喾k严y嚵c嘤y嚸d嚹l嚺t嚻x嚽c嚾h嚿h啭z嗫n嚣a囃z冁c囆c囇l呓y囋z苏s囍x囎z囏j囐y嘱z囒l囓n囕r囖l囘h囙y囜n団t囥k囦y囧j囨p囩y囱c囬h囮e囯g囲w図t囶g囷q囸r囼t圀g圁y圂h圅h囵l国g圌c围w圎y圏q圐k圑p园y圆y圔y圕t图t圗t团t圙l圚h圛y圝l圞l圠y圡t圢t圤p圥l圦k圧y圫y圱q圲q圴z圵d圶q圷x圸s圼n圽m圿j坁z坃x坄y坅q坆m坈r坉t坋b坒b坓j坔d坕j坖j坘d坙j坢b坣t坥q坧z坬g坮t垧s坱y坲f坴l坵q坸g坹x坽l坾z坿f垁z垇a垈d垉p垊m垍j垎h垏l垐c垑c垔y垕h垖d垗z垘f垙g垚y垜d垝g垞c垟y垥x垨s垪b垬h垯d垰k垱d垳h垵a垶x垷x垹b垺p垻b垼y垽y垾h垿x埀c埁c埄b埅d埆q埇y埈j埉x埊d埌l埍j埐q埑z埓l埖h埗b埛j埜y埞d垭y埢q埣s埥q埦w埧j埨l埩z埪k埫c埬d埮t埰c埲b埳x埵d执z埻z埼q埾j埿n堁k堃k堄n坚j堈g堉y垩e堌g堎l堏f堐y堒k堓a堔s堖n堗t堘c堚h堛b堜l埚g堟z堢b堣y堥m堦j堧r堨a堩g堫z堬y堭h堮e尧y报b堲j堳m场c堶t堷y堸f堹z堺j堻j堼f堽g堾c碱j塀p塁l塂j塃h塅d塆w塇x塉j块k茔y塎y垲k塐s埘s塓m塕w塖c涂t塙q塚z塛l塜p塝b塟z塠d塡t坞w塣z埙x塦z塧a塨g塩y塪x塭w塮x塯l塰h塱l塲c塳p塴b尘c塶l塷l塸o堑q塺m塻m塼z塽s塿l墂b墄q墆z墇z墈k垫d墋c墌z墍x墎g墏q墐j墒s墔c墕y墖t増z墘q墛w坠z墝q墠s墡s墢f墣p墤k墥t墦f墧q墪d墫c墬d墭s堕d墯d墰t墱d墲w墴h墵t墶d墷y墸z墹j墺a墙q垦k墿y壀p壂d壃j壄y壆x坛t壈l壉j壊h壋d壌r壍q壏x壐x壒a压y壖r壗j垒l圹k垆l壛y壜t壝w坏h垄l壠l壡r坜l壣l壥c壦x壧y壨l坝b壪w壭s壮z壱y売m壴z壵z壷h壸k壶h壻x壼k寿s壾m壿d夀s夁y夃g夅j夆f夈z変b夊s夋q夌l夎c夐x夑x夒n夓x夗y夘w夛d夝q夞y够g夡q梦m夣m夦c夨c夬g夰g夲b夳t夵y夶b夻h夽y夹g夿b奀e奃d奅p奆j奊x奌d奍q奂h奒k奓z奙b奛h奜f奝d奞x奟b奡a奣w奤h奦w奥a奨j奁l夺d奫y奬j奭s奋f奯h奰b奱l奲d奵d奷q奺j奻n奼c奾x奿f妀j妅h妉d妋f妎h妏w妐z妑p妔k妕z妘y妚f妜y妆z妟y妠n妡x妦f妧w妬d妰z妱z你n妴y妵t妶x妷z妸e妺m妼b妽s妿e姀h姁x姂f姄m姅b姇f姈l姉z姌r姗s姎y姏g姕z姖j姙r姛d姞j姟g姠x姡h姢j姤g奸j姧j姩n侄z姫z姭x姮h姯g姰j姱h姲y姳m姴l姵p姶y姷y姸y姺x姼s姽g姾q娀s娂h娋s娍c娎x娏m娐f娒m娔k娕c娖c娗t娙x娚n娱y娝b娞n娡z娢h娤z娦p娧t娨m娪w娫y娬w娭a娮y娯y娰s娳l娵j娷s娸q娹x娺z娻d娽l娾a娿e娄l婃c婄p婅j婇c婈l婋x婌s婍q婎h婏f婐w婑w婒t婓f婔f婖t婗n婘j婙j婛j婜q婝d婞x婟h婠w婡l婣y婤z婥c妇f婨l婩a婫h婬y娅y婮j婯l婰d婱x婳h婸d婹y婻n婼c婽j婾t媀y媁w媂d媃r媄m媅d媆r媇q媈h媉w媊q媋c媌m媍f媎j媏d媐y媓h媔m媕a媖y媗x媘j媙w媜z媞t媟x媠d媢m媣r媤s媥p媦w娲w媨c媩h媫j媬b媭x媮t妫g媰c媱y媴y媶r媷r媹l媺m媻p媪a妈m媿k嫀q嫃z嫄y嫅j嫆r嫇m嫈y嫊s嫋n嫍t嫎p嫏l嫐n嫑b嫓p嫕y妪y嫙x嫚m嫛y嫝k嫞y嫟n嫢g嫤j嫥z嫧z嫨h嫪l嫬z嫭h嫮h嫯a嫰n嫲m嫳p嫴g妩w嫶q嫷t嫸z嫹m嫺x娴x嫼m嫽l嫾l嬀g嬁d嬂z嬄y嬅h嬆x嬇k娆r嬊y婵c娇j嬍m嬎f嬏f嬐x嬑y嬒h嬔f嬕s嬘s嫱q嬚l嬛h袅n嬞d嬠c嫒a嬢n嬣n嬷m嬥t嬦c嬧j嬨c嬩y嫔p嬫r嬬r嬭n嬮y嬯t婴y嬱q嬳y嬵m嬶k婶s嬹x嬺n嬻d嬼l嬽y嬾l嬿y孁l孂j娘n孄l孅x孆y孇s孈x孉h孊m孋l娈l孍y孎z孏l孖m孞x孠s孡t孧y孙s孭m孮c孯q孲y孴n孷l学x孹b孻n孼n孾y孪l宂r宆q宊t宍r宎y宐y宑j宒z宔z宖h実s宧y宨t宩s宬c宭q宫g宯x宱z宲b宷c宺h宻m宼k寀c寁z寃y寈q寉h寊z寋j寍n寎b寏h寑q寔s寕n寖j寗n寘z寙y寚b寛k寜n寠j寝q寣h实s宁n审s寪w写x宽k寭h寯j寱y寲y寳b寴q宠c宝b寷f寽l対d尀p専z尃f将j专z寻x尌s对d导d尐j尒e尓e尗s尙s尛m尞l尟x尠x尡h尣w尦l尨m尩w尪w尫w尭y尮d尯k尰z尲g尳g尵t尶g尴g屃x届j屇t屌d屍s屒z屓x屔n屖x屘m屚l屛p屉t扉f屟x屡l层c屧x屦j屩j屪l屫j属s屭x屰n屲w屳x屴l屵a屶h屷h屸h屻r屼w屽h屾s岀c岃y岄y岆y岇a岉w岊j岋e岏w岒q岓q岕j岝z岞z岠j冈g岤x岥p岦l迢t岨j岮t岯p岰a岲k岴q岶p岹t岺l岻d岼p峀x峂t峃x峅b峆h峇b峈l峉e峌d峍l峎e峏e峐g峑q峓y峔m峕s峖a峗w峘h峚m峛l峜f峝t峞w峟y峠q峢l峧j峩e峫x峬b峯f峱n峲l峳y岘x峵r岛d峷s峸c峹t峺g峼g峡x峿w崀l崁k崄x崅q崈c崉t崊l崋h崌j崃l崏m崐k崑k崒z崓g崕y岗g崘l崚l崜d崝z崟y岽d崡h峥z崣w崥p崨j崪z崫j崬d崯y崰z崱z崲h嵛y崵y崶f崷q崸y崹t崺y崻z崼s崿e嵀z嵁k嵂l嵃y嵄m嵅h嵆j嵈h嵉t嵍w嵎y嵏z岚l嵑k岩y嵓y嵔w嵕z嵖c嵗s嵙k嵚q嵜q嵞t嵟c嵠x嵡w嵢c嵣d嵤r嵥j嵦k嵧l嵨w嵪k嵭b嵮d嵰q嵱y嵲n嵳c嵵s嵶r嵷s嵸z嵹j嵺l嵻k嵼y嵾c嵿d嶀t嵝l嶃z崭z嶅a嶆c岖q嶉w嶊z嶋d嶌d嶍x嶎y嶏p嶐l嶑x嶒c嶓b嶔q嶕j嶖y崂l嶘z嶚l嶛l嶜q嶞t嶟z峤j嶡j嶢y嶣j嶤y嶥j嶦z峄y嶨x嶩n嶫y嶬y嶭n嶮x嶯j嶰x嶱k嶲g嶳d嶴a嶵z嶶w嵘r嶹d岭l嶻j屿y岳y嶾y嶿r巀j巁l巂x巃l巄l巇x巈j巉c巊y岿k巌y巎n巐c漓l峦l巓d巅d巕n巗y巘y巙k巚y巜k巟h巠j巣c巤l巪g巬p巭b巯q巵z巶z巸y卺j巺x巻j巼p巿f帀z帄d帇n帊p帋z帍h帎d帒d帓m帗f帞m帟y帠y帡p帢q帣j帤r帅s帨s帩q帪z师s帬q帯d帰g帲p帐z帴j帵w带d帹s帺q帾z帿h帧z幁z帏w幆y幇b幈p幉d幊g幋p幍t幎m幏j幐t幑h幒z幓s幖b帼g帻z幙m幚b幜j幝c帜z幠h币b幤b幦m幧q幨c蒙m帮b帱c幭m幮c幰x幱l幵j幷b干g几j庁t仄z広g庈q庉d庌y庍b庎j庒z庘y庛c庝t庡y庢z庣t庤z庨x庩t庪g库k庬m庮y庯b庰b庱c庲l庴j庻s庼q庽y庿m廀s厕c厢x廃f厩j廅e廆h廇l厦s廋s廌z廍b廎q廏j廔l廕y廗d廘l廙y厨c廜t厮s廞x庙m厂a庑w废f广a廤k廥k廦b廧q廪l廫l庐l廭j廮y廯x廰t痈y廲l厅t廵x廸d廹p廻h廼n廽h弆j弇y弉z弌y弍e弎s弑s吊d弖h弙w弚t弜j弝b弡j弢t弣f弤d弨c弫z弬y弮j弰s弲x弪j弴d张z弶j强j弸p弻b弽s弾d弿j彁g彂f彃b彄k彅j彇x弹d彉g彋h弥m彍g弯w彏j彑j彔l彚h彛y彜y彞y彟h彠h彣w彦y彧y彨c雕d彮y彯p彲c彴z彵t彶j彸z彺w彽d彾l佛f徃w徆x徍w徎c徏z径j従c徔c徖c徝z从c徟z徕l徢x徣j徤j徥s徧b复f旁p徯x徰z徱p徲t徳d徶b彻c徺j徻h徾m徿l忀x忁b忂q忈r忊d忋g忎r忓h忔y忕s忚x忛f応y忞m忟m忢w忣j忥x忦j忨w忩c忬y忯q忰c忲t忳d忴q忶h忷x忹w忺x忼k怇j怈y怉b怋m怌p怐j怑b怗t怘h怚c怞y怟d怢t怣y怤f怬x怮y怰x怲b怳h怴x怶b怷s怸x怹t怺y怽m恀s恄x恅l恒h恇k恈m恉z恊x恌y恏h恑g恓x恔x恖s恗h恘q恛h恞y恟x恠g恡l耻c恦s恮z恱y恲p恴d恵h恷q恾m悀y悁j悂p悦y悆y悇t悈j悊z悋l悎h悏q悐t悑b悓q悕x悗m悘y悙h悜c悞w悡l悢l悤c悥y悧l悩n悪e悮w悰c悳d怅c闷m悷l悹g悺g凄q悾k悿t惀l惁x惂k惃g惄n惇d惈g惉z惌y惍j惎j惏l惐y惒h惓q惔t惖t惗n啜c惛h惞x惢s惣z惤j惥y惪d恼n恽y惵d惷c惸q恻c惼b惽m惾z惿t愃x愄w愅g愇w愊b愋x愌h愐m愑y愒q愓d愔y愖c愗m愘k愙k爱a惬q愝y愞n愡c愢s愥y悫q愩g愬s愭q愮y愯s愰h愱j愳j怆c愵n愶x恺k愸z愹y愺c愻x愼s愽b忾k慀x慁h慂y栗l慅s慆t殷y慉x态t愠y慏m慐g慒c慓p慔m慖g慗c惨c惭c慛c慜m慞z恸t慠a慡s惯g慤q慥z慦j慩l怄o怂s慬q慭y虑l慯s慱t慲m悭q慴s庆q慸d慹z慺l慻j戚q慽q欲y慿p憀l憁c忧y憃c憄z憅t憆c憇q憈q惫b憌q憍j憏c怜l凭p愦k憓h憕c憖y憗y憘x憙x惮d憛t憞d憟s憠j憢x憣f愤f憥l憦l憪x悯m憭l怃w憯c憰j憱c宪x憳t憴s憵p忆y憸x憹n憺d憻t憼j憽s懀w懁x懃q懄q懅j懆s恳k应y怿y檩l懎s懐h懓a懕y懖g懗x懘c懙y懚y懛d懜m懝a怼d懠q懢l懑m懤c懥z懧n恹y懩y懪b懫z懬k懭k懮y懯f懰l懱m惩c懳h懴c懒l怀h悬x懹r忏c懻j惧j懽h慑s恋l戁n戂m戃t戄j戅g戆g钺y戓g戋j戙d戜d戝z戞j戠z戣k戦z戗q戨g戬j戫y戭y戯x战z戱x戏h户h戸h戹e戺s戻t戼m扂d扄s扅y扆y扊y扏q仂l払f扖h扗z扙z扚d扜y扝y扞h扟s叉c扡t扦q扤w扥d扨s扱c扲q扴j扵y扷b扸x抵d扻z扽d抁y抂k拚p抅j擦c抇h抈y抋q抌d抍z殒y抏w抐n抔p抙p抜b抝a択z抣y抦b抧z抩n抪p抭y抮z抰y抲h抳n曳y抶c抷p抸j抺m抾q拀z拁j拃z抛p拏n拑q拕t拝b拞d拠j拡k拤q拪q拫h拰n拵c拸y拹x拺c拻h挀b挃z挄k挅d挆d挊n挋z挍j挏d挐n挒l挓z挔l挕d挗j挘l挙j挜y挦x挧y挩t挬b挭g挮t挰c挱s挳k挴m挵n挷b挸j挻s挼r挟x挿c捀p捁j捄j捇h捈t捊p捑z捒s捓y捔j捖w捗b捘z捙y捚z捛l捜s捝t捠b捤w捥w捦q舍s捪m扪m捬f捯d捰w卷j捳y捴z捵c捸t捹b捼r捽z捾w捿q掁c扫s抡l掅q掆g掋d掍h掑q掓s掔q掕l掗y挣z掚l挂g掜y掝h掞y掟z采c掦t掫z掯k掱p掲j掵m掶j掹m掻s掽p掿n拣j揁z揂j揃j揅y揇n揈h揊p揋w揌z揑n揓s揔z揕z揗x揘h揙b扬y换h揜y揝z揟x揢k揤j揥d揦l揧l揨c揫j揬t挥h揯g揰c揱x揳x揵q揷c背b揺y揻w揼b揾w搃z搄g构g搇q搈r搉q搊c损s搎s搑r搒b搕k摇y捣d搘z搙n搚l搝q擀g搢j搣m搤e搥c搧s搨t搩j搫p搯t搰h搱z搲w搳h搵w抢q搷t搸z搹e搻n搼q搾z摂s摃g摉s摋s摌c摍s摎n摏c摐c掴g摓f摕d摗s摙l摚c摛c掼g摝l搂l摠z摡g摢h摣z摤q摥t摦h摨z摪j摫g摬y摮a挚z摰n摱m摲c抠k摴c摵s抟t摷j掺c摼k摽b摿y撀g撁q撃j撆p捞l撉d撊x撋r撌g撍z撎y撏x撑c挠n撔h撗h搭d捻n撛l撜z撝h挢j撠j撡c掸d拨b撦c撨x撪b抚f撯z撱w扑p揿q撴d撶h撹j挞t撽j挝w捡j拥y擃n掳l擆z择z擈p擉c击j挡d擌s擏q擑j擓k担d擕x擖y擙a据j擛y擜e擝m挤j擡t擥l擧j擨y擩r擪y擫y拟n擭h擮j摈b拧n搁g掷z擳z扩k擵m擶j撷x擸l擹t摆b擞s撸l擽l扰r攁y攃c摅s攅z撵n攇x攈j攊l攋l攌h攍y攎l隆l攐q攑q攓q拦l攕x撄y攗m搀c撺c携x摄s攞l攟j攠m攡c攒c挛l摊t攦l攧d攨w攩d搅j揽l攭l攰g攱g攲q攳x考k攼g攽b敀p敁d敂k敃m敄w敆h敇c敊c敋g敍x敎j敐c敒s敓d敔y败b叙x敚d敜n敟d敠d敡y敤k敥y敧q敨t敩x敪d敭y敮x敯m敱a敳a敌d敶c数s敹l敺q敻x敼y敽j敾s敿j斀z斁d敛l毙b斄l斅x斆x斈x斉q斊q斍j斎z斏l斒b斔y斓l斖w斘s斚j斝j斞y斠j斢t斣d斦y斨q斪q斩z斱z斲z斴l斵z斶c断d斸z斺c斻h斾p斿l旀m旗q旇p旈l旉f旊f旍j旐z旑y旓s旔j旕e旘z旙f旚p旛f旜z旝k旞s旟y旡j旣j旪x旫t旲t旳d旴x旵c旸y旹s旻m旼m旽t旾c旿w昁b昄b昅j升s昈h昉f昋g昍x昑q昒h昖y昗z昘f昚s昛j昜y昞b昡x昢p昣z昤l昦h昩m昪b昫x昬h昮z昰s昲f昳d昷w昸d昹a昺b昻a昽l昿k晀t时s晄h晅x晆k晈j晋j晊z晍t晎h晐g晑x晘h晙j晛x晜k昼z曦x晠s晢z晣z晥w晧h晩w晪t晫z晭z晱s晳x晵q晸z晹y晻a晼w晽l晿c暀w暁x暃f暅g暆y晕y晖h暊x暋m暍y暏s暐w暒q暓m暕j阳y暙c暚y暛s暜p暞j暟k暠g暡w畅c暣q暤h暥y暦l暩j暪m暂z暬x暯m暰c昵n暲z暳h暵h暶x暷c了l暺t暻j暼p暽l暿x曀y曁j曂h曃d晔y曅y历l昙t曈t晓x曊f曋s曍h曎y曏x曐x曑s曒j曓b曔j曕y暧a曘r曚m曞l曟c旷k曡d曣y曤h曥l曧r曨l曪l曫l晒s曭t曮y曯z曱y曵y曶h书s曺c曽z朁c朂x会g朄y朅q朇b朎l朏k朒g朓t朖l朘j朙m朚h朜t朞j朠y朡z朢w朣t朤l朥l胧l术s朰t朲r朳b朶d朷d朸l朹q朻j朼b朾c朿c杁r杄q杅y圬w杊x杋f杍z杒r杔t杕d杗m杘c杙y杚g杛g杝t杢j杣m杤w杦j杧m杫s杬y杮f东d杴x杶c杸s杹h杺x杻c杽c枀s枂w枃j枅j枆m枊a枍y枎f枏n枑h枒y枓d枔x枖y栀z枛z枟y枠h枡s枤d枦l枩s枬z枮x枱s枲x拐g枹b枺m枻y枼y枽y枾s枿n柀b柂d柅n柆l柇h柈b柉f柊z柋d柌c柍y柎f柕m柖s柗s柟n柡y柣z柤z柦d柧g柪a柫f柭b柮w柲b栅s柶s柷z柹s柺g査c柼y柾j栁l栂m栃l栄r栆z栍s栐y栒x栔q栕c栘y栙x栚z栛l栜s栞k栟b栠r栢b栣r栤b栥z栦c栧y栨c栫j栬z栮e栯y栰f栱g栴z栵l栶y栺z栻s栿f桇r桋y桍k桏q桒s桖x桘c桙y桚z桛k桝j桞l桟z桪x桬s桭c桮b桯t桰g桱j桲b桳b桵r桸x桹l桺l桻f桼q桽w桾j杆g梀s梂q梄y梇l梈p梉z梊d梋x梌t梎a梐b梑d梒h梕r梖b梘j梙h梚w梛n梜j条t梞j枭x梠l梡k梣c梥s里l梪d梬y梮j梱k梲z梴c梶w梷j梸l梹b梺x梻x梼d梽z梾l梿l棁z弃q棅b棆l棈q棊q棌c棎c棏d棐f棑p棓b棔h枨c枣z棙l棛y棜y棝g棞j栋d棡g棢w棤q棥f棦c栈z棨q棩y棪y棫y棬j棭y棯s栖q棳z棴f棶l棷z棸z棻f棽c棾q棿n椀w椂l椄j椆c椇j椈j椉c椊z椌k桠y椑b椓z椔z椕b椖p椗d椙c椚m椛h検j椝g椞x椡d椢g椣d椥z椦q椧m椨f椩g椪p椫s椬y椮s椯d椱f椲h椳w椵j椶z椷j椸y椺x椻y椼y椾j楀y楁h楃w楄p楅b楆y楇g楈x楉r杨y楋l楌y楍b楎h楏k楐j楑k楒s枫f楘m楙m楛h楜h楟t楢y楤c楥x楧y桢z楩p楪d楬j业y楯d楰y楲w楳m楴d极j楶j楺r楻h楽l楾h楿k榁m榃t榅w榊s榋c榌b榎j榏y榑b榒n榓m榖g榗j榚y榝s榞y榟z榠m榡s榢j榣y榤j榥h榩q杩m榬y荣r榯s榰z榲w榳t榵r榶t榸z榹s榺s榼k榽x榾g桤q槂s盘p槄t槅g槆c槇d槈n槉j枪q槏q槑m槒x杠g槕z槖t様y槙d槚j槜z槝d槞l槡s槢x槣j槤l槥h槦r椠q椁g槩g槪g槫t槬h槮s槯c槰p槱y桨j槴h槵h槶g槷n槹g槺k槻g槼g槾m樀d桩z樃l樄c枞c樆l樇x樈q樉s樋t樌g樍z樎s樏l梁l樒m楼l樔c樕s樖k标b樚l樛l樜z樝z枢s樠m樢n样y樤t樥p樦z樧s権q樫j樬c樭j樮y樰x樲e樳x樴z樶z樷c朴p树s桦h樻g橀x橁c橂d橃f橅m橆w桡r橉l橊l桥q橌x橍r橎f橏j橑l橒y橓s橔t橕c橖t橗m橚s橜j橝t橞h机j橠n椭t橣n橤r橦t橧z橪y横h橬q橭g橮l橯l橰g橲x橳s橴z橵z橶j橷d橸j橺x橻c橽t橾s橿j檃y檅h檆s檇z檈x柽c檊g檋j檌z檍y檏p檒f檓h档d檕j檖s檘p檙c檚c檛z桧g檝j檞j檟j檡z检j樯q檤d檥y檦b檧s檨s檭y檮c台t檰m檱q檲t槟b檴h檵j檶q檷n柠n檹y檺g槛j檼y檽n檿y櫀q櫁m櫂z柜g櫄c櫅j櫆k櫇p櫉c櫊g櫋m櫌y櫍z櫎h櫏q櫑l櫒s橹l櫔l櫕c櫖l櫗m櫘h櫙o榈l栉z櫜g椟d橼y栎l櫠f櫡z櫣l櫤j橱c櫦q槠z栌l櫩y枥l櫫z榇c櫭j櫮e櫯s櫰h櫱n櫲y栊l櫵q櫶x櫷g榉j櫹x棂l樱y櫼j櫽y櫾y欀x欁n栏l欅j欆s欇s欈w欉c权q欋q欌z欍j欎y椤l欐l欑c栾l欓d欔q欕e榄l欗l欘z欙l欚l欛b欜n欝y欥y欨x欩c欪c欫q欬k欭y欮j欯x欰x欱h欳k欴l欵k欶s欸a欻c欼c钦q欿k歀k歁k歂c歄g歅y歈y歊x歋y歍w歏j欧o歑h歒t歓h歔x歕p歖x歗x歘x歚s歛l歜c歝y欤y歠c欢h歨b歩b歫j歭z歮s歯c歰s歱z岁s歳s歴l歵z歶y归g歺d歽z歾m殁m殀y殅s殈x殌j殎q殐s殑j殔y殕f殗y残c殙h殜d殝z殟w殠c殢t殣j殇s殥y殦c殧j殨k殩c殚d殬d殓l殡b殰d殱j歼j殶z殸q殹y杀s殻k壳k殽x殾x毁h毃q毄j殴o毇h毈d毉y毊x毋w毎m毐a毑j毘p毚c毞b毟m毠j毢s毣m毤t毦e毧r毨x毩j球q毭d毰p毱j毲d毴b毶s毷m毸s毺s毻t毼h毾t毵s氀l氁m氂m氃t氄r毡z氉s氊z氋m氇l氎d氒j気q氜y氝n氞n氠s气q氥x氢q氩y氭d氱y氲y氶z氷b氹d氺s氻l氼n泛f氿g汃p汄z汅m汈d汋z汌c丸w汏d汑t汒m汓q汖p汘q污w汚w汢t汣j汥z汧q汫j汬j汭r汮j汯h汱t汳b汵g汷z汸f决j汼n汿x沀x沄y沇y沊d沋y沍h沎h沑n没m冲c沗h沘b沚z沜p沝z沞z沠p沢z沨f沬m沯z沰t沴l沵m沶y沷f沺t泀s况k泂j泃j泆y泇j泋h泍b泎z泏c泑y泒g泙p泚c泜z泝s泟c泤s泦j泧y泩s泬j泭f泲j泴g泹d洀p洃h洅z洆c洈w洉h洊j洍s洏e洐x洑f洓s洔z洕y洖w洘k洝a洟y洠s洡l洢y洣m洤q洦p洨x泄x洬s洭k洯q洰j洴p汹x洷z洸g洺m洿w浀q浂y浄j浉s浌p浐c浕j浖l浗q浘w浛h浝m浟y浡b浢d浤h浥y浧y浨l浫h浭g浱c浳y浵t浶l浃j浺c浻j浽s浾c浿p涀x涁s涃k涄p涆h泾j涊n涋t涍x涏t涐e涒t涗s涘s涙l涚s涢y涥h涬x涭s涰c涱z涳n涴w涷d涹w涺j涻s凉l涽h涾t淁q淂d淈g淉g淊y淍z淎p淏h淐c淓f淔z淕l淗j泪l淛z淜p淟t淢y淣n渌l淧m淩l沦l淭q淯y淰n淲b淴h渊y涞l淸q浅j淽z淾y淿b渀b渁y渂w渃r渄f渆y渇k済j渉s渋s渏y渒p渓x渕y渘r涣h减j渞q渟t渢f涡g渧t渨w渪r测c渮h渰y渱h渳m渵m渶y渷y渹q渻s渼m渽z浑h渿n湀g湁c湂e湅l湆q湇q湈m湉t凑c湋w湌c湏h湐p湑x湒j湗f湙y湚y湜s湝j浈z湠t湡y湢b湣m湤s湥t湦s涌c湨j湩d湪t湬q湭q汤s湰l湱h湳n湴b湵y湶q湷z湸l湹c湺x湻c湼n湽z満m溁y溂l溄f溇l沩w溊b溋y溌h溍j溎y溑s溒y溓l溔y溕m准z溗c溙t溚t溛w沟g溞s溠z溡s溣l溤m溦w溨z溩w温w溬q溭z溮s溰a溵y溸s溹s湿s溾a溿p滀c滃w沧c灭m滆g滈h滉h滊q涤d滍z荥x滐j滒g滘j滙h滛y滝l滣c滧y滪y滫x沪h滭b滮b滞z滰j滱k渗s滳s滶a卤l浒h滺y滻c滼f滽y滚g满m漀q渔y漃j漄y漅c漇x漈j漊l漋l漌j漍g漎c漑g漒q漖j漗c漘c漙t沤o漛t漜y漝x漞m漟t漡s汉h涟l漥w漦c漧g漨f渍z漮k漰p涨z漴c漵x漷h渐j漺s漻l漼c漽t浆j潀c潂h潃x潄s潅g潈z潉k潊x潌z潏y潐j泼p潒d潓h洁j潕w潖p潗j潙w潚s潜q潝x泻x潠s潡d润r潥s潧z潨c潩y潪z潫w潬t浔x溃k潱y潳t潵s潶h滗b潹c潻s潽p潾l涠w涩s澁s澂c澃j澅h浇a涝l澊c澋j澏h澐y澑l澒h澓f澔h澕h澖x涧j澘s澙x澛l澝n澞y澟l渑m澢d澣h泽d澥x澦y澨s泶x澪l澫w澬z澭y浍k澯c澰l淀d澲y澴h澷m澸g澺y澻s澼p澽j澾t澿q浊z浓n濄g濅j濆p濇s濈j濊h濋c濌t濍s濎d濏s濐z濓l濔m濖s濗m泞n濙y濚y濜j濝q济j濢c濣w涛t濥y濦y濧d濨c濩h濪q滥l濬j濭a潍w滨b濲g濳q濴y濶k濷f濹b溅j濻w泺p濽z滤l濿l瀁y瀂l瀃s瀄z滢y渎d瀈h瀊p渖s瀌b瀍c瀎m浏l瀒s瀓c瀔g濒b瀖h瀗x泸l瀙q瀜r沥l瀞j潇x潆y瀡s瀢w瀤h瀥x瀦z泷l濑l瀩d瀪f瀫h瀬l瀭s瀮l瀯y瀱j潋l瀳j瀴y瀶l瀷y瀸j瀺c瀻d瀼r瀽j澜l瀿f灀s灁y灂z沣f滠s灅l灆l灇c灈q灉y灊q灋f灍j灎y灐y洒s灒z灓l灔y灖m灗s滩t灙d灚j灛c灏h灟z灠l灡l灢n湾w滦l灥x灦x灧y灨g灪y灮g灱x灲x灳h灴h灷z灹z灺x灻c灾z炁q炂z炄n炆w炇p炈y炋p炌k炐p炑m炘x炚g炛g炞b炟d炠x炡z炢z炣k炤z炥f炦b炧x炨x炩l炪z炰p炴y炵t炶s为w炿z烄j烅x烆h烇q烉h烋x烌x烍x烎y乌w烐z烑y烒s烓w烔t烕m烖z烗k烚x烜x烝z烠h烡g烢c烣h烥c烰f烱j烲x烳p烃t烵z烶t烸h烺l烻y烼x烾c烿r焀h焁x焂s焃h焄x焅k焆j焇x焈x焋z焌j焍d焎x焏j焒l焔y焗j焛l焜k焝h焞t焟x焠c无m焢h焣j焤f焥w焧z焨f焩p焪q焫r焬x焮x焳j焴y焵g焸x焹g焻c焼s焽x焾n焿g煀q煁c煂h煃k煄z煆x煇h煈f炼l煋x煍j煏b煐y煑z炜w煓t煔s煕x煖n煗n煘c烟y煚j煛j煝m煟w煠y煡j茕q煣r焕h烦f煪q煫s炀y煭l煯j煰z煱g煴y煵n煶s煷h煹g煻t煼c煾e煿b熀h熁x熂x熃w熅y熆h熇h熈x熉y熋x熌s熍q熎y熐m熑l荧y熓w熕g熖y炝q熚b熛b熜c熝l熞j熡l熢p熣s熤y熥t熦j熧z熩h熪y熫z熭w熮l熯h熰o热r熲j熴k熶c熷z熸j熺x熻x熼y熽x炽c熿h燀c烨y燂t焰y燅x燆q燇j灯d炖d燊s燋q燍s燏y磷l燑t烧s燖x燗l燘m烫t燚y燛j焖m燝z营y燡y燣l燤t灿c燨x燩q燪z燫l烛z燯l燱y燲x燳z烩h燵t燶n燷l燸x燺h燻x烬j燽c焘d燿y爀h爂b爃r爄l爅m爇r爈l爉l爊a爋x爌k烁s爎l爏l炉l爑j爒l爓y爔x爕x爖l爘c爚y烂l爜c爞c爟g爡c爢m爣t爤l爦l爧l爩y爫z争z爮p爯c爲w爳h爴j爷y爼z尔e牀c牁k牂z牃d牄q牅y牉p牊c牋j牎c牏y牐z牑b牓b牕c牗y牍d牚c牜n牞j它t牣r牤m牥f牨g瘪b牫g牬b牭s牰y牱k牳m牶q牷q牸z牻m牼k牵q犂l犃p犅g犆z犇b犈q犉c犌j犎f犐k犑j犓c犔x犕b荦l犗j犘m犙s犚w犁l犜d犝t犞q犠x犡l犊d犣l犤b犥p犦b牺x犨c犩w犪k犫c犮q犱j犲c犳z犵g犺k犻p犼h犽y犾y犿h状z狅k狆z狇m狉p狊j狋y狌s狏t狑l狓p狕y狖y狘x狛b狜k狝x狟h狢h狣z狤j狥x狦s狧t狪t狫l狵m狶x狭x狈b狾z狿y猀s猂h猄j猅p猆f猇x猈b猉q猋b猌y猐q猑k猒y猔z猘z狰z猚y猟l猠c猣z猤g猦f猧w猨y猭c猯t猰y猲h猳j猵p犹y猺y狲s猼b獀s獁m獂h獃d狱y狮s獆h獇q獈y獊c獋h獌m奖j獏m獑c獓a獔h獕s獘b獙b獚h獛p獜l獝x獞t獟y獡s獢x獣s獤d獥j獦g獧j独d獩h狯k猃x猕m狞n獱b获h獳r獴m猎l獶n犷g兽s獭t献x獽r獿n猡l玁x玂q玃j玅m兹c玈l玊s玌q玍g玏l玐b玒h玓d玔c玕g玗y玘q玙y玚c玜h玝w玞f玠j玡y玣b玤b玥y玦j玧m珏j玪j玬d玭p玱q玴y玵a玶p玸f玹x玼c玽g玾j玿s珁c珃r珄s珅s珆y珇z珋l珌b珎z珒j珓j珔j珕l珖g珗x珘z珚y珛x珜y珝x珟s珡q珢y珣x珤b珦x珨x珪g珫c珬x佩p珯l珰d珱y珳w珴e珵c珶d珷w珸w珹c珺j珻m珼b珽t现x珿c琀h琁x琂y琄x琇x琈f琋x琌l琍l琎j琑s琒f琓w琔d琕p琖z琗c琘m琙y琜l琝m琞s琟w琠t琡s琣b琤c琧e琩c琫b琭l琯g琱d琲b琷q琸z琹q珐f琻j琽d琾j珲h瑀y瑂m瑃c瑄x瑅t瑆x瑇d瑈r瑉m玮w瑌r瑍h瑎x瑏c瑐j瑑z瑒y瑓l瑔q瑖d瑝h瑠l瑡s瑢r琐s瑶y瑥w瑧z瑨j莹y玛m瑫t瑬l瑮l琅l瑱t瑲q瑳c瑴j瑵z瑹t瑺c瑻k瑼z瑽c瑿y璂q璄j璅s璆q璈a琏l璌y璍y璏z璑w璒d璓x璔z璕x璖q璗d璘l璙l璚j璛s璝g璟j璡j璢l玑j璤h璥j瑷a璪z璫d璬j璭g璮t璯h环h璱s璲s璳t璴c璵y璶j璷l璸b璹s璻z璼l玺x璾j璿x瓀r瓁w瓂g瓃l瓄d瓅l瓆z瓇r瓈l瓉z琼q瓋t瓌g瓍s瓎l珑l瓐l瓑l瓓l璎y瓕m镶x瓗q瓘g瓙d瓒z瓛h瓝b瓟b瓡z瓥l瓨x瓩q瓪b瓫p瓬f瓭d瓳h瓵y瓸b瓹j瓺c瓻c瓽d瓾w甀z甁p甂b甃z甅l甆c甈q甉x甊l甋d瓯o甎z甐l甒w甔d瓮w甖y甗y甛t甝h甞c甠q甡s产c産c甤r甧s甪l甮f甴y甶f甹p甼t甽z甿m畁b畂m畃x畆m畇y畉f畊g畍j畐f畑t畒m畓d畕j畖w畗d畘n亩m畟j畠t畡g毕b畣d畤z畨f畩y画h畲s畭s畮m畯j异y畱l畳d畵h畷z畺j畻c畽t畾l疀c疁l疂d疄l疅j畴c疈p疉d叠d疌j疍d疎s疐z疓n疕b疘g疛z疞x疢c疦j疧q疨y疩c疭z疶x疷z疺f疻z痱f痀g痁d痆n痋t痌t痎j痏w痐h痑t痓z痗m痉j痚x痜t痝m酸s痡f痥d痩s痬y痮z痯g麻m痵j痶t痷a痸c痹b痻m痽d痾k瘂y瘄c瘆s瘇z瘈z瘉y疯f疡y瘎c瘏t瘑g瘒w痪h瘔k瘖y瘚j瘜x瘝g瘗y疮c瘣h疟n瘨d瘬z瘮s瘯c瘱y瘲z瘶s瘷s瘘l瘻l瘽q疗l癄q癅l痨l痫x癈f瘅d癋h癎x癏g癐g癑n癒y癓w癕y癗l疠l癙s癚d癛l癝l癠j痴c痒y疖j症z癧l癨h癞l癪j癣x瘿y瘾y瘫t癫d癳l癴l癵l癶b癹b発f发f癿q皀b皁z皃m皅p皉c皊l皌m皍j皏p皐g皒e皔h皕b皗c皘q皑a皛x皜h皝h皞h皟z皠c皡h皢x皣y皥h皦j皧a皨x皩h皪l皫p皬h皭j皯g疱p皳q皵q皶z皷g皲j皹j皱z隳h皼g皽z皾d盀q盁y盃b啊a阿a埃a挨a哎a哀a癌a蔼a矮a艾a碍a隘a鞍a氨a安a俺a按a暗a岸a胺a案a肮a昂a盎a凹a敖a熬a翱a袄a傲a懊a澳a芭b捌b扒b叭b吧b笆b八b疤b巴b拔b跋b靶b把b耙b霸b罢b爸b白b柏b百b佰b拜b稗b斑b班b搬b扳b般b颁b板b版b扮b拌b伴b瓣b半b办b绊b邦b梆b榜b膀b绑b棒b磅b蚌b镑b傍b谤b苞b胞b包b褒b盄d盇h盉h盋b盌w盓y盕f盙f盚q盗d盝l盏z盠l盢x监j盦a卢l盨x盩z荡d盫a盬g盭l盰g盳m盵q盷x盺x盻x盽f盿m眀m眂s眃y眅p眆f眊m県x眎s眏y眐z眑y眒s眓h眔d眕z眖k眗j眘s眛m眜m眝z眞z眡s眤n眦z眧c眪b眫p眬l眮t眰d眱d眲n眳m眴s眹z眻y眽m众z眿m睂m睄s睅h睆h睈c睉c睊j睋e睌m睍x睎x困k睒s睓t睔g睕w睖l睗s睘q睙l睁z薄b雹b保b堡b饱b抱b暴b豹b鲍b爆b杯b碑b悲b卑b北b辈b贝b钡b倍b焙b被b奔b本b笨b崩b绷b甭b泵b蹦b迸b逼b鼻b比b鄙b笔b彼b碧b蓖b蔽b毖b庇b闭b敝b弊b必b辟b壁b臂b避b陛b鞭b边b编b贬b扁b便b变b卞b辨b辩b辫b遍b彪b膘b表b鳖b憋b彬b斌b宾b兵b冰b柄b丙b秉b饼b炳b睝l睐l睟s睠j睤b睧h睩l睾g睭z睮y睯h睰m睱x睲x睳h睴h睵z睶c睷j睸m睺h睻x睼t瞁x瞂f瞃w瞆g眯m瞉k瞊d瞋c瞐m瞕z瞖y瞗d瞘k瞙m瞚s瞛c瞜l瞝c瞒m瞡g瞣w瞤s瞦x瞨p瞫s瞮c瞯x瞱y瞲x瞴w瞶g瞷j瞸y瞹a瞺h睑j瞾z矀w矁c矂s矃n矄x矅y矆h矈m矉p矋l矌k矎x矏m矐h矑l矒m矔g矕m矖x矘t矙k瞩z矝j矞y矟s矠z矡j矤s病b玻b菠b播b钵b波b博b勃b搏b铂b箔b伯b帛b舶b脖b膊b渤b泊b驳b捕b卜b哺b补b埠b不b步b簿b部b怖b猜c裁c材c才c财c睬c踩c彩c菜c蔡c餐c蚕c苍c舱c藏c操c糙c槽c曹c草c策c蹭c插c茬c茶c查c碴c搽c察c岔c差c诧c拆c柴c豺c蝉c馋c谗c缠c阐c颤c昌c猖c矦h矨y矪z矫j矰z矱y矴d矵q矷z矹w矺z矻k矼g砃d砄j砅l砆f砇m砈e砊k砋z砎j砏p砐e砓z砕s砙w砛j砞m砠j砡y砢l砤t砨e砪m砫z砮n砯p砱l炮b砳l砵b砶p砽y砿k硁k硂q朱z硄k硆e硈q硉l硊w硋a硍k硏y硑p硓l硔h硘q硙w硚q硛c硜k硞q硟c硠l硣x硖x硥m硦l硧y砗c硩c砚y硰s硱k硲y硳z硴h硵l硶c硹s硺z硻k硽y硾z硿k碀c碁q碂z碃q常c长c肠c敞c唱c倡c超c抄c钞c朝c嘲c潮c巢c吵c炒c车c扯c撤c掣c澈c郴c臣c辰c晨c忱c沉c陈c趁c衬c称c城c橙c成c呈c乘c程c澄c诚c承c逞c骋c秤c持c匙c池c迟c弛c驰c齿c侈c赤c翅c斥c充c虫c崇c抽c酬c踌c稠c愁c筹c仇c绸c瞅c丑c臭c初c出c躇c锄c雏c滁c除c楚c碄l碅j碆b碈m碊j碋h碏x碒y碔w碕q碖l碙n碝r碞y碠d碢t碤y碦k碨w硕s碪z碫d碬x砀d碮t碯n碵t碶q碷d碸f确q码m碿s磀e磃s磄t磆h磇p磈k磌t磍x磎x磏l磑w磒y磓d磖l磗z磘y砖z磛c磜q磝a磞p磟l磠l磡k磢c碜c磤y磥l磦b碛q磩z磪c磫z磮l矶j磱l磳z磵j磶x磸d磹d磻b磼j硗q磾d磿l礀j礂x礄q礆j礇y礈z礉h礊k礋z礌l础c矗c搐c触c处c揣c川c穿c椽c船c喘c串c窗c幢c床c闯c吹c炊c捶c锤c垂c春c椿c醇c唇c淳c纯c蠢c戳c绰c疵c茨c磁c雌c辞c慈c瓷c词c此c刺c赐c次c聪c葱c匆c粗c醋c簇c促c蹿c篡c窜c摧c崔c催c脆c瘁c粹c淬c翠c村c存c磋c撮c搓c措c挫c错c达d答d瘩d打d大d呆a歹d傣d戴d殆d代d贷d袋d待d逮d礍j礏y礐q礑d礒y礔p礕p礖y礗p礘e礚k礛j礜y礝r礟p礠c礡b礢y礣m礥x矿k礧l礨l礩z砺l砾l矾f礭q礮p礯y礰l砻l礲l礳m礵s礷j礸c礹y礽r礿y祂t祃m祄x祆x只z祊b祋d祌z祎y祏s佑y祑z祒t祔f秘b祙m祡c祣l祤y祦w祩z祪g祫x祬z祮g祰g祲j祳s祴g祵k祹t祻g祼g祽z祾l禄l禂d禃z禆b禇c禉y禋y禌z祸h禐y禑x禒x怠d耽d丹d郸d胆d旦d氮d但d淡d诞d蛋d党d刀d蹈d倒d祷d到d稻d悼d道d德d得d的d蹬d登d等d瞪d凳d邓d堤d低d滴d迪d笛d狄d翟d嫡d底d地d蒂d第d帝d弟d递d缔d颠d掂d滇d碘d点d典d靛d电d佃d甸d店d惦d奠d殿d碉d叼d凋d刁d掉d钓d调d跌d爹d碟d蝶d迭d谍d禓s禔z禕y禖m禗s禘d禙b禛z禜y禝j禞g禟t禠s禡m禢t禣f禤x禥q御y禨j禩s禅c禫d禬g禭s礼l禯n祢m禲l禴y禵t禶z禷l禸r禼x秃t秂r秄z秅c秇y籼x秊n秌q秏h秐y秓z秔j秖z秗y秙k秚b秛p秜n秝l秞y秠p秡b秥n秨z秪d秬j秮h秱t秲s秳h秴h秵y秶z秷z秹r秺d秼z秾n秿f稁g稄x税s稇k秆g稉j稊t稌s稏y稐l稑l稒g稓z稕z稖b稘j稙z稛k棱l丁d盯d叮d钉d顶d鼎d锭d定d订d冬d董d懂d侗d恫d洞d兜d抖d陡d豆d逗d痘d都d督d毒d读d堵d睹d赌d杜d镀d肚d度d渡d妒d端d短d锻d段d缎d堆d队d墩d蹲c敦d顿d囤d钝d盾d遁d掇d哆d多d垛d躲d朵d跺d舵d剁d惰d蛾e峨e鹅e俄e额e讹e娥e厄e扼e遏e鄂e饿e恩e而e耳e饵e洱e二e稝p禀b稡z稢y稤l稦y稧x稨b稩j稪f稫p稭j种c稯z稰x稲d稴x稵z稶y稺z稾g谷g穁r穂s穃r穄j穅k穇c穈m穊j穋l稣s颖y穏w穐q穒k穓y穔h穕q穖j穘x穚j穛z穜t穝z穞l穟s穑s秽h穣r穤n穥y穦p穧j穨t稳w穪c穬k穭l穮b穯s穱z穲l穳c穵w穻y穼s穽j穾y窂l窅y窇b窉b窊w窋z窌j窎d窏w窐w窓c窔y窙x窚c窛k窞d窡z窢h贰e罚f筏f伐f乏f阀f法f藩f帆f番f翻f樊f钒f繁f凡f反f返f范f贩f犯f饭f芳f方f肪f房f防f妨f访f纺f放f菲f非f啡f飞f肥f匪f诽f吠f肺f沸f费f芬f酚f吩f氛f分f纷f焚f汾f粉f份f忿f粪f丰f封f蜂f峰f锋f风f烽f逢f冯f缝f讽f奉f凤f否f敷f肤f孵f扶f拂b辐f幅f氟f符f伏f俘f服f窣s窤g窝w洼w窫y穷q窑y窰y窱t窲c窴t窵d窭j窷l窸x窹w窥k窻c窼c窾k竀c竁c竂l竃z窍q竆q窦d竈z竉l窃q竍s竎f竏q竐c竑h竒q竓h竔s竗m竘q竚z竛l竜l竝b竡b竢s竤h竧j竩y竫j竬q竮p竰l竱z竲c竳d竴c竵w竞j竷k竻l竼p竾c笀m笁z笂w笅j笇s笉q笌y笍z笎y笐h笒c笓b笖y笗d笘s笚d笜z笝n笟g笡q笢m笣b笧c笩f笭l浮f涪f福f袱f弗f甫f辅f俯f釜f斧f脯f腑f府f腐f赴f副f覆f赋f傅f付f阜f父f腹f负f富f讣f附f缚f咐f噶g嘎g该g改g概g钙g盖g溉g甘g柑g竿g肝g赶g感g敢g赣g钢g缸g肛g纲g港g篙g皋g高g膏g羔g糕g搞g镐g稿g哥g歌g戈g鸽g胳g疙g割g革g葛g格g蛤g阁g隔g铬g各g给g根g跟g耕g更g庚g羹g笯n笰f笲f笴g笵f笶s笷m笹t筇q笽m笿l筀g筁q筂c筃y筄y筈k筊j笋s筎r筓j筕h筗z筙l筜d筞c筟f筡t筣l筤l筥j筦g笕j筨h筩t筪x筫z筬c筭s筯z筰z筶g筸g筺k筼y筽o筿x箁p箂l箃z箅b箆b箉g箊y笺j箌z箎c筝z箑s箒z箓l箖l箘q箙f箚z箛g箞q箟j箠c箣c箤z箥p箮x箯b箰s箲x箳p箵x箶h箷s箹y箺c箻l箼w箽d箾s箿j节j篂x篃m埂g耿g梗g工g攻g功g恭g龚g供g躬g公g弓g巩g汞g拱g贡g共g钩g勾g苟g狗g垢g购g辜g菇g咕g箍g估g沽g孤g姑g鼓g古g蛊g骨g股g故g顾g固g刮g瓜g寡g褂g乖g怪g棺g关g官g冠g观g管g馆g罐g灌g贯g光g逛g瑰g规g圭g硅g闺g轨g鬼g诡g癸g桂g跪g贵g辊g棍g锅g郭g果g裹g过g哈h篅c篈f筑z篊h箧q篍q篎m篏q篐g篔y篕h篖t篗y篘c篛r篜z篞n篟q筱x篢l篣p笃d篧z篨c筛s篫z篬q篭l篯j篰b篲h筚b篴z篵c篶y篸c篹s篺p篽y篿t箦z簁s簂g簃y簄h簅c簆k簈p簉z簊j篓l簎c簐n蓑s簒c簓s簔s簕l簗z簘x簙b簚m簛s簜d簝l箪d簠f简j簢m篑k簤d簥j簨z簩l箫x簬l簭s簮z簯q簰p簱q簲p簳g簴j簵l簶l檐y簹d簺s簻z簼g签q帘l籂s骸h孩h海h氦h亥h害h骇h酣h憨h邯h韩h涵h寒h函h喊h罕h翰h撼h捍h旱h憾h悍h焊h汗h夯b杭h航h壕h嚎h豪h毫b郝h好h耗h号h浩h呵h喝h荷h菏h核h禾h和h何h合g盒h貉h阂h河h涸h赫h褐h鹤h贺h嘿h黑h痕h很h狠h恨h亨h衡h轰h哄h烘h虹h鸿h洪h宏h弘h红g喉h侯h猴h吼h厚h候h后h呼h乎h忽h瑚h葫h胡h蝴h狐h糊h湖h篮l籄k籅y籆y籇h籈z籉t籊t籎y籏q藤t籑z籒z籓f籔s籕z籖q籗z籘t籙l籚l籛j箨t籝y籞y籁l笼l籡s籢l籣l龠y仠g籦z籧j籨l笾b簖d籫z篱l籭s箩l籯y籰y籱z吁x籵f籶s籷z籸s籹n籺h籾n籿c粀z粁q粂z粃b粄b粅w粆s粇k粈r粊b粋c粌y粍z佂z粏t粐h佹g侀x粔j粖y粙z粚c粛s粠h侼b侽n粣c粦l粨b粩l粫e粬q粭h粯x粰f粴l粤y粶l粷j粸q粺b粻z弧h虎h唬h护h互h花h华h猾h滑h化h话h槐h淮h桓h还h缓h患h豢h宦h幻h荒h慌h黄h磺h蝗h簧h皇h凰h惶h煌h晃h幌h恍h谎h灰h辉h徽h恢h蛔h回h悔h慧h卉h惠h晦h贿h讳h诲h绘h荤h昏h婚h魂h混h豁h活h伙h火h或h惑h霍h货h圾j基j畸j稽j箕j粿g糀h倄y糃t糄b糆m糉z糋j糎l糏x糐f糑n糒b糓g糔x糘j糚z糁s糡j馍m糣s糤s糥n糦x粮l糩k糪b糫h糬s糭z糮x糱n粝l糳z籴d糵n粜t糷l糹s糺j糼g糽z纠j纪j紁c纣z紃x约y纡y纥g纨w纫r纹w紌q纳n紎z紏t纽n紑f紒j纾s纰p紖z纱s紘h纸z级j纭y紝r紞d紟j紣c紥z紦h紨f紩z紪q紬c紭h扎z细x绂f绁x绅s紴b紵z紶q偟h肌j饥j迹j激j讥j鸡j姬j绩j缉j吉j棘j辑j籍j集j及j急j疾j即j嫉j脊j己j蓟j技j偤y冀j季j伎j祭j悸j寄j寂j计j记j既j忌j际j妓j继j嘉j枷j佳j加j荚j颊j贾g甲j钾j假j稼j架j驾j嫁j尖j间j煎j兼j肩j艰j缄j茧j柬j硷j剪j荐j鉴j践j贱j见j键j箭j件j紷l紸z绍s绀g紻y绋f紽t紾z绐d绌c絁s终z弦x组z絅j絇q絈m絉s絊z絋k経j絍r绗h絏x傶q结j絑z絒c傸c絓g絔b绝j絖k絗h絘c絙h絚g绦t絜j絝k绞j絟q絠g络l绚x絣p絤x絥f絧t绒r絩t絪y絫l絬x絭j絯g絰d统t丝s絴x絵h絶j絸j绢j絺c絻w絼z絽l絿q綀s綂t绡x綄h綅q绠g綇x绨t綉x綊x綋h綌x綍f綎t绥s綐d捆k綒f经j綔h綕z綖y綗j綘f健j舰j饯j建j僵j姜j江j疆j蒋j讲j匠j酱j降j蕉j椒j礁j焦j胶j交j郊j骄j嚼j铰j脚j狡j角j饺j缴j教j酵j轿j较j叫j窖j揭j接j皆j秸j街j阶j截j劫j桔j捷j睫j竭j姐j戒j藉j芥g界j借j介j疥j诫j巾j筋j斤j金j兠d今j津j襟j紧j锦j谨j进j靳j禁j近j浸j継j続x综z綝c缍d綟l绿l綡j绻q綤s綧z綨j綩w綪q綫x绶s维w綯t绾w网w綳b缀z綶g綷c纶g绺l绮q绽z綼b绫l绵m緀q緁j緂t緃z绲g緅z緆x缁z緈x緉l绯f緌r緍m緎y総z緐f緑l绪x緓y緔s緕z緖x缃x缂k线x緜m緟c缗m緢m缘y緤x緥b缌s緧q緪g緫z缅m緭w緮f纬w緰x缑g缈m緳x练l緵z缏b緷g緸y缇t緺g荆j兢j茎j睛j晶j鲸j京j惊j精j粳j井j警j景j颈g静j境j敬j镜j靖j竟j炯j窘j揪j究j玖j韭j久j灸j九j酒j救j旧j臼j舅j咎j就j疚j鞠j拘j狙j疽j居j驹j菊j咀j矩j举j沮j聚j拒j巨j具j距j剏c踞j锯j俱j句g炬j捐j鹃j娟j倦j眷j撅j攫j抉j掘j倔j爵j觉j诀j均j菌j钧j军j君j峻j致z緼w緽c緾c緿d縀x縁y縂z縃x縄s縅o縆g縇s萦y缙j缢y缒z縌n縍b縎g縏p绉z缣j縒c縓q縔s縕y縖x縗c縘x縙r縜y缜z缟g缛r縠h縡z縢t县x縤s縥z縦z縧t縨h縩c縪b縬c缡l缩s演y縰x纵z缧l纤q缦m絷z缕l縸m缥p縺l縼x总z縿s繀s繂l繄y缫s缪m襁q繉s繊x繋j繌z繍x繎r繐s缯z繓z织z缮s繖s繗l繘j繙f缭l繛c繜z勩y俊j竣j浚j郡j骏j喀k咖g卡k咯g开k揩k楷j慨k刊k堪k勘k坎k砍k看k康k慷k糠k扛g抗k亢g炕k拷k烤k靠k坷k苛k柯k棵k磕k颗k科k咳h可k渴k刻k客k课k肯k啃k坑k吭h空k恐k孔k控k口k扣k寇k枯k哭k窟k苦k酷k裤k夸k垮k挎k跨k胯k筷k快k款k筐k狂k框k眶k亏k盔k葵k奎k魁k傀g绕r繟c繠r绣x缋h繣h繤z繥x繦q繧w繨d绳s繬s繮j缳h缲q繱c繲x繴b繵d繶y繷n繸s绎y繺s繻x缤b缱q繿l纀p纁x纃z纅y纆m纇l缬x纉z纩k续x累l纎x纐k纑l纒c缨y厠c纗z缵z纙l缆l纝l纞l纮h纴r纻z纼z绖d绤x绬y绹t缊w缐x缞c缷x缹f缻f缼q缾p罀z罁g罃y罆g罇z罉c罊q罋w罂y罍l罎t罏l罒w罓w馈k愧k坤k昆k括g廓k阔k垃l拉l喇l蜡l腊l辣l啦l莱l赖l蓝l婪l阑l兰l谰l览l榔l狼l廊l郎l朗l浪l牢l老l佬l姥l酪l烙l勒l雷l镭l蕾l磊l儡l肋l类l楞l冷l厘l梨l黎l狸l离l理l李l鲤l莉l荔l吏l丽l利l傈l例l俐l罙s罛g罜z罝j罞m罠m罣g罤t罥j罦f罧s罫g罬z罭y罯a罳s骂m罶l罸f罺c呩s罻w罼b罽j罿c羀l羂j羃m羄z罴p羇j羁j羉l羍d羏y羐l羑y羓b羕y羖g羗q羙m羠y羢r羟q羡x义y羬x羱y羴s羺n羾h翀c翃h翆c翇f翈x翉b翋l翍p翏l翐z翑q习x翓x翖x翗k翙h翚h翛x翜s翝h翞j翢d翣s哷l痢l立l粒l隶l力l璃l哩l联l莲l连l镰l廉l脸l链i啅z粱l良l辆l量l晾l亮l谅l撩l聊l僚l燎l寥l辽l潦l撂l镣l廖l料l列l烈l劣l琳l林l霖l临l邻l鳞l淋l赁l啙z啛c吝l拎l玲l菱l零l龄l铃l伶l羚l凌l灵l陵l领l另l令l溜l琉l榴l硫l馏l留l瘤l流l柳l六l龙l聋l窿l翤c翧x翨c翪z翫w翬h翯h翲p翴l翵h翶a翷l翸p翘q翽h翾x翿d耂l耇g耈g耉g耊d耎n耏n耓t耚p嗘j耝q耞j耟j耡c耣l耤j耫z耧l耭j耮l耯h耰y耲h耴y耹q耺y耼d耾h聀z聄z聅c聇z聈y聉w聏e聐y聑t聓x聕h圣s聗l聙j聛b聜d聝g闻w聟x聠p聡c聢x聣n聤t聥j聦c聧k聨l聫l聬w聭k聮l声s耸s聴t聩k聂n职z聸d聍n聺q聻n嘓g聼t听t拢l陇l漏l陋l芦l颅l虏l鲁l麓l碌l露l路l赂l鹿l潞l录l陆l驴l铝l旅l履l氯l律l率l卵l掠l略l轮l噵d论l萝l螺l逻l锣l骡l裸g落l洛l嚍j骆l嚒m蚂m马m嘛m埋m买m麦m卖m迈m脉m馒m蛮m蔓m曼m慢m漫m肁z肂s肃s肈z肊y肍q肎k肏c肐g肑d囄l肔c肕r肗r肙y肞c肣q肦b肧p肨p肬y肰r肳w肵q肶p肹x肻k胅d胇b胈b胉b胊q坺f垀h胏z胐f胒n胓p胔z胕f胘x胟m胠q胢q胣c胦y胮p胵c胷x胹e埱c埶y胾z胿g脀z脁t脃c脄m胁x脇x脋x脌n脕w脗w脙x胫j脜r脝h脟l脠s脡t脢m脤s脥j塈x睃s脨c修x脪x脱t脭c脮n脰d脳n脴p脵g脷l胀z脼l脽s脿b谩m芒m墽q茫m盲m氓m壔d忙m莽m猫m茅m锚m毛m矛m铆m卯m茂m冒m帽m貌m贸m么m玫m枚m梅m酶m霉m煤m眉m媒m镁m每m美m昧m寐m妹m媚m门m萌m檬m盟m锰m猛m孟m醚m靡m糜m迷m谜m米m觅m泌b蜜m密m棉m眠m冕m免m勉m娩m面m苗m妌j描m瞄m藐m秒m妛c妭b渺m妙m蔑m民m抿m皿m敏m姃z闽m明m螟m鸣m铭m名m命m谬m摸m腀l腁p腂g腃j腄c腅d腇n腉n腍r肾s腏z腒j腖d腗p腘g腛w腜m腝r腞z娊x脶l腢o腣d腤a脑n腨s腪y肿z腬r腯t腲w腵j婂m腶d腷b膁q腽w膄s膅t膆s膇z膉y膋l膌j膍p膎x膐l膒o膓c膔l膕g膖p膗c膙j膞z膟l膡y膢l膤x膥c膧t腻n膫l膬c膭k膮x媑z膯t膰f膱z膲j膴h媝q媡l膵c膶r膷x膸s膼z脍k脓n臄j臅c臇j臈l臋t脐q臎c膑b臐x臑n嫿h嬃x嬓j臓z摹m蘑m模m嬜x膜m磨m摩m嬟y魔m抹m末m莫m墨m默m沫m漠m寞m陌m谋m牟m某m拇m牡m姆m母m墓m暮m幕m募m慕m木m目m孨z睦m牧m穆m拿n哪n孶z钠n那n娜n氖n乃n奶n耐n奈n南n男n难n囊n闹n淖n呢n馁n嫩n能n妮n霓n倪n泥n尼n匿n逆n溺n蔫n拈n年n碾n酿n鸟d尿n捏n孽n镊n镍n涅n您n凝n臔x臕b臖x臗k臙y胪l臛h臜z臝l臞q脏z脔l臡n臢z卧w臦g臩g臫j臮j臯g臰c岅b臲n臵g臶j臷d臸z臹x岟y臽x臿c舃x与y兴x岪f岾z峊f舎s舏j舑t峣y舓s舕t铺p舗p峮q舘g舙h舚t舝x舠d舤f舥p舦t舧f舩c舮l舲l舼q峾y舽p艀f艁z艂f艃l艅y艆l艊b艌n艍j艎h艐k艑b艒m艓d艔d嵽d嶈q艖c艗y艛l艜d艝s艞y艠d艡d艢q舣y艥j艧h艩q牛m扭n钮n嶪y农n弄l奴n努n怒n女n暖n虐n挪n懦n糯n诺n哦e巆y鸥o藕o偶o巏q啪p趴p爬p帕p怕p琶p拍p排p牌p徘p湃p派p攀p潘f磐p盼p畔p判p叛p乓p庞p耪p胖p咆p刨b袍p跑p泡p呸p胚p培p裴p赔p陪p配p沛b盆p砰p抨p烹p澎p彭p蓬p棚p硼p篷p膨p朋p鹏p捧p碰p坯p砒p霹p批p披p劈p琵p毗p艪l舻l艬c艭s艵p艶y艳y艹a艻l艼d幯j庅m庺s芃p芅y芆c芇m廐j芉g芌y苄b芓z芔h芕s弐e芚t芛w芞q芠w芢r芣f芧x芲l弞s芵j芶g芺a刍c芼m芿r苀h苂c苃y苅y苆s苉p苐d苖d苙l苝b苢y苎z苨n苩p苪b苬x苭y苮x苰h徛j苲z徦j苳d苵d苶n苸h苺m苼s苽g苾b苿w徴z茀f徸z茊z茋z茐c茒y茓x茖g茘l忇l茙r茝c茞c怓n茠h茡z茢l茣w茤j茥g茦c茩h茪g茮j怱c茷f茻m茽z啤p脾p疲p皮p匹p恎d痞p僻p屁p譬p篇p偏p片p骗p恜c飘p瓢p票p撇p瞥p拼p频p贫p品p聘p乒p坪p苹p萍p平p瓶p评p屏b坡p颇p婆p破p魄b迫p粕p剖p莆p葡p菩p蒲p埔b圃b普p浦p谱p曝b瀑b期j欺q妻q七q漆q柒q沏q其j棋q奇j歧q畦q崎q愂b齐j祈q祁q起q岂q乞q企q契q器q迄q汽q泣q愪y讫q掐q茾q茿z荁h荂f荄g荅d愲g荈c荋e荌a荍q荎c荓p荕j荖l荗s荘z荙d荝c荢z慃y荰d荱w荲l荳d荴f荵r荶y荹b荺y荾s荿c莀c莁w莂b莃x莄g莇z莈m庄z莋z莌t莏s莐c莑p莔m莕x憉p莗c莙j莚y莝c莟h莡c莣w莤s莥n莦s憜d苋x莬w莭j莮n憡c莯m莵t莻n莾m莿c菂d菃q菄d菆c菈l菉l菋w菍n菎k菐p菑z菒g菓g菕l菗c憿j菙c菚z菛m菞l菢b菣q菤j菦q菧d菨j菫j懏j菬q菭t恰q洽q钎q铅q千q懡m迁q仟q谦q乾q黔q钱q钳q前q遣q谴q嵌k欠q歉q腔q羌q蔷q橇q锹q敲q悄q瞧q巧q鞘q撬q峭q俏q切q茄j且j怯q戵q侵q亲q秦q琴q勤q芹q擒q禽q沁q青q轻q卿q清q擎q晴q氰q情q顷q请q秋q丘q邱q求q囚q抯z酋q泅q趋q蛆q曲q躯q屈q驱q渠q菮g菳q庵a菵w拲g菶b菷z菺j挌g菼t菾t菿d萀h萅c苌c萈h萉f萐s萒y萓y萔t萕q萖w萗c萙k萚t萛j萞b萟y萠p萡b萢p萣d萩q萪k萫x万m萭y萮y萯f萰l萲x萳n萴c掤b莴w萶c萷s萹b萺m萻a萾y葀k葁j葂m葃z葄z葅z葇r葈x叶x葊a葋q葌j葍f葎l葏j葐p荭h葓h搮l摀w葕x葖t葘z葝q葞m葟h葠s葢g葤z摖q葥q苇w葧b葨w葪j葮d药y葰j葲q葴z摾j葹s葻l葼z取q娶q龋q趣q去q圈j颧q醛q泉q全q痊q拳q犬q券q撧j缺q炔g瘸q鹊q榷q裙q群q然r燃r冉r染r瓤r壤r攘r嚷r让r饶r惹r壬r擟m仁r人r忍r韧r任r认r刃r妊r扔r仍r日r戎r茸r擿t攂l蓉r融r熔r溶r攚w容r冗r揉r柔r肉r茹r蠕r儒r孺r如r辱r乳r汝r攺y入r褥r软r阮r蕊r瑞r锐r闰r若r弱r撒s萨s腮s鳃s塞s赛s三s叁s葽y葾y葿m蒀y蒁s蒃z蒄g蒅s蒆x蒍w蒏y蒐s蒑y蒒s蒓c莳s蒕y蒖z蒘r蒚l蒛q蒝y莅l蒟j蒠x蒢c蒣x蒤t蒥l蒦h蒧d蒨q蒩z蒪p蒫c蒬y蒭c蒮y蒰p蒱p蒳n斮z蒵x斳q蒷y蒻r蒾m荪s蓂m蓃s蓅l蓆x蓇g蓈l蓌c蓎t蓏l蓒x蓔y蓕g蓗z蓘g蓙g蓚t蓛c蓜p蓞d蓡s旤h蓢l蓤l蓧d蓨t蓩m蓪t蓫z蓭a苁c蓱p蓲q蓳j蓴c蓵j蓶w蓷t蓸c蓹y蓺y蓻z荜b蓾l蔀b蔁z蔂l散s桑s嗓s搔s骚s嫂s瑟s色s森s僧s莎s砂s沙s傻s啥s晇x煞s珊s苫s杉s山s煽s衫s闪s陕s擅s赡s膳s善s汕s晬z扇s商s赏s晌s上s尚s裳c梢s捎s稍s芍s勺s韶s少s哨s邵s奢s赊s蛇s舌s赦s射s涉s社s设s砷s申s呻s伸s身s深s娠s神s沈s暎y暔n甚s慎s生s甥s牲s蔃q暭h蔄m蔅y蔇j蔈b蔉g蔊h蔋d蔍l蔎s蔏s蔐d蔒h蔕d蔖c蔘s蔙x蔛h蔜a曌z曗y曻s蒌l蔠z蔢p蔤m茑n蔧h蔩y蔪j荫y蔮g蔯c蔰h蔱s蔲k蔳q枈p蔵z蔶z蔾l蔿w蕀j荨q蕂s蕄m蕅o蒇c蕇d蕋r蕌l蕍y荞q蕏z蕐h蕑j芸y蕔b莸y蕗l柛s荛r蕚e蕛t蕜f蕝j蕟f蕠r柨b蒉k蕣s蕥y蕦x蕧f柸b芜w蕫d蕬s萧x栭e蕯s蕰y蕱s蕳j蕵s蕶l蓣y蕸x桗d蕼s蕽n蕿x薀y薁y桜y省s盛c剩s失s施s诗s尸s虱s十s石d拾s什s梍z食s蚀s识s史s矢s使s屎s驶s始s式s示s士s世s梫q柿s事s拭s誓s逝s嗜s噬s适s棃l仕s侍s释s棇c饰s氏s市f恃s室s视s试s收s手s首s守s授s售s受s椃h瘦s蔬s梳s殊s抒s输s叔s舒s淑s椘c疏s赎s孰s熟s薯s暑s曙s署s蜀s黍s鼠s述s束s戍s竖s墅s庶s漱s薂x薃h楕t楖j楡y荟h薉h薋c芗x薍w薎m薐l薒c薓s薕l薖k榐z薗y薘d薙t薚t薝z薞s槀g薠f薡d薢x薣g薥s槁g薫x薬y薭b薱d槗q薲p薳y薴n薵c薶m薸p荠j薻z薼c薽z薾e薿n藀y藂c藃x藄q藅f藆j藇x藈k藊b藋d藌m荩j槸y藑q藒q藔l藖x藗s樐l藘l藙y藚x藛x艺y藞l藟l藠j藡d藢z藣b藦m藧h藨b薮s藫t藬t藭q藮q藯w藰l樼z樿s藲o藳g藴y藵b苈l藸z橩q恕s刷s耍s摔s衰c甩s栓s拴s霜s双s爽s谁s水s睡s吮s瞬s顺s舜s说s朔s斯s撕s嘶s思s私s司s死s肆s寺s嗣s四s似s饲s巳s松s颂s送s宋s讼s诵s搜s艘s嗽s酥s俗s素s檪l速s粟s僳s塑s溯s宿s诉s蒜s算s檾q櫈d櫐l虽s隋s随s髓s碎s穗s遂s隧s祟s櫢s梭s櫴l唆s索s锁s所s櫿y塌t他t她t欃c塔d蔺l欟g欦q藽q藾l歞e蘁w蘂r歬q殏q蕲q蘈t蘉m蕴y蘌y蘍x蘎j蘏j蘐x殭j毥x蘔j蘕p蘖n蘘r蘙y藓x蘛y蘜j蘝l蔹l蘟y蘠q蘡y茏l蘣t蘤h蘥y蘦l蘨y蘪m蘫l蘬g蘮j蘯d蘰k蘱l蘲l蘳h蘴f蘵z蘶w蘷k汦z汻h沕m蓠l蘻j蘽l蘾h虀j虁k泈z泘h虃j泿y虄s虅t洜l虇q虈x虉y虊l虋m虌b虒s虓x虖h虗x虘c虙f虚x虝h虠j浰l虡j虣b浲f虤y虥z虦z涖l涶t虩x虪s蹋t踏t胎t淃j抬t泰t酞t太t汰t坍t贪t檀t痰t潭t谭t谈t坦t毯t袒t碳t探t炭t渜n塘t搪t堂t棠t膛t唐t糖t倘c躺t淌t趟t掏t滔t萄t桃t逃t淘t陶t讨t套t特t腾t疼t誊t梯t湕j剔t踢t锑t提d题t蹄t啼t体t替t嚏t惕t涕t剃t湲y天t添t填t田t甜t恬t舔t腆t挑t眺t跳t贴t铁f帖t虭d虯q虰d虳j虴z虵s溳y滖s滜z滵m虸z蚃x蚄f漐z蚆b蚇c蚈q蚉w蚎y蚏y蚐j蚑q蚒t漹y潎p蚖y潣m蚗j蚘h蚙q蚚q蚛z蚞m蚟w蚡f蚢h蚥f蚦r蚫b澚a蚮d蚲p蚳c蚷j蚸l蚹f蚻z蚼g蚽p蚾p蛁d蛂b蛃b蛈t蛌t蛍y蛒g蛓c蛕h蛖m蛗f蛚l蛜y蛝x蛠l濵b蛡y蛢p蛣j濸c蛥s蛦y蛧w蛨m蛪q蛫g蛬q瀀y瀇w瀐j蛵x蛶j蛷q蛱j蜕t蛼c蛽b蛿h蜁x蜄s蜅f蚬x蜋l蜌b蜎y蜏y蜐j蜑d蜔d蜖h汀t廷t停t亭t庭t挺t艇t通t桐t酮t瞳t同t铜t彤t童t桶t灜y捅t筒t痛t偷t投t头t灩y透t凸t突t徒t途t屠t土t吐t兔t湍t推t颓t腿t褪t退t吞t屯t臀t拖t托t炏y鸵t陀t驮d炓l炗g驼t妥t拓t唾t挖w哇w蛙w娃w瓦w袜w炲t歪w外w豌w玩w顽w烷w完w碗w挽w晚w皖w惋w宛w烞p婉w腕w汪w王w烮l亡w枉w往w旺w望w忘w妄w威w蜙z蜛j蜝q蜟y蜠j蜤s蜦l蜧l蜨d蜪t蜫k蜬h蜭h蜯b蜰f蜲w蜳d蜵y蜶s蜸q蜹r蜺n蜼w蜽l蝀d蝁e蝂b蝃d蝄w蝅c焭q蝆y焲y蝋l蝍j蝏t焷p蝐m蝑x蝒m蝔j蝘y蝚r蝛w蝜f蝝y蝞m蝟w蝡r蝢x虾h蝧y蝨s蝩c蝪t蝫z蝬z蝭d蝯y蝱m蝲l蝳d蝵q蝷l蜗w蝹y蝺q蝿y螀j螁b蛳s螆c螇x螉w螊l螌b螎r螏j螑x螒h螔y螕b螖h螘y螙d螛h螜h螝g螠y螡w萤y螣t螤z巍w微w危w韦w违w桅w唯w惟w萎w委w尾w未w蔚w味w畏w胃w喂w魏w位w渭w谓w尉w慰w卫w瘟w蚊w文w燰w吻w紊w嗡w翁w爁l我w斡w握w沃w巫w钨w诬w屋w爗y爙r梧w吾w武w爠q五w捂w午w爥z舞w伍w侮w戊w雾w晤w物w勿w悟w误w昔x熙x析x西x硒x矽x晰x嘻x吸x牔b锡x螥c螦s螧q螩d螪s螮d螰l螱w螲d螴c螶q螷p螸y螹c蝼l螼q螾y螿j蟁w蟂x蟃w蛰z蟅z蝈g蟉l蟌c蟍l蟎m蟏x蟐c蟔m蟕z蟖s蟗q蟘t蟙z蟚p蟜j蟝q蟞b蟟l蟡g蟢x虮j蟤z蟦f蟧l蟨j蟩j蟫y狔n狚d蛲n猍l蟰x猏j蟱w蟳x蟴s蟵c蛏c蟷d蟸l蟺s蚁y蟼j蟽d蟿q蠀c蠁x蠂s蠄q蝇y虿c蠇l蠈z蠉x蠋z猽m蠌z蠍x蠎m蠏x蛴q蝾r蠒j蚝h獉z蠗z蠘j蠙b蠚h蠜f蠝l蠞j蠠m蛎l稀x息x希x悉x膝x夕x惜x熄x烯x溪x汐x犀x檄x袭x席x媳x喜x铣x洗x獹l隙x瞎x匣x霞x辖x暇x下x夏x掀x锨x先x仙x鲜x咸x贤x舷x闲x涎x嫌x显x险x腺x馅x陷x限x相x香x箱x襄x湘x乡x翔x祥x详x想x响x享x项x巷h橡x像x象x硝x霄x削x哮x销x消x宵x淆x蠤q蠥n蠦l蠧d蠨x蠩z蠪l蠫l蠬l蠭f蠮y蠯p蠰n蠳y蠴s蠵x瑊j瑘y蠸q瑦w瑸b璊m蠽j蠾z蠿z璠f衃p衆z衉k衋x衎k衏y衐q衑l衒x衕t衘x衦g衧y衪y甇y衱j衳z衴d衵r衶z衸j衺x衻r衼z袀j袃c袆h袇r畄l袉t袊l袌p袎y袏z袐b袑s袓j袔h袕x袗z袘y袙p畞m袚f畧l袝f袟z袠z袡r袣y袥t袦n袧g袨x袩z袪q小x孝x校j肖x疜x笑x效x楔x些x歇x疪b蝎x鞋x邪x斜x谐x械x卸x蟹x懈x痟x谢x屑x薪x痭b芯x锌x欣x辛x新x忻x心x信x衅x星x腥x猩x惺x刑x型x形x邢x行h醒x杏x性x姓x兄x胸x瘹d匈x雄x癁f熊x休x羞x朽x嗅x癊y锈x秀x袖x墟x戌q需x须x徐x许x蓄x酗x癦m旭x序x畜c絮n婿x轩x喧x宣x旋x玄x袬y袮m袯b袲c袳c袵r袶p袸j袹b袺j袻e袽r袿g裀y裃k裄h裇x裈k裋s裌j裍k裐j裑s裓g裖z裗l裚j裛y装z裞s裠q裦b裧c裩k裪t裫y裬l裭c裮c裯c裲l裵p裶f裷y裺y裻d制z裿y褀q褁g褃k褄q褅t褆t褈c褉x褋d褌k褍d褎x褏x褑y褔f褕y褖t褗y褘h褜p褝d褞y褟t褠g褢h褣r褤y褦n褧j褨s褩b褬s褭n褮y褯j褱h裢l褵l褷s选x眩x靴x薛x穴x雪x血x熏x循x旬x询x驯x巡x殉x汛x训x讯x逊x迅x押y鸦y鸭y丫y芽y牙y蚜y崖y衙y涯y雅y盶y讶y焉y阉y淹y盐y研y蜒y延y言y颜y阎y炎y沿y奄y掩y眼y衍y堰y燕y雁y唁y宴y谚y验y殃y央y鸯y秧y佯y羊y洋y氧y仰y养y漾y邀y腰y妖y褛l褹y褺d亵x褼x褽w褾b褿c襀j襃b襅q襆f襇j襈z襉j襊c襋j襌d襍z襎f襏b襑x襒b襓r襔m襕l襗z襘g襙c襚s襛n襜c裣l裆d襡s襢z襣b褴l襥f襧z襨t襩s襫s襭x襮b襰l襱l襳x襴l襵z襶d襷t襸z襹s襺j襼y襽l襾y覀y覂f覄f覅f覇b覉j瞈w覊j瞏q覌g覍b覎y瞔z覐j覑p覒m覔m覕p覗s觇c覙z覚j覛m覜t覝l覞y覟z覠j觋x遥y谣y姚y咬y舀y要y矊m耀y椰y噎y耶y野y冶y也y页y掖y腋y夜y液y一y壹y医y揖y铱y依y伊y衣y颐y夷y遗w移y胰y疑y沂y宜y姨y彝y椅y倚y已y乙y矣y以y抑y易y邑y屹g役y臆y逸y肄y疫y亦y裔y意y毅y益y溢y诣y议y谊y译y翼y翌y茵y因y音y阴y姻y吟y银y淫y寅y饮y尹y引y隐y覢s覣w覤x覥t觎y覧l矲b覨e覩d觊j覭m覮y觏g覰q覱z觐j観g覴d覵j覶l觑q覸j硡h硢y覻q覼l覾s觌d觃y觍t觕c觗z觘c觙j觛d觝d觟h觠q觡g觢s觤g觧j觨h觩q觪x觬n觭j觮j觰z觱b觲x觞s觵g觯z觷x觹x觺y觻l觼j觽x觾y觿x訁y訄q訅q訆j訉f訋d讧h訍c訏x讦j訑y訒r訔y讪s訙x訚y印y英y鹰y迎y赢y盈y影y硬y映y臃y庸y雍y踊y蛹y咏y碐l泳y永y恿y勇y用y幽y悠y尤y由y邮y铀y油y游y酉y碻q有y碽g友y磂l右y釉y诱y又y幼y迂y淤y于y盂y榆y虞y愚y舆y余y俞y逾y鱼y愉y渝y磭c隅y予y磰s雨y禹y宇y语y羽y玉y域y礃z芋y郁y遇y喻y峪y愈y育y誉y訞y訠s訡y讷n訦c訧y訨z訩x訫x訬c訮y訯s訰z訲y訳y訵c诃h訷s訸h訹x诊z注z证z訽g訿z詀z诂g詂f詃j詄d詅l诋d詇y詊p詋z詌g詍y讵j詏y诈z詑t诒y詓q诏z詖b礶g祍r祘s诎q詙b詚d诅z詜t詝z詟z诩x祱s詤h詥h祶d詧c詨x詪h诟g禈h诠q詯h诘j祯z詴w诜s詶c詷t詸m詻l诙h詽y詾x诖g誀e浴y寓y裕y预y豫y驭y鸳y冤y元y垣y袁y原y援y辕y猿y源y远y苑y愿y怨y院y曰y越y跃y钥y月y阅y耘y云y郧y陨y允y运y酝y韵y孕y匝z砸z杂z栽z哉z宰z载z再z在z赞z赃z葬z遭z糟z凿z藻z早z澡z蚤z躁z噪z造z皂z灶z燥z责z贼z怎z增z憎z曾c赠z喳c秢l渣z札z轧g誁b誂t誃y诔l诛z诓k誈w誋j志z誏l誐e诳k诶a誔t誖b誗c誙k诮q誛q誜s誝a誟x誢x诰g誧b誩j誫z説s読d誮h誯c誱j誳q誴c誵x谇s誷w誸x誺c誻t誾y諀p諁z谄c諃c谆z諅j諆j諈z诿w諊j諌d诤z諎z诹z諐q诼z諓j諔c諕x谂s諘b諙h諚b谀y諝x稬n谝p諟s諠x諡s诨h諣h稸x穉z铡z闸z眨z榨z咋z穙p乍z炸z摘z斋z穠n宅z窄z寨z瞻z詹z粘n沾z辗z展z蘸z站z湛z樟z章z彰z漳z掌z杖z丈z账z仗z瘴z障z招z昭z找z沼z赵z照z罩z兆z肇z召s遮z折s哲z辙z者z锗z蔗z这z浙z珍z斟z真z甄z砧z臻z贞z针z枕z疹z震z振z镇z阵z蒸z征z怔z整z拯z正z政z谔e諥z谛d諨f諩p諪t谏j諬q谕y谘z諯z諰x諲y谙a諴x諵n谌c诸z諹y諻h谖x窧z窽k谒y竌c竨d竪s诌z謆s謈b謉k謋h謌g謍y謏x竸j谧m謑x謒q謓c谑x謕t谡s謘c谥s謜y謞h謡y謢l謣y謤b謥c謧l谟m謩m謪s谪z謭j謮z謯j謰l謱l讴o謴g謵x謶z謷a謸a謺z謻y謼h謽j謿c譀h譂c譃x譄z譅s郑z芝z枝z支z吱z蜘z知z肢z脂z汁z之z直z植z殖s值z址z指z止z趾z旨z至z置z峙s智z秩z稚z质z炙z痔z治z窒z中z盅z筳t筴c忠z钟z衷z重c仲z舟z箈t周z州z洲z粥y轴z肘z帚z咒z宙z骤z珠z株z蛛z猪z逐z竹z煮z拄z主z著z柱z助z蛀z贮z铸z譆x譇z譈d譊n譋l譌e谲j譐z譑j譒b譓h譔z譕w谮z譗z谯q譛j譝s譞x譠t譡d譢s譣x譤j譥j譧z譨n譩y谵z譭h譮h譱s譲r譳r篒y譶t譸z譹h譺a譻y譼j譾j譿h讁z讂j讃z讄l讅s讆w讇c讉y讋z篻p讌y讍e雠c讏w讐c讑y讔y谶c讗x讘n讙h讛y谠d讝z谳y讟d讬t讱r讻x诇x诐b诪z谉s谞x住z祝z驻z抓z爪z拽z转z撰z赚z篆z撞z椎c锥z追z赘z捉z拙z卓z桌z琢z茁z酌z啄z着z灼z咨z资z姿z滋z淄z孜z紫z仔z籽z滓z自z字z鬃z棕z踪z宗z邹z走z奏z揍z租z足z卒c族z祖z阻z钻z纂z嘴z醉z最z罪z尊z遵z昨z左z佐z柞z做z作z坐z座z谸q谹h谺x谻j谼h谽h谾h谿x豀x豂l豃h豄d豅l豋d豍b豏x豑z豒z豓y籋n豖c豗h豘t豙y豛y豜j豝b豞h豟e豠c豣j豤k豥g豦j豧f豨x豩b豭j豮f豯x豰h豱w豲h豴d豵z豷y豻a豼p豽n豾p豿g貀n貁y貃m貄s貆h貇k貈h貋a貎n貏b貐y貑j貒t貕x貖y貗j貙c貚t貛h貜j粎m粓g貟y粡t貣d貤y貦w貭z亍c丌q兀w丐g廿n卅s丕p丞c鬲g孬n噩e丨g禺o丿p匕b乇z夭a爻y卮z氐d囟x胤y馗k毓y鼗t丶z亟j鼐n乜m亓q孛b嘏g厝c厥j靥y赝y匚f叵p糂s匾b赜z卦g卣y刂d刈y刎w刳k剌l糛t剞j剡s剜w蒯k剽p劂j劁q劐h劓y冂j罔w亻r仃d仉z仨s糿g仫m仞r仳p伢y佤w仵w伉k紤j佞n佧k攸y佚y佝g貮e贳s貱b赀z貵p貹s贶k絾c綛k綥q緛r繏x繑q繝j纄p纋y纕x纚l缿x翄c翭h翺a耛s聎t肒h肸x胋t胑z胻h脦t脺c脻j腟c臒w臤q臱m舋x舿k艕b芀t芁q芖z苚y茟y茰y莍q菻l萂h萿k葔h蔝m蔨j蔴m蕮x薆a莶x藱h藼x蘀t蘃r蘒q蘓s蘹h虂l虆l虨b虶y虷h蚅e蚔q蚭n蚿x蛯e蝖x螐w螚n蟭j蠷q蠺c衂n衭f袛d袾z襂s襐x覫p覹w觓q訤x詉n詗x詺m誎c誽n諽g諿x謃x謟t謲c譍y譪a譵d貥h乩j仡g斛h颢h銮l乊h乥h夫f兓j兙s兛q兝g兞h兣g兺b囻g坟f妢f婲h孒j尅k屗u岎f帉f幥z幩f弅f徚u怭b怾g慙c昐f晲n曢u朆f朌f朑u朩p枌f梤f乐l橨f檂n欂b毜c毮s洂y涜d颍y澵z炃f炍p炾h烪u焑y焺s燌f燓f燞u燢x獖f瓧s瓰f瓱m瓲t瓼l榛z彳c夔k璞p丟d並b丬p乂y乄s亙g亞y亠t亳b仝t伋j伕f伲n伽g佇z佈b佔z佗t佘s佟t佪h佴e併b佶j佻t佼j佾y侃k來l侉k侏z侑y侔m侖l侶l侷j俅q俎z俑y俚l俜p俟q俠x俳p俸f俾b倆l倉c個g倌g倏s們m倖x倜t倣f倥k倨j倩q倫l倬z倭w倮l偃y偈j偉w偌r偎w偕x側c偵z偺z偽w傖c傘s備b傢j傭y傳c傴y債z傷s傺c傾q僂l僅j僇l僉q僑q僕p僖x僥j僦j僬j僭j僮t僱g價j儀y儂n億y儅d儆j儇x儉j儋d儐b儔c儕c儘j優y儲c儷l儸l儺n儻t儼y兌d兒e兕s兗y內n兩l兮x冊c冑z冖m冢z冥m冪m冫b冱h冼x冽l凇s凈j凍d凫f凱k凵k凼d刖y別b刪s剄j則z剋k剎c剛g剝b剮g剴k創c剷c劃h劇j劉l劊g劌g劍j劑j劬q劭s劻k劾h勁j勐m動d勗x務w勛x勝s勞l勢s勣j勦j勰x勱m勵l勹b勻y匍p匏p匐f匭g匯h匱k區q協x卟b卩j卹x卻q厙s厭y厲l厴y厶s參c叟s叢c叨d叩k叱c叻l吆y吋c吒z吖y吡b吣q吲y吳w吶n呂l呃e呋f呎c呔d呤l呦y呱g呲c呶n呷g咂z咄d咔k咚d咝s咣g咤c咦y咧l咩m咪m咫z咭j咻x咼w咿y哂s哌p哏g哐k哚d哞m員y哧c哳z哽g哿g唄b唅h唏x唑z唔m唣z唧j唪f唰s唳l唷y唸n唼s唿h啁z啉l問w啐c啕t啖d啞y啟q啣x啵b啶d啷l啻c啾j喁y喃n喈j喋z喏n喑y喔o喙h喚h喟k喪s喫c喬q單d喱l喵m嗄a嗆q嗇s嗉s嗌y嗍s嗎m嗑k嗒d嗔c嗖s嗚w嗝g嗟j嗤c嗥h嗦s嗨h嗪q嗬h嗲d嗵t嗶b嗷a嗾s嘀d嘁q嘈c嘌p嘍l嘔o嘖z嘜m嘞l嘟d嘣b嘧m嘩h嘬c嘭p嘮l嘯x嘰j嘵x嘸f嘹l噁e噌c噍j噓x噔d噗p噘j噙q噠d噢o噤j噥n噦y噫a噯a噱j噲k噴p噸d噹d噻s噼p嚀n嚅r嚆h嚇h嚌j嚐c嚓c嚙n嚥y嚦l嚨l嚮x嚯h嚳k嚴y囀z囁n囂x囅c囈y囉l囌s囑z囔n囗w囝j囡n囪c囫h囹l囿y圄y圇l圉y圊q國g圍w園y圓y圖t圜h圩w圪g圮p圯y圳z圻q坂b坌b坨t坩g坫d坭n坰j坳a坶m坻c坼c垅l垌d垓g垠y垡f垤d垴n埏s埒l埕c埝n埡y埤p埭d埯a埴z執z埸y埽s堀k堅j堇j堊e堋b堍t堙y堞d堠h報b場c堿j塄l塊k塋y塍c塒s塗t塢w塤x塥g塬y塵c塹q塾s墀c墁m墉y墊d墑d墚l墜z墮d墻q壅y壇t壑h壓y壙k壚l壞h壟l壢l壩b壯z壺h壽s夂z夙s夠g夢m夤y夥h夼k夾j奐h奕y奘z奚x奧a奪d妁s妃f妍y妗j妝z妞n妣b妤y妯z妲d妳n妾q姊z姍s姒s姘p姝s姣j姦j姪z姹c娉p娌l娑s娓w娛y娣d娼c婀e婊b婕j婢b婦f婧j婭y婷t婺w媛y媧w媯g媲p媸c媼a媽m媾g嫖p嫗y嫘l嫜z嫠l嫣y嫦c嫫m嫵w嫻x嬈r嬉x嬌j嬖b嬗s嬙q嬝n嬡a嬤m嬰y嬲n嬴y嬸s孀s孃n孑j孓j孚f孢b孥n孫s孱c孳z學x孿l宀m宄g宓m宕d宥y宮g宸c寢q寤w實s寧n審s寫x寬k寮l寰h寵c寶b將j專z尋x對d尕g尜g尢w尥l尬g尷g尻k屄b屆j屐j屙e屜t屣x層c屬s屮c屺q岈y岌j岍q岐q岑c岙a岜b岡g岢k岣g岧t岫x岬j岱d岵h岷m峁m峋x峒d峴x島d峽x崆k崍l崗g崙l崛j崞g崠d崢z崤x崦y崧s崮g崴w崽z崾y嵇j嵊s嵋m嵒y嵩s嵫z嵬w嵯c嵴j嶁l嶂z嶄z嶇q嶗l嶙l嶷n嶸r嶺l嶼y嶽y巋k巑c巔d巖y巛c巰q巹j巽x帑t帔p帙z帥s帳z帶d帷w幃w幄w幔m幘z幛z幞f幟z幡f幣b幪m幫b幬c幹g幺y幾j庀p庂z庋g庖p庠x庥x庫k庳b庹t庾y廁c廂x廄j廈s廑q廒a廚c廛c廝s廡w廢f廣g廨x廩l廬l廱y廳t廴y廾g弁b弈y弋y弒s弔d弩n弭m弳j張z強q弼b彀g彆b彈d彊q彌m彎w彐x彖t彗h彘z彙h彡s彥y彫d彷f彿f徂c徇x徉y後h徑j徙x徜c從c徠l徨h復f徫w徬p徭y徵z徹c徼j忉d忐t忑t忒t忖c忝t忡c忤w忪s忭b忮z忸n怊c怍z怏y怙h怛d怡y怦p怩n怫f怵c恁n恂x恆h恙y恚h恝j恣z恥c恧n恪k悃k悅y悌t悒y悖b悚s悛q悝k悱f悴c悵c悶m悻x悽q惆c惘w惙c惝t惡e惱n惲y惴z惻c愀q愆q愍m愎b愕e愛a愜q愣l愨q愫s愴c愾k慄l慇y慊q態t慍y慘c慚c慝t慟t慣g慫s慮l慵y慶q慼q慾y憂y憊b憐l憑p憔q憚d憝d憧c憩q憫m憬j憲x憶y憷c懇k應y懋m懌y懍l懔l懞m懟d懣m懨y懲c懵m懶l懷h懺c懼j懾s懿y戀l戇g戉y戔j戕q戛j戟j戡k戢j戤g戥d戧q戩j戰z戲x戶h戽h戾l扃j扈h扌s扐c扠c扢g扺z抃b抆w抎y抴y抻c拊f拋p拗a拮j拶z挈q挲s挶j挹y挾x捃j捋l捨s捩l捫m捭b捱a捺n掃s掄l掊p掎j掙z掛g採c掬j掭t掮q掰b掾y揀j揄y揆k揎x揚y換h揞a揠y揲d揶y揸z揹b搆g搋c搌z損s搖y搗d搛j搟x搠s搡s搦n搴q搶q搿g摁e摑g摒b摜g摞l摟l摭z摯z摳k摶t摺z摻c撈l撓n撙z撚n撟j撣d撥b撫f撲p撻t撾z撿j擁y擄l擇z擊j擐h擔d擗p擘b據j擠j擢z擣d擤x擬n擯b擰n擱g擲z擴k擷x擺b擻s擼l擾r攄s攆n攉h攏l攔l攖y攙c攛c攜x攝s攢z攣l攤t攥z攬l攮n攴p攷k敉m敕c敗b敘x敫j敵d斂l斃b斐f斕l斫z斬z斷d於w旂q旃z旄m旆p旌j旎n旒l旖y旮g旯l旰g昀y昃z昇s昊h昕x昝z昱y昴m昶c晁c時s晉j晏y晗h晝z晞x晟c晡b晷g暄x暈y暉h暌k暘y暝m暨j暫z暱n暸l暹x暾t曄y曆l曇t曉x曖a曛x曜y曠k曩n曬s曷h書s會h朊r朐q朕z朦m朧l朮s杇w杈c杌w杓b杞q杪m東d杲g杳y杵c杷b杼z枇p枋f枘r枙e枰p枳z枵x枸g柁d柃l柘z柚y柝t柢d柩j柰n柵s栝g栩x栲k栳l桀j桁h桄g桉a桊j桎z桕j桫s桴f桷j桿g梃t梏g梓z梔z條t梟x梩q梵f棄q棖c棗z棟d棣d棧z棰c棲q棹z棼f椋l椏y椐j椴d椹s楂c楊y楓f楗j楝l楠n楣m楦x楨z楫j業y楮c楱c極j楸q楹y榀p榍x榕r榘j榙t榧f榪m榫s榭x榮r榱c榻t榿q槃p槊s槌c槍q槎c槓g槧q槨g槭q槲h槳j槿j樁z樂l樅c樑l樓l樗c樘t標b樞s樨x樵q樸p樹s樺h樽z樾y橄g橈r橋q橐t橘j橛j機j橢t橫h檁l檉c檎q檔d檗b檜g檠q檢j檫c檯t檳b檸n檻j櫓l櫚l櫛z櫝d櫟l櫥c櫧z櫨l櫪l櫬c櫳l櫸j櫺l櫻y欄l權q欏l欒l欖l欞l欷x欹q歃s歆x歎t歐o歙s歟y歡h歲s歷l歿m殂c殄t殍p殘c殞y殤s殪y殫d殮l殯b殲j殳s殺s殼k毀h毂g毆o毌g毪m毬q毳c毹s毽j毿s氅c氆p氈z氌l氍q氕p氘d氙x氚c氡d氣q氤y氪k氫q氬y氳y氵s氽c氾f汆c汊c汍w汎f汔q汜s汨m汩g汴b汶w決j沅y沆h沌d沐m沒m沓d沔m沖c沭s沱t沲t泐l泓h泔g泖m泗s泠l泫x泮p泯m泱y洄h洇y洌l洎j洙z洚j洧w洩x洫x洮t洳r洵x洶x洹h浜b浞z浠x浣h浬h浯w浹j浼m涇j涑s涓j涔c涫g涮s涼l涿z淅x淇q淒q淙c淚l淝f淞s淠p淥l淦g淨j淪l淵y淶l淼m渙h渚z減j渥w渦w渫x測c渲x渾h湄m湊c湎m湓p湔j湞z湟h湧y湫j湮y湯t溆x溏t準z溘k溝g溟m溥p溧l溫w溱q溲s溴x溷h溻t溼s溽r滂p滄c滅m滎x滏f滕t滟y滬h滯z滲s滷l滸h滹h滾g滿m漉l漕c漚o漢h漣l漤l漩x漪y漬z漭m漯l漲z漶h漸j漿j潁y潑p潔j潛q潟x潢h潤r潯x潰k潲s潴z潷b潸s潺c潼t澀s澆j澇l澉g澌s澍s澗j澠m澤d澧l澩x澮k澱d澶c澹d濂l濃n濉s濕s濘n濛m濞b濟j濠h濡r濤t濫l濮p濯z濰w濱b濺j濼l瀅y瀆d瀉x瀋s瀏l瀕b瀘l瀚h瀛y瀝l瀟x瀠y瀣x瀧l瀨l瀰m瀲l瀵f瀹y灃f灄s灑s灕l灘t灝h灞b灣w灤l灬h災z炅g炫x炱t為w炻s烀h烊y烏w焐w焓h無w焯c焱y煅d煉l煊x煒w煙y煜y煢q煦x煨w煩f煬y煲b煳h煸b煺t熒y熗q熘l熠y熨y熱r熳m熵s熹x熾c燁y燄y燉d燐l燒s燔f燙t營y燠y燦c燧s燬h燭z燮x燴h燹x燼j燾d爐l爛l爝j爨c爭z爰y爺y爾e爿p牆q牒d牖y牘d牝p牠t牦m牪y牮j牯g牴d牽q牿g犄j犍j犏p犒k犛l犟j犧x犭q犰q犴a犸m狀z狁y狃n狍p狎x狒f狨r狩s狳y狴b狷j狹x狺y狻s狽b猁l猊n猓g猗y猙z猝c猞s猢h猥w猬w猱n猶y猷y猸m猹c猻s獄y獅s獍j獐z獒a獗j獠l獨d獪k獫x獬x獯x獰n獲h獵l獷g獸s獺t獻x獼m獾h玀l玆z玎d玟m玢b玨j玳d玷d珀p珂k珈j珉m珙g珞l珥e珧y珩h珮p現x琊y琚j琛c琥h琦q琨k琪q琬w琮c琰y琺f琿h瑁m瑕x瑗y瑙n瑛y瑜y瑣s瑤y瑩y瑪m瑭t瑯l瑾j璀c璇x璉l璋z璐l璜h璣j璦a璧b璨c璩q璺w璽x瓊q瓏l瓖x瓚z瓞d瓠h瓴l瓿b甍m甏b甑z甓p甙d產c甦s甬y町d甾z畀b畈f畋t畎q畚b畛z畝m畫h畬s異y畹w畼c畿j疃t疊d疋y疒n疔d疝s疣y疬l疰z疳g疴k疸d疿f痂j痃x痄z痍y痖y痙j痣z痤c痦w痧s痲m痳m痼g痿w瘀y瘃z瘊h瘌l瘍y瘐y瘓h瘕j瘙s瘛c瘞y瘠j瘡c瘢b瘥c瘭b瘰l瘳c瘺l瘼m癀h療l癃l癆l癇x癍b癔y癖p癜d癟b癡c癢y癥z癩l癬x癭y癮y癯q癰y癱t癲d發f皈b皎j皓h皙x皚a皤f皰p皴c皸j皺z皻z盍h盜d盞z盡j監j盤p盥g盧l盪d盱x盹d眄m眇m眈d眍k眚s眢y眣d眥z眭s眵c眸m睇d睏k睚y睜z睞l睢s睥b睨n睪y睽k睿r瞀m瞌k瞍s瞑m瞞m瞟p瞠c瞢m瞭l瞰k瞵l瞼j瞽g瞿j矇m矍j矓l矚z矜j矧s矬c矯j矸g砉h砑y砘d砜f砝f砟z砣t砥d砩f砬l砭b砲p砹a砼t硃z硇n硌g硎x硐d硤x硨c硪w硭m硯y碇d碓d碚b碣j碥b碩s碲d碹x碼m磉s磔z磙g磚z磣c磧q磬q磯j磲q磴d礅d礎c礓j礙a礞m礤c礦k礪l礫l礱l礴b礻s祀s祅y祇q祉z祐y祓f祕m祗q祚z祛q祜h祠c祧t祺q祿l禊x禍h禎z禚z禦y禧x禮l禰m禱d禳r禿t秈x秕b秣m秫s秭z稂l稃f稅s稆l稈g稔r稜l稞k稟b種z稱c稷j稹z穀g穌s積j穢h穩w穫h穰r穸x穹q窀z窆b窈y窕t窠k窨x窩w窪w窬y窮q窯y窳y窶j窺k竄c竅q竊q竦s競j竺d竽y笄j笈j笊z笏h笙s笞c笠l笤t笥s笪d笫z笮z笱g笳j笸p笻q筆b筌q筍s筘k筠j筢p筮s筲s筵y筻g箄b箇g箋j箏z箐q箜k箝q箬r箴z箸z節j篁h範f築z篋q篌h篚f篝g篠x篤d篥l篦b篩s篪c篳b篼d篾m簀z簋g簌s簍l簏l簑s簟d簡j簣k簦d簪z簫x簷y簸b簽q簾l籀z籃l籌c籐t籜t籟l籠l籤q籥y籩b籪d籬l籮l籲y粑b粞x粢z粧z粲c粵y粼l粽z糅r糇h糈x糌z糍c糗q糝s糢m糧l糨j糰t糲l糴d糶t糸m糾j紀j紂z約y紅h紇h紈w紉r紋w納n紐n紓s紕p紗s紙z級j紜y紡f紮z細x紱f紲x紳s紹s紺g紼f紿d絀c終z絃x組z絆b絎h結j絛t絞j絡l絢x給g絨r統t絲s絳j絹j綁b綃x綆g綈t綏s綑k經j綜z綞d綠l綢c綣q綦q綬s維w綮q綰w綱g網w綴z綵c綸l綹l綺q綻z綾l綿m緇z緊j緋f緒x緗x緘j緙k線x緝j緞d締d緡m緣y緦s編b緩h緬m緯w緱g緲m練l緶b緹t緻z縈y縉j縊y縐z縑j縚t縛f縝z縞g縟r縣x縫f縭l縮s縯y縱z縳z縴q縵m縶z縷l縹p縻m總z績j繅s繆m繇y繈q繒z織z繕s繚l繞r繡x繢h繩s繪h繫x繭j繯h繰q繳j繹y繼j繾q纈x纊k續x纍l纏c纓y纔c纖x纘z纛d纜l纟s绔k绛j绱s缰j缶f缽b罄q罅x罈t罌y罘f罟g罡g罨y罰f罱l罵m罹l罾z羅l羆p羈j羋m羝d羧s義y羯j羰t羲x羸l羼c羿y翊y翎l習x翕x翡f翥z翦j翩p翮h翳y翹q耄m耆q耋d耑d耒l耔z耖c耜s耠h耢l耥t耦o耨n耩j耬l耱m耵d耷d聃d聆l聒g聞w聯l聰c聱a聲s聳s聵k聶n職z聹n聽t聾l聿y肅s肓h肜c肟w肫z肭n肱g肴y肷q肼j肽t胂s胍g胗z胛j胝z胥x胨d胩k胬n胭y胱g胲h胴d胼p脅x脈m脎s脒m脘w脛j脞c脣c脧j脩x脫t脬p脲n脹z腈j腌a腎s腓f腙z腚d腠c腡l腦n腧s腩n腫z腭e腱j腴y腸c腼m膂l膃w膈g膚f膠j膦l膪c膺y膻s膽d膾k膿n臁l臉l臊s臌g臍q臏b臚l臟z臠l臧z臨l臬n臾y舁y舂c舄x與y興x舉j舊j舐s舖p舛c舡c舢s舨b舫f舭b舯z舳z舴z舸g舺x舾x艄s艉w艋m艏s艚c艟c艣l艦j艨m艫l艮g艱j艴f艷y艸c艽j艿n芄w芊q芎x芏d芑q芘b芙f芟s芡q芤k芨j芩q芪q芫y芮r芰j芴w芷z芻c芾f苊e苒r苓l苕s苘q苜m苠m苡y苣j苤p苧n苴j苷g苻f茆m茇b茈c茉m茌c茍j茗m茚y茛g茜q茭j茯f茱z茲z茳j茴h茺c茼t荀x荃q荇x荊j荏r荑t荬m荸b荻d荼a荽s莊z莒j莓m莘s莛t莞g莠y莢j莧x莨l莩f莪e莰k莺y莼c菀w菁j菅j菔f菖c菘s菝b菟t菡h菥x華h菰g菸y菹z菽s萁q萃c萆b萊l萋q萏d萑h萘n萜t萬w萱x萵w萸y萼e葆b葉y葑f葙x葚r葜q葦w葩p葭j葯y葳w葶t葷h葸x葺q蒈k蒎p蒔s蒗l蒞l蒡b蒴s蒺j蒼c蒽e蒿h蓁z蓊w蓋g蓍s蓐r蓓b蓥y蓦m蓯c蓰x蓼l蓽b蔌s蔔b蔟c蔣j蔥c蔦n蔭y蔸d蔻k蕁q蕃f蕈x蕎q蕓y蕕y蕖q蕙h蕞z蕢k蕤r蕨j蕩d蕪w蕭x蕷y蕹w蕺j蕻h薅h薇w薈h薊j薌x薏y薑j薔q薜b薟x薤x薦j薧h薨h薩s薰x薷r薹t薺j藁g藍l藎j藜l藝y藥y藪s藶l藷s藹a藺l藿h蘄q蘅h蘆l蘇s蘊y蘋p蘗b蘚x蘢l蘧q蘩f蘭l蘺l蘼m蘿l虍h虔q處c虛x虜l號h虢g虧k虬q虺h虻m蚋r蚍p蚓y蚣g蚧j蚨f蚩c蚪d蚯q蚰y蚱z蚴y蚵k蚶h蚺r蛄g蛅z蛉l蛐q蛑m蛘y蛞k蛟j蛩q蛭z蛸s蛺j蛻t蜃s蜆x蜇z蜈w蜉f蜊l蜍c蜓t蜚f蜞q蜢m蜣q蜥x蜩t蜮y蜱p蜷q蜻q蜾g蜿w蝌k蝓y蝕s蝙b蝠f蝣y蝤q蝥m蝦x蝮f蝰k蝸w蝻n蝽c螂l螃p螅x螋s螓q螗t螞m螢y螨m螫s螬c螭c螯a螳t螵p螻l螽z蟀s蟄z蟆m蟈g蟊m蟋x蟑z蟒m蟓x蟠p蟥h蟪h蟬c蟮s蟯n蟲c蟶c蟻y蟾c蠃l蠅y蠆c蠊l蠐q蠑r蠓m蠔h蠖h蠛m蠟l蠡l蠣l蠱g蠲j蠹d蠼q衄n術s衛w衝c衢q衤y衩c衲n衹z衽r衾q衿j袂m袈j袞g袢p袤m袷q裊n裎c裏l裒p裘q補b裝z裟s裡l裥j裨b裰d裱b裼t製z裾j複f褊b褓b褙b褚c褡d褫c褰q褲k褳l褶z褻x襝l襞b襠d襤l襦r襪w襬b襯c襻p覃q見j規g覓m視s覘c覡x覦y親q覬j覯g覲j覷q覺j覽l覿d觖j觚g觜z觥g觫s觳h觴s觶z觸c訂d訃f訇h訊x訌h討t訐j訓x訕s訖q託t記j訛e訝y訢x訣j訪f設s許x訴s診z註z証z訾z詁g詆d詈l詎j詐z詒y詔z評p詘q詛z詞c詠y詡x詢x詣y詩s詫c詭g詮q話h該g詵s詼h誅z誆k誇k誌z認r誑k誕d誘y誚q語y誠c誡j誣w誤w誥g誨h誰s課k誶s誼y調d諂c諄z談t諉w請q諍z諏z諑z諒l論l諗s諛y諜d諞p諢h諤e諧x諫j諮z諱h諳a諶c諷f諸z諺y諾n謀m謁y謂w謅z謇j謊h謎m謐m謔x謗b謙q謚s講j謝x謠y謦q謨m謫z謬m謳o謹j譁h證z譎j譖z識s譙q譚t譜p譟z譫z譯y議y譴q護h譽y讀d讎c讒c讓r讕l讖c讚z谫j豇j豈q豉c豎s豐f豔y豕s豚t豬z豳b豸z貂d貅x貊m貍l貓m貔p貘m貝b負f財c貢g貧p貨h販f貪t貫g責z貯z貰s貲z貳e貴g貶b貸d貺k貼t貾c貿m賁b賂l賃l賄h賅g賆p資z賈j賉x賊z賋j賌g賎j賏y賐j賑z賒s賓b賔b賕q賖s賗c賘z賙z賛z賜c賝c賞s賟t賠p賡g賢x賣m賤j賥s賧d賨c賩c質z賬z賭d賮j賯x賰c賳z賴l賵f賶c賷j賸s賹y賺z賻f購g賽s賾z賿l贀y贂c贃w贄z贅z贆b贇y贈z贉d贊z贋y贌p贍s贎w贏y贐j贑g贒x贓z贔b贕d贗y贘s贙x贚l贛g贜z贠y贲b贻y贽z赅g赆j赇q赈z赉l赍j赑b赒z赓g赕d赗f赙f赟y赥x赧n赨t赩x赪c赬c赭z赮x赯t赱z赲l赳j赸s赹q赺y赻x赼z赽j赿c趂c趃d趄j趆d趇x趈z趉j趌j趍q趎c趏g趐x趑z趔l趖s趗c趘x趚s趜j趝j趞q趠c趡c趤d趥q趧t趨q趩c趪h趫q趭j趮z趯t趰e趱z趲z趵b趷k趹j趺f趻c趼j趽f趿t跁b跂q跄q跅t跆t跇y跈j跉l跍k跎t跏j跐c跒q跓z跔j跕d跖z跗f跘p跙j跚s跛b跜n跞l跠y跡j跢d跣x跤j跦z跧q跩z跫q跬k跭x跰p跱z跲j跴c跶d跷q跸b跹x跻j跼j跽j跾s跿t踀c踁j踂n踃x踄b踅x踆c踈s踉l踍q踎m踑j踒w踓w踔c踕j踗n踘j踙n踚l踛l踝h踟c踡j踣b踥q踦q踧c踫p踬z踭z踮d踯z踰y踱d踲d踳c踴y踵z踶d踷z踸c踹c踺j踻g踽j踾f踿c蹀d蹁p蹂r蹃n蹇j蹉c蹊q蹍n蹐j蹑n蹒p蹓l蹔z蹕b蹖c蹗l蹘l蹙c蹚t蹛d蹜s蹝x蹞k蹟j蹠z蹡q蹢d蹣p蹤z蹥l蹧z蹨n蹩b蹪t蹫j蹮x蹯f蹰c蹱z蹳b蹴c蹵c蹶g蹷j蹸l蹹t蹺q蹻q蹼p蹽l蹾d躀g躂d躃b躄b躅z躆j躈q躉d躊c躋j躍y躎n躏l躐l躑z躒l躓z躔c躕c躖d躗w躘l躙l躚x躛w躜z躝l躞x躟r躠s躡n躢t躣q躥c躦z躧x躨k躩j躭d躮s躰t躱d躵h躶l躷a躸j躹j躻w躽y躾x躿k軀q軁l軃d軄z軆t軇d軉y車c軋y軌g軎w軏y軐x軑d軒x軓f軔r軕s軖k軗s軘t軙c軚d軜n軝q軟r軠k軡q転z軣h軤h軥q軦k軧d軨l軩d軪a軫z軬f軮y軰b軱g軲g軴z軵r軶e軷b軹z軺y軻k軼y軽q軾s軿p輀e輁g輂j較j輄g輅l輆k輈z載z輋s輌l輍y輎s輏y輐w輓w輔f輕q輖z輗n輘l輙z輚z輛l輝h輞w輟c輡k輢y輣p輤q輥g輦n輨g輩b輫p輬l輭r輮r輰y輱x輲c輴c輵g輶y輷h輸s輹f輺z輻f輽f輾z輿y轀w轁t轂g轃z轄x轅y轆l轇j轈c轉z轊w轍z轎j轏z轐b轑l轔l轖s轗k轘h俁y係x轛d轝y轞j轟h轠l轡p轢l倀c轤l轥l轪d轫r轭e轱g轲k轳l轵z轶y轷h轸z轹l轺y轼s轾z辁q辂l辄z辇n辋w辌l辍c辏c辒w辔p辘l傑j辚l辝c辠z辡b辢l辥x辦b辪x辬b辮b辯b農n辳n辵c辶c辷y辸r辻s込y辿c迃y迆y迉q迊b迋w迌t迍z迏d儈k迕w迖d迗e迚d迤y迥j迨d迩e迬z迮z迯t迱y迲k迳j迴h迵d迺n迻y凜l迾l逄p逅h逇d逈j逋b逍x逎q逑q逓d逕j逖t這z逜w逡q連l逥h逦l逧g逨l逪c逬b逭h逯l週z進j逳y逴c逵k逶w逷t逹d逺y勸q遀s遄c遅c遈s遊y運y遌e過g遐x遑h遒q遖n遘g遙y遛l遜x遝t遞d遟c遠y遡s遢t遤h遦g遨a遪c遫c遯d遲c咴h遴l遶r遷q選x遹y遺y遻e遼l遽j遾s邁m邂x邃s還h邅z邆t邇e邈m邉b邊b邋l邌l邏l邒t邔q邕y邖s邘y邙m邛q邜x邝k邟k邠b邡f邥s邧y邬w邭j邰t邲b邳p邴b邶b邷w邸d邺y邼k邾z邿s喹k郀k郂g郃h郄q郅z郆j郇x郈h郉x郍n嗩s郏j郐k郒l郓y郔y郕c郖d郗x郘l郙f嘆t郚w郛f郜g郟j郠g嘗c郢y郤x郥b郦l郪q郫p郮z郯t郱p郳n郵y郶b郷x郹j郻q郾y郿m鄀r鄁b鄃s鄄j鄆y鄇h鄈k鄉x嚕l鄊x鄌t鄎x鄏r鄐c鄑z鄓y嚶y鄔w鄕x鄗h鄚m鄛c鄜f鄝l鄞y鄟z鄠h鄡q鄢y鄣z鄥q鄦x鄨b鄫z鄬w鄭z鄮m鄯s鄰l鄱p鄲d鄴y鄵c鄶k鄷f鄸m團t鄺k鄻l鄼z鄽c鄾y酀y酁c酂z酃l酄h酆f酇z酈l酊d酎z酏y酐g酑y酓y酔z酕m酖d酘d酙z酛k酜f酟t酠q酡t酢c酤g酦f垸y酧c酩m酫c酭y酯z酰x酲c酴t酹l酺p酻z堝g酾s醀w醁l醂l醃y醄t醅p醊z醌k醍t醎x醏d醐h醑x醕c醖y醗p醘k醙s醜c醝c醞y醟y醠a醡z醢h醣t醤j醥p醧y醨l醩z醪l醫y醬j醭b醮j醯x醰t醱p醲n醳y醴l醵j醶y醷y醸n醹r醺x醻c醼y醽l醾m醿m墼j釁x釃s釄m釅y壎x釆b壘l釐l釓g釖d奩l釘d釚q釛h針z釞z釟b釡f釣d釦k釧c釨z釩f釬h釭g釮q釰r釱d釲s釳x釴y釵c釶s釷t釸x釹n釺q釻q釼r釽p釾y鈀b鈁f鈂c鈅y鈆q嬋c鈉n鈊x鈋e鈌j鈍d嬪p孌l鈐q鈒s鈓r鈔c鈕n鈗y鈘y鈛g鈜h鈞j導d鈡z鈢x鈣g鈤r鈥h鈦t鈧k屝f鈫q鈬d鈭z鈮n鈯t鈰s鈲g鈳k鈴l屨j鈶s鈷g鈸b鈹p鈺y鈻s鈼z鈽b鉁z鉂s鉃s鉄t鉆z鉈t鉉x鉊z鉋b鉌h鉍b鉎s鉏c鉐s鉑b鉓c鉕p鉖t鉘f鉙z鉚m鉛q鉜f鉝l鉟p鉠y鉣j鉤g鉦z崳y鉨x鉩x鉪d鉫j鉭t鉮s嵐l鉯y鉰s鉱k鉶x鉷h鉸j鉹c鉺e鉻g鉼b嶝d鉿h嶧y銀y銂z巒l銄x銆m銇l銈j銉y銊x銋r銌z師s銎q銏s銒x銓q銔p銖z銙k銚d銛x銜x銝x銞j銟c銢p銥y銦y銧g銩d銪y銭q銯k銲h銳r銴s廟m銵k廠c銶q銷x銸z銺z銻t鋀t鋁l鋂m鋄w鋅x鋆y鋇b鋈w鋉s鋋c鋌t鋎h鋑j鋕z鋖s鋗x鋘h鋙w鋚t鋛k忄x鋞x鋟q鋠s鋡h鋢l鋣y鋤c鋥z鋦j鋧x鋨e鋩m鋪p鋬p鋭r鋮c鋯g鋰l鋳z鋴z鋵t惚h鋷z鋸j鋹c鋺y愷k鋼g鋽d鋿s錀l慪o錁k錂l錃p慳q憒k錅l憮w錇p錉m錊z錋p錌a錍p錎x錏y懸x錑l錒a錓k錕k錗n錘c錙z錚z錜n錞c錟t錠d錡q錢q錣z錤j錥y錦j錧g錨m錩c錪t捲j錬l錭d錮g錯c錱z録l錳m錴l錵h錷g錸l錹k錺k錻b揮h錼n錽w錾z錿h鍀d鍁x鍄l鍆m鍇k鍈y鍉c鍊l鍋g鍌x鍍d鍏w鍐z鍑f鍒r鍓j鍔e鍕j鍖c鍗t撐c鍘z鍙h鍚y撖h鍛d撘d撢d撳q擋d鍞k鍟s鍠h鍡w鍢f鍣z鍤c鍥q鍦s鍧h鍨k鍩n鍪m鍫q鍬q鍭h鍯c鍱y鍲m鍳j鍵j鍶s鍷k鍸h鍹x攪j鍺z鍻j鍼z鍽b鍾z鍿z鎀x鎁y鎂m鎃p鎄a鎅j鎆q鎇m鎈c鎉d鎊b攵p鎋x鎌l鎍s數s鎏l鎐y鎑y鎒n鎓w鎔r鎕t鎖s鎘g鎙s鎛b鎜p鎝d鎞b鎟s鎠g鎡z鎤h暢c鎦l鎧k鎨s鎩s鎪s鎫w鎬g鎭z鎮z鎯l鎰y鎱y鎲t鎳n鎴x鎵j鎶g鎷m鎸j鎹k鎺h鎻s鎼x鎽f鎾w鎿n鏀l鏁s鏂o鏃z鏄t鏅x鏆g鏇x鏈l鏉s鏊a鏋m鏌m鏍l鏎b鏏w鏐l鏑d鏒s鏔y鏕l鏖a鏗k鏘q鏙c鏚q鏛s鏝m鏞y鏟c鏠f鏡j鏢b鏣s鏤l鏥x枧j枴g柙x鏧l鏨z鏩j鏪c鏫l鏬x鏭x鏮k鏯s鏰b鏱z鏲q鏳z鏴l鏵h鏶j鏸h鏹q鏺p鏻l鏼s鏽x鏾s鏿c鐀g鐁s鐂l鐃n鐄h鐅p鐆s鐇f鐈q鐉q鐊x鐋t鐌x鐎j鐏z鐐l鐑q鐒l鐓d鐔x鐕z鐖j鐗j鐘z鐙d鐚y鐛y鐜d鐝j鐞n鐟z鐠p鐡t鐣c鐤d鐥s鐦k鐧j鐨f鐩s鐪l鐫j鐬h鐭y鐮l鐯z鐰q鐱j鐲z鐴b鐵t榦g鐷y鐸d鐹g鐻j鐽d鐾b鐿y鑀a構g鑁z鑂x槔g鑄z鑅h鑆z鑇j鑈n鑉h鑊h鑋q鑌b樣y鑎g鑏n鑐x鑑j鑒j鑓y鑔c鑕z鑖m鑗l鑘l檑l鑜s鑝p檣q鑞l鑟d鑠s鑡c鑢l鑣b鑤b鑥l鑦x鑧k鑨l鑩e櫃g鑪l鑫x鑬j櫞y鑮b鑯j鑰y鑱c鑲x鑳j鑴x鑵g鑷n鑸l鑹c鑺q鑻p鑼l鑽z鑾l鑿z钀n钁j欽q钃z钄l钅j钆g钇y钊z钋p钌l钍t钏c钐s钑s钔m钕n钖y钗c钚b钛t钜j钣b钤q钪k钫f钬h钭t钯b钰y钲z钴g钶k钷p钸b钹b钼m钽t铄s铈s铉x铊s铋b铌n铍p铎d铏x铐k铑l铒e铓m铔y铕y铖c铗j铘y铙n铚z铛c铞d铟y铠k铢z汙w铤d铥d铦x铧h铨q铩s铪h铫d铮z铯s铳c铴t铵a铷r铹l铻w铼l铽t铿k锂l锃z锆g锇e锉c锊l锍l锎k锏j況k锒l锓q锔j锕a锖q锘n锛b锜q锝d锞k锟k锠c锢g锧z锩j锪h锫p锬t锱z锲q锴k锵q锶s锷e锸c锺z锼s锽h锾h锿a镂l镃z镄f镅m镆m镈b镉g镋t镌j镎n镏l镒y镓j镔b镕r镖b镗t镘m镙l镚b镛y镝d镞z镟x镠l镡t镢j镤p淺q镥l镦d镧l镨p镩c镫d镬h镯z镱y镲c镳b镴l镵c長c镸c镹j溈w镻d镼j镽l門m閂s閃s閄h滌d閆y閇b閈h閉b閊c開k閌k閍b閎h閏r閐s閑x閒x漁y閔m閕x閖l閗d閘z閙n閚z閛p閜x閝l閞b閠r閡h関g閣g閤g閦c閧h閨g閩m閪s閫k閬l閭l閮t閰j閱y閲y潿w閳c閴q閶c閷s閸k閹y閺w閻y閼e閽h閾y閿w闀h闁b濁z闄y闅w闆b闈w闉y闊k闋q闌l闍d闎q闏p闐t濾l闓k瀾l闕q闖c闗g闘d闙q闚k闛t關g闝p闞k闟x闠h闡c闤h闥t闦w闩s闫y闬h闱w闳h闵m闶k闼t闾l闿k阃k阄j阆l阇d阈y阊c阋x阌w阍h阏e阒q阓h阕q阖h阗t阘t阙j阚k阛h阝f阞l阠x烴t阡q阢w阣y阤t阥y阦y阧d阨a阩s阪b阫p阬k阭y阯z阰p阱j阷c阸e阹q阺d阼z阽d阾l陁t陂b陃b陉x陊d煥h陎s陏d陑e陒g陓y陔g陖j陗q陘x陙c陚w陜x陝s陞s陟z陠p陣z陦d陧n陫f燈d燜m陭q陮d爍s陰y陱j陲c陳c陴p陸l陹s険x陻y陼z陽y陾r陿x隀c隁y隂y隃y隄d隇w隈w隉n隊d隌a牾w隍h階j隑g隒y隓h犋j隕y隖w隗k隚t際j犖l隝d隞a犢d隟x隠y隡s隢r隣l隤t隥d隦p隨s隩a險x隬n隭e隮j隯d隰x隱y隲z隴l隵x隷l隸l隹z隺h隻z隼s隽j隿y雂q雃j雈h雉z雊g雋j雎j雐h雑z雒l雓y雔c雖s雗h雘h雙s雚g雛c雜z雝y雞j雟g雡l離l難n雤y雥z雦c雧j雩y雫n雬f獎j雭s雮m雯w雰f雱p雲y雳l雴c雵y雸a獮x電d雼d雽h雿d霁j霂m霃c霅z霆t霈p霊l霋q霌z霎s霏f霐h霑z霒y霔s霕t霗l霘d霙y霚w霛l霝l霟h霠y霡m霢m霤l霥m霦b霧w霨w霩k霪y霫x霬y霭a霮d霯t霰s霱y霳l霴d霵j霶p霷y霺w霼x瑋w霽j霾m霿m靀m靁l靂l靃h靄a靅f靆d靇l靈l靉a靊f靋l靌b靍h靎h靏h靐b璁c靑q靓j靔t靕z靗c靘q靚j靜j靝t靟f靣m靤p靦m靧h靨y靪d靫c靬j靭r靮d靯d靰w靱r靲q靵n靷y環h靸s靹n靺m靻z靼d靽b靾x靿y鞀t鞁b瓔y鞂j鞃h鞄p鞅y鞆b鞇y鞈g鞉t鞊j鞌a鞎h鞏g鞐k鞑d鞒q鞓t甌o鞔m鞕b鞖s鞗t鞙x鞚k甕w鞛b鞜t鞝s鞞b鞟k鞡l鞢x鞣r鞤b鞥e鞦q鞧q鞨h鞩q鞪m鞫j鞬j鞮d鞯j鞰w鞱t鞲g鞳t鞴b鞵x畢b鞶p鞷g鞸b鞹k鞺t鞻l鞼g當d鞽q鞾x鞿j韀j疇c韂c韃d韅x韆q韇d韈w韉j韊l痠s韋w韌r韍f韎m韏q韐g韑w韒q韓h韔c韕k痺b韖r韗y韘s韙w韚g韛b韜t韝g瘋f韞y韟g韠b韡w韢s韣d韤w韥d韨f韪w韫y韬t韮j韯x韰x韱x韲j韴z韷l韸p韹h韺y韻y韼p韽a韾y響x頀h頁y頂d頃q項x癉d頇h須x頉y癘l頊x頋e頌s頍k頎q頏h癤j預y頑w頒b頓d頔d頕d頖p頗p領l頙c頚j頛l頜h頝q頞e頟e頠w頡j頢k頣s頤y頥y頦k頧d頨y頩p頪l頫f頬j頭t頮h頯k頰j頱l頲t頳c頴y頵j頶h頷h頸j頹t頺t頻b頼l頽t頾z頿z顀c顁d顂l顃t顄h顅q顆k顇c顈j顉q顊y顋s題t額e顎e顏y眙y顐w顒y顓z顔y顕x顖x顗y願y顙s顚d顛d顜j眾z顝k類l顟l顠p顡w顢m顣c顤y顥h顦q顧g顨x顩y顪h顫c顬r顭m顮b顯x顰p瞇m顱l顲l顳n顴q顸h顼x颀q颉j颋t颌g颎j颏k颒h颔h颕y颙y颚e颛z颞n颟m颡s颣l颥r颦p風f颩d颪g颫f颬x颭z颮b颯s颰b颱t颲l颳g颴x颵x颶j颷b颸s颹w颺y颻y颼s颽k颾s颿f飀l飁x飂l飃p飄p飅l飆b飇b飈b飉l飊b飋s飌f飍x飏y飐z飑b飒s飓j飔s飕s飖y砦z飗l飙b飚b飛f飜f飝f飡c飢j飣d飤s飥t飦z飧s飨x飩t飪r飫y飬y飭c飮y飯f飰f飱s碭d飲y飳z飴y飵z飶b飷j確q飸t飹b飺c飻t飼s飽b飾s飿d餀h餁r餂t餃j餄h餅b餆y餇t餈c餉x養y餋j餌e磽q餍y餎l餏x餑b餒n餓e餔b餕j餖d餗s餘y餙s餚y餛h餜g餝s餞j餟c餠b餡x餢b餣y餤d餥f餦z餧w館g餩e餪n餫y餬h餭h餮t餯h餰j餱h餲a餳x礬f餵w餶g餷c餸s餹t餺b餻g餼x餽k餾l餿s饀t饂w饃m饄t饅m饆b饇y饈x饉j饊s饋k饌z饍s饎x饏d饐y饑j饒r饔y饕t饖w饗x饘z饚h饛m饜y饝m饞c饟x饠l饡z饢n饣s饤d饦t饧x饨t禪s饩x饪r饫y饬c饳d饴y饷x饸h饹g饻x饽b饾d馀y馂j馃g馄h馇c馉g馊s馌y馎b馐x馑j馓s馔z馕n馘g馛b馜n馝b馞b馟t馠h馡f馢j馣a馤a馥f馦x馧y馨x穎y穡s馪p馫x馬m馭y馮f馯h馰d馱t馲t馳c馴x馵z馶z馷p馸x馹r馺s馻y馼w馽z馾d馿l駀y竇d駂b駃j筅x駅y駆q駇w駈q駉j駊p駋z駌y筧j駍p駎z駏j駐z駑n駒j駓p駔z駕j駖l駗z駘t駙f駚y駛s駜b駝t駞t駟s箢y駠l駡m駢p駣t駤z駥r駦t駧d駨x駩q駪s駫j駬e駭h駮b簞d駰y駱l駲z駳d駴h駵l駶j駷s駸q駹m駺l駻h駼t駽x駾t駿j騀e騁c騂x騃a騄l騅z騆z騇s騈p騉k騊t騋l騌z騍k騎q騏q騐y騑f騒s験y騔g騕y騖w騗p騙p騚q騛f紆y騜h騝q騞h騟y騠t騡q騢x騣z純c騥r騦s騧g騨t絕j騩g騪s騬c騭z騮l騯p騰t騱x騲c騳d騴y綽c緄g騶z騷s騸s騹q騺z騻s騼l騽x騾l騿z縋z驁a驂c驃p驄c驅q縲l驆b驇z驈y驉x驊h驋b驌s驍x驎l驏z驐d繃b驑l驒t驓c驔d驕j驖t驗y驘l驙z驚j驛y驜y繽b驝t驞p驟z驠y驡l驢l驣t驤x驥j驦s驧j驨x驩h驪l驫b驲r驵z驷s驸f驺z驽n驿y骀d骁x骃y骅h骈p骉b骊l骍x骎q骐q骒k骓z骔z骕s骖c骘z骙k罷b骛w骜a骝l骞q骟s骠b骢c骣c骥j骦s骧x骩w骪w骫w骬y骭g骮y骯a骰t骱j骲b骳b骴c骵t羨x骶d骷k骹q骺h骻k骼g骽t骾g骿p羻q髀b髁k髂q髃y髄s髅l髆b髇x髈b髉b髋k髌b髎l髏l聖s髐x髑d髒z體t髕b髖k髗l髙g髚q髛k髜q髝l髞s髟b髠k髡k髢d肀y髣f髤x髥r髦m髧d髩b髪f髫t髬p髭z髮f髯r髰t胙z髱b髲b髳m髴f髷q髸g髹x髺k髻j髽z髾s髿s鬀t鬁l膣z鬄t鬅p鬆s鬇z鬈q鬉z鬊s鬋j鬌d鬍h鬎l鬏j鬐q鬑l鬒z鬓b鬔p鬕m鬖s鬗m鬘m鬙s鬚x鬛l鬜q鬝q鬞n鬟h鬠k臘l鬡n鬢b鬣l鬤r鬥d臥w鬧n鬨h鬩x鬪d鬬d鬭d鬮j鬯c鬰y艙c鬳y艤y鬴f鬵z鬶g鬷z鬸l鬹g鬺s鬻y鬽m鬾j鬿q魀g魃b魅m魆x魇y芐h魉l魊y魋t魍w魎l魐g魑c魒p魕j魖x魗c魘y魙z魚y荮z莖j魜r魝j魞a魟h魠t魡d魢j魣x魤e魥j魦s魧h菪d菴a魩m萇c魪j魫s魬b魭y魮p魯l魰w葒h魲l魳z魴f魶n魷y魸n魹m魺h魻x魼q魽h魾p魿l鮀t蒹j蓀s鮂q鮃p鮄f鮅b鮆c鮇w鮈j鮉d蓮l鮊b鮋y鮌g鮍p鮎n鮏x鮐t鮑b蔆l鮒f鮓z鮔j鮕g鮖s蔞l蕆c蕘r鮘c鮙t鮚j鮛s鮜h鮝x鮞e鮟a鮠w鮡z鮢z鮣y鮤l鮥l鮦t鮧y鮨y鮩b鮪w鮫j鮬k鮭g鮮x鮯g鮰h鮱l鮲m鮳k鮴x鮵t鮶j鮷t鮸m鮹s鮺z鮻s鮼q鮽y鮾n鯀g鯁g鯂s鯃w鯄q鯅s鯆p鯇h鯈t蘞l鯊s鯋s鯌k鯍m鯎c鯏l虼g鯐s鯑k鯒y鯓s鯔z鯕q鯖q鯗x鯘n鯚j鯛d鯜q鯝g鯞z鯟d鯠l鯡f鯢n鯣y鯤k蜴y鯦j鯧c鯨j鯩l鯪l螄s螈y鯬l鯭m鯮z鯯z鯰n鯱x鯲d鯳s鯴s鯵s鯶h鯷t鯹x鯺z鯻l鯼z鯽j鯾b鯿b鰀h蟛p鰁q鰂z鰃w蟣j鰄w鰅y鰆c鰇r鰈d鰉h鰊l鰋y鰌q鰍q鰎j鰏b蠶c鰑y蠻m衊m鰓s鰔j鰕x鰖t鰗h鰘s鰙r鰚h鰛w鰜j鰝h鰞w鰟p鰠s鰡l鰢m鰣s鰤s鰥g鰦z鰧t鰨t鰩y鰪e鰫y鰬q鰭q鰮w鰯r鰰h鰱l鰲a袼g裉k鰴h鰵m鰶j鰷t鰸q鰹j鰺s鰻m鰼x鰽q鰿j鱀j鱁z鱂j鱃x鱄z鱅y鱆z鱇k鱈x襖a襲x鱊y鱋q鱌x鱍b鱎j鱏x鱐s鱑h鱒z覈h觀g觔j鱔s鱕f鱖g鱗l鱘x鱙y鱚x鱛a鱜k鱞g鱟h鱠k鱡z鱢s鱣z鱤g鱥g計j鱦y鱧l鱨c鱩h鱪s鱫a訟s訥n訶h鱭j鱮x鱯h鱰s鱱l鱲l鱳l鱴m鱵z鱶x鱷e鱸l鱹g鱺l鱻x鱽d鱾j試s鱿y鲀t鲂f詬g鲃b鲄h鲅b詰j鲆p鲇n詳x鲈l鲉y鲊z鲋f詿g鲌b鲎h誄l鲏p鲐t鲑g鲒j鲓k鲔w鲕e鲖t鲗z鲘h鲙k鲚j鲛j鲝z鲞x鲟x誦s鲠g鲡l說s鲢l鲣j鲥s鲦t誹f鲧g鲨s鲩h鲪j鲫j鲬y鲭q鲮l鲯q鲰z鲱f鲲k鲳c鲴g鲵n鲶n鲷d鲹s鲺s諦d鲻z鲼f諭y鲽d鲾b鲿c鳀t諼x謄t鳁w鳂w鳄e謖s鳅q鳆f謾m譏j鳇h鳈q鳉j鳊b變b鳌a鳍q鳎t鳏g鳐y鳑p讞y鳓l鳔b鳕x鳗m鳘m鳙y鳚w鳜g鳝s鳟z鳠h鳡g鳢l鳣z鳤g鳥n鳦y鳧f豊l鳨l鳪b鳫y鳬f鳭d鳮j鳯f鳰n鳱g鳲s鳳f鳴m鳵b鳶y貞z買m費f貽y鳸h賀h鳹q鳺f鳻b鳼w鳽j鳾s鳿y鴀f鴁y鴂j鴃j鴄p賍z鴅h鴆z鴇b鴈y鴉y鴊z鴋f鴌f賚l賦f賫l鴎o賱y鴏d賲b鴐j鴑r鴒l鴓m鴔f鴕t鴖m鴗l鴘b鴙z鴚g鴛y鴜c鴝q鴞x鴟c鴠d鴡j鴣g鴤z鴥y鴦y鴧y鴨y鴩d鴪y贖s鴬y鴭d赾q鴰g鴱a鴲z鴳y鴴h鴵x鴶j鴷l鴸z鴹y鴺y鴻h鴼l鴽r趒t鴾m鴿g趕g鵁j鵂x鵃z鵄c鵅l鵆q鵇t鵈e趛y鵊j鵋j趢l鵌t鵍h鵎t趦z趬q趶k鵐w鵒y鵓b鵔j鵕j跊m鵖b鵗x鵘j鵙j鵚t鵛j鵜t鵝e鵞e鵟k鵠h鵢s鵣l鵤z跮d鵦l鵧p鵨s鵩f鵪a鵫z鵬p踇m鵭q鵮q鵯b踋j鵰d鵱l鵲q踐j鵳j鵴j鵵t鵶y鵷y踖j鵸q鵹l鵺y鵻z鵼k鵽d踜l鵾k鵿s鶀q踠w鶁j鶂y踤z踨z踼t鶄j鶅z鶆l鶇d蹅c蹆t蹌q蹎d蹏t鶉c鶊g鶋j鶌q鶍y鶎k鶏j鶐s鶑y鶒c鶓m躌w躤j鶖q躪l鶗t鶘h鶙t鶚e躳g躴l躼l軂l軅y軈y軍j鶜m鶝f鶞c鶟t鶠y鶡h鶢y鶣p鶤k鶥m鶦h軛e鶧y軞m軭k軯p軳p鶩w鶪j軸z輇q鶬c鶭f鶮h鶯y鶰y鶱x鶲w輑y鶴h鶵c輜z鶶t鶷x鶸r輠g鶹l鶺j鶻g鶼j輧p輪l輯j輳c輼w鶾h鶿c鷀c鷁y鷂y轋h轌x轓f鷄j鷅l鷆t鷇k鷈t鷉t鷊y鷋t鷌m鷍x鷎g鷏t鷐c鷑j鷒t鷓z轙y鷔a轚j鷕y鷖y轜e鷗o鷘c鷙z鷚l鷛y轣l鷝b鷞s鷟z鷠y鷡w鷢j鷣y鷤t鷥s鷦j鷨h鷩b鷪y鷫s鷬h辀z鷮j辎z鷯l辤c鷱g辧b鷲j鷳x鷴x鷵t鷶m鷷z鷸y鷹y鷺l鷻t鷼x鷽x辭c鷿p鸀z鸁l鸂x鸃y鸄j鸅z鸆y鸇z辴z鸈y鸊p鸋n鸌h辺d鸍m鸎y鸏m鸐d鸑y迀g鸒y鸓l鸔b鸕l鸖h鸗l鸘s鸙y鸚y鸛g鸜q鸝l鸞l鸠j鸢y鸤s鸧c鸨b鸩z鸪g鸫d鸬l鸮x鸰l鸱c鸲q鸴x鸶s鸷z鸸e鸹g鸺x鸻h鸼z鸾l鹀w鹁b鹂l鹄g鹆y鹇x迒h鹈t迓y鹉w鹋m鹌a鹍k迠c鹎b迡c鹐q鹑c迣z迦j迧c鹓y鹔s迶y鹖h鹗e迼j鹘g迿x鹙q鹚c鹛m逌y逘y鹜w鹝y鹞y鹟w鹠l鹡j鹢y鹣j鹥y鹦y鹨l鹩l鹪j逤s鹫j逩b逫z逰y鹬y鹭l鹮h鹯z鹱h鹲m鹳g鹵l鹷l鹸j鹹x鹻j鹼j鹽y鹾c逽n逿d遃y遆t遉z麁c麂j麃b麄c麅p麆z麇j麈z麉j麊m麋b麌y麍l麎c麏j達d麐l違w麑n麒q麔j遚c麕j麖j麗l麘x麙x麚j麛m麜l麝s麞z麟l麠j麢l麣y麤c麥m麧h麨c麩f麪m麫m麬f麭p麮q麯q麰m麱f麲x麳l麴q麵m麶c麷f麸f麹q麺m適s麼m麽m遬s麾h麿m遰d黀z遱l黁n遳c黃h黅j黆g黇t黈t黉h黊h黋k黌h黏n黐c黒h黓y黕d黖x黗t黙m黚q黛d黜c黝y點d黟y黠x黡y黢q黣m黤y黥q黦y黧l黨d黩d黪c黫y邍y黬y邎y黭y黮d邐l黯a黰z黱d黲c黳y黴m黵d黶y黷d黸l黹z黻f黼f黽m邗h黾m黿y鼀c鼁q鼂c鼃w鼄z鼅z鼆m鼇a邞f鼊b鼋y邨c鼌c邩h鼍t邫b邽g鼑d鼒z鼔g鼕d鼘y鼙p鼚c鼛g鼜c鼝y鼞t鼟t鼡n鼢f鼣f鼤w鼥b鼦d鼧t郋x鼨z郌g鼩q鼪s鼫s鼬y鼭s鼮t鼯w鼰j鼱j鼲h鼳j鼴y鼵t鼶s鼷x鼸x郞l鼹y鼺l鼼y鼽q鼾h鼿w齀w齁h齂x齃e齄z齅x郣b郩x齆w齇z齈n齉n齊q郰z郲l齌j齍z齎j齏j齑j齒c齓c齔c齕h齖y齗y齘x郼y齚z齛x齜z齝c齞y齟j齠t齡l齢l齣c齤q齥x鄅y鄋s齧n齨j鄍m齪c齫y齬y齭c鄒z齯n鄖y鄘y鄤m齱z齲q齳y齴y鄧d鄩x鄪b齶e齷w齸y齹c齺z齻d齼c齾y龀c龁h龂y鄳m鄹z龃j龅b龆t龇z龈y龉y龊c龌w龍l龏g鄿q酅x龑y龒l龓l龔g龕k龗l龘d龛k龜g龝q酨z龞b龢h龣j龤x龥y鳩j鳷z鴍w鴢y鴫t鴮w鴯e鵀r鵉l鵏b鵑j鵡w鵥k鶃y鶛j鶨c鶫d鶳s鶽s鷃y鷜l鷧y鷭f鷰y鷾y鸉y鹒g鹕h鹶j鹺c麀y麡q鼈b鼉t鼏m齋z齙b齦y齮y齰z齵y齽j龎p龖d龡c癷b唉a苯b瞓f硸n秎f斗d稥x坊f竕f告g龟g哼h解j擂l罖r芈m羒f羘z羛y羜z羣q羦h羪y羫q羭y羮g羳f羵f羶s羷l翂f裂l聁u膹f艈u漂p骑q砌q雀q蒊h蒶f蕒m蕡f是s伺c毝c苔t虲u蚠f蝊u蟇m衁h衇m衈e衖x衚h衜d衞w衟d衠z衯f衮g袰b袴k呀y訜f子z豶f亂l傯z僨f償c兇x喲Y嗯E堯Y塏K墳F墾K鶕A鶔r鶈q鱬r鱝f魵f髍m馩f馚f饙f餴f颃h霻f霣y雺w隫f闧u闇a閥f閟b間j镪q钿d鐼f鐢f鏦c鏜t鍂p奮f婁l媵y屢l嶠j幀z幗g憤f錖d錆q銽x橥z歸g殛j炷z甯n瘧n瘵z碡z糞f紛f羥q腳j膩n臺t莜y蓿x褸l誒e讜d讠y贁b趀c趓d趙z趸d跀y跥d輊z輒z轒f轕g遧z邚r邤x郬q郺y酳y酼h酽y醆z醈t醓t醔q醦c釀n釂j釈s釋s釒j釔y釕l釗z釙p釠l釢n釤s釥q鉀j釪h釫h釯m釿j鈃x鈄d鈇f鈈b鈎g鈏y鈑b鈖f鈙q鈚p鈝y鈟d鈠y鈨y鈩h鈱m鈵b鈾y鈿d鉅j鉇s鉒z鉔z鉗q鉞y鉡b鉢b鉥s鉧m鉬m鉲k鉳b鉵t鉽s鉾m銁j銃c銅t銍z銐c銑x銕t銗h銘m銠l銡j銣r銤m銨a銫s銬k銰a銱d銹x銼c銾h銿z鋃l鋊y鋍b鋏j鋐h鋒f鋓c鋔w鋜z鋝l鋫l鋱t鋲b鋶l鋻j鋾t錄l錈j錐z錔t錛b錝c錫x錰s錶b鍃h鍅f鍎t鍜x鍝y鍮t鍰h鍴d鎎k鎗q鎚c鎢w鎣y鎥t鏓c鏷p鐍j鐳l鐶h鐺d鑃d鑍y鑙j鑚z鑛k鑭l鑶c钂t钘x铇b锳y镮h镺a镾m閁m閅m閯s閵l闂h闃g闑n闒t闔h闢p闣d陥x陬z陯l韁j韄h頄q順s顑k飠s饁y饓c駁b駄t駯z騘c騤k騫q騵y鰐e鰒f鰳l鰾p鱉b鱓s鳋s鳒j鳛x鹧z鹴s黂f黺f鼖f齩y驀m髊c髨k髵e髶e髼p鬂b鬦d鬫k鬱y魈x魌q魓b魛d魨t魱h鮁b鮗d鮿z鯙c鯉l鯥l鯫z鯸h龐p&quot;</span>;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 常用简体汉字</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">const</span> <span class="built_in">string</span> SimplifiedChinese = <span class="string">&quot;一乙二十丁厂七卜人入八九几儿了力乃刀又三于干亏士工土才寸下大丈与万上小口巾山千乞川亿个勺久凡及夕丸么广亡门义之尸弓己已子卫也女飞刃习叉马乡丰王井开夫天无元专云扎艺木五支厅不太犬区历尤友匹车巨牙屯比互切瓦止少日中冈贝内水见午牛手毛气升长仁什片仆化仇币仍仅斤爪反介父从今凶分乏公仓月氏勿欠风丹匀乌凤勾文六方火为斗忆订计户认心尺引丑巴孔队办以允予劝双书幻玉刊示末未击打巧正扑扒功扔去甘世古节本术可丙左厉右石布龙平灭轧东卡北占业旧帅归且旦目叶甲申叮电号田由史只央兄叼叫另叨叹四生失禾丘付仗代仙们仪白仔他斥瓜乎丛令用甩印乐句匆册犯外处冬鸟务包饥主市立闪兰半汁汇头汉宁穴它讨写让礼训必议讯记永司尼民出辽奶奴加召皮边发孕圣对台矛纠母幼丝式刑动扛寺吉扣考托老执巩圾扩扫地扬场耳共芒亚芝朽朴机权过臣再协西压厌在有百存而页匠夸夺灰达列死成夹轨邪划迈毕至此贞师尘尖劣光当早吐吓虫曲团同吊吃因吸吗屿帆岁回岂刚则肉网年朱先丢舌竹迁乔伟传乒乓休伍伏优伐延件任伤价份华仰仿伙伪自血向似后行舟全会杀合兆企众爷伞创肌朵杂危旬旨负各名多争色壮冲冰庄庆亦刘齐交次衣产决充妄闭问闯羊并关米灯州汗污江池汤忙兴宇守宅字安讲军许论农讽设访寻那迅尽导异孙阵阳收阶阴防奸如妇好她妈戏羽观欢买红纤级约纪驰巡寿弄麦形进戒吞远违运扶抚坛技坏扰拒找批扯址走抄坝贡攻赤折抓扮抢孝均抛投坟抗坑坊抖护壳志扭块声把报却劫芽花芹芬苍芳严芦劳克苏杆杠杜材村杏极李杨求更束豆两丽医辰励否还歼来连步坚旱盯呈时吴助县里呆园旷围呀吨足邮男困吵串员听吩吹呜吧吼别岗帐财针钉告我乱利秃秀私每兵估体何但伸作伯伶佣低你住位伴身皂佛近彻役返余希坐谷妥含邻岔肝肚肠龟免狂犹角删条卵岛迎饭饮系言冻状亩况床库疗应冷这序辛弃冶忘闲间闷判灶灿弟汪沙汽沃泛沟没沈沉怀忧快完宋宏牢究穷灾良证启评补初社识诉诊词译君灵即层尿尾迟局改张忌际陆阿陈阻附妙妖妨努忍劲鸡驱纯纱纳纲驳纵纷纸纹纺驴纽奉玩环武青责现表规抹拢拔拣担坦押抽拐拖拍者顶拆拥抵拘势抱垃拉拦拌幸招坡披拨择抬其取苦若茂苹苗英范直茄茎茅林枝杯柜析板松枪构杰述枕丧或画卧事刺枣雨卖矿码厕奔奇奋态欧垄妻顷转斩轮软到非叔肯齿些虎虏肾贤尚旺具果味昆国昌畅明易昂典固忠咐呼鸣咏呢岸岩帖罗帜岭凯败贩购图钓制知垂牧物乖刮秆和季委佳侍供使例版侄侦侧凭侨佩货依的迫质欣征往爬彼径所舍金命斧爸采受乳贪念贫肤肺肢肿胀朋股肥服胁周昏鱼兔狐忽狗备饰饱饲变京享店夜庙府底剂郊废净盲放刻育闸闹郑券卷单炒炊炕炎炉沫浅法泄河沾泪油泊沿泡注泻泳泥沸波泼泽治怖性怕怜怪学宝宗定宜审宙官空帘实试郎诗肩房诚衬衫视话诞询该详建肃录隶居届刷屈弦承孟孤陕降限妹姑姐姓始驾参艰线练组细驶织终驻驼绍经贯奏春帮珍玻毒型挂封持项垮挎城挠政赴赵挡挺括拴拾挑指垫挣挤拼挖按挥挪某甚革荐巷带草茧茶荒茫荡荣故胡南药标枯柄栋相查柏柳柱柿栏树要咸威歪研砖厘厚砌砍面耐耍牵残殃轻鸦皆背战点临览竖省削尝是盼眨哄显哑冒映星昨畏趴胃贵界虹虾蚁思蚂虽品咽骂哗咱响哈咬咳哪炭峡罚贱贴骨钞钟钢钥钩卸缸拜看矩怎牲选适秒香种秋科重复竿段便俩贷顺修保促侮俭俗俘信皇泉鬼侵追俊盾待律很须叙剑逃食盆胆胜胞胖脉勉狭狮独狡狱狠贸怨急饶蚀饺饼弯将奖哀亭亮度迹庭疮疯疫疤姿亲音帝施闻阀阁差养美姜叛送类迷前首逆总炼炸炮烂剃洁洪洒浇浊洞测洗活派洽染济洋洲浑浓津恒恢恰恼恨举觉宣室宫宪突穿窃客冠语扁袄祖神祝误诱说诵垦退既屋昼费陡眉孩除险院娃姥姨姻娇怒架贺盈勇怠柔垒绑绒结绕骄绘给络骆绝绞统耕耗艳泰珠班素蚕顽盏匪捞栽捕振载赶起盐捎捏埋捉捆捐损都哲逝捡换挽热恐壶挨耻耽恭莲莫荷获晋恶真框桂档桐株桥桃格校核样根索哥速逗栗配翅辱唇夏础破原套逐烈殊顾轿较顿毙致柴桌虑监紧党晒眠晓鸭晃晌晕蚊哨哭恩唤啊唉罢峰圆贼贿钱钳钻铁铃铅缺氧特牺造乘敌秤租积秧秩称秘透笔笑笋债借值倚倾倒倘俱倡候俯倍倦健臭射躬息徒徐舰舱般航途拿爹爱颂翁脆脂胸胳脏胶脑狸狼逢留皱饿恋桨浆衰高席准座脊症病疾疼疲效离唐资凉站剖竞部旁旅畜阅羞瓶拳粉料益兼烤烘烦烧烛烟递涛浙涝酒涉消浩海涂浴浮流润浪浸涨烫涌悟悄悔悦害宽家宵宴宾窄容宰案请朗诸读扇袜袖袍被祥课谁调冤谅谈谊剥恳展剧屑弱陵陶陷陪娱娘通能难预桑绢绣验继球理捧堵描域掩捷排掉堆推掀授教掏掠培接控探据掘职基著勒黄萌萝菌菜萄菊萍菠营械梦梢梅检梳梯桶救副票戚爽聋袭盛雪辅辆虚雀堂常匙晨睁眯眼悬野啦晚啄距跃略蛇累唱患唯崖崭崇圈铜铲银甜梨犁移笨笼笛符第敏做袋悠偿偶偷您售停偏假得衔盘船斜盒鸽悉欲彩领脚脖脸脱象够猜猪猎猫猛馅馆凑减毫麻痒痕廊康庸鹿盗章竟商族旋望率着盖粘粗粒断剪兽清添淋淹渠渐混渔淘液淡深婆梁渗情惜惭悼惧惕惊惨惯寇寄宿窑密谋谎祸谜逮敢屠弹随蛋隆隐婚婶颈绩绪续骑绳维绵绸绿琴斑替款堪搭塔越趁趋超提堤博揭喜插揪搜煮援裁搁搂搅握揉斯期欺联散惹葬葛董葡敬葱落朝辜葵棒棋植森椅椒棵棍棉棚棕惠惑逼厨厦硬确雁殖裂雄暂雅辈悲紫辉敞赏掌晴暑最量喷晶喇遇喊景践跌跑遗蛙蛛蜓喝喂喘喉幅帽赌赔黑铸铺链销锁锄锅锈锋锐短智毯鹅剩稍程稀税筐等筑策筛筒答筋筝傲傅牌堡集焦傍储奥街惩御循艇舒番释禽腊脾腔鲁猾猴然馋装蛮就痛童阔善羡普粪尊道曾焰港湖渣湿温渴滑湾渡游滋溉愤慌惰愧愉慨割寒富窜窝窗遍裕裤裙谢谣谦属屡强粥疏隔隙絮嫂登缎缓编骗缘瑞魂肆摄摸填搏塌鼓摆携搬摇搞塘摊蒜勤鹊蓝墓幕蓬蓄蒙蒸献禁楚想槐榆楼概赖酬感碍碑碎碰碗碌雷零雾雹输督龄鉴睛睡睬鄙愚暖盟歇暗照跨跳跪路跟遣蛾蜂嗓置罪罩错锡锣锤锦键锯矮辞稠愁筹签简毁舅鼠催傻像躲微愈遥腰腥腹腾腿触解酱痰廉新韵意粮数煎塑慈煤煌满漠源滤滥滔溪溜滚滨粱滩慎誉塞谨福群殿辟障嫌嫁叠缝缠静碧璃墙撇嘉摧截誓境摘摔聚蔽慕暮蔑模榴榜榨歌遭酷酿酸磁愿需弊裳颗嗽蜻蜡蝇蜘赚锹锻舞稳算箩管僚鼻魄貌膜膊膀鲜疑馒裹敲豪膏遮腐瘦辣竭端旗精歉熄熔漆漂漫滴演漏慢寨赛察蜜谱嫩翠熊凳骡缩慧撕撒趣趟撑播撞撤增聪鞋蕉蔬横槽樱橡飘醋醉震霉瞒题暴瞎影踢踏踩踪蝶蝴嘱墨镇靠稻黎稿稼箱箭篇僵躺僻德艘膝膛熟摩颜毅糊遵潜潮懂额慰劈操燕薯薪薄颠橘整融醒餐嘴蹄器赠默镜赞篮邀衡膨雕磨凝辨辩糖糕燃澡激懒壁避缴戴擦鞠藏霜霞瞧蹈螺穗繁辫赢糟糠燥臂翼骤鞭覆蹦镰翻鹰警攀蹲颤瓣爆疆壤耀躁嚼嚷籍魔灌蠢霸露囊罐&quot;</span>;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 英文字母</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">const</span> <span class="built_in">string</span> Letters = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 数字</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">const</span> <span class="built_in">string</span> Numbers = <span class="string">&quot;0123456789&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="字符串工具方法"><a href="#字符串工具方法" class="headerlink" title="字符串工具方法"></a>字符串工具方法</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 版 本 Fly V7.0.3 飞联开发框架</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Copyright (c) 2013-2018 上海力软信息技术有限公司</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 创建人：力软-框架开发组</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 日 期：2017.03.04</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：字符串工具方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Str</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> Empty(空字符串)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 空字符串</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> Empty</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="built_in">string</span>.Empty; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> PinYin(获取汉字的拼音简码)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取汉字的拼音简码，即首字母缩写,范例：中国,返回zg</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;chineseText&quot;&gt;</span>汉字文本,范例： 中国<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">PinYin</span>(<span class="params"><span class="built_in">string</span> chineseText</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(chineseText))</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">char</span> text <span class="keyword">in</span> chineseText)</span><br><span class="line">            result.AppendFormat(<span class="string">&quot;&#123;0&#125;&quot;</span>, ResolvePinYin(text));</span><br><span class="line">        <span class="keyword">return</span> result.ToString().ToLower();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 解析单个汉字的拼音简码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>单个汉字<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ResolvePinYin</span>(<span class="params"><span class="built_in">char</span> text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] charBytes = Encoding.Default.GetBytes(text.ToString());</span><br><span class="line">        <span class="keyword">if</span> (charBytes[<span class="number">0</span>] &lt;= <span class="number">127</span>)</span><br><span class="line">            <span class="keyword">return</span> text.ToString();</span><br><span class="line">        <span class="keyword">var</span> unicode = (<span class="built_in">ushort</span>)(charBytes[<span class="number">0</span>] * <span class="number">256</span> + charBytes[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">string</span> pinYin = ResolvePinYinByCode(unicode);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrWhiteSpace(pinYin))</span><br><span class="line">            <span class="keyword">return</span> pinYin;</span><br><span class="line">        <span class="keyword">return</span> ResolvePinYinByFile(text.ToString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 使用字符编码方式获取拼音简码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ResolvePinYinByCode</span>(<span class="params"><span class="built_in">ushort</span> unicode</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB0A1&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uB0C4&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;A&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB0C5&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uB2C0&#x27;</span> &amp;&amp; unicode != <span class="number">45464</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;B&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB2C1&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uB4ED&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;C&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB4EE&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uB6E9&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;D&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB6EA&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uB7A1&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;E&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB7A2&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uB8C0&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;F&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB8C1&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uB9FD&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;G&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uB9FE&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uBBF6&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;H&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uBBF7&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uBFA5&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;J&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uBFA6&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC0AB&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;K&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC0AC&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC2E7&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;L&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC2E8&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC4C2&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;M&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC4C3&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC5B5&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;N&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC5B6&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC5BD&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;O&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC5BE&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC6D9&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;P&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC6DA&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC8BA&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Q&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC8BB&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uC8F5&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;R&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uC8F6&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uCBF9&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;S&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uCBFA&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uCDD9&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;T&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uCDDA&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uCEF3&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;W&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uCEF4&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uD188&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;X&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uD1B9&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uD4D0&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Y&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (unicode &gt;= <span class="string">&#x27;\uD4D1&#x27;</span> &amp;&amp; unicode &lt;= <span class="string">&#x27;\uD7F9&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Z&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 从拼音简码文件获取</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>单个汉字<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ResolvePinYinByFile</span>(<span class="params"><span class="built_in">string</span> text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">int</span> index = Const.ChinesePinYin.IndexOf(text, StringComparison.Ordinal);</span><br><span class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">return</span> Const.ChinesePinYin.Substring(index + <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取全拼</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 把汉字转换成拼音(全拼)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hzString&quot;&gt;</span>汉字字符串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>转换后的拼音(全拼)字符串<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ConvertPinYin</span>(<span class="params"><span class="built_in">string</span> text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">// 匹配中文字符</span></span><br><span class="line">        Regex regex = <span class="keyword">new</span> Regex(<span class="string">&quot;^[\u4e00-\u9fa5]$&quot;</span>);</span><br><span class="line">        <span class="built_in">byte</span>[] array = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">2</span>];</span><br><span class="line">        <span class="built_in">string</span> pyString = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="built_in">int</span> chrAsc = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">int</span> i1 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">int</span> i2 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">char</span>[] noWChar = text.ToCharArray();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; noWChar.Length; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 中文字符</span></span><br><span class="line">            <span class="keyword">if</span> (regex.IsMatch(noWChar[j].ToString()))</span><br><span class="line">            &#123;</span><br><span class="line">                array = System.Text.Encoding.Default.GetBytes(noWChar[j].ToString());</span><br><span class="line">                i1 = (<span class="built_in">short</span>)(array[<span class="number">0</span>]);</span><br><span class="line">                i2 = (<span class="built_in">short</span>)(array[<span class="number">1</span>]);</span><br><span class="line">                chrAsc = i1 * <span class="number">256</span> + i2 - <span class="number">65536</span>;</span><br><span class="line">                <span class="keyword">if</span> (chrAsc &gt; <span class="number">0</span> &amp;&amp; chrAsc &lt; <span class="number">160</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    pyString += noWChar[j];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 修正部分文字</span></span><br><span class="line">                    <span class="keyword">if</span> (chrAsc == <span class="number">-9254</span>)  <span class="comment">// 修正“圳”字</span></span><br><span class="line">                        pyString += <span class="string">&quot;Zhen&quot;</span>;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="built_in">int</span> i = (ChinesePinYinValue.Length - <span class="number">1</span>); i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span> (ChinesePinYinValue[i] &lt;= chrAsc)</span><br><span class="line">                            &#123;</span><br><span class="line">                                pyString += ChinesePinYinName[i];</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 非中文字符</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                pyString += noWChar[j].ToString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pyString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 拼音码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span>[] ChinesePinYinValue = <span class="keyword">new</span> <span class="built_in">int</span>[]</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="number">-20319</span>,<span class="number">-20317</span>,<span class="number">-20304</span>,<span class="number">-20295</span>,<span class="number">-20292</span>,<span class="number">-20283</span>,<span class="number">-20265</span>,<span class="number">-20257</span>,<span class="number">-20242</span>,<span class="number">-20230</span>,<span class="number">-20051</span>,<span class="number">-20036</span>,</span><br><span class="line">    <span class="number">-20032</span>,<span class="number">-20026</span>,<span class="number">-20002</span>,<span class="number">-19990</span>,<span class="number">-19986</span>,<span class="number">-19982</span>,<span class="number">-19976</span>,<span class="number">-19805</span>,<span class="number">-19784</span>,<span class="number">-19775</span>,<span class="number">-19774</span>,<span class="number">-19763</span>,</span><br><span class="line">    <span class="number">-19756</span>,<span class="number">-19751</span>,<span class="number">-19746</span>,<span class="number">-19741</span>,<span class="number">-19739</span>,<span class="number">-19728</span>,<span class="number">-19725</span>,<span class="number">-19715</span>,<span class="number">-19540</span>,<span class="number">-19531</span>,<span class="number">-19525</span>,<span class="number">-19515</span>,</span><br><span class="line">    <span class="number">-19500</span>,<span class="number">-19484</span>,<span class="number">-19479</span>,<span class="number">-19467</span>,<span class="number">-19289</span>,<span class="number">-19288</span>,<span class="number">-19281</span>,<span class="number">-19275</span>,<span class="number">-19270</span>,<span class="number">-19263</span>,<span class="number">-19261</span>,<span class="number">-19249</span>,</span><br><span class="line">    <span class="number">-19243</span>,<span class="number">-19242</span>,<span class="number">-19238</span>,<span class="number">-19235</span>,<span class="number">-19227</span>,<span class="number">-19224</span>,<span class="number">-19218</span>,<span class="number">-19212</span>,<span class="number">-19038</span>,<span class="number">-19023</span>,<span class="number">-19018</span>,<span class="number">-19006</span>,</span><br><span class="line">    <span class="number">-19003</span>,<span class="number">-18996</span>,<span class="number">-18977</span>,<span class="number">-18961</span>,<span class="number">-18952</span>,<span class="number">-18783</span>,<span class="number">-18774</span>,<span class="number">-18773</span>,<span class="number">-18763</span>,<span class="number">-18756</span>,<span class="number">-18741</span>,<span class="number">-18735</span>,</span><br><span class="line">    <span class="number">-18731</span>,<span class="number">-18722</span>,<span class="number">-18710</span>,<span class="number">-18697</span>,<span class="number">-18696</span>,<span class="number">-18526</span>,<span class="number">-18518</span>,<span class="number">-18501</span>,<span class="number">-18490</span>,<span class="number">-18478</span>,<span class="number">-18463</span>,<span class="number">-18448</span>,</span><br><span class="line">    <span class="number">-18447</span>,<span class="number">-18446</span>,<span class="number">-18239</span>,<span class="number">-18237</span>,<span class="number">-18231</span>,<span class="number">-18220</span>,<span class="number">-18211</span>,<span class="number">-18201</span>,<span class="number">-18184</span>,<span class="number">-18183</span>, <span class="number">-18181</span>,<span class="number">-18012</span>,</span><br><span class="line">    <span class="number">-17997</span>,<span class="number">-17988</span>,<span class="number">-17970</span>,<span class="number">-17964</span>,<span class="number">-17961</span>,<span class="number">-17950</span>,<span class="number">-17947</span>,<span class="number">-17931</span>,<span class="number">-17928</span>,<span class="number">-17922</span>,<span class="number">-17759</span>,<span class="number">-17752</span>,</span><br><span class="line">    <span class="number">-17733</span>,<span class="number">-17730</span>,<span class="number">-17721</span>,<span class="number">-17703</span>,<span class="number">-17701</span>,<span class="number">-17697</span>,<span class="number">-17692</span>,<span class="number">-17683</span>,<span class="number">-17676</span>,<span class="number">-17496</span>,<span class="number">-17487</span>,<span class="number">-17482</span>,</span><br><span class="line">    <span class="number">-17468</span>,<span class="number">-17454</span>,<span class="number">-17433</span>,<span class="number">-17427</span>,<span class="number">-17417</span>,<span class="number">-17202</span>,<span class="number">-17185</span>,<span class="number">-16983</span>,<span class="number">-16970</span>,<span class="number">-16942</span>,<span class="number">-16915</span>,<span class="number">-16733</span>,</span><br><span class="line">    <span class="number">-16708</span>,<span class="number">-16706</span>,<span class="number">-16689</span>,<span class="number">-16664</span>,<span class="number">-16657</span>,<span class="number">-16647</span>,<span class="number">-16474</span>,<span class="number">-16470</span>,<span class="number">-16465</span>,<span class="number">-16459</span>,<span class="number">-16452</span>,<span class="number">-16448</span>,</span><br><span class="line">    <span class="number">-16433</span>,<span class="number">-16429</span>,<span class="number">-16427</span>,<span class="number">-16423</span>,<span class="number">-16419</span>,<span class="number">-16412</span>,<span class="number">-16407</span>,<span class="number">-16403</span>,<span class="number">-16401</span>,<span class="number">-16393</span>,<span class="number">-16220</span>,<span class="number">-16216</span>,</span><br><span class="line">    <span class="number">-16212</span>,<span class="number">-16205</span>,<span class="number">-16202</span>,<span class="number">-16187</span>,<span class="number">-16180</span>,<span class="number">-16171</span>,<span class="number">-16169</span>,<span class="number">-16158</span>,<span class="number">-16155</span>,<span class="number">-15959</span>,<span class="number">-15958</span>,<span class="number">-15944</span>,</span><br><span class="line">    <span class="number">-15933</span>,<span class="number">-15920</span>,<span class="number">-15915</span>,<span class="number">-15903</span>,<span class="number">-15889</span>,<span class="number">-15878</span>,<span class="number">-15707</span>,<span class="number">-15701</span>,<span class="number">-15681</span>,<span class="number">-15667</span>,<span class="number">-15661</span>,<span class="number">-15659</span>,</span><br><span class="line">    <span class="number">-15652</span>,<span class="number">-15640</span>,<span class="number">-15631</span>,<span class="number">-15625</span>,<span class="number">-15454</span>,<span class="number">-15448</span>,<span class="number">-15436</span>,<span class="number">-15435</span>,<span class="number">-15419</span>,<span class="number">-15416</span>,<span class="number">-15408</span>,<span class="number">-15394</span>,</span><br><span class="line">    <span class="number">-15385</span>,<span class="number">-15377</span>,<span class="number">-15375</span>,<span class="number">-15369</span>,<span class="number">-15363</span>,<span class="number">-15362</span>,<span class="number">-15183</span>,<span class="number">-15180</span>,<span class="number">-15165</span>,<span class="number">-15158</span>,<span class="number">-15153</span>,<span class="number">-15150</span>,</span><br><span class="line">    <span class="number">-15149</span>,<span class="number">-15144</span>,<span class="number">-15143</span>,<span class="number">-15141</span>,<span class="number">-15140</span>,<span class="number">-15139</span>,<span class="number">-15128</span>,<span class="number">-15121</span>,<span class="number">-15119</span>,<span class="number">-15117</span>,<span class="number">-15110</span>,<span class="number">-15109</span>,</span><br><span class="line">    <span class="number">-14941</span>,<span class="number">-14937</span>,<span class="number">-14933</span>,<span class="number">-14930</span>,<span class="number">-14929</span>,<span class="number">-14928</span>,<span class="number">-14926</span>,<span class="number">-14922</span>,<span class="number">-14921</span>,<span class="number">-14914</span>,<span class="number">-14908</span>,<span class="number">-14902</span>,</span><br><span class="line">    <span class="number">-14894</span>,<span class="number">-14889</span>,<span class="number">-14882</span>,<span class="number">-14873</span>,<span class="number">-14871</span>,<span class="number">-14857</span>,<span class="number">-14678</span>,<span class="number">-14674</span>,<span class="number">-14670</span>,<span class="number">-14668</span>,<span class="number">-14663</span>,<span class="number">-14654</span>,</span><br><span class="line">    <span class="number">-14645</span>,<span class="number">-14630</span>,<span class="number">-14594</span>,<span class="number">-14429</span>,<span class="number">-14407</span>,<span class="number">-14399</span>,<span class="number">-14384</span>,<span class="number">-14379</span>,<span class="number">-14368</span>,<span class="number">-14355</span>,<span class="number">-14353</span>,<span class="number">-14345</span>,</span><br><span class="line">    <span class="number">-14170</span>,<span class="number">-14159</span>,<span class="number">-14151</span>,<span class="number">-14149</span>,<span class="number">-14145</span>,<span class="number">-14140</span>,<span class="number">-14137</span>,<span class="number">-14135</span>,<span class="number">-14125</span>,<span class="number">-14123</span>,<span class="number">-14122</span>,<span class="number">-14112</span>,</span><br><span class="line">    <span class="number">-14109</span>,<span class="number">-14099</span>,<span class="number">-14097</span>,<span class="number">-14094</span>,<span class="number">-14092</span>,<span class="number">-14090</span>,<span class="number">-14087</span>,<span class="number">-14083</span>,<span class="number">-13917</span>,<span class="number">-13914</span>,<span class="number">-13910</span>,<span class="number">-13907</span>,</span><br><span class="line">    <span class="number">-13906</span>,<span class="number">-13905</span>,<span class="number">-13896</span>,<span class="number">-13894</span>,<span class="number">-13878</span>,<span class="number">-13870</span>,<span class="number">-13859</span>,<span class="number">-13847</span>,<span class="number">-13831</span>,<span class="number">-13658</span>,<span class="number">-13611</span>,<span class="number">-13601</span>,</span><br><span class="line">    <span class="number">-13406</span>,<span class="number">-13404</span>,<span class="number">-13400</span>,<span class="number">-13398</span>,<span class="number">-13395</span>,<span class="number">-13391</span>,<span class="number">-13387</span>,<span class="number">-13383</span>,<span class="number">-13367</span>,<span class="number">-13359</span>,<span class="number">-13356</span>,<span class="number">-13343</span>,</span><br><span class="line">    <span class="number">-13340</span>,<span class="number">-13329</span>,<span class="number">-13326</span>,<span class="number">-13318</span>,<span class="number">-13147</span>,<span class="number">-13138</span>,<span class="number">-13120</span>,<span class="number">-13107</span>,<span class="number">-13096</span>,<span class="number">-13095</span>,<span class="number">-13091</span>,<span class="number">-13076</span>,</span><br><span class="line">    <span class="number">-13068</span>,<span class="number">-13063</span>,<span class="number">-13060</span>,<span class="number">-12888</span>,<span class="number">-12875</span>,<span class="number">-12871</span>,<span class="number">-12860</span>,<span class="number">-12858</span>,<span class="number">-12852</span>,<span class="number">-12849</span>,<span class="number">-12838</span>,<span class="number">-12831</span>,</span><br><span class="line">    <span class="number">-12829</span>,<span class="number">-12812</span>,<span class="number">-12802</span>,<span class="number">-12607</span>,<span class="number">-12597</span>,<span class="number">-12594</span>,<span class="number">-12585</span>,<span class="number">-12556</span>,<span class="number">-12359</span>,<span class="number">-12346</span>,<span class="number">-12320</span>,<span class="number">-12300</span>,</span><br><span class="line">    <span class="number">-12120</span>,<span class="number">-12099</span>,<span class="number">-12089</span>,<span class="number">-12074</span>,<span class="number">-12067</span>,<span class="number">-12058</span>,<span class="number">-12039</span>,<span class="number">-11867</span>,<span class="number">-11861</span>,<span class="number">-11847</span>,<span class="number">-11831</span>,<span class="number">-11798</span>,</span><br><span class="line">    <span class="number">-11781</span>,<span class="number">-11604</span>,<span class="number">-11589</span>,<span class="number">-11536</span>,<span class="number">-11358</span>,<span class="number">-11340</span>,<span class="number">-11339</span>,<span class="number">-11324</span>,<span class="number">-11303</span>,<span class="number">-11097</span>,<span class="number">-11077</span>,<span class="number">-11067</span>,</span><br><span class="line">    <span class="number">-11055</span>,<span class="number">-11052</span>,<span class="number">-11045</span>,<span class="number">-11041</span>,<span class="number">-11038</span>,<span class="number">-11024</span>,<span class="number">-11020</span>,<span class="number">-11019</span>,<span class="number">-11018</span>,<span class="number">-11014</span>,<span class="number">-10838</span>,<span class="number">-10832</span>,</span><br><span class="line">    <span class="number">-10815</span>,<span class="number">-10800</span>,<span class="number">-10790</span>,<span class="number">-10780</span>,<span class="number">-10764</span>,<span class="number">-10587</span>,<span class="number">-10544</span>,<span class="number">-10533</span>,<span class="number">-10519</span>,<span class="number">-10331</span>,<span class="number">-10329</span>,<span class="number">-10328</span>,</span><br><span class="line">    <span class="number">-10322</span>,<span class="number">-10315</span>,<span class="number">-10309</span>,<span class="number">-10307</span>,<span class="number">-10296</span>,<span class="number">-10281</span>,<span class="number">-10274</span>,<span class="number">-10270</span>,<span class="number">-10262</span>,<span class="number">-10260</span>,<span class="number">-10256</span>,<span class="number">-10254</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>  拼音码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span>[] ChinesePinYinName = <span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="string">&quot;A&quot;</span>,<span class="string">&quot;Ai&quot;</span>,<span class="string">&quot;An&quot;</span>,<span class="string">&quot;Ang&quot;</span>,<span class="string">&quot;Ao&quot;</span>,<span class="string">&quot;Ba&quot;</span>,<span class="string">&quot;Bai&quot;</span>,<span class="string">&quot;Ban&quot;</span>,<span class="string">&quot;Bang&quot;</span>,<span class="string">&quot;Bao&quot;</span>,<span class="string">&quot;Bei&quot;</span>,<span class="string">&quot;Ben&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Beng&quot;</span>,<span class="string">&quot;Bi&quot;</span>,<span class="string">&quot;Bian&quot;</span>,<span class="string">&quot;Biao&quot;</span>,<span class="string">&quot;Bie&quot;</span>,<span class="string">&quot;Bin&quot;</span>,<span class="string">&quot;Bing&quot;</span>,<span class="string">&quot;Bo&quot;</span>,<span class="string">&quot;Bu&quot;</span>,<span class="string">&quot;Ba&quot;</span>,<span class="string">&quot;Cai&quot;</span>,<span class="string">&quot;Can&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Cang&quot;</span>,<span class="string">&quot;Cao&quot;</span>,<span class="string">&quot;Ce&quot;</span>,<span class="string">&quot;Ceng&quot;</span>,<span class="string">&quot;Cha&quot;</span>,<span class="string">&quot;Chai&quot;</span>,<span class="string">&quot;Chan&quot;</span>,<span class="string">&quot;Chang&quot;</span>,<span class="string">&quot;Chao&quot;</span>,<span class="string">&quot;Che&quot;</span>,<span class="string">&quot;Chen&quot;</span>,<span class="string">&quot;Cheng&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Chi&quot;</span>,<span class="string">&quot;Chong&quot;</span>,<span class="string">&quot;Chou&quot;</span>,<span class="string">&quot;Chu&quot;</span>,<span class="string">&quot;Chuai&quot;</span>,<span class="string">&quot;Chuan&quot;</span>,<span class="string">&quot;Chuang&quot;</span>,<span class="string">&quot;Chui&quot;</span>,<span class="string">&quot;Chun&quot;</span>,<span class="string">&quot;Chuo&quot;</span>,<span class="string">&quot;Ci&quot;</span>,<span class="string">&quot;Cong&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Cou&quot;</span>,<span class="string">&quot;Cu&quot;</span>,<span class="string">&quot;Cuan&quot;</span>,<span class="string">&quot;Cui&quot;</span>,<span class="string">&quot;Cun&quot;</span>,<span class="string">&quot;Cuo&quot;</span>,<span class="string">&quot;Da&quot;</span>,<span class="string">&quot;Dai&quot;</span>,<span class="string">&quot;Dan&quot;</span>,<span class="string">&quot;Dang&quot;</span>,<span class="string">&quot;Dao&quot;</span>,<span class="string">&quot;De&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Deng&quot;</span>,<span class="string">&quot;Di&quot;</span>,<span class="string">&quot;Dian&quot;</span>,<span class="string">&quot;Diao&quot;</span>,<span class="string">&quot;Die&quot;</span>,<span class="string">&quot;Ding&quot;</span>,<span class="string">&quot;Diu&quot;</span>,<span class="string">&quot;Dong&quot;</span>,<span class="string">&quot;Dou&quot;</span>,<span class="string">&quot;Du&quot;</span>,<span class="string">&quot;Duan&quot;</span>,<span class="string">&quot;Dui&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Dun&quot;</span>,<span class="string">&quot;Duo&quot;</span>,<span class="string">&quot;E&quot;</span>,<span class="string">&quot;En&quot;</span>,<span class="string">&quot;Er&quot;</span>,<span class="string">&quot;Fa&quot;</span>,<span class="string">&quot;Fan&quot;</span>,<span class="string">&quot;Fang&quot;</span>,<span class="string">&quot;Fei&quot;</span>,<span class="string">&quot;Fen&quot;</span>,<span class="string">&quot;Feng&quot;</span>,<span class="string">&quot;Fo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Fou&quot;</span>,<span class="string">&quot;Fu&quot;</span>,<span class="string">&quot;Ga&quot;</span>,<span class="string">&quot;Gai&quot;</span>,<span class="string">&quot;Gan&quot;</span>,<span class="string">&quot;Gang&quot;</span>,<span class="string">&quot;Gao&quot;</span>,<span class="string">&quot;Ge&quot;</span>,<span class="string">&quot;Gei&quot;</span>,<span class="string">&quot;Gen&quot;</span>,<span class="string">&quot;Geng&quot;</span>,<span class="string">&quot;Gong&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Gou&quot;</span>,<span class="string">&quot;Gu&quot;</span>,<span class="string">&quot;Gua&quot;</span>,<span class="string">&quot;Guai&quot;</span>,<span class="string">&quot;Guan&quot;</span>,<span class="string">&quot;Guang&quot;</span>,<span class="string">&quot;Gui&quot;</span>,<span class="string">&quot;Gun&quot;</span>,<span class="string">&quot;Guo&quot;</span>,<span class="string">&quot;Ha&quot;</span>,<span class="string">&quot;Hai&quot;</span>,<span class="string">&quot;Han&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Hang&quot;</span>,<span class="string">&quot;Hao&quot;</span>,<span class="string">&quot;He&quot;</span>,<span class="string">&quot;Hei&quot;</span>,<span class="string">&quot;Hen&quot;</span>,<span class="string">&quot;Heng&quot;</span>,<span class="string">&quot;Hong&quot;</span>,<span class="string">&quot;Hou&quot;</span>,<span class="string">&quot;Hu&quot;</span>,<span class="string">&quot;Hua&quot;</span>,<span class="string">&quot;Huai&quot;</span>,<span class="string">&quot;Huan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Huang&quot;</span>,<span class="string">&quot;Hui&quot;</span>,<span class="string">&quot;Hun&quot;</span>,<span class="string">&quot;Huo&quot;</span>,<span class="string">&quot;Ji&quot;</span>,<span class="string">&quot;Jia&quot;</span>,<span class="string">&quot;Jian&quot;</span>,<span class="string">&quot;Jiang&quot;</span>,<span class="string">&quot;Jiao&quot;</span>,<span class="string">&quot;Jie&quot;</span>,<span class="string">&quot;Jin&quot;</span>,<span class="string">&quot;Jing&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Jiong&quot;</span>,<span class="string">&quot;Jiu&quot;</span>,<span class="string">&quot;Ju&quot;</span>,<span class="string">&quot;Juan&quot;</span>,<span class="string">&quot;Jue&quot;</span>,<span class="string">&quot;Jun&quot;</span>,<span class="string">&quot;Ka&quot;</span>,<span class="string">&quot;Kai&quot;</span>,<span class="string">&quot;Kan&quot;</span>,<span class="string">&quot;Kang&quot;</span>,<span class="string">&quot;Kao&quot;</span>,<span class="string">&quot;Ke&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Ken&quot;</span>,<span class="string">&quot;Keng&quot;</span>,<span class="string">&quot;Kong&quot;</span>,<span class="string">&quot;Kou&quot;</span>,<span class="string">&quot;Ku&quot;</span>,<span class="string">&quot;Kua&quot;</span>,<span class="string">&quot;Kuai&quot;</span>,<span class="string">&quot;Kuan&quot;</span>,<span class="string">&quot;Kuang&quot;</span>,<span class="string">&quot;Kui&quot;</span>,<span class="string">&quot;Kun&quot;</span>,<span class="string">&quot;Kuo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;La&quot;</span>,<span class="string">&quot;Lai&quot;</span>,<span class="string">&quot;Lan&quot;</span>,<span class="string">&quot;Lang&quot;</span>,<span class="string">&quot;Lao&quot;</span>,<span class="string">&quot;Le&quot;</span>,<span class="string">&quot;Lei&quot;</span>,<span class="string">&quot;Leng&quot;</span>,<span class="string">&quot;Li&quot;</span>,<span class="string">&quot;Lia&quot;</span>,<span class="string">&quot;Lian&quot;</span>,<span class="string">&quot;Liang&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Liao&quot;</span>,<span class="string">&quot;Lie&quot;</span>,<span class="string">&quot;Lin&quot;</span>,<span class="string">&quot;Ling&quot;</span>,<span class="string">&quot;Liu&quot;</span>,<span class="string">&quot;Long&quot;</span>,<span class="string">&quot;Lou&quot;</span>,<span class="string">&quot;Lu&quot;</span>,<span class="string">&quot;Lv&quot;</span>,<span class="string">&quot;Luan&quot;</span>,<span class="string">&quot;Lue&quot;</span>,<span class="string">&quot;Lun&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Luo&quot;</span>,<span class="string">&quot;Ma&quot;</span>,<span class="string">&quot;Mai&quot;</span>,<span class="string">&quot;Man&quot;</span>,<span class="string">&quot;Mang&quot;</span>,<span class="string">&quot;Mao&quot;</span>,<span class="string">&quot;Me&quot;</span>,<span class="string">&quot;Mei&quot;</span>,<span class="string">&quot;Men&quot;</span>,<span class="string">&quot;Meng&quot;</span>,<span class="string">&quot;Mi&quot;</span>,<span class="string">&quot;Mian&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Miao&quot;</span>,<span class="string">&quot;Mie&quot;</span>,<span class="string">&quot;Min&quot;</span>,<span class="string">&quot;Ming&quot;</span>,<span class="string">&quot;Miu&quot;</span>,<span class="string">&quot;Mo&quot;</span>,<span class="string">&quot;Mou&quot;</span>,<span class="string">&quot;Mu&quot;</span>,<span class="string">&quot;Na&quot;</span>,<span class="string">&quot;Nai&quot;</span>,<span class="string">&quot;Nan&quot;</span>,<span class="string">&quot;Nang&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Nao&quot;</span>,<span class="string">&quot;Ne&quot;</span>,<span class="string">&quot;Nei&quot;</span>,<span class="string">&quot;Nen&quot;</span>,<span class="string">&quot;Neng&quot;</span>,<span class="string">&quot;Ni&quot;</span>,<span class="string">&quot;Nian&quot;</span>,<span class="string">&quot;Niang&quot;</span>,<span class="string">&quot;Niao&quot;</span>,<span class="string">&quot;Nie&quot;</span>,<span class="string">&quot;Nin&quot;</span>,<span class="string">&quot;Ning&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Niu&quot;</span>,<span class="string">&quot;Nong&quot;</span>,<span class="string">&quot;Nu&quot;</span>,<span class="string">&quot;Nv&quot;</span>,<span class="string">&quot;Nuan&quot;</span>,<span class="string">&quot;Nue&quot;</span>,<span class="string">&quot;Nuo&quot;</span>,<span class="string">&quot;O&quot;</span>,<span class="string">&quot;Ou&quot;</span>,<span class="string">&quot;Pa&quot;</span>,<span class="string">&quot;Pai&quot;</span>,<span class="string">&quot;Pan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Pang&quot;</span>,<span class="string">&quot;Pao&quot;</span>,<span class="string">&quot;Pei&quot;</span>,<span class="string">&quot;Pen&quot;</span>,<span class="string">&quot;Peng&quot;</span>,<span class="string">&quot;Pi&quot;</span>,<span class="string">&quot;Pian&quot;</span>,<span class="string">&quot;Piao&quot;</span>,<span class="string">&quot;Pie&quot;</span>,<span class="string">&quot;Pin&quot;</span>,<span class="string">&quot;Ping&quot;</span>,<span class="string">&quot;Po&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Pu&quot;</span>,<span class="string">&quot;Qi&quot;</span>,<span class="string">&quot;Qia&quot;</span>,<span class="string">&quot;Qian&quot;</span>,<span class="string">&quot;Qiang&quot;</span>,<span class="string">&quot;Qiao&quot;</span>,<span class="string">&quot;Qie&quot;</span>,<span class="string">&quot;Qin&quot;</span>,<span class="string">&quot;Qing&quot;</span>,<span class="string">&quot;Qiong&quot;</span>,<span class="string">&quot;Qiu&quot;</span>,<span class="string">&quot;Qu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Quan&quot;</span>,<span class="string">&quot;Que&quot;</span>,<span class="string">&quot;Qun&quot;</span>,<span class="string">&quot;Ran&quot;</span>,<span class="string">&quot;Rang&quot;</span>,<span class="string">&quot;Rao&quot;</span>,<span class="string">&quot;Re&quot;</span>,<span class="string">&quot;Ren&quot;</span>,<span class="string">&quot;Reng&quot;</span>,<span class="string">&quot;Ri&quot;</span>,<span class="string">&quot;Rong&quot;</span>,<span class="string">&quot;Rou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Ru&quot;</span>,<span class="string">&quot;Ruan&quot;</span>,<span class="string">&quot;Rui&quot;</span>,<span class="string">&quot;Run&quot;</span>,<span class="string">&quot;Ruo&quot;</span>,<span class="string">&quot;Sa&quot;</span>,<span class="string">&quot;Sai&quot;</span>,<span class="string">&quot;San&quot;</span>,<span class="string">&quot;Sang&quot;</span>,<span class="string">&quot;Sao&quot;</span>,<span class="string">&quot;Se&quot;</span>,<span class="string">&quot;Sen&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Seng&quot;</span>,<span class="string">&quot;Sha&quot;</span>,<span class="string">&quot;Shai&quot;</span>,<span class="string">&quot;Shan&quot;</span>,<span class="string">&quot;Shang&quot;</span>,<span class="string">&quot;Shao&quot;</span>,<span class="string">&quot;She&quot;</span>,<span class="string">&quot;Shen&quot;</span>,<span class="string">&quot;Sheng&quot;</span>,<span class="string">&quot;Shi&quot;</span>,<span class="string">&quot;Shou&quot;</span>,<span class="string">&quot;Shu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Shua&quot;</span>,<span class="string">&quot;Shuai&quot;</span>,<span class="string">&quot;Shuan&quot;</span>,<span class="string">&quot;Shuang&quot;</span>,<span class="string">&quot;Shui&quot;</span>,<span class="string">&quot;Shun&quot;</span>,<span class="string">&quot;Shuo&quot;</span>,<span class="string">&quot;Si&quot;</span>,<span class="string">&quot;Song&quot;</span>,<span class="string">&quot;Sou&quot;</span>,<span class="string">&quot;Su&quot;</span>,<span class="string">&quot;Suan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Sui&quot;</span>,<span class="string">&quot;Sun&quot;</span>,<span class="string">&quot;Suo&quot;</span>,<span class="string">&quot;Ta&quot;</span>,<span class="string">&quot;Tai&quot;</span>,<span class="string">&quot;Tan&quot;</span>,<span class="string">&quot;Tang&quot;</span>,<span class="string">&quot;Tao&quot;</span>,<span class="string">&quot;Te&quot;</span>,<span class="string">&quot;Teng&quot;</span>,<span class="string">&quot;Ti&quot;</span>,<span class="string">&quot;Tian&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Tiao&quot;</span>,<span class="string">&quot;Tie&quot;</span>,<span class="string">&quot;Ting&quot;</span>,<span class="string">&quot;Tong&quot;</span>,<span class="string">&quot;Tou&quot;</span>,<span class="string">&quot;Tu&quot;</span>,<span class="string">&quot;Tuan&quot;</span>,<span class="string">&quot;Tui&quot;</span>,<span class="string">&quot;Tun&quot;</span>,<span class="string">&quot;Tuo&quot;</span>,<span class="string">&quot;Wa&quot;</span>,<span class="string">&quot;Wai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Wan&quot;</span>,<span class="string">&quot;Wang&quot;</span>,<span class="string">&quot;Wei&quot;</span>,<span class="string">&quot;Wen&quot;</span>,<span class="string">&quot;Weng&quot;</span>,<span class="string">&quot;Wo&quot;</span>,<span class="string">&quot;Wu&quot;</span>,<span class="string">&quot;Xi&quot;</span>,<span class="string">&quot;Xia&quot;</span>,<span class="string">&quot;Xian&quot;</span>,<span class="string">&quot;Xiang&quot;</span>,<span class="string">&quot;Xiao&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Xie&quot;</span>,<span class="string">&quot;Xin&quot;</span>,<span class="string">&quot;Xing&quot;</span>,<span class="string">&quot;Xiong&quot;</span>,<span class="string">&quot;Xiu&quot;</span>,<span class="string">&quot;Xu&quot;</span>,<span class="string">&quot;Xuan&quot;</span>,<span class="string">&quot;Xue&quot;</span>,<span class="string">&quot;Xun&quot;</span>,<span class="string">&quot;Ya&quot;</span>,<span class="string">&quot;Yan&quot;</span>,<span class="string">&quot;Yang&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Yao&quot;</span>,<span class="string">&quot;Ye&quot;</span>,<span class="string">&quot;Yi&quot;</span>,<span class="string">&quot;Yin&quot;</span>,<span class="string">&quot;Ying&quot;</span>,<span class="string">&quot;Yo&quot;</span>,<span class="string">&quot;Yong&quot;</span>,<span class="string">&quot;You&quot;</span>,<span class="string">&quot;Yu&quot;</span>,<span class="string">&quot;Yuan&quot;</span>,<span class="string">&quot;Yue&quot;</span>,<span class="string">&quot;Yun&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Za&quot;</span>, <span class="string">&quot;Zai&quot;</span>,<span class="string">&quot;Zan&quot;</span>,<span class="string">&quot;Zang&quot;</span>,<span class="string">&quot;Zao&quot;</span>,<span class="string">&quot;Ze&quot;</span>,<span class="string">&quot;Zei&quot;</span>,<span class="string">&quot;Zen&quot;</span>,<span class="string">&quot;Zeng&quot;</span>,<span class="string">&quot;Zha&quot;</span>,<span class="string">&quot;Zhai&quot;</span>,<span class="string">&quot;Zhan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Zhang&quot;</span>,<span class="string">&quot;Zhao&quot;</span>,<span class="string">&quot;Zhe&quot;</span>,<span class="string">&quot;Zhen&quot;</span>,<span class="string">&quot;Zheng&quot;</span>,<span class="string">&quot;Zhi&quot;</span>,<span class="string">&quot;Zhong&quot;</span>,<span class="string">&quot;Zhou&quot;</span>,<span class="string">&quot;Zhu&quot;</span>,<span class="string">&quot;Zhua&quot;</span>,<span class="string">&quot;Zhuai&quot;</span>,<span class="string">&quot;Zhuan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Zhuang&quot;</span>,<span class="string">&quot;Zhui&quot;</span>,<span class="string">&quot;Zhun&quot;</span>,<span class="string">&quot;Zhuo&quot;</span>,<span class="string">&quot;Zi&quot;</span>,<span class="string">&quot;Zong&quot;</span>,<span class="string">&quot;Zou&quot;</span>,<span class="string">&quot;Zu&quot;</span>,<span class="string">&quot;Zuan&quot;</span>,<span class="string">&quot;Zui&quot;</span>,<span class="string">&quot;Zun&quot;</span>,<span class="string">&quot;Zuo&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> Splice(拼接集合元素)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 拼接集合元素</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;T&quot;&gt;</span>集合元素类型<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;list&quot;&gt;</span>集合<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;quotes&quot;&gt;</span>引号，默认不带引号，范例：单引号 &quot;&#x27;&quot;<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;separator&quot;&gt;</span>分隔符，默认使用逗号分隔<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Splice</span>&lt;<span class="title">T</span>&gt;(<span class="params">IEnumerable&lt;T&gt; list, <span class="built_in">string</span> quotes = <span class="string">&quot;&quot;</span>, <span class="built_in">string</span> separator = <span class="string">&quot;,&quot;</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (list == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> each <span class="keyword">in</span> list)</span><br><span class="line">            result.AppendFormat(<span class="string">&quot;&#123;0&#125;&#123;1&#125;&#123;0&#125;&#123;2&#125;&quot;</span>, quotes, each, separator);</span><br><span class="line">        <span class="keyword">return</span> result.ToString().TrimEnd(separator.ToCharArray());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> FirstUpper(将值的首字母大（小）写)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 将值的首字母大写</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">FirstUpper</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> firstChar = <span class="keyword">value</span>.Substring(<span class="number">0</span>, <span class="number">1</span>).ToUpper();</span><br><span class="line">        <span class="keyword">return</span> firstChar + <span class="keyword">value</span>.Substring(<span class="number">1</span>, <span class="keyword">value</span>.Length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 将值的首字母小写</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">FirstLower</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> firstChar = <span class="keyword">value</span>.Substring(<span class="number">0</span>, <span class="number">1</span>).ToLower();</span><br><span class="line">        <span class="keyword">return</span> firstChar + <span class="keyword">value</span>.Substring(<span class="number">1</span>, <span class="keyword">value</span>.Length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ToCamel(将字符串转成驼峰形式)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 将字符串转成驼峰形式</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>原始字符串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToCamel</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> FirstUpper(<span class="keyword">value</span>.ToLower());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ContainsChinese(是否包含中文)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否包含中文</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>文本<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">ContainsChinese</span>(<span class="params"><span class="built_in">string</span> text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> pattern = <span class="string">&quot;[\u4e00-\u9fa5]+&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> Regex.IsMatch(text, pattern);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ContainsNumber(是否包含数字)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否包含数字</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>文本<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">ContainsNumber</span>(<span class="params"><span class="built_in">string</span> text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="built_in">string</span> pattern = <span class="string">&quot;[0-9]+&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> Regex.IsMatch(text, pattern);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> Distinct(去除重复)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 去除重复</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>值，范例1：&quot;5555&quot;,返回&quot;5&quot;,范例2：&quot;4545&quot;,返回&quot;45&quot;<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Distinct</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> array = <span class="keyword">value</span>.ToCharArray();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">string</span>(array.Distinct().ToArray());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> Truncate(截断字符串)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 截断字符串</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>文本<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;length&quot;&gt;</span>返回长度<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;endCharCount&quot;&gt;</span>添加结束符号的个数，默认0，不添加<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;endChar&quot;&gt;</span>结束符号，默认为省略号<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Truncate</span>(<span class="params"><span class="built_in">string</span> text, <span class="built_in">int</span> length, <span class="built_in">int</span> endCharCount = <span class="number">0</span>, <span class="built_in">string</span> endChar = <span class="string">&quot;.&quot;</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(text))</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">if</span> (text.Length &lt; length)</span><br><span class="line">            <span class="keyword">return</span> text;</span><br><span class="line">        <span class="keyword">return</span> text.Substring(<span class="number">0</span>, length) + GetEndString(endCharCount, endChar);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取结束字符串</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetEndString</span>(<span class="params"><span class="built_in">int</span> endCharCount, <span class="built_in">string</span> endChar</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; endCharCount; i++)</span><br><span class="line">            result.Append(endChar);</span><br><span class="line">        <span class="keyword">return</span> result.ToString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ToSimplifiedChinese(转换为简体中文)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为简体中文</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>繁体中文<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToSimplifiedChinese</span>(<span class="params"><span class="built_in">string</span> text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Strings.StrConv(text, VbStrConv.SimplifiedChinese);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ToSimplifiedChinese(转换为繁体中文)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为繁体中文</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>简体中文<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToTraditionalChinese</span>(<span class="params"><span class="built_in">string</span> text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Strings.StrConv(text, VbStrConv.TraditionalChinese);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> Unique(获取全局唯一值)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取全局唯一值</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Unique</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Guid.NewGuid().ToString().Replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> GetLastProperty(获取最后一个属性)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取最后一个属性</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;propertyName&quot;&gt;</span>属性名，范例，A.B.C,返回&quot;C&quot;<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetLastProperty</span>(<span class="params"><span class="built_in">string</span> propertyName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (propertyName.IsEmpty())</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">var</span> lastIndex = propertyName.LastIndexOf(<span class="string">&quot;.&quot;</span>, StringComparison.Ordinal) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> propertyName.Substring(lastIndex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>加密、解密帮助类</title>
      <link href="2023/07/17/DESEncrypt/"/>
      <url>2023/07/17/DESEncrypt/</url>
      
        <content type="html"><![CDATA[<h1 id="加密、解密帮助类"><a href="#加密、解密帮助类" class="headerlink" title="加密、解密帮助类"></a>加密、解密帮助类</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> DESEncrypt</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：加密、解密帮助类</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DESEncrypt</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> key = <span class="string">&quot;learun###***&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ========加密========</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 加密</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Text&quot;&gt;</span>需要加密的内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="built_in">string</span> Text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Encrypt(Text, key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 加密数据 </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Text&quot;&gt;</span>需要加密的内容<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sKey&quot;&gt;</span>秘钥<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="built_in">string</span> Text, <span class="built_in">string</span> sKey</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        DESCryptoServiceProvider des = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">        <span class="built_in">byte</span>[] inputByteArray;</span><br><span class="line">        inputByteArray = Encoding.Default.GetBytes(Text);</span><br><span class="line">        des.Key = ASCIIEncoding.ASCII.GetBytes(Md5Helper.Hash(sKey).ToUpper().Substring(<span class="number">0</span>, <span class="number">8</span>));</span><br><span class="line">        des.IV = ASCIIEncoding.ASCII.GetBytes(Md5Helper.Hash(sKey).ToUpper().Substring(<span class="number">0</span>, <span class="number">8</span>));</span><br><span class="line">        System.IO.MemoryStream ms = <span class="keyword">new</span> System.IO.MemoryStream();</span><br><span class="line">        CryptoStream cs = <span class="keyword">new</span> CryptoStream(ms, des.CreateEncryptor(), CryptoStreamMode.Write);</span><br><span class="line">        cs.Write(inputByteArray, <span class="number">0</span>, inputByteArray.Length);</span><br><span class="line">        cs.FlushFinalBlock();</span><br><span class="line">        StringBuilder ret = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">byte</span> b <span class="keyword">in</span> ms.ToArray())</span><br><span class="line">        &#123;</span><br><span class="line">            ret.AppendFormat(<span class="string">&quot;&#123;0:X2&#125;&quot;</span>, b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret.ToString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> ========解密========</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 解密</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Text&quot;&gt;</span>需要解密的内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> Text</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(Text))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Decrypt(Text, key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 解密数据 </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Text&quot;&gt;</span>需要解密的内容<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sKey&quot;&gt;</span>秘钥<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="built_in">string</span> Text, <span class="built_in">string</span> sKey</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        DESCryptoServiceProvider des = <span class="keyword">new</span> DESCryptoServiceProvider();</span><br><span class="line">        <span class="built_in">int</span> len;</span><br><span class="line">        len = Text.Length / <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">byte</span>[] inputByteArray = <span class="keyword">new</span> <span class="built_in">byte</span>[len];</span><br><span class="line">        <span class="built_in">int</span> x, i;</span><br><span class="line">        <span class="keyword">for</span> (x = <span class="number">0</span>; x &lt; len; x++)</span><br><span class="line">        &#123;</span><br><span class="line">            i = Convert.ToInt32(Text.Substring(x * <span class="number">2</span>, <span class="number">2</span>), <span class="number">16</span>);</span><br><span class="line">            inputByteArray[x] = (<span class="built_in">byte</span>)i;</span><br><span class="line">        &#125;</span><br><span class="line">        des.Key = ASCIIEncoding.ASCII.GetBytes(Md5Helper.Hash(sKey).ToUpper().Substring(<span class="number">0</span>, <span class="number">8</span>));</span><br><span class="line">        des.IV = ASCIIEncoding.ASCII.GetBytes(Md5Helper.Hash(sKey).ToUpper().Substring(<span class="number">0</span>, <span class="number">8</span>));</span><br><span class="line">        System.IO.MemoryStream ms = <span class="keyword">new</span> System.IO.MemoryStream();</span><br><span class="line">        CryptoStream cs = <span class="keyword">new</span> CryptoStream(ms, des.CreateDecryptor(), CryptoStreamMode.Write);</span><br><span class="line">        cs.Write(inputByteArray, <span class="number">0</span>, inputByteArray.Length);</span><br><span class="line">        cs.FlushFinalBlock();</span><br><span class="line">        <span class="keyword">return</span> Encoding.Default.GetString(ms.ToArray());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="数据访问-SqlServer-上下文"><a href="#数据访问-SqlServer-上下文" class="headerlink" title="数据访问(SqlServer) 上下文"></a>数据访问(SqlServer) 上下文</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Md5Helper</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：数据访问(SqlServer) 上下文</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Md5Helper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> &quot;MD5加密&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> MD5加密</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;str&quot;&gt;</span>加密字符<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;code&quot;&gt;</span>加密位数16/32<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="built_in">string</span> str, <span class="built_in">int</span> code</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> strEncrypt = <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">if</span> (code == <span class="number">16</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            strEncrypt = Hash(str).Substring(<span class="number">8</span>, <span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (code == <span class="number">32</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            strEncrypt = Hash(str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> strEncrypt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 32位MD5加密（小写）</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;input&quot;&gt;</span>输入字段<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Hash</span>(<span class="params"><span class="built_in">string</span> input</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        MD5CryptoServiceProvider md5Hasher = <span class="keyword">new</span> MD5CryptoServiceProvider();</span><br><span class="line">        <span class="built_in">byte</span>[] data = md5Hasher.ComputeHash(Encoding.Default.GetBytes(input));</span><br><span class="line">        StringBuilder sBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; data.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            sBuilder.Append(data[i].ToString(<span class="string">&quot;x2&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sBuilder.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>邮件收发组件</title>
      <link href="2023/07/17/MailHelper/"/>
      <url>2023/07/17/MailHelper/</url>
      
        <content type="html"><![CDATA[<h1 id="邮件收发"><a href="#邮件收发" class="headerlink" title="邮件收发"></a>邮件收发</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 邮件收发组件</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MailHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 邮件服务器地址lr</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailServer = Config.GetValue(<span class="string">&quot;MailHost&quot;</span>);</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 用户名lr</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailUserName = Config.GetValue(<span class="string">&quot;MailUserName&quot;</span>);</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 密码lr</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailPassword = Config.GetValue(<span class="string">&quot;MailPassword&quot;</span>);</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 名称lr</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailName = Config.GetValue(<span class="string">&quot;MailName&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 邮件服务器地址xcfl</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailServerN = Config.GetValue(<span class="string">&quot;host&quot;</span>);</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 用户名xcfl</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailUserNameN = Config.GetValue(<span class="string">&quot;mailFrom&quot;</span>);</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 密码xcfl</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailPasswordN = Config.GetValue(<span class="string">&quot;mailPwd&quot;</span>);</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 名称xcfl</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> MailNameN = Config.GetValue(<span class="string">&quot;mailFrom&quot;</span>);</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 同步发送邮件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;to&quot;&gt;</span>收件人邮箱地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;subject&quot;&gt;</span>主题<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;body&quot;&gt;</span>内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;encoding&quot;&gt;</span>编码<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isBodyHtml&quot;&gt;</span>是否Html<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;enableSsl&quot;&gt;</span>是否SSL加密连接<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>是否成功<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Send</span>(<span class="params"><span class="built_in">string</span> to, <span class="built_in">string</span> subject, <span class="built_in">string</span> body, <span class="built_in">string</span> encoding = <span class="string">&quot;UTF-8&quot;</span>, <span class="built_in">bool</span> isBodyHtml = <span class="literal">true</span>, <span class="built_in">bool</span> enableSsl = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            MailMessage message = <span class="keyword">new</span> MailMessage();</span><br><span class="line">            <span class="comment">// 接收人邮箱地址</span></span><br><span class="line">            message.To.Add(<span class="keyword">new</span> MailAddress(to));</span><br><span class="line">            message.From = <span class="keyword">new</span> MailAddress(MailUserName, MailName);</span><br><span class="line">            message.BodyEncoding = Encoding.GetEncoding(encoding);</span><br><span class="line">            message.Body = body;</span><br><span class="line">            <span class="comment">//GB2312</span></span><br><span class="line">            message.SubjectEncoding = Encoding.GetEncoding(encoding);</span><br><span class="line">            message.Subject = subject;</span><br><span class="line">            message.IsBodyHtml = isBodyHtml;</span><br><span class="line"></span><br><span class="line">            SmtpClient smtpclient = <span class="keyword">new</span> SmtpClient(MailServer, <span class="number">25</span>);</span><br><span class="line">            smtpclient.Credentials = <span class="keyword">new</span> System.Net.NetworkCredential(MailUserName, MailPassword);</span><br><span class="line">            <span class="comment">//SSL连接</span></span><br><span class="line">            smtpclient.EnableSsl = enableSsl;</span><br><span class="line">            smtpclient.Send(message);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(ex.ToString());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 同步发送邮件XCFL</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;to&quot;&gt;</span>收件人邮箱地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;subject&quot;&gt;</span>主题<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;body&quot;&gt;</span>内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;encoding&quot;&gt;</span>编码<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isBodyHtml&quot;&gt;</span>是否Html<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;enableSsl&quot;&gt;</span>是否SSL加密连接<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>是否成功<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">SendMine</span>(<span class="params"><span class="built_in">string</span> to, <span class="built_in">string</span> subject, <span class="built_in">string</span> body, <span class="built_in">string</span> encoding = <span class="string">&quot;UTF-8&quot;</span>, <span class="built_in">bool</span> isBodyHtml = <span class="literal">true</span>, <span class="built_in">bool</span> enableSsl = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            MailMessage message = <span class="keyword">new</span> MailMessage();</span><br><span class="line">            <span class="comment">// 接收人邮箱地址</span></span><br><span class="line">            message.To.Add(<span class="keyword">new</span> MailAddress(to));</span><br><span class="line">            message.From = <span class="keyword">new</span> MailAddress(MailUserNameN, MailNameN);</span><br><span class="line">            message.BodyEncoding = Encoding.GetEncoding(encoding);</span><br><span class="line">            message.Body = body;</span><br><span class="line">            <span class="comment">//GB2312</span></span><br><span class="line">            message.SubjectEncoding = Encoding.GetEncoding(encoding);</span><br><span class="line">            message.Subject = subject;</span><br><span class="line">            message.IsBodyHtml = isBodyHtml;</span><br><span class="line"></span><br><span class="line">            SmtpClient smtpclient = <span class="keyword">new</span> SmtpClient(MailServerN, <span class="number">25</span>);</span><br><span class="line">            smtpclient.Credentials = <span class="keyword">new</span> System.Net.NetworkCredential(MailUserNameN, MailPasswordN);</span><br><span class="line">            <span class="comment">//SSL连接</span></span><br><span class="line">            smtpclient.EnableSsl = enableSsl;</span><br><span class="line">            smtpclient.Send(message);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 异步发送邮件 独立线程</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;to&quot;&gt;</span>邮件接收人<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;title&quot;&gt;</span>邮件标题<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;body&quot;&gt;</span>邮件内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;port&quot;&gt;</span>端口号<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SendByThread</span>(<span class="params"><span class="built_in">string</span> to, <span class="built_in">string</span> title, <span class="built_in">string</span> body, <span class="built_in">int</span> port = <span class="number">25</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(<span class="built_in">delegate</span> ()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                SmtpClient smtp = <span class="keyword">new</span> SmtpClient();</span><br><span class="line">                <span class="comment">//邮箱的smtp地址</span></span><br><span class="line">                smtp.Host = MailServer;</span><br><span class="line">                <span class="comment">//端口号</span></span><br><span class="line">                smtp.Port = port;</span><br><span class="line">                <span class="comment">//构建发件人的身份凭据类</span></span><br><span class="line">                smtp.Credentials = <span class="keyword">new</span> NetworkCredential(MailUserName, MailPassword);</span><br><span class="line">                <span class="comment">//构建消息类</span></span><br><span class="line">                MailMessage objMailMessage = <span class="keyword">new</span> MailMessage();</span><br><span class="line">                <span class="comment">//设置优先级</span></span><br><span class="line">                objMailMessage.Priority = MailPriority.High;</span><br><span class="line">                <span class="comment">//消息发送人</span></span><br><span class="line">                objMailMessage.From = <span class="keyword">new</span> MailAddress(MailUserName, <span class="string">&quot;提醒&quot;</span>, System.Text.Encoding.UTF8);</span><br><span class="line">                <span class="comment">//收件人</span></span><br><span class="line">                objMailMessage.To.Add(to);</span><br><span class="line">                <span class="comment">//标题</span></span><br><span class="line">                objMailMessage.Subject = title.Trim();</span><br><span class="line">                <span class="comment">//标题字符编码</span></span><br><span class="line">                objMailMessage.SubjectEncoding = System.Text.Encoding.UTF8;</span><br><span class="line">                <span class="comment">//正文</span></span><br><span class="line">                objMailMessage.Body = body.Trim();</span><br><span class="line">                objMailMessage.IsBodyHtml = <span class="literal">true</span>;</span><br><span class="line">                <span class="comment">//内容字符编码</span></span><br><span class="line">                objMailMessage.BodyEncoding = System.Text.Encoding.UTF8;</span><br><span class="line">                <span class="comment">//发送</span></span><br><span class="line">                smtp.Send(objMailMessage);</span><br><span class="line">            &#125;</span><br><span class="line">            catch (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(ex.ToString());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)).Start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 发送</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;account&quot;&gt;</span>配置<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;mailModel&quot;&gt;</span>信息<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Send</span>(<span class="params">MailAccount account, MailModel mailModel</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            MailMessage mailMessage = <span class="keyword">new</span> MailMessage();</span><br><span class="line">            mailMessage.From = <span class="keyword">new</span> MailAddress(account.Account, account.AccountName);</span><br><span class="line">            <span class="comment">//发件人</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(mailModel.To))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> ToArray = mailModel.To.Split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> ToArray)</span><br><span class="line">                &#123;</span><br><span class="line">                    mailMessage.To.Add(<span class="keyword">new</span> MailAddress(item));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//抄送人</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(mailModel.CC))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> CCArray = mailModel.CC.Split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> CCArray)</span><br><span class="line">                &#123;</span><br><span class="line">                    mailMessage.CC.Add(<span class="keyword">new</span> MailAddress(item));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//密送人</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(mailModel.Bcc))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> BccArray = mailModel.Bcc.Split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> BccArray)</span><br><span class="line">                &#123;</span><br><span class="line">                    mailMessage.Bcc.Add(<span class="keyword">new</span> MailAddress(item));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//附件</span></span><br><span class="line">            <span class="comment">//var filePath = DirFileHelper.GetAbsolutePath(&quot;~/Resource/EmailFile/&quot;);</span></span><br><span class="line">            <span class="comment">//foreach (MailFile item in mailModel.Attachment)</span></span><br><span class="line">            <span class="comment">//&#123;</span></span><br><span class="line">            <span class="comment">//    var attachment = new Attachment(filePath + item.FileId);</span></span><br><span class="line">            <span class="comment">//    attachment.Name = item.FileName;</span></span><br><span class="line">            <span class="comment">//    mailMessage.Attachments.Add(attachment);</span></span><br><span class="line">            <span class="comment">//&#125;</span></span><br><span class="line">            mailMessage.Subject = mailModel.Subject;</span><br><span class="line">            mailMessage.Body = mailModel.BodyText;</span><br><span class="line">            mailMessage.IsBodyHtml = <span class="literal">true</span>;</span><br><span class="line">            mailMessage.Priority = MailPriority.Normal;</span><br><span class="line">            mailMessage.SubjectEncoding = Encoding.UTF8;</span><br><span class="line">            mailMessage.BodyEncoding = Encoding.UTF8;</span><br><span class="line">            <span class="comment">//不被当作垃圾邮件的关键代码--Begin            </span></span><br><span class="line">            mailMessage.Headers.Add(<span class="string">&quot;X-Priority&quot;</span>, <span class="string">&quot;3&quot;</span>);</span><br><span class="line">            mailMessage.Headers.Add(<span class="string">&quot;X-MSMail-Priority&quot;</span>, <span class="string">&quot;Normal&quot;</span>);</span><br><span class="line">            mailMessage.Headers.Add(<span class="string">&quot;X-Mailer&quot;</span>, <span class="string">&quot;Microsoft Outlook Express 6.00.2900.2869&quot;</span>);</span><br><span class="line">            mailMessage.Headers.Add(<span class="string">&quot;X-MimeOLE&quot;</span>, <span class="string">&quot;Produced By Microsoft MimeOLE V6.00.2900.2869&quot;</span>);</span><br><span class="line">            mailMessage.Headers.Add(<span class="string">&quot;ReturnReceipt&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">            <span class="comment">//不被当作垃圾邮件的关键代码--End        </span></span><br><span class="line">            <span class="keyword">using</span> (SmtpClient smtpClient = <span class="keyword">new</span> SmtpClient(account.SMTPHost, account.SMTPPort))</span><br><span class="line">            &#123;</span><br><span class="line">                smtpClient.UseDefaultCredentials = <span class="literal">false</span>;</span><br><span class="line">                smtpClient.Credentials = <span class="keyword">new</span> NetworkCredential(account.Account, account.Password);</span><br><span class="line">                smtpClient.DeliveryMethod = SmtpDeliveryMethod.Network;</span><br><span class="line">                smtpClient.Send(mailMessage);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 删除</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;account&quot;&gt;</span>配置<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;UID&quot;&gt;</span>UID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Delete</span>(<span class="params">MailAccount account, <span class="built_in">string</span> UID</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (POP3_Client pop3Client = <span class="keyword">new</span> POP3_Client())</span><br><span class="line">            &#123;</span><br><span class="line">                pop3Client.Connect(account.POP3Host, account.POP3Port, <span class="literal">false</span>);</span><br><span class="line">                pop3Client.Login(account.Account, account.Password);</span><br><span class="line">                <span class="keyword">if</span> (pop3Client.Messages.Count &gt; <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (POP3_ClientMessage messages <span class="keyword">in</span> pop3Client.Messages)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (messages.UID == UID)</span><br><span class="line">                        &#123;</span><br><span class="line">                            messages.MarkForDeletion();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;account&quot;&gt;</span>配置<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;receiveCount&quot;&gt;</span>已收邮件数、注意：如果已收邮件数和邮件数量一致则不获取<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;MailModel&gt; <span class="title">Get</span>(<span class="params">MailAccount account, <span class="built_in">int</span> receiveCount</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> filePath = DirFileHelper.GetAbsolutePath(<span class="string">&quot;~/Resource/EmailFile/&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> resultList = <span class="keyword">new</span> List&lt;MailModel&gt;();</span><br><span class="line">            <span class="keyword">using</span> (POP3_Client pop3Client = <span class="keyword">new</span> POP3_Client())</span><br><span class="line">            &#123;</span><br><span class="line">                pop3Client.Connect(account.POP3Host, account.POP3Port, account.Ssl);</span><br><span class="line">                pop3Client.Login(account.Account, account.Password);</span><br><span class="line">                <span class="keyword">var</span> messages = pop3Client.Messages;</span><br><span class="line">                <span class="keyword">if</span> (receiveCount == messages.Count)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> resultList;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> i = messages.Count - <span class="number">1</span>; receiveCount &lt;= i; i--)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">var</span> messageItem = messages[i];</span><br><span class="line">                    <span class="keyword">var</span> messageHeader = Mail_Message.ParseFromByte(messageItem.MessageToByte());</span><br><span class="line">                    resultList.Add(<span class="keyword">new</span> MailModel()</span><br><span class="line">                    &#123;</span><br><span class="line">                        UID = messageItem.UID,</span><br><span class="line">                        To = messageHeader.From == <span class="literal">null</span> ? <span class="string">&quot;&quot;</span> : messageHeader.From[<span class="number">0</span>].Address,</span><br><span class="line">                        ToName = messageHeader.From == <span class="literal">null</span> ? <span class="string">&quot;&quot;</span> : messageHeader.From[<span class="number">0</span>].DisplayName,</span><br><span class="line">                        Subject = messageHeader.Subject,</span><br><span class="line">                        BodyText = messageHeader.BodyHtmlText,</span><br><span class="line">                        Attachment = GetFile(filePath, messageHeader.GetAttachments(<span class="literal">true</span>, <span class="literal">true</span>), messageItem.UID),</span><br><span class="line">                        Date = messageHeader.Date,</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> resultList;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 解析附件并且下载到本地目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;messageFile&quot;&gt;</span>附件对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;UID&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;MailFile&gt; <span class="title">GetFile</span>(<span class="params"><span class="built_in">string</span> filePath, MIME_Entity[] messageFile, <span class="built_in">string</span> UID</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> resultList = <span class="keyword">new</span> List&lt;MailFile&gt;();</span><br><span class="line">        <span class="keyword">foreach</span> (MIME_Entity entity <span class="keyword">in</span> messageFile)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> fileName = entity.ContentType.Param_Name;</span><br><span class="line">            <span class="keyword">var</span> fileByte = (MIME_b_SinglepartBase)entity.Body;</span><br><span class="line">            <span class="keyword">var</span> fileId = UID + <span class="string">&quot;_&quot;</span> + fileName;</span><br><span class="line">            DirFileHelper.CreateFile(filePath + fileId, fileByte.Data);</span><br><span class="line">            <span class="keyword">var</span> fileSize = DirFileHelper.GetFileSize(filePath + fileId);</span><br><span class="line">            resultList.Add(<span class="keyword">new</span> MailFile</span><br><span class="line">            &#123;</span><br><span class="line">                FileId = fileId,</span><br><span class="line">                FileName = fileName,</span><br><span class="line">                FileSize = DirFileHelper.ToFileSize(fileSize)</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="MailAccount"><a href="#MailAccount" class="headerlink" title="MailAccount"></a>MailAccount</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MailAccount</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> POP3服务</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> POP3Host &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> POP3端口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> POP3Port &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SMTP服务</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> SMTPHost &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SMTP端口</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> SMTPPort &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 账户</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Account &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 账户名称</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> AccountName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 密码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SSL</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Ssl &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="MailFile"><a href="#MailFile" class="headerlink" title="MailFile"></a>MailFile</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MailFile</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FileId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FileName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FileSize &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> DateTime FileTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FileState &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="MailModel"><a href="#MailModel" class="headerlink" title="MailModel"></a>MailModel</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MailModel</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> UID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> To &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> ToName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CC &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CCName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Bcc &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> BccName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Subject &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> BodyText &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> List&lt;MailFile&gt; Attachment &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> DateTime Date &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件下载类</title>
      <link href="2023/07/17/FileDownHelper/"/>
      <url>2023/07/17/FileDownHelper/</url>
      
        <content type="html"><![CDATA[<h1 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> FileDownHelper</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：文件下载类</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FileDownHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 参数为虚拟路径</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">FileNameExtension</span>(<span class="params"><span class="built_in">string</span> FileName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Path.GetExtension(MapPathFile(FileName));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取物理地址</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">MapPathFile</span>(<span class="params"><span class="built_in">string</span> FileName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> HttpContext.Current.Server.MapPath(FileName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 验证文件是否存在</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;FileName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">FileExists</span>(<span class="params"><span class="built_in">string</span> FileName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> destFileName = FileName;</span><br><span class="line">        <span class="keyword">if</span> (File.Exists(destFileName))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 普通下载</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;FileName&quot;&gt;</span>文件虚拟路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>  <span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;name&quot;&gt;</span>返回客户端名称<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DownLoadold</span>(<span class="params"><span class="built_in">string</span> FileName, <span class="built_in">string</span> name</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> destFileName = FileName;</span><br><span class="line">        <span class="keyword">if</span> (File.Exists(destFileName))</span><br><span class="line">        &#123;</span><br><span class="line">            FileInfo fi = <span class="keyword">new</span> FileInfo(destFileName);</span><br><span class="line">            HttpContext.Current.Response.Clear();</span><br><span class="line">            HttpContext.Current.Response.ClearHeaders();</span><br><span class="line">            HttpContext.Current.Response.Buffer = <span class="literal">false</span>;</span><br><span class="line">            HttpContext.Current.Response.AppendHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span> + HttpUtility.UrlEncode(name, System.Text.Encoding.UTF8));</span><br><span class="line">            HttpContext.Current.Response.AppendHeader(<span class="string">&quot;Content-Length&quot;</span>, fi.Length.ToString());</span><br><span class="line">            HttpContext.Current.Response.ContentType = <span class="string">&quot;application/octet-stream&quot;</span>;</span><br><span class="line">            HttpContext.Current.Response.WriteFile(destFileName);</span><br><span class="line">            HttpContext.Current.Response.Flush();</span><br><span class="line">            HttpContext.Current.Response.End();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 分块下载</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;FileName&quot;&gt;</span>文件虚拟路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DownLoad</span>(<span class="params"><span class="built_in">string</span> FileName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> filePath = MapPathFile(FileName);</span><br><span class="line">        <span class="built_in">long</span> chunkSize = <span class="number">204800</span>;             <span class="comment">//指定块大小 </span></span><br><span class="line">        <span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[chunkSize]; <span class="comment">//建立一个200K的缓冲区 </span></span><br><span class="line">        <span class="built_in">long</span> dataToRead = <span class="number">0</span>;                 <span class="comment">//已读的字节数   </span></span><br><span class="line">        FileStream stream = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//打开文件   </span></span><br><span class="line">            stream = <span class="keyword">new</span> FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read);</span><br><span class="line">            dataToRead = stream.Length;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//添加Http头   </span></span><br><span class="line">            HttpContext.Current.Response.ContentType = <span class="string">&quot;application/octet-stream&quot;</span>;</span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachement;filename=&quot;</span> + HttpUtility.UrlEncode(Path.GetFileName(filePath)));</span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Length&quot;</span>, dataToRead.ToString());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (dataToRead &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (HttpContext.Current.Response.IsClientConnected)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> length = stream.Read(buffer, <span class="number">0</span>, Convert.ToInt32(chunkSize));</span><br><span class="line">                    HttpContext.Current.Response.OutputStream.Write(buffer, <span class="number">0</span>, length);</span><br><span class="line">                    HttpContext.Current.Response.Flush();</span><br><span class="line">                    HttpContext.Current.Response.Clear();</span><br><span class="line">                    dataToRead -= length;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dataToRead = <span class="number">-1</span>; <span class="comment">//防止client失去连接 </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            HttpContext.Current.Response.Write(<span class="string">&quot;Error:&quot;</span> + ex.Message);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (stream != <span class="literal">null</span>) stream.Close();</span><br><span class="line">            HttpContext.Current.Response.Close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 下载文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filename&quot;&gt;</span>文件名称<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DownLoadString</span>(<span class="params"><span class="built_in">string</span> content, <span class="built_in">string</span> filename</span>)</span> &#123;</span><br><span class="line">        MemoryStream stream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">        <span class="built_in">byte</span>[] byteArray = System.Text.Encoding.UTF8.GetBytes(content);</span><br><span class="line">        stream.Write(byteArray,<span class="number">0</span>, byteArray.Length);</span><br><span class="line">        stream.Position = <span class="number">0</span>;</span><br><span class="line">        DownLoad(stream, filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 下载文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filename&quot;&gt;</span>文件名称<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DownLoadBase64</span>(<span class="params"><span class="built_in">string</span> content, <span class="built_in">string</span> filename</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">byte</span>[] arr = Convert.FromBase64String(content);</span><br><span class="line">        MemoryStream ms = <span class="keyword">new</span> MemoryStream(arr);</span><br><span class="line">        DownLoad(ms, filename);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 分块下载</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;stream&quot;&gt;</span>文件流<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filename&quot;&gt;</span>文件名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DownLoad</span>(<span class="params">MemoryStream stream, <span class="built_in">string</span> filename</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">long</span> chunkSize = <span class="number">204800</span>;             <span class="comment">//指定块大小 </span></span><br><span class="line">        <span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[chunkSize]; <span class="comment">//建立一个200K的缓冲区 </span></span><br><span class="line">        <span class="built_in">long</span> dataToRead = <span class="number">0</span>;                 <span class="comment">//已读的字节数   </span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            dataToRead = stream.Length;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//添加Http头   </span></span><br><span class="line">            HttpContext.Current.Response.ContentType = <span class="string">&quot;application/octet-stream&quot;</span>;</span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachement;filename=&quot;</span> + filename);</span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Length&quot;</span>, dataToRead.ToString());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (dataToRead &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (HttpContext.Current.Response.IsClientConnected)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> length = stream.Read(buffer, <span class="number">0</span>, Convert.ToInt32(chunkSize));</span><br><span class="line">                    HttpContext.Current.Response.OutputStream.Write(buffer, <span class="number">0</span>, length);</span><br><span class="line">                    HttpContext.Current.Response.Flush();</span><br><span class="line">                    HttpContext.Current.Response.Clear();</span><br><span class="line">                    dataToRead -= length;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dataToRead = <span class="number">-1</span>; <span class="comment">//防止client失去连接 </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            HttpContext.Current.Response.Write(<span class="string">&quot;Error:&quot;</span> + ex.Message);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (stream != <span class="literal">null</span>) stream.Close();</span><br><span class="line">            HttpContext.Current.Response.Close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 下载文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>物理地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DownLoadnew</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">long</span> chunkSize = <span class="number">204800</span>;             <span class="comment">//指定块大小 </span></span><br><span class="line">        <span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[chunkSize]; <span class="comment">//建立一个200K的缓冲区 </span></span><br><span class="line">        <span class="built_in">long</span> dataToRead = <span class="number">0</span>;                 <span class="comment">//已读的字节数   </span></span><br><span class="line">        FileStream stream = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//打开文件   </span></span><br><span class="line">            stream = <span class="keyword">new</span> FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read);</span><br><span class="line">            dataToRead = stream.Length;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//添加Http头   </span></span><br><span class="line">            HttpContext.Current.Response.ContentType = <span class="string">&quot;application/octet-stream&quot;</span>;</span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachement;filename=&quot;</span> + HttpUtility.UrlEncode(Path.GetFileName(filePath)));</span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Length&quot;</span>, dataToRead.ToString());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (dataToRead &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (HttpContext.Current.Response.IsClientConnected)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> length = stream.Read(buffer, <span class="number">0</span>, Convert.ToInt32(chunkSize));</span><br><span class="line">                    HttpContext.Current.Response.OutputStream.Write(buffer, <span class="number">0</span>, length);</span><br><span class="line">                    HttpContext.Current.Response.Flush();</span><br><span class="line">                    HttpContext.Current.Response.Clear();</span><br><span class="line">                    dataToRead -= length;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dataToRead = <span class="number">-1</span>; <span class="comment">//防止client失去连接 </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            HttpContext.Current.Response.Write(<span class="string">&quot;Error:&quot;</span> + ex.Message);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (stream != <span class="literal">null</span>) stream.Close();</span><br><span class="line">            HttpContext.Current.Response.Close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>  输出硬盘文件，提供下载 支持大文件、续传、速度限制、资源占用小</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;_Request&quot;&gt;</span>Page.Request对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;_Response&quot;&gt;</span>Page.Response对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;_fileName&quot;&gt;</span>下载文件名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;_fullPath&quot;&gt;</span>带文件名下载路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;_speed&quot;&gt;</span>每秒允许下载的字节数<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回是否成功<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="comment">//---------------------------------------------------------------------</span></span><br><span class="line">    <span class="comment">//调用：</span></span><br><span class="line">    <span class="comment">// string FullPath=Server.MapPath(&quot;count.txt&quot;);</span></span><br><span class="line">    <span class="comment">// ResponseFile(this.Request,this.Response,&quot;count.txt&quot;,FullPath,100);</span></span><br><span class="line">    <span class="comment">//---------------------------------------------------------------------</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">ResponseFile</span>(<span class="params">HttpRequest _Request, HttpResponse _Response, <span class="built_in">string</span> _fileName, <span class="built_in">string</span> _fullPath, <span class="built_in">long</span> _speed</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            FileStream myFile = <span class="keyword">new</span> FileStream(_fullPath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);</span><br><span class="line">            BinaryReader br = <span class="keyword">new</span> BinaryReader(myFile);</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                _Response.AddHeader(<span class="string">&quot;Accept-Ranges&quot;</span>, <span class="string">&quot;bytes&quot;</span>);</span><br><span class="line">                _Response.Buffer = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">long</span> fileLength = myFile.Length;</span><br><span class="line">                <span class="built_in">long</span> startBytes = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">int</span> pack = <span class="number">10240</span>;  <span class="comment">//10K bytes</span></span><br><span class="line">                <span class="built_in">int</span> sleep = (<span class="built_in">int</span>)Math.Floor((<span class="built_in">double</span>)(<span class="number">1000</span> * pack / _speed)) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (_Request.Headers[<span class="string">&quot;Range&quot;</span>] != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    _Response.StatusCode = <span class="number">206</span>;</span><br><span class="line">                    <span class="built_in">string</span>[] range = _Request.Headers[<span class="string">&quot;Range&quot;</span>].Split(<span class="keyword">new</span> <span class="built_in">char</span>[] &#123; <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;-&#x27;</span> &#125;);</span><br><span class="line">                    startBytes = Convert.ToInt64(range[<span class="number">1</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">                _Response.AddHeader(<span class="string">&quot;Content-Length&quot;</span>, (fileLength - startBytes).ToString());</span><br><span class="line">                <span class="keyword">if</span> (startBytes != <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    _Response.AddHeader(<span class="string">&quot;Content-Range&quot;</span>, <span class="built_in">string</span>.Format(<span class="string">&quot; bytes &#123;0&#125;-&#123;1&#125;/&#123;2&#125;&quot;</span>, startBytes, fileLength - <span class="number">1</span>, fileLength));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                _Response.AddHeader(<span class="string">&quot;Connection&quot;</span>, <span class="string">&quot;Keep-Alive&quot;</span>);</span><br><span class="line">                _Response.ContentType = <span class="string">&quot;application/octet-stream&quot;</span>;</span><br><span class="line">                _Response.AddHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span> + HttpUtility.UrlEncode(_fileName, System.Text.Encoding.UTF8));</span><br><span class="line"></span><br><span class="line">                br.BaseStream.Seek(startBytes, SeekOrigin.Begin);</span><br><span class="line">                <span class="built_in">int</span> maxCount = (<span class="built_in">int</span>)Math.Floor((<span class="built_in">double</span>)((fileLength - startBytes) / pack)) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; maxCount; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (_Response.IsClientConnected)</span><br><span class="line">                    &#123;</span><br><span class="line">                        _Response.BinaryWrite(br.ReadBytes(pack));</span><br><span class="line">                        Thread.Sleep(sleep);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        i = maxCount;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            catch</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line">                br.Close();</span><br><span class="line">                myFile.Close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 小程序下载文件，对图片采取内联形式</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>物理地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileExt&quot;&gt;</span>文件扩展名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DownLoadWx</span>(<span class="params"><span class="built_in">string</span> filePath, <span class="built_in">string</span> fileExt = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">long</span> chunkSize = <span class="number">204800</span>;             <span class="comment">//指定块大小 </span></span><br><span class="line">        <span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[chunkSize]; <span class="comment">//建立一个200K的缓冲区 </span></span><br><span class="line">        <span class="built_in">long</span> dataToRead = <span class="number">0</span>;                 <span class="comment">//已读的字节数   </span></span><br><span class="line">        FileStream stream = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//打开文件   </span></span><br><span class="line">            stream = <span class="keyword">new</span> FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read);</span><br><span class="line">            dataToRead = stream.Length;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> (fileExt?.ToLower())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;jpg&quot;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;jpeg&quot;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;bmp&quot;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;gif&quot;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;png&quot;</span>:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;webp&quot;</span>:</span><br><span class="line">                    HttpContext.Current.Response.ContentType = <span class="string">&quot;image/jpeg&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    HttpContext.Current.Response.ContentType = <span class="string">&quot;application/octet-stream&quot;</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//添加Http头   </span></span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Length&quot;</span>, dataToRead.ToString());</span><br><span class="line">            HttpContext.Current.Response.AddHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachement;filename=&quot;</span> + HttpUtility.UrlEncode(Path.GetFileName(filePath)));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (dataToRead &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (HttpContext.Current.Response.IsClientConnected)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> length = stream.Read(buffer, <span class="number">0</span>, Convert.ToInt32(chunkSize));</span><br><span class="line">                    HttpContext.Current.Response.OutputStream.Write(buffer, <span class="number">0</span>, length);</span><br><span class="line">                    HttpContext.Current.Response.Flush();</span><br><span class="line">                    HttpContext.Current.Response.Clear();</span><br><span class="line">                    dataToRead -= length;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dataToRead = <span class="number">-1</span>; <span class="comment">//防止client失去连接 </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            HttpContext.Current.Response.Write(<span class="string">&quot;Error:&quot;</span> + ex.Message);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (stream != <span class="literal">null</span>) stream.Close();</span><br><span class="line">            HttpContext.Current.Response.Close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件夹文件操作类</title>
      <link href="2023/07/17/DirFileHelper/"/>
      <url>2023/07/17/DirFileHelper/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> DirFileHelper</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：文件夹文件操作类</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">DirFileHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 检测指定目录是否存在</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 检测指定目录是否存在</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>目录的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsExistDirectory</span>(<span class="params"><span class="built_in">string</span> directoryPath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Directory.Exists(directoryPath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取指定目录中的文件列表</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取指定目录中所有文件列表</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>指定目录的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span>[] <span class="title">GetFileNames</span>(<span class="params"><span class="built_in">string</span> directoryPath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//如果目录不存在，则抛出异常</span></span><br><span class="line">        <span class="keyword">if</span> (!IsExistDirectory(directoryPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FileNotFoundException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//获取文件列表</span></span><br><span class="line">        <span class="keyword">return</span> Directory.GetFiles(directoryPath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取指定目录中所有子目录列表</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取指定目录中所有子目录列表</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>指定目录的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span>[] <span class="title">GetDirectories</span>(<span class="params"><span class="built_in">string</span> directoryPath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//如果目录不存在，则抛出异常</span></span><br><span class="line">        <span class="keyword">if</span> (!IsExistDirectory(directoryPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FileNotFoundException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Directory.GetDirectories(directoryPath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取指定目录及子目录中所有文件列表(搜索)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取指定目录及子目录中所有文件列表</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>指定目录的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;searchPattern&quot;&gt;</span>模式字符串，&quot;*&quot;代表0或N个字符，&quot;?&quot;代表1个字符。</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 范例：&quot;Log*.xml&quot;表示搜索所有以Log开头的Xml文件。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isSearchChild&quot;&gt;</span>是否搜索子目录<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span>[] <span class="title">GetFileNames</span>(<span class="params"><span class="built_in">string</span> directoryPath, <span class="built_in">string</span> searchPattern, <span class="built_in">bool</span> isSearchChild</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//如果目录不存在，则抛出异常</span></span><br><span class="line">        <span class="keyword">if</span> (!IsExistDirectory(directoryPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FileNotFoundException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (isSearchChild)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> Directory.GetFiles(directoryPath, searchPattern, SearchOption.AllDirectories);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> Directory.GetFiles(directoryPath, searchPattern, SearchOption.TopDirectoryOnly);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (IOException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 根据时间获取指定路径目录下的 指定后缀名的 的所有文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 根据时间获取指定路径目录下的 指定后缀名的 的所有文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;path&quot;&gt;</span>文件路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Extension&quot;&gt;</span>后缀名 比如.txt<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataRow[] <span class="title">GetFilesByTime</span>(<span class="params"><span class="built_in">string</span> path, <span class="built_in">string</span> Extension</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Directory.Exists(path))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> fielExts = <span class="built_in">string</span>.Format(<span class="string">&quot;*&#123;0&#125;&quot;</span>, Extension);</span><br><span class="line">            <span class="built_in">string</span>[] files = Directory.GetFiles(path, fielExts);</span><br><span class="line">            <span class="keyword">if</span> (files.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                DataTable table = <span class="keyword">new</span> DataTable();</span><br><span class="line">                table.Columns.Add(<span class="keyword">new</span> DataColumn(<span class="string">&quot;filename&quot;</span>, Type.GetType(<span class="string">&quot;System.String&quot;</span>)));</span><br><span class="line">                table.Columns.Add(<span class="keyword">new</span> DataColumn(<span class="string">&quot;createtime&quot;</span>, Type.GetType(<span class="string">&quot;System.DateTime&quot;</span>)));</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; files.Length; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    DataRow row = table.NewRow();</span><br><span class="line">                    DateTime creationTime = System.IO.File.GetCreationTime(files[i]);</span><br><span class="line">                    <span class="built_in">string</span> fileName = Path.GetFileName(files[i]);</span><br><span class="line">                    row[<span class="string">&quot;filename&quot;</span>] = fileName;</span><br><span class="line">                    row[<span class="string">&quot;createtime&quot;</span>] = creationTime;</span><br><span class="line">                    table.Rows.Add(row);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> table.Select(<span class="built_in">string</span>.Empty, <span class="string">&quot;createtime desc&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataRow[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 检测指定目录中是否存在指定的文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 检测指定目录中是否存在指定的文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>指定目录的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;searchPattern&quot;&gt;</span>模式字符串，&quot;*&quot;代表0或N个字符，&quot;?&quot;代表1个字符。</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 范例：&quot;Log*.xml&quot;表示搜索所有以Log开头的Xml文件。<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isSearchChild&quot;&gt;</span>是否搜索子目录<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Contains</span>(<span class="params"><span class="built_in">string</span> directoryPath, <span class="built_in">string</span> searchPattern, <span class="built_in">bool</span> isSearchChild = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//获取指定的文件列表</span></span><br><span class="line">            <span class="built_in">string</span>[] fileNames = GetFileNames(directoryPath, searchPattern, isSearchChild);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//判断指定文件是否存在</span></span><br><span class="line">            <span class="keyword">if</span> (fileNames.Length == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(ex.Message);</span><br><span class="line">            <span class="comment">//LogHelper.WriteTraceLog(TraceLogLevel.Error, ex.Message);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 检测指定目录是否为空</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 检测指定目录是否为空</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>指定目录的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsEmptyDirectory</span>(<span class="params"><span class="built_in">string</span> directoryPath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//判断是否存在文件</span></span><br><span class="line">            <span class="built_in">string</span>[] fileNames = GetFileNames(directoryPath);</span><br><span class="line">            <span class="keyword">if</span> (fileNames.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//判断是否存在文件夹</span></span><br><span class="line">            <span class="built_in">string</span>[] directoryNames = GetDirectories(directoryPath);</span><br><span class="line">            <span class="keyword">if</span> (directoryNames.Length &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        catch</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//这里记录日志</span></span><br><span class="line">            <span class="comment">//LogHelper.WriteTraceLog(TraceLogLevel.Error, ex.Message);</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 创建目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 创建目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dir&quot;&gt;</span>要创建的目录路径包括目录名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CreateDir</span>(<span class="params"><span class="built_in">string</span> dir</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dir.Length == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (!Directory.Exists(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir))</span><br><span class="line">            Directory.CreateDirectory(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 删除目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 删除目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dir&quot;&gt;</span>要删除的目录路径和名称<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DeleteDir</span>(<span class="params"><span class="built_in">string</span> dir</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dir.Length == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (Directory.Exists(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir))</span><br><span class="line">            Directory.Delete(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 清空指定目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 清空指定目录下所有文件及子目录,但该目录依然保存.</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>指定目录的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ClearDirectory</span>(<span class="params"><span class="built_in">string</span> directoryPath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        directoryPath = HttpContext.Current.Server.MapPath(directoryPath);</span><br><span class="line">        <span class="keyword">if</span> (IsExistDirectory(directoryPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//删除目录中所有的文件</span></span><br><span class="line">            <span class="built_in">string</span>[] fileNames = GetFileNames(directoryPath);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; fileNames.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                DeleteFile(fileNames[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//删除目录中所有的子目录</span></span><br><span class="line">            <span class="built_in">string</span>[] directoryNames = GetDirectories(directoryPath);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; directoryNames.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                DeleteDir(directoryNames[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 复制文件夹</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 复制文件夹(递归)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;varFromDirectory&quot;&gt;</span>源文件夹路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;varToDirectory&quot;&gt;</span>目标文件夹路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CopyFolder</span>(<span class="params"><span class="built_in">string</span> varFromDirectory, <span class="built_in">string</span> varToDirectory</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Directory.CreateDirectory(varToDirectory);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!Directory.Exists(varFromDirectory)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span>[] directories = Directory.GetDirectories(varFromDirectory);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (directories.Length &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="built_in">string</span> d <span class="keyword">in</span> directories)</span><br><span class="line">            &#123;</span><br><span class="line">                CopyFolder(d, varToDirectory + d.Substring(d.LastIndexOf(<span class="string">&quot;\\&quot;</span>)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">string</span>[] files = Directory.GetFiles(varFromDirectory);</span><br><span class="line">        <span class="keyword">if</span> (files.Length &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="built_in">string</span> s <span class="keyword">in</span> files)</span><br><span class="line">            &#123;</span><br><span class="line">                System.IO.File.Copy(s, varToDirectory + s.Substring(s.LastIndexOf(<span class="string">&quot;\\&quot;</span>)), <span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 检测指定文件是否存在,如果存在返回true</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 检测指定文件是否存在,如果存在则返回true。</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsExistFile</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> File.Exists(filePath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>  检测指定文件是否存在,如果存在则返回true。</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的相对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsExistFileEx</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> rootPath = Assembly.GetExecutingAssembly().CodeBase.Replace(<span class="string">&quot;/bin/Learun.Util.DLL&quot;</span>, <span class="string">&quot;&quot;</span>).Replace(<span class="string">&quot;file:///&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> File.Exists(rootPath + filePath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 创建文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 创建文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dir&quot;&gt;</span>相对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;pagestr&quot;&gt;</span>文件内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CreateFile</span>(<span class="params"><span class="built_in">string</span> dir, <span class="built_in">string</span> pagestr</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        dir = dir.Replace(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;\\&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (dir.IndexOf(<span class="string">&quot;\\&quot;</span>) &gt; <span class="number">-1</span>)</span><br><span class="line">            CreateDir(dir.Substring(<span class="number">0</span>, dir.LastIndexOf(<span class="string">&quot;\\&quot;</span>)));</span><br><span class="line">        System.IO.StreamWriter sw = <span class="keyword">new</span> System.IO.StreamWriter(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir, <span class="literal">false</span>, System.Text.Encoding.GetEncoding(<span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">        sw.Write(pagestr);</span><br><span class="line">        sw.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 创建一个文件。</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CreateFile</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//如果文件不存在则创建该文件</span></span><br><span class="line">            <span class="keyword">if</span> (!IsExistFile(filePath))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//创建一个FileInfo对象</span></span><br><span class="line">                FileInfo file = <span class="keyword">new</span> FileInfo(filePath);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//创建文件</span></span><br><span class="line">                FileStream fs = file.Create();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//关闭文件流</span></span><br><span class="line">                fs.Close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//LogHelper.WriteTraceLog(TraceLogLevel.Error, ex.Message);</span></span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 创建一个文件,并将字节流写入文件。</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;buffer&quot;&gt;</span>二进制流数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CreateFile</span>(<span class="params"><span class="built_in">string</span> filePath, <span class="built_in">byte</span>[] buffer</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//如果文件不存在则创建该文件</span></span><br><span class="line">            <span class="keyword">if</span> (!IsExistFile(filePath))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//创建一个FileInfo对象</span></span><br><span class="line">                FileInfo file = <span class="keyword">new</span> FileInfo(filePath);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//创建文件</span></span><br><span class="line">                FileStream fs = file.Create();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//写入二进制流</span></span><br><span class="line">                fs.Write(buffer, <span class="number">0</span>, buffer.Length);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//关闭文件流</span></span><br><span class="line">                fs.Close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//LogHelper.WriteTraceLog(TraceLogLevel.Error, ex.Message);</span></span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 创建文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;path&quot;&gt;</span>绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CreateFileContent</span>(<span class="params"><span class="built_in">string</span> path, <span class="built_in">string</span> content</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        FileInfo fi = <span class="keyword">new</span> FileInfo(path);</span><br><span class="line">        <span class="keyword">var</span> di = fi.Directory;</span><br><span class="line">        <span class="keyword">if</span> (!di.Exists)</span><br><span class="line">        &#123;</span><br><span class="line">            di.Create();</span><br><span class="line">        &#125;</span><br><span class="line">        StreamWriter sw = <span class="keyword">new</span> StreamWriter(path, <span class="literal">false</span>, System.Text.Encoding.GetEncoding(<span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">        sw.Write(content);</span><br><span class="line">        sw.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 创建文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;path&quot;&gt;</span>绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;encoding&quot;&gt;</span>编码格式<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CreateFileContent</span>(<span class="params"><span class="built_in">string</span> path, <span class="built_in">string</span> content, <span class="built_in">string</span> encoding</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        FileInfo fi = <span class="keyword">new</span> FileInfo(path);</span><br><span class="line">        <span class="keyword">var</span> di = fi.Directory;</span><br><span class="line">        <span class="keyword">if</span> (!di.Exists)</span><br><span class="line">        &#123;</span><br><span class="line">            di.Create();</span><br><span class="line">        &#125;</span><br><span class="line">        StreamWriter sw = <span class="keyword">new</span> StreamWriter(path, <span class="literal">false</span>, System.Text.Encoding.GetEncoding(encoding));</span><br><span class="line">        sw.Write(content);</span><br><span class="line">        sw.Close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 删除文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 删除文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;file&quot;&gt;</span>要删除的文件路径和名称<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DeleteFile</span>(<span class="params"><span class="built_in">string</span> file</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (System.IO.File.Exists(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + file))</span><br><span class="line">        &#123;</span><br><span class="line">            System.IO.File.Delete(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 删除文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DeleteFile2</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (File.Exists(filePath))</span><br><span class="line">        &#123;</span><br><span class="line">            File.Delete(filePath);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 移动文件(剪贴--粘贴)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 移动文件(剪贴--粘贴)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dir1&quot;&gt;</span>要移动的文件的路径及全名(包括后缀)<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dir2&quot;&gt;</span>文件移动到新的位置,并指定新的文件名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MoveFile</span>(<span class="params"><span class="built_in">string</span> dir1, <span class="built_in">string</span> dir2</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        dir1 = dir1.Replace(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;\\&quot;</span>);</span><br><span class="line">        dir2 = dir2.Replace(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;\\&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (System.IO.File.Exists(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir1))</span><br><span class="line">            System.IO.File.Move(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir1, System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 复制文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 复制文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dir1&quot;&gt;</span>要复制的文件的路径已经全名(包括后缀)<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dir2&quot;&gt;</span>目标位置,并指定新的文件名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CopyFile</span>(<span class="params"><span class="built_in">string</span> dir1, <span class="built_in">string</span> dir2</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        dir1 = dir1.Replace(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;\\&quot;</span>);</span><br><span class="line">        dir2 = dir2.Replace(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;\\&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (System.IO.File.Exists(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir1))</span><br><span class="line">        &#123;</span><br><span class="line">            System.IO.File.Copy(System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir1, System.Web.HttpContext.Current.Request.PhysicalApplicationPath + <span class="string">&quot;\\&quot;</span> + dir2, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 检查文件,如果文件不存在则创建</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 检查文件,如果文件不存在则创建  </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;FilePath&quot;&gt;</span>路径,包括文件名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ExistsFile</span>(<span class="params"><span class="built_in">string</span> FilePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//if(!File.Exists(FilePath))    </span></span><br><span class="line">        <span class="comment">//File.Create(FilePath);    </span></span><br><span class="line">        <span class="comment">//以上写法会报错,详细解释请看下文.........   </span></span><br><span class="line">        <span class="keyword">if</span> (!System.IO.File.Exists(FilePath))</span><br><span class="line">        &#123;</span><br><span class="line">            FileStream fs = System.IO.File.Create(FilePath);</span><br><span class="line">            fs.Close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 删除指定文件夹对应其他文件夹里的文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 删除指定文件夹对应其他文件夹里的文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;varFromDirectory&quot;&gt;</span>指定文件夹路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;varToDirectory&quot;&gt;</span>对应其他文件夹路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DeleteFolderFiles</span>(<span class="params"><span class="built_in">string</span> varFromDirectory, <span class="built_in">string</span> varToDirectory</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Directory.CreateDirectory(varToDirectory);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!Directory.Exists(varFromDirectory)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span>[] directories = Directory.GetDirectories(varFromDirectory);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (directories.Length &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="built_in">string</span> d <span class="keyword">in</span> directories)</span><br><span class="line">            &#123;</span><br><span class="line">                DeleteFolderFiles(d, varToDirectory + d.Substring(d.LastIndexOf(<span class="string">&quot;\\&quot;</span>)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span>[] files = Directory.GetFiles(varFromDirectory);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (files.Length &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="built_in">string</span> s <span class="keyword">in</span> files)</span><br><span class="line">            &#123;</span><br><span class="line">                System.IO.File.Delete(varToDirectory + s.Substring(s.LastIndexOf(<span class="string">&quot;\\&quot;</span>)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 从文件的绝对路径中获取文件名( 包含扩展名 )</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 从文件的绝对路径中获取文件名( 包含扩展名 )</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetFileName</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//获取文件的名称</span></span><br><span class="line">        FileInfo fi = <span class="keyword">new</span> FileInfo(filePath);</span><br><span class="line">        <span class="keyword">return</span> fi.Name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 复制文件参考方法,页面中引用</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 复制文件参考方法,页面中引用</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;cDir&quot;&gt;</span>新路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;TempId&quot;&gt;</span>模板引擎替换编号<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CopyFiles</span>(<span class="params"><span class="built_in">string</span> cDir, <span class="built_in">string</span> TempId</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//if (Directory.Exists(Request.PhysicalApplicationPath + &quot;\\Controls&quot;))</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    string TempStr = string.Empty;</span></span><br><span class="line">        <span class="comment">//    StreamWriter sw;</span></span><br><span class="line">        <span class="comment">//    if (File.Exists(Request.PhysicalApplicationPath + &quot;\\Controls\\Default.aspx&quot;))</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        TempStr = File.ReadAllText(Request.PhysicalApplicationPath + &quot;\\Controls\\Default.aspx&quot;);</span></span><br><span class="line">        <span class="comment">//        TempStr = TempStr.Replace(&quot;&#123;$ChannelId$&#125;&quot;, TempId);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//        sw = new StreamWriter(Request.PhysicalApplicationPath + &quot;\\&quot; + cDir + &quot;\\Default.aspx&quot;, false, System.Text.Encoding.GetEncoding(&quot;GB2312&quot;));</span></span><br><span class="line">        <span class="comment">//        sw.Write(TempStr);</span></span><br><span class="line">        <span class="comment">//        sw.Close();</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    if (File.Exists(Request.PhysicalApplicationPath + &quot;\\Controls\\Column.aspx&quot;))</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        TempStr = File.ReadAllText(Request.PhysicalApplicationPath + &quot;\\Controls\\Column.aspx&quot;);</span></span><br><span class="line">        <span class="comment">//        TempStr = TempStr.Replace(&quot;&#123;$ChannelId$&#125;&quot;, TempId);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//        sw = new StreamWriter(Request.PhysicalApplicationPath + &quot;\\&quot; + cDir + &quot;\\List.aspx&quot;, false, System.Text.Encoding.GetEncoding(&quot;GB2312&quot;));</span></span><br><span class="line">        <span class="comment">//        sw.Write(TempStr);</span></span><br><span class="line">        <span class="comment">//        sw.Close();</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    if (File.Exists(Request.PhysicalApplicationPath + &quot;\\Controls\\Content.aspx&quot;))</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        TempStr = File.ReadAllText(Request.PhysicalApplicationPath + &quot;\\Controls\\Content.aspx&quot;);</span></span><br><span class="line">        <span class="comment">//        TempStr = TempStr.Replace(&quot;&#123;$ChannelId$&#125;&quot;, TempId);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//        sw = new StreamWriter(Request.PhysicalApplicationPath + &quot;\\&quot; + cDir + &quot;\\View.aspx&quot;, false, System.Text.Encoding.GetEncoding(&quot;GB2312&quot;));</span></span><br><span class="line">        <span class="comment">//        sw.Write(TempStr);</span></span><br><span class="line">        <span class="comment">//        sw.Close();</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    if (File.Exists(Request.PhysicalApplicationPath + &quot;\\Controls\\MoreDiss.aspx&quot;))</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        TempStr = File.ReadAllText(Request.PhysicalApplicationPath + &quot;\\Controls\\MoreDiss.aspx&quot;);</span></span><br><span class="line">        <span class="comment">//        TempStr = TempStr.Replace(&quot;&#123;$ChannelId$&#125;&quot;, TempId);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//        sw = new StreamWriter(Request.PhysicalApplicationPath + &quot;\\&quot; + cDir + &quot;\\DissList.aspx&quot;, false, System.Text.Encoding.GetEncoding(&quot;GB2312&quot;));</span></span><br><span class="line">        <span class="comment">//        sw.Write(TempStr);</span></span><br><span class="line">        <span class="comment">//        sw.Close();</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    if (File.Exists(Request.PhysicalApplicationPath + &quot;\\Controls\\ShowDiss.aspx&quot;))</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        TempStr = File.ReadAllText(Request.PhysicalApplicationPath + &quot;\\Controls\\ShowDiss.aspx&quot;);</span></span><br><span class="line">        <span class="comment">//        TempStr = TempStr.Replace(&quot;&#123;$ChannelId$&#125;&quot;, TempId);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//        sw = new StreamWriter(Request.PhysicalApplicationPath + &quot;\\&quot; + cDir + &quot;\\Diss.aspx&quot;, false, System.Text.Encoding.GetEncoding(&quot;GB2312&quot;));</span></span><br><span class="line">        <span class="comment">//        sw.Write(TempStr);</span></span><br><span class="line">        <span class="comment">//        sw.Close();</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    if (File.Exists(Request.PhysicalApplicationPath + &quot;\\Controls\\Review.aspx&quot;))</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        TempStr = File.ReadAllText(Request.PhysicalApplicationPath + &quot;\\Controls\\Review.aspx&quot;);</span></span><br><span class="line">        <span class="comment">//        TempStr = TempStr.Replace(&quot;&#123;$ChannelId$&#125;&quot;, TempId);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//        sw = new StreamWriter(Request.PhysicalApplicationPath + &quot;\\&quot; + cDir + &quot;\\Review.aspx&quot;, false, System.Text.Encoding.GetEncoding(&quot;GB2312&quot;));</span></span><br><span class="line">        <span class="comment">//        sw.Write(TempStr);</span></span><br><span class="line">        <span class="comment">//        sw.Close();</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    if (File.Exists(Request.PhysicalApplicationPath + &quot;\\Controls\\Search.aspx&quot;))</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        TempStr = File.ReadAllText(Request.PhysicalApplicationPath + &quot;\\Controls\\Search.aspx&quot;);</span></span><br><span class="line">        <span class="comment">//        TempStr = TempStr.Replace(&quot;&#123;$ChannelId$&#125;&quot;, TempId);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//        sw = new StreamWriter(Request.PhysicalApplicationPath + &quot;\\&quot; + cDir + &quot;\\Search.aspx&quot;, false, System.Text.Encoding.GetEncoding(&quot;GB2312&quot;));</span></span><br><span class="line">        <span class="comment">//        sw.Write(TempStr);</span></span><br><span class="line">        <span class="comment">//        sw.Close();</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取文本文件的行数</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取文本文件的行数</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">GetLineCount</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//将文本文件的各行读到一个字符串数组中</span></span><br><span class="line">        <span class="built_in">string</span>[] rows = System.IO.File.ReadAllLines(filePath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//返回行数</span></span><br><span class="line">        <span class="keyword">return</span> rows.Length;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取一个文件的长度</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取一个文件的长度,单位为Byte</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">GetFileSize</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//创建一个文件对象</span></span><br><span class="line">        FileInfo fi = <span class="keyword">new</span> FileInfo(filePath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取文件的大小</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">int</span>)fi.Length;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取指定目录中的子目录列表</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取指定目录及子目录中所有子目录列表</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;directoryPath&quot;&gt;</span>指定目录的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;searchPattern&quot;&gt;</span>模式字符串，&quot;*&quot;代表0或N个字符，&quot;?&quot;代表1个字符。</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 范例：&quot;Log*.xml&quot;表示搜索所有以Log开头的Xml文件。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isSearchChild&quot;&gt;</span>是否搜索子目录<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span>[] <span class="title">GetDirectories</span>(<span class="params"><span class="built_in">string</span> directoryPath, <span class="built_in">string</span> searchPattern, <span class="built_in">bool</span> isSearchChild</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (isSearchChild)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> Directory.GetDirectories(directoryPath, searchPattern, SearchOption.AllDirectories);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> Directory.GetDirectories(directoryPath, searchPattern, SearchOption.TopDirectoryOnly);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (IOException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 向文本文件写入内容</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 向文本文件中写入内容</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>写入的内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;encoding&quot;&gt;</span>编码<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">WriteText</span>(<span class="params"><span class="built_in">string</span> filePath, <span class="built_in">string</span> text, Encoding encoding</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//向文件写入内容</span></span><br><span class="line">        System.IO.File.WriteAllText(filePath, text, encoding);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 向文本文件的尾部追加内容</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 向文本文件的尾部追加内容</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>写入的内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AppendText</span>(<span class="params"><span class="built_in">string</span> filePath, <span class="built_in">string</span> content</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        System.IO.File.AppendAllText(filePath, content);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 将现有文件的内容复制到新文件中</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 将源文件的内容复制到目标文件中</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sourceFilePath&quot;&gt;</span>源文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;destFilePath&quot;&gt;</span>目标文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Copy</span>(<span class="params"><span class="built_in">string</span> sourceFilePath, <span class="built_in">string</span> destFilePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        System.IO.File.Copy(sourceFilePath, destFilePath, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 将文件移动到指定目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 将文件移动到指定目录</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sourceFilePath&quot;&gt;</span>需要移动的源文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;descDirectoryPath&quot;&gt;</span>移动到的目录的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Move</span>(<span class="params"><span class="built_in">string</span> sourceFilePath, <span class="built_in">string</span> descDirectoryPath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//获取源文件的名称</span></span><br><span class="line">        <span class="built_in">string</span> sourceFileName = GetFileName(sourceFilePath);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (IsExistDirectory(descDirectoryPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//如果目标中存在同名文件,则删除</span></span><br><span class="line">            <span class="keyword">if</span> (IsExistFile(descDirectoryPath + <span class="string">&quot;\\&quot;</span> + sourceFileName))</span><br><span class="line">            &#123;</span><br><span class="line">                DeleteFile(descDirectoryPath + <span class="string">&quot;\\&quot;</span> + sourceFileName);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//将文件移动到指定目录</span></span><br><span class="line">            System.IO.File.Move(sourceFilePath, descDirectoryPath + <span class="string">&quot;\\&quot;</span> + sourceFileName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 从文件的绝对路径中获取文件名( 不包含扩展名 )</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 从文件的绝对路径中获取文件名( 不包含扩展名 )</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetFileNameNoExtension</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//获取文件的名称</span></span><br><span class="line">        FileInfo fi = <span class="keyword">new</span> FileInfo(filePath);</span><br><span class="line">        <span class="keyword">return</span> fi.Name.Split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 从文件的绝对路径中获取扩展名</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 从文件的绝对路径中获取扩展名</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span>        </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetExtension</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//获取文件的名称</span></span><br><span class="line">        FileInfo fi = <span class="keyword">new</span> FileInfo(filePath);</span><br><span class="line">        <span class="keyword">return</span> fi.Extension;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 清空文件内容</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 清空文件内容</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件的绝对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ClearFile</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//删除文件</span></span><br><span class="line">        System.IO.File.Delete(filePath);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//重新创建该文件</span></span><br><span class="line">        CreateFile(filePath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 获取文件大小并以B，KB，GB，TB</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 计算文件大小函数(保留两位小数),Size为字节大小</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;size&quot;&gt;</span>初始文件大小<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToFileSize</span>(<span class="params"><span class="built_in">long</span> size</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> m_strSize = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="built_in">long</span> FactSize = <span class="number">0</span>;</span><br><span class="line">        FactSize = size;</span><br><span class="line">        <span class="keyword">if</span> (FactSize &lt; <span class="number">1024.00</span>)</span><br><span class="line">            m_strSize = FactSize.ToString(<span class="string">&quot;F2&quot;</span>) + <span class="string">&quot; 字节&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (FactSize &gt;= <span class="number">1024.00</span> &amp;&amp; FactSize &lt; <span class="number">1048576</span>)</span><br><span class="line">            m_strSize = (FactSize / <span class="number">1024.00</span>).ToString(<span class="string">&quot;F2&quot;</span>) + <span class="string">&quot; KB&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (FactSize &gt;= <span class="number">1048576</span> &amp;&amp; FactSize &lt; <span class="number">1073741824</span>)</span><br><span class="line">            m_strSize = (FactSize / <span class="number">1024.00</span> / <span class="number">1024.00</span>).ToString(<span class="string">&quot;F2&quot;</span>) + <span class="string">&quot; MB&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (FactSize &gt;= <span class="number">1073741824</span>)</span><br><span class="line">            m_strSize = (FactSize / <span class="number">1024.00</span> / <span class="number">1024.00</span> / <span class="number">1024.00</span>).ToString(<span class="string">&quot;F2&quot;</span>) + <span class="string">&quot; GB&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> m_strSize;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 返回绝对路径</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 返回绝对路径</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>相对路径<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetAbsolutePath</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> HttpContext.Current.Server.MapPath(filePath);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 读取文本文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 读取文本文件</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>文件地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ReadText</span>(<span class="params"><span class="built_in">string</span> filePath</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (File.Exists(filePath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> File.ReadAllText(filePath);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>验证扩展</title>
      <link href="2023/07/17/ExtensionsValidate/"/>
      <url>2023/07/17/ExtensionsValidate/</url>
      
        <content type="html"><![CDATA[<h1 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Extensions.Validate</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：验证扩展</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Extensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 检测空值,为null则抛出ArgumentNullException异常</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;obj&quot;&gt;</span>对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;parameterName&quot;&gt;</span>参数名<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CheckNull</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> obj, <span class="built_in">string</span> parameterName</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(parameterName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否为空</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsEmpty</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">string</span>.IsNullOrWhiteSpace(<span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否为空</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsEmpty</span>(<span class="params"><span class="keyword">this</span> Guid? <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">value</span> == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> IsEmpty(<span class="keyword">value</span>.Value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否为空</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsEmpty</span>(<span class="params"><span class="keyword">this</span> Guid <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">value</span> == Guid.Empty)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否为空</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsEmpty</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">value</span> != <span class="literal">null</span> &amp;&amp; !<span class="built_in">string</span>.IsNullOrEmpty(<span class="keyword">value</span>.ToString()))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>可空类型扩展</title>
      <link href="2023/07/17/ExtensionsNullable/"/>
      <url>2023/07/17/ExtensionsNullable/</url>
      
        <content type="html"><![CDATA[<h1 id="可空类型"><a href="#可空类型" class="headerlink" title="可空类型"></a>可空类型</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Extensions.Nullable</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 扩展 - 可空类型</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Extensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 安全返回值</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>可空值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> T <span class="title">SafeValue</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">this</span> T? <span class="keyword">value</span></span>) <span class="keyword">where</span> T : <span class="keyword">struct</span></span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">value</span> ?? <span class="literal">default</span>(T);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 是否包含</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;obj&quot;&gt;</span>字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>包含字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">ContainsEx</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> obj,<span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(obj))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> obj.Contains(<span class="keyword">value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 字串是否在指定字串中存在</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;obj&quot;&gt;</span>字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>被包含字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">Like</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> obj, <span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(<span class="keyword">value</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(obj))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span>.IndexOf(obj) != <span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>json序列反序列化扩展</title>
      <link href="2023/07/17/ExtensionsJson/"/>
      <url>2023/07/17/ExtensionsJson/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Extensions.Json</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：扩展.json序列反序列化</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Extensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转成json对象</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Json&quot;&gt;</span>json字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">ToJson</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> Json</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Json == <span class="literal">null</span> ? <span class="literal">null</span> : JsonConvert.DeserializeObject(Json);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转成json字串</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;obj&quot;&gt;</span>对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToJson</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> obj</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> timeConverter = <span class="keyword">new</span> IsoDateTimeConverter &#123; DateTimeFormat = <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span> &#125;;</span><br><span class="line">        <span class="keyword">return</span> JsonConvert.SerializeObject(obj, timeConverter);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转成json字串</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;obj&quot;&gt;</span>对象<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;datetimeformats&quot;&gt;</span>时间格式化<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToJson</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> obj, <span class="built_in">string</span> datetimeformats</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> timeConverter = <span class="keyword">new</span> IsoDateTimeConverter &#123; DateTimeFormat = datetimeformats &#125;;</span><br><span class="line">        <span class="keyword">return</span> JsonConvert.SerializeObject(obj, timeConverter);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 字串反序列化成指定对象实体</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;T&quot;&gt;</span>实体类型<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Json&quot;&gt;</span>字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> T <span class="title">ToObject</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> Json</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Json == <span class="literal">null</span> ? <span class="literal">default</span>(T) : JsonConvert.DeserializeObject&lt;T&gt;(Json);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 字串反序列化成指定对象实体(列表)</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;T&quot;&gt;</span>实体类型<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Json&quot;&gt;</span>字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">List</span>&lt;<span class="title">T</span>&gt; <span class="title">ToList</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> Json</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Json == <span class="literal">null</span> ? <span class="literal">null</span> : JsonConvert.DeserializeObject&lt;List&lt;T&gt;&gt;(Json);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 字串反序列化成DataTable</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Json&quot;&gt;</span>字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataTable <span class="title">ToTable</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> Json</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Json == <span class="literal">null</span> ? <span class="literal">null</span> : JsonConvert.DeserializeObject&lt;DataTable&gt;(Json);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 字串反序列化成linq对象</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Json&quot;&gt;</span>字串<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JObject <span class="title">ToJObject</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">string</span> Json</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Json == <span class="literal">null</span> ? JObject.Parse(<span class="string">&quot;&#123;&#125;&quot;</span>) : JObject.Parse(Json.Replace(<span class="string">&quot;&amp;nbsp;&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日期时间扩展</title>
      <link href="2023/07/17/ExtensionsDateTime/"/>
      <url>2023/07/17/ExtensionsDateTime/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Extensions.DateTime</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 日期时间扩展</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Extensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，带时分秒，格式：&quot;yyyy-MM-dd HH:mm:ss&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isRemoveSecond&quot;&gt;</span>是否移除秒<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToDateTimeString</span>(<span class="params"><span class="keyword">this</span> DateTime dateTime, <span class="built_in">bool</span> isRemoveSecond = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (isRemoveSecond)</span><br><span class="line">            <span class="keyword">return</span> dateTime.ToString(<span class="string">&quot;yyyy-MM-dd HH:mm&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dateTime.ToString(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，带时分秒，格式：&quot;yyyy-MM-dd HH:mm:ss&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isRemoveSecond&quot;&gt;</span>是否移除秒<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToDateTimeString</span>(<span class="params"><span class="keyword">this</span> DateTime? dateTime, <span class="built_in">bool</span> isRemoveSecond = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dateTime == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">return</span> ToDateTimeString(dateTime.Value, isRemoveSecond);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，不带时分秒，格式：&quot;yyyy-MM-dd&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToDateString</span>(<span class="params"><span class="keyword">this</span> DateTime dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> dateTime.ToString(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，不带时分秒，格式：&quot;yyyy-MM-dd&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToDateString</span>(<span class="params"><span class="keyword">this</span> DateTime? dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dateTime == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">return</span> ToDateString(dateTime.Value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，不带年月日，格式：&quot;HH:mm:ss&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToTimeString</span>(<span class="params"><span class="keyword">this</span> DateTime dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> dateTime.ToString(<span class="string">&quot;HH:mm:ss&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，不带年月日，格式：&quot;HH:mm:ss&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToTimeString</span>(<span class="params"><span class="keyword">this</span> DateTime? dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dateTime == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">return</span> ToTimeString(dateTime.Value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，带毫秒，格式：&quot;yyyy-MM-dd HH:mm:ss.fff&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToMillisecondString</span>(<span class="params"><span class="keyword">this</span> DateTime dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> dateTime.ToString(<span class="string">&quot;yyyy-MM-dd HH:mm:ss.fff&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，带毫秒，格式：&quot;yyyy-MM-dd HH:mm:ss.fff&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToMillisecondString</span>(<span class="params"><span class="keyword">this</span> DateTime? dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dateTime == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">return</span> ToMillisecondString(dateTime.Value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，不带时分秒，格式：&quot;yyyy年MM月dd日&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToChineseDateString</span>(<span class="params"><span class="keyword">this</span> DateTime dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">string</span>.Format(<span class="string">&quot;&#123;0&#125;年&#123;1&#125;月&#123;2&#125;日&quot;</span>, dateTime.Year, dateTime.Month, dateTime.Day);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，不带时分秒，格式：&quot;yyyy年MM月dd日&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToChineseDateString</span>(<span class="params"><span class="keyword">this</span> DateTime? dateTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dateTime == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">return</span> ToChineseDateString(dateTime.SafeValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，带时分秒，格式：&quot;yyyy年MM月dd日 HH时mm分&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isRemoveSecond&quot;&gt;</span>是否移除秒<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToChineseDateTimeString</span>(<span class="params"><span class="keyword">this</span> DateTime dateTime, <span class="built_in">bool</span> isRemoveSecond = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        result.AppendFormat(<span class="string">&quot;&#123;0&#125;年&#123;1&#125;月&#123;2&#125;日&quot;</span>, dateTime.Year, dateTime.Month, dateTime.Day);</span><br><span class="line">        result.AppendFormat(<span class="string">&quot; &#123;0&#125;时&#123;1&#125;分&quot;</span>, dateTime.Hour, dateTime.Minute);</span><br><span class="line">        <span class="keyword">if</span> (isRemoveSecond == <span class="literal">false</span>)</span><br><span class="line">            result.AppendFormat(<span class="string">&quot;&#123;0&#125;秒&quot;</span>, dateTime.Second);</span><br><span class="line">        <span class="keyword">return</span> result.ToString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取格式化字符串，带时分秒，格式：&quot;yyyy年MM月dd日 HH时mm分&quot;</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateTime&quot;&gt;</span>日期<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isRemoveSecond&quot;&gt;</span>是否移除秒<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToChineseDateTimeString</span>(<span class="params"><span class="keyword">this</span> DateTime? dateTime, <span class="built_in">bool</span> isRemoveSecond = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (dateTime == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">return</span> ToChineseDateTimeString(dateTime.Value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>类型转换</title>
      <link href="2023/07/17/ExtensionsConvert/"/>
      <url>2023/07/17/ExtensionsConvert/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>数值转换</td><td>——————————————</td></tr><tr><td>int ToInt(this object data)</td><td>转换为整型</td></tr><tr><td>int? ToIntOrNull(this object data)</td><td>转换为可空整型</td></tr><tr><td>double ToDouble(this object data)</td><td>转换为双精度浮点数</td></tr><tr><td>double ToDouble(this object data, int digits)</td><td>转换为双精度浮点数,并按指定的小数位4舍5入</td></tr><tr><td>double? ToDoubleOrNull(this object data)</td><td>转换为可空双精度浮点数</td></tr><tr><td>decimal ToDecimal(this object data)</td><td>转换为高精度浮点数</td></tr><tr><td>decimal ToDecimal(this  object data, int digits)</td><td>转换为高精度浮点数,并按指定的小数位4舍5入</td></tr><tr><td>decimal? ToDecimalOrNull(this  object data)</td><td>转换为可空高精度浮点数</td></tr><tr><td>decimal? ToDecimalOrNull(this object data, int digits)</td><td>转换为可空高精度浮点数,并按指定的小数位4舍5入</td></tr><tr><td>日期转换</td><td>——————————————</td></tr><tr><td>DateTime ToDate(this object data)</td><td>转换为日期</td></tr><tr><td>DateTime? ToDateOrNull(this object data)</td><td>转换为可空日期</td></tr><tr><td>布尔转换</td><td>——————————————</td></tr><tr><td>bool ToBool(this object data)</td><td>转换为布尔值</td></tr><tr><td>bool? GetBool(this object data)</td><td>获取布尔值</td></tr><tr><td>bool? ToBoolOrNull(this object data)</td><td>转换为可空布尔值</td></tr><tr><td>字符串转换</td><td>——————————————</td></tr><tr><td>string ToString(this object data)</td><td>转换为字符串</td></tr></tbody></table><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>Extensions.Convert</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 描 述：类型转换扩展</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Extensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 数值转换</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为整型</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">ToInt</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> data</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">int</span> result;</span><br><span class="line">        <span class="keyword">var</span> success = <span class="built_in">int</span>.TryParse(data.ToString(), <span class="keyword">out</span> result);</span><br><span class="line">        <span class="keyword">if</span> (success)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Convert.ToInt32(ToDouble(data, <span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为可空整型</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span>? ToIntOrNull(<span class="keyword">this</span> <span class="built_in">object</span> data)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">int</span> result;</span><br><span class="line">        <span class="built_in">bool</span> isValid = <span class="built_in">int</span>.TryParse(data.ToString(), <span class="keyword">out</span> result);</span><br><span class="line">        <span class="keyword">if</span> (isValid)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为双精度浮点数</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">ToDouble</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> data</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">double</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">double</span>.TryParse(data.ToString(), <span class="keyword">out</span> result) ? result : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为双精度浮点数,并按指定的小数位4舍5入</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;digits&quot;&gt;</span>小数位数<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">ToDouble</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> data, <span class="built_in">int</span> digits</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.Round(ToDouble(data), digits);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为可空双精度浮点数</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span>? ToDoubleOrNull(<span class="keyword">this</span> <span class="built_in">object</span> data)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">double</span> result;</span><br><span class="line">        <span class="built_in">bool</span> isValid = <span class="built_in">double</span>.TryParse(data.ToString(), <span class="keyword">out</span> result);</span><br><span class="line">        <span class="keyword">if</span> (isValid)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为高精度浮点数</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">decimal</span> <span class="title">ToDecimal</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> data</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">decimal</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">decimal</span>.TryParse(data.ToString(), <span class="keyword">out</span> result) ? result : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为高精度浮点数,并按指定的小数位4舍5入</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;digits&quot;&gt;</span>小数位数<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">decimal</span> <span class="title">ToDecimal</span>(<span class="params"><span class="keyword">this</span>  <span class="built_in">object</span> data, <span class="built_in">int</span> digits</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.Round(ToDecimal(data), digits);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为可空高精度浮点数</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">decimal</span>? ToDecimalOrNull(<span class="keyword">this</span>  <span class="built_in">object</span> data)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">decimal</span> result;</span><br><span class="line">        <span class="built_in">bool</span> isValid = <span class="built_in">decimal</span>.TryParse(data.ToString(), <span class="keyword">out</span> result);</span><br><span class="line">        <span class="keyword">if</span> (isValid)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为可空高精度浮点数,并按指定的小数位4舍5入</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;digits&quot;&gt;</span>小数位数<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">decimal</span>? ToDecimalOrNull(<span class="keyword">this</span> <span class="built_in">object</span> data, <span class="built_in">int</span> digits)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> result = ToDecimalOrNull(data);</span><br><span class="line">        <span class="keyword">if</span> (result == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> Math.Round(result.Value, digits);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 日期转换</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为日期</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DateTime <span class="title">ToDate</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> data</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> DateTime.MinValue;</span><br><span class="line">        DateTime result;</span><br><span class="line">        <span class="keyword">return</span> DateTime.TryParse(data.ToString(), <span class="keyword">out</span> result) ? result : DateTime.MinValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为可空日期</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DateTime? ToDateOrNull(<span class="keyword">this</span> <span class="built_in">object</span> data)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        DateTime result;</span><br><span class="line">        <span class="built_in">bool</span> isValid = DateTime.TryParse(data.ToString(), <span class="keyword">out</span> result);</span><br><span class="line">        <span class="keyword">if</span> (isValid)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 布尔转换</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为布尔值</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">ToBool</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> data</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">bool</span>? <span class="keyword">value</span> = GetBool(data);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">value</span> != <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">value</span>.Value;</span><br><span class="line">        <span class="built_in">bool</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bool</span>.TryParse(data.ToString(), <span class="keyword">out</span> result) &amp;&amp; result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取布尔值</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span>? GetBool(<span class="keyword">this</span> <span class="built_in">object</span> data)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (data.ToString().Trim().ToLower())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;0&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;是&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;否&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;yes&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;no&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="literal">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为可空布尔值</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span>? ToBoolOrNull(<span class="keyword">this</span> <span class="built_in">object</span> data)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="built_in">bool</span>? <span class="keyword">value</span> = GetBool(data);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">value</span> != <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">value</span>.Value;</span><br><span class="line">        <span class="built_in">bool</span> result;</span><br><span class="line">        <span class="built_in">bool</span> isValid = <span class="built_in">bool</span>.TryParse(data.ToString(), <span class="keyword">out</span> result);</span><br><span class="line">        <span class="keyword">if</span> (isValid)</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 字符串转换</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 转换为字符串</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToString</span>(<span class="params"><span class="keyword">this</span> <span class="built_in">object</span> data</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> data == <span class="literal">null</span> ? <span class="built_in">string</span>.Empty : data.ToString().Trim();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET扩展 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.gitignore通用模板</title>
      <link href="2023/07/13/gitignore/"/>
      <url>2023/07/13/gitignore/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br></pre></td><td class="code"><pre><span class="line">## Ignore Visual Studio temporary files, build results, and</span><br><span class="line">## files generated by popular Visual Studio add-ons.</span><br><span class="line">##</span><br><span class="line">## Get latest from https:&#x2F;&#x2F;github.com&#x2F;github&#x2F;gitignore&#x2F;blob&#x2F;master&#x2F;VisualStudio.gitignore</span><br><span class="line"></span><br><span class="line"># User-specific files</span><br><span class="line">*.rsuser</span><br><span class="line">*.suo</span><br><span class="line">*.user</span><br><span class="line">*.userosscache</span><br><span class="line">*.sln.docstates</span><br><span class="line"></span><br><span class="line"># User-specific files (MonoDevelop&#x2F;Xamarin Studio)</span><br><span class="line">*.userprefs</span><br><span class="line"></span><br><span class="line"># Mono auto generated files</span><br><span class="line">mono_crash.*</span><br><span class="line"></span><br><span class="line"># Build results</span><br><span class="line">[Dd]ebug&#x2F;</span><br><span class="line">[Dd]ebugPublic&#x2F;</span><br><span class="line">[Rr]elease&#x2F;</span><br><span class="line">[Rr]eleases&#x2F;</span><br><span class="line">x64&#x2F;</span><br><span class="line">x86&#x2F;</span><br><span class="line">[Ww][Ii][Nn]32&#x2F;</span><br><span class="line">[Aa][Rr][Mm]&#x2F;</span><br><span class="line">[Aa][Rr][Mm]64&#x2F;</span><br><span class="line">bld&#x2F;</span><br><span class="line">[Bb]in&#x2F;</span><br><span class="line">[Oo]bj&#x2F;</span><br><span class="line">[Oo]ut&#x2F;</span><br><span class="line">[Ll]og&#x2F;</span><br><span class="line">[Ll]ogs&#x2F;</span><br><span class="line"></span><br><span class="line"># Visual Studio 2015&#x2F;2017 cache&#x2F;options directory</span><br><span class="line">.vs&#x2F;</span><br><span class="line"># Uncomment if you have tasks that create the project&#39;s static files in wwwroot</span><br><span class="line">#wwwroot&#x2F;</span><br><span class="line"></span><br><span class="line"># Visual Studio 2017 auto generated files</span><br><span class="line">Generated\ Files&#x2F;</span><br><span class="line"></span><br><span class="line"># MSTest test Results</span><br><span class="line">[Tt]est[Rr]esult*&#x2F;</span><br><span class="line">[Bb]uild[Ll]og.*</span><br><span class="line"></span><br><span class="line"># NUnit</span><br><span class="line">*.VisualState.xml</span><br><span class="line">TestResult.xml</span><br><span class="line">nunit-*.xml</span><br><span class="line"></span><br><span class="line"># Build Results of an ATL Project</span><br><span class="line">[Dd]ebugPS&#x2F;</span><br><span class="line">[Rr]eleasePS&#x2F;</span><br><span class="line">dlldata.c</span><br><span class="line"></span><br><span class="line"># Benchmark Results</span><br><span class="line">BenchmarkDotNet.Artifacts&#x2F;</span><br><span class="line"></span><br><span class="line"># .NET Core</span><br><span class="line">project.lock.json</span><br><span class="line">project.fragment.lock.json</span><br><span class="line">artifacts&#x2F;</span><br><span class="line"></span><br><span class="line"># ASP.NET Scaffolding</span><br><span class="line">ScaffoldingReadMe.txt</span><br><span class="line"></span><br><span class="line"># StyleCop</span><br><span class="line">StyleCopReport.xml</span><br><span class="line"></span><br><span class="line"># Files built by Visual Studio</span><br><span class="line">*_i.c</span><br><span class="line">*_p.c</span><br><span class="line">*_h.h</span><br><span class="line">*.ilk</span><br><span class="line">*.meta</span><br><span class="line">*.obj</span><br><span class="line">*.iobj</span><br><span class="line">*.pch</span><br><span class="line">*.pdb</span><br><span class="line">*.ipdb</span><br><span class="line">*.pgc</span><br><span class="line">*.pgd</span><br><span class="line">*.rsp</span><br><span class="line">*.sbr</span><br><span class="line">*.tlb</span><br><span class="line">*.tli</span><br><span class="line">*.tlh</span><br><span class="line">*.tmp</span><br><span class="line">*.tmp_proj</span><br><span class="line">*_wpftmp.csproj</span><br><span class="line">*.log</span><br><span class="line">*.vspscc</span><br><span class="line">*.vssscc</span><br><span class="line">.builds</span><br><span class="line">*.pidb</span><br><span class="line">*.svclog</span><br><span class="line">*.scc</span><br><span class="line"></span><br><span class="line"># Chutzpah Test files</span><br><span class="line">_Chutzpah*</span><br><span class="line"></span><br><span class="line"># Visual C++ cache files</span><br><span class="line">ipch&#x2F;</span><br><span class="line">*.aps</span><br><span class="line">*.ncb</span><br><span class="line">*.opendb</span><br><span class="line">*.opensdf</span><br><span class="line">*.sdf</span><br><span class="line">*.cachefile</span><br><span class="line">*.VC.db</span><br><span class="line">*.VC.VC.opendb</span><br><span class="line"></span><br><span class="line"># Visual Studio profiler</span><br><span class="line">*.psess</span><br><span class="line">*.vsp</span><br><span class="line">*.vspx</span><br><span class="line">*.sap</span><br><span class="line"></span><br><span class="line"># Visual Studio Trace Files</span><br><span class="line">*.e2e</span><br><span class="line"></span><br><span class="line"># TFS 2012 Local Workspace</span><br><span class="line">$tf&#x2F;</span><br><span class="line"></span><br><span class="line"># Guidance Automation Toolkit</span><br><span class="line">*.gpState</span><br><span class="line"></span><br><span class="line"># ReSharper is a .NET coding add-in</span><br><span class="line">_ReSharper*&#x2F;</span><br><span class="line">*.[Rr]e[Ss]harper</span><br><span class="line">*.DotSettings.user</span><br><span class="line"></span><br><span class="line"># TeamCity is a build add-in</span><br><span class="line">_TeamCity*</span><br><span class="line"></span><br><span class="line"># DotCover is a Code Coverage Tool</span><br><span class="line">*.dotCover</span><br><span class="line"></span><br><span class="line"># AxoCover is a Code Coverage Tool</span><br><span class="line">.axoCover&#x2F;*</span><br><span class="line">!.axoCover&#x2F;settings.json</span><br><span class="line"></span><br><span class="line"># Coverlet is a free, cross platform Code Coverage Tool</span><br><span class="line">coverage*.json</span><br><span class="line">coverage*.xml</span><br><span class="line">coverage*.info</span><br><span class="line"></span><br><span class="line"># Visual Studio code coverage results</span><br><span class="line">*.coverage</span><br><span class="line">*.coveragexml</span><br><span class="line"></span><br><span class="line"># NCrunch</span><br><span class="line">_NCrunch_*</span><br><span class="line">.*crunch*.local.xml</span><br><span class="line">nCrunchTemp_*</span><br><span class="line"></span><br><span class="line"># MightyMoose</span><br><span class="line">*.mm.*</span><br><span class="line">AutoTest.Net&#x2F;</span><br><span class="line"></span><br><span class="line"># Web workbench (sass)</span><br><span class="line">.sass-cache&#x2F;</span><br><span class="line"></span><br><span class="line"># Installshield output folder</span><br><span class="line">[Ee]xpress&#x2F;</span><br><span class="line"></span><br><span class="line"># DocProject is a documentation generator add-in</span><br><span class="line">DocProject&#x2F;buildhelp&#x2F;</span><br><span class="line">DocProject&#x2F;Help&#x2F;*.HxT</span><br><span class="line">DocProject&#x2F;Help&#x2F;*.HxC</span><br><span class="line">DocProject&#x2F;Help&#x2F;*.hhc</span><br><span class="line">DocProject&#x2F;Help&#x2F;*.hhk</span><br><span class="line">DocProject&#x2F;Help&#x2F;*.hhp</span><br><span class="line">DocProject&#x2F;Help&#x2F;Html2</span><br><span class="line">DocProject&#x2F;Help&#x2F;html</span><br><span class="line"></span><br><span class="line"># Click-Once directory</span><br><span class="line">publish&#x2F;</span><br><span class="line"></span><br><span class="line"># Publish Web Output</span><br><span class="line">*.[Pp]ublish.xml</span><br><span class="line">*.azurePubxml</span><br><span class="line"># Note: Comment the next line if you want to checkin your web deploy settings,</span><br><span class="line"># but database connection strings (with potential passwords) will be unencrypted</span><br><span class="line">*.pubxml</span><br><span class="line">*.publishproj</span><br><span class="line"></span><br><span class="line"># Microsoft Azure Web App publish settings. Comment the next line if you want to</span><br><span class="line"># checkin your Azure Web App publish settings, but sensitive information contained</span><br><span class="line"># in these scripts will be unencrypted</span><br><span class="line">PublishScripts&#x2F;</span><br><span class="line"></span><br><span class="line"># NuGet Packages</span><br><span class="line">*.nupkg</span><br><span class="line"># NuGet Symbol Packages</span><br><span class="line">*.snupkg</span><br><span class="line"># The packages folder can be ignored because of Package Restore</span><br><span class="line">**&#x2F;[Pp]ackages&#x2F;*</span><br><span class="line"># except build&#x2F;, which is used as an MSBuild target.</span><br><span class="line">!**&#x2F;[Pp]ackages&#x2F;build&#x2F;</span><br><span class="line"># Uncomment if necessary however generally it will be regenerated when needed</span><br><span class="line">#!**&#x2F;[Pp]ackages&#x2F;repositories.config</span><br><span class="line"># NuGet v3&#39;s project.json files produces more ignorable files</span><br><span class="line">*.nuget.props</span><br><span class="line">*.nuget.targets</span><br><span class="line"></span><br><span class="line"># Microsoft Azure Build Output</span><br><span class="line">csx&#x2F;</span><br><span class="line">*.build.csdef</span><br><span class="line"></span><br><span class="line"># Microsoft Azure Emulator</span><br><span class="line">ecf&#x2F;</span><br><span class="line">rcf&#x2F;</span><br><span class="line"></span><br><span class="line"># Windows Store app package directories and files</span><br><span class="line">AppPackages&#x2F;</span><br><span class="line">BundleArtifacts&#x2F;</span><br><span class="line">Package.StoreAssociation.xml</span><br><span class="line">_pkginfo.txt</span><br><span class="line">*.appx</span><br><span class="line">*.appxbundle</span><br><span class="line">*.appxupload</span><br><span class="line"></span><br><span class="line"># Visual Studio cache files</span><br><span class="line"># files ending in .cache can be ignored</span><br><span class="line">*.[Cc]ache</span><br><span class="line"># but keep track of directories ending in .cache</span><br><span class="line">!?*.[Cc]ache&#x2F;</span><br><span class="line"></span><br><span class="line"># Others</span><br><span class="line">ClientBin&#x2F;</span><br><span class="line">~$*</span><br><span class="line">*~</span><br><span class="line">*.dbmdl</span><br><span class="line">*.dbproj.schemaview</span><br><span class="line">*.jfm</span><br><span class="line">*.pfx</span><br><span class="line">*.publishsettings</span><br><span class="line">orleans.codegen.cs</span><br><span class="line"></span><br><span class="line"># Including strong name files can present a security risk</span><br><span class="line"># (https:&#x2F;&#x2F;github.com&#x2F;github&#x2F;gitignore&#x2F;pull&#x2F;2483#issue-259490424)</span><br><span class="line">#*.snk</span><br><span class="line"></span><br><span class="line"># Since there are multiple workflows, uncomment next line to ignore bower_components</span><br><span class="line"># (https:&#x2F;&#x2F;github.com&#x2F;github&#x2F;gitignore&#x2F;pull&#x2F;1529#issuecomment-104372622)</span><br><span class="line">#bower_components&#x2F;</span><br><span class="line"></span><br><span class="line"># RIA&#x2F;Silverlight projects</span><br><span class="line">Generated_Code&#x2F;</span><br><span class="line"></span><br><span class="line"># Backup &amp; report files from converting an old project file</span><br><span class="line"># to a newer Visual Studio version. Backup files are not needed,</span><br><span class="line"># because we have git ;-)</span><br><span class="line">_UpgradeReport_Files&#x2F;</span><br><span class="line">Backup*&#x2F;</span><br><span class="line">UpgradeLog*.XML</span><br><span class="line">UpgradeLog*.htm</span><br><span class="line">ServiceFabricBackup&#x2F;</span><br><span class="line">*.rptproj.bak</span><br><span class="line"></span><br><span class="line"># SQL Server files</span><br><span class="line">*.mdf</span><br><span class="line">*.ldf</span><br><span class="line">*.ndf</span><br><span class="line"></span><br><span class="line"># Business Intelligence projects</span><br><span class="line">*.rdl.data</span><br><span class="line">*.bim.layout</span><br><span class="line">*.bim_*.settings</span><br><span class="line">*.rptproj.rsuser</span><br><span class="line">*- [Bb]ackup.rdl</span><br><span class="line">*- [Bb]ackup ([0-9]).rdl</span><br><span class="line">*- [Bb]ackup ([0-9][0-9]).rdl</span><br><span class="line"></span><br><span class="line"># Microsoft Fakes</span><br><span class="line">FakesAssemblies&#x2F;</span><br><span class="line"></span><br><span class="line"># GhostDoc plugin setting file</span><br><span class="line">*.GhostDoc.xml</span><br><span class="line"></span><br><span class="line"># Node.js Tools for Visual Studio</span><br><span class="line">.ntvs_analysis.dat</span><br><span class="line">node_modules&#x2F;</span><br><span class="line"></span><br><span class="line"># Visual Studio 6 build log</span><br><span class="line">*.plg</span><br><span class="line"></span><br><span class="line"># Visual Studio 6 workspace options file</span><br><span class="line">*.opt</span><br><span class="line"></span><br><span class="line"># Visual Studio 6 auto-generated workspace file (contains which files were open etc.)</span><br><span class="line">*.vbw</span><br><span class="line"></span><br><span class="line"># Visual Studio LightSwitch build output</span><br><span class="line">**&#x2F;*.HTMLClient&#x2F;GeneratedArtifacts</span><br><span class="line">**&#x2F;*.DesktopClient&#x2F;GeneratedArtifacts</span><br><span class="line">**&#x2F;*.DesktopClient&#x2F;ModelManifest.xml</span><br><span class="line">**&#x2F;*.Server&#x2F;GeneratedArtifacts</span><br><span class="line">**&#x2F;*.Server&#x2F;ModelManifest.xml</span><br><span class="line">_Pvt_Extensions</span><br><span class="line"></span><br><span class="line"># Paket dependency manager</span><br><span class="line">.paket&#x2F;paket.exe</span><br><span class="line">paket-files&#x2F;</span><br><span class="line"></span><br><span class="line"># FAKE - F# Make</span><br><span class="line">.fake&#x2F;</span><br><span class="line"></span><br><span class="line"># CodeRush personal settings</span><br><span class="line">.cr&#x2F;personal</span><br><span class="line"></span><br><span class="line"># Python Tools for Visual Studio (PTVS)</span><br><span class="line">__pycache__&#x2F;</span><br><span class="line">*.pyc</span><br><span class="line"></span><br><span class="line"># Cake - Uncomment if you are using it</span><br><span class="line"># tools&#x2F;**</span><br><span class="line"># !tools&#x2F;packages.config</span><br><span class="line"></span><br><span class="line"># Tabs Studio</span><br><span class="line">*.tss</span><br><span class="line"></span><br><span class="line"># Telerik&#39;s JustMock configuration file</span><br><span class="line">*.jmconfig</span><br><span class="line"></span><br><span class="line"># BizTalk build output</span><br><span class="line">*.btp.cs</span><br><span class="line">*.btm.cs</span><br><span class="line">*.odx.cs</span><br><span class="line">*.xsd.cs</span><br><span class="line"></span><br><span class="line"># OpenCover UI analysis results</span><br><span class="line">OpenCover&#x2F;</span><br><span class="line"></span><br><span class="line"># Azure Stream Analytics local run output</span><br><span class="line">ASALocalRun&#x2F;</span><br><span class="line"></span><br><span class="line"># MSBuild Binary and Structured Log</span><br><span class="line">*.binlog</span><br><span class="line"></span><br><span class="line"># NVidia Nsight GPU debugger configuration file</span><br><span class="line">*.nvuser</span><br><span class="line"></span><br><span class="line"># MFractors (Xamarin productivity tool) working folder</span><br><span class="line">.mfractor&#x2F;</span><br><span class="line"></span><br><span class="line"># Local History for Visual Studio</span><br><span class="line">.localhistory&#x2F;</span><br><span class="line"></span><br><span class="line"># BeatPulse healthcheck temp database</span><br><span class="line">healthchecksdb</span><br><span class="line"></span><br><span class="line"># Backup folder for Package Reference Convert tool in Visual Studio 2017</span><br><span class="line">MigrationBackup&#x2F;</span><br><span class="line"></span><br><span class="line"># Ionide (cross platform F# VS Code tools) working folder</span><br><span class="line">.ionide&#x2F;</span><br><span class="line"></span><br><span class="line"># Fody - auto-generated XML schema</span><br><span class="line">FodyWeavers.xsd</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DataTable的相互转换</title>
      <link href="2023/07/06/DataTableConvert/"/>
      <url>2023/07/06/DataTableConvert/</url>
      
        <content type="html"><![CDATA[<h1 id="DataTable和List相互转换"><a href="#DataTable和List相互转换" class="headerlink" title="DataTable和List相互转换"></a>DataTable和List相互转换</h1><h2 id="DataTable转换到List"><a href="#DataTable转换到List" class="headerlink" title="DataTable转换到List"></a>DataTable转换到List</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">IList</span>&lt;<span class="title">T</span>&gt; <span class="title">ConvertTo</span>&lt;<span class="title">T</span>&gt;(<span class="params">DataTable table</span>)  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">   <span class="keyword">if</span> (table == <span class="literal">null</span>)  </span><br><span class="line">   &#123;  </span><br><span class="line">       <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">   &#125;  </span><br><span class="line"> </span><br><span class="line">   List&lt;DataRow&gt; rows = <span class="keyword">new</span> List&lt;DataRow&gt;();  </span><br><span class="line"> </span><br><span class="line">   <span class="keyword">foreach</span> (DataRow row <span class="keyword">in</span> table.Rows)  </span><br><span class="line">   &#123;  </span><br><span class="line">       rows.Add(row);  </span><br><span class="line">   &#125;  </span><br><span class="line"> </span><br><span class="line">   <span class="keyword">return</span> ConvertTo&lt;T&gt;(rows);  </span><br><span class="line">&#125;  </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">IList</span>&lt;<span class="title">T</span>&gt; <span class="title">ConvertTo</span>&lt;<span class="title">T</span>&gt;(<span class="params">IList&lt;DataRow&gt; rows</span>)  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">   IList&lt;T&gt; list = <span class="literal">null</span>;  </span><br><span class="line"> </span><br><span class="line">   <span class="keyword">if</span> (rows != <span class="literal">null</span>)  </span><br><span class="line">   &#123;  </span><br><span class="line">       list = <span class="keyword">new</span> List&lt;T&gt;();  </span><br><span class="line"> </span><br><span class="line">       <span class="keyword">foreach</span> (DataRow row <span class="keyword">in</span> rows)  </span><br><span class="line">       &#123;  </span><br><span class="line">           T item = CreateItem&lt;T&gt;(row);  </span><br><span class="line">           list.Add(item);  </span><br><span class="line">       &#125;  </span><br><span class="line">   &#125;  </span><br><span class="line"> </span><br><span class="line">   <span class="keyword">return</span> list;</span><br><span class="line">&#125;    </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> T <span class="title">CreateItem</span>&lt;<span class="title">T</span>&gt;(<span class="params">DataRow row</span>)    </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T obj = <span class="literal">default</span>(T);    </span><br><span class="line">    <span class="keyword">if</span> (row != <span class="literal">null</span>)    </span><br><span class="line">    &#123;    </span><br><span class="line">       obj = Activator.CreateInstance&lt;T&gt;();    </span><br><span class="line"> </span><br><span class="line">       <span class="keyword">foreach</span> (DataColumn column <span class="keyword">in</span> row.Table.Columns)    </span><br><span class="line">       &#123;    </span><br><span class="line">           PropertyInfo prop = obj.GetType().GetProperty(column.ColumnName);    </span><br><span class="line">           <span class="keyword">try</span>   </span><br><span class="line">           &#123;    </span><br><span class="line">               <span class="built_in">object</span> <span class="keyword">value</span> = row[column.ColumnName];    </span><br><span class="line">               prop.SetValue(obj, <span class="keyword">value</span>, <span class="literal">null</span>);    </span><br><span class="line">           &#125;    </span><br><span class="line">           catch   </span><br><span class="line">           &#123;  <span class="comment">//You can log something here     </span></span><br><span class="line">               <span class="comment">//throw;    </span></span><br><span class="line">           &#125;    </span><br><span class="line">       &#125;    </span><br><span class="line">    &#125;    </span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> obj;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>    </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 实体转换辅助类    </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span>    </span></span><br><span class="line">public class ModelConvertHelper&lt;T&gt; where   T : new()    </span><br><span class="line"> &#123;    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IList&lt;T&gt; <span class="title">ConvertToModel</span>(<span class="params">DataTable dt</span>)    </span></span><br><span class="line"><span class="function"></span>     &#123;    </span><br><span class="line">        <span class="comment">// 定义集合    </span></span><br><span class="line">         IList&lt;T&gt; ts = <span class="keyword">new</span> List&lt;T&gt;(); </span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 获得此模型的类型   </span></span><br><span class="line">         Type type = <span class="keyword">typeof</span>(T);      </span><br><span class="line">        <span class="built_in">string</span> tempName = <span class="string">&quot;&quot;</span>;      </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">foreach</span> (DataRow dr <span class="keyword">in</span> dt.Rows)      </span><br><span class="line">         &#123;    </span><br><span class="line">             T t = <span class="keyword">new</span> T();     </span><br><span class="line">            <span class="comment">// 获得此模型的公共属性      </span></span><br><span class="line">             PropertyInfo[] propertys = t.GetType().GetProperties(); </span><br><span class="line">            <span class="keyword">foreach</span> (PropertyInfo pi <span class="keyword">in</span> propertys)      </span><br><span class="line">             &#123;      </span><br><span class="line">                 tempName = pi.Name;  <span class="comment">// 检查DataTable是否包含此列    </span></span><br><span class="line">   </span><br><span class="line">                <span class="keyword">if</span> (dt.Columns.Contains(tempName))      </span><br><span class="line">                 &#123;      </span><br><span class="line">                    <span class="comment">// 判断此属性是否有Setter      </span></span><br><span class="line">                    <span class="keyword">if</span> (!pi.CanWrite) <span class="keyword">continue</span>;         </span><br><span class="line">   </span><br><span class="line">                    <span class="built_in">object</span> <span class="keyword">value</span> = dr[tempName];      </span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">value</span> != DBNull.Value)      </span><br><span class="line">                         pi.SetValue(t, <span class="keyword">value</span>, <span class="literal">null</span>);  </span><br><span class="line">                 &#125;     </span><br><span class="line">             &#125;      </span><br><span class="line">             ts.Add(t);      </span><br><span class="line">         &#125;     </span><br><span class="line">        <span class="keyword">return</span> ts;     </span><br><span class="line">     &#125;     </span><br><span class="line"> &#125;    </span><br></pre></td></tr></table></figure><blockquote><p>使用方式：<br>// 获得查询结果<br>DataTable dt = DbHelper.ExecuteDataTable(…);<br>// 把DataTable转换为IList<UserInfo><br>IList<UserInfo> users = ModelConvertHelper<UserInfo>.ConvertToModel(dt);</p></blockquote><h2 id="List-IEnumerable转换到DataTable-DataView"><a href="#List-IEnumerable转换到DataTable-DataView" class="headerlink" title="List/IEnumerable转换到DataTable/DataView"></a>List<T>/IEnumerable转换到DataTable/DataView</h2><h3 id="方法一-1"><a href="#方法一-1" class="headerlink" title="方法一"></a>方法一</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Convert a List&#123;T&#125; to a DataTable.</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> DataTable <span class="title">ToDataTable</span>&lt;<span class="title">T</span>&gt;(<span class="params">List&lt;T&gt; items</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tb = <span class="keyword">new</span> DataTable(<span class="keyword">typeof</span> (T).Name);</span><br><span class="line"> </span><br><span class="line">    PropertyInfo[] props = <span class="keyword">typeof</span> (T).GetProperties(BindingFlags.Public | BindingFlags.Instance);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">foreach</span> (PropertyInfo prop <span class="keyword">in</span> props)</span><br><span class="line">    &#123;</span><br><span class="line">        Type t = GetCoreType(prop.PropertyType);</span><br><span class="line">        tb.Columns.Add(prop.Name, t);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">foreach</span> (T item <span class="keyword">in</span> items)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> values = <span class="keyword">new</span> <span class="built_in">object</span>[props.Length];</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; props.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            values[i] = props[i].GetValue(item, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        tb.Rows.Add(values);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> tb;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Determine of specified type is nullable</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsNullable</span>(<span class="params">Type t</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !t.IsValueType || (t.IsGenericType &amp;&amp; t.GetGenericTypeDefinition() == <span class="keyword">typeof</span>(Nullable&lt;&gt;));</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Return underlying type if type is Nullable otherwise return the type</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Type <span class="title">GetCoreType</span>(<span class="params">Type t</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (t != <span class="literal">null</span> &amp;&amp; IsNullable(t))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!t.IsValueType)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Nullable.GetUnderlyingType(t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方法二-1"><a href="#方法二-1" class="headerlink" title="方法二"></a>方法二</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataTable <span class="title">ToDataTable</span>&lt;<span class="title">T</span>&gt;(<span class="params">IEnumerable&lt;T&gt; collection</span>)</span></span><br><span class="line"><span class="function"></span> &#123;</span><br><span class="line">     <span class="keyword">var</span> props = <span class="keyword">typeof</span>(T).GetProperties();</span><br><span class="line">     <span class="keyword">var</span> dt = <span class="keyword">new</span> DataTable();</span><br><span class="line">     dt.Columns.AddRange(props.Select(p =&gt; <span class="keyword">new</span> DataColumn(p.Name, p.PropertyType)).ToArray());</span><br><span class="line">     <span class="keyword">if</span> (collection.Count() &gt; <span class="number">0</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; collection.Count(); i++)</span><br><span class="line">         &#123;</span><br><span class="line">             ArrayList tempList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">             <span class="keyword">foreach</span> (PropertyInfo pi <span class="keyword">in</span> props)</span><br><span class="line">             &#123;</span><br><span class="line">                 <span class="built_in">object</span> obj = pi.GetValue(collection.ElementAt(i), <span class="literal">null</span>);</span><br><span class="line">                 tempList.Add(obj);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="built_in">object</span>[] array = tempList.ToArray();</span><br><span class="line">             dt.LoadDataRow(array, <span class="literal">true</span>);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> dt;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h1 id="DataTable转换成Json"><a href="#DataTable转换成Json" class="headerlink" title="DataTable转换成Json"></a>DataTable转换成Json</h1><h2 id="方法1：使用StringBuilder"><a href="#方法1：使用StringBuilder" class="headerlink" title="方法1：使用StringBuilder"></a>方法1：使用StringBuilder</h2><p>这是Json样本数据的样子: {“姓名 “:”张三”, “年龄”:”30”}。Json里用花括号保存对象，它可以包含多个名称/值对。所以使用StringBuilder我们可以创建一个类似的Json字符串。<br>由于要使用StringBuilder类，我们首先需要导入System.Text命名空间，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">using System.Text;</span><br></pre></td></tr></table></figure><p>下面的代码将生成一个Json字符串，遍历DataTable的行和列，获取数据，添加到一个StringBuilder对象 JsonString，然后返回这个对象。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">DataTableToJson</span>(<span class="params">DataTable table</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> JsonString = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">if</span> (table.Rows.Count &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            JsonString.Append(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; table.Rows.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                JsonString.Append(<span class="string">&quot;&#123;&quot;</span>);</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; table.Columns.Count; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (j &lt; table.Columns.Count - <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        JsonString.Append(<span class="string">&quot;\&quot;&quot;</span> + table.Columns[j].ColumnName.ToString() + <span class="string">&quot;\&quot;:&quot;</span> + <span class="string">&quot;\&quot;&quot;</span> + table.Rows[i][j].ToString() + <span class="string">&quot;\&quot;,&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (j == table.Columns.Count - <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        JsonString.Append(<span class="string">&quot;\&quot;&quot;</span> + table.Columns[j].ColumnName.ToString() + <span class="string">&quot;\&quot;:&quot;</span> + <span class="string">&quot;\&quot;&quot;</span> + table.Rows[i][j].ToString() + <span class="string">&quot;\&quot;&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i == table.Rows.Count - <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    JsonString.Append(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    JsonString.Append(<span class="string">&quot;&#125;,&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            JsonString.Append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> JsonString.ToString();  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="方法2：使用-JavaScriptSerializer"><a href="#方法2：使用-JavaScriptSerializer" class="headerlink" title="方法2：使用 JavaScriptSerializer"></a>方法2：使用 JavaScriptSerializer</h2><p>首先我们添加System.Web.Script.Serialization命名空间，如下：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Web.Script.Serialization; </span><br></pre></td></tr></table></figure><p>JavaScriptSerializer这个类是由异步通信层内部使用来序列化和反序列化数据。如果序列化一个对象，就使用序列化方法。反序列化Json字符串，使用Deserialize或DeserializeObject方法。在这里，我们使用序列化方法得到Json格式的数据。代码以下：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">DataTableToJsonWithJavaScriptSerializer</span>(<span class="params">DataTable table</span>)</span></span><br><span class="line"><span class="function"></span>   &#123; </span><br><span class="line">       JavaScriptSerializer jsSerializer = <span class="keyword">new</span> JavaScriptSerializer(); </span><br><span class="line">       List &lt; Dictionary &lt; <span class="built_in">string</span>, <span class="built_in">object</span> &gt;&gt; parentRow = <span class="keyword">new</span> List &lt; Dictionary &lt; <span class="built_in">string</span>, <span class="built_in">object</span> &gt;&gt; (); </span><br><span class="line">       Dictionary &lt; <span class="built_in">string</span>, <span class="built_in">object</span> &gt; childRow; </span><br><span class="line">       <span class="keyword">foreach</span>(DataRow row <span class="keyword">in</span> table.Rows)</span><br><span class="line">       &#123; </span><br><span class="line">           childRow = <span class="keyword">new</span> Dictionary &lt; <span class="built_in">string</span>, <span class="built_in">object</span> &gt; (); </span><br><span class="line">           <span class="keyword">foreach</span>(DataColumn col <span class="keyword">in</span> table.Columns)</span><br><span class="line">           &#123; </span><br><span class="line">               childRow.Add(col.ColumnName, row[col]); </span><br><span class="line">           &#125; </span><br><span class="line">           parentRow.Add(childRow); </span><br><span class="line">       &#125; </span><br><span class="line">       <span class="keyword">return</span> jsSerializer.Serialize(parentRow); </span><br><span class="line">   &#125;  </span><br></pre></td></tr></table></figure><h2 id="方法3：使用Json-Net-DLL-Newtonsoft"><a href="#方法3：使用Json-Net-DLL-Newtonsoft" class="headerlink" title="方法3：使用Json.Net DLL (Newtonsoft)"></a>方法3：使用Json.Net DLL (Newtonsoft)</h2><p>这个方法中要添加Json.Net DLL引用，我们可以从Newtonsoft下载Json.Net DLL，再导入命名空间，代码如下：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Newtonsoft.Json;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">DataTableToJsonWithJsonNet</span>(<span class="params">DataTable table</span>)</span></span><br><span class="line"><span class="function"></span>   &#123; </span><br><span class="line">    <span class="built_in">string</span> JsonString=<span class="built_in">string</span>.Empty; </span><br><span class="line">    JsonString = JsonConvert.SerializeObject(table); </span><br><span class="line">    <span class="keyword">return</span> JsonString; </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>识别滑块验证登录</title>
      <link href="2023/03/20/SliderVerification/"/>
      <url>2023/03/20/SliderVerification/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">ChromeOptions options = <span class="keyword">new</span> ChromeOptions();</span><br><span class="line"><span class="comment">//是否现实浏览器：true显示，false不显示</span></span><br><span class="line"><span class="built_in">bool</span> ifShowBrowser = <span class="keyword">this</span>._ConfigItem.ifShowBrowser;</span><br><span class="line"><span class="keyword">if</span> (!ifShowBrowser) options.AddArgument(<span class="string">&quot;-headless&quot;</span>);</span><br><span class="line"><span class="comment">//设置浏览器大小避免无头模式下元素越界异常</span></span><br><span class="line">options.AddArgument(<span class="string">&quot;--window-size=1920,1050&quot;</span>);</span><br><span class="line"><span class="comment">//减少headless模式下日志</span></span><br><span class="line">options.AddArgument(<span class="string">&quot;log-level=3&quot;</span>);</span><br><span class="line"><span class="comment">//绕过检测</span></span><br><span class="line"><span class="comment">// 启用 Stealth 模式</span></span><br><span class="line">options.AddArgument(<span class="string">&quot;--disable-blink-features=AutomationControlled&quot;</span>);</span><br><span class="line">options.AddArgument(<span class="string">&quot;--disable-blink-features=AutomationControlledCrOS&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加 Stealth 用户代理字符串</span></span><br><span class="line">options.AddArgument(<span class="string">&quot;--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.111 Safari/537.36&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加 Stealth WebGL 配置</span></span><br><span class="line">options.AddArgument(<span class="string">&quot;--disable-webgl&quot;</span>);</span><br><span class="line">options.AddArgument(<span class="string">&quot;--disable-extensions&quot;</span>);</span><br><span class="line">options.AddArgument(<span class="string">&quot;--disable-plugins&quot;</span>);</span><br><span class="line"><span class="comment">//实例化一个谷歌浏览器</span></span><br><span class="line"><span class="comment">//设置cmd窗口不弹出来</span></span><br><span class="line">ChromeDriverService service = ChromeDriverService.CreateDefaultService(System.AppDomain.CurrentDomain.BaseDirectory.ToString());</span><br><span class="line">service.HideCommandPromptWindow = !ifShowBrowser;</span><br><span class="line">ChromeDriver driver = <span class="keyword">new</span> ChromeDriver(service, options);</span><br><span class="line"><span class="comment"><span class="doctag">///</span>/以青港登录为例，完成自动登录，浏览器中打开青港，可以换成任意你要测试的网站，可以人工打开网站去输入账号密码看看</span></span><br><span class="line"><span class="comment">//driver.Navigate().GoToUrl(&quot;http://cdcs.qgil.net/index&quot;);</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>/获取cookie</span></span><br><span class="line"><span class="comment">//var _cookie = driver.Manage().Cookies;</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>/在获取的cookie中添加token和sidebarStatus</span></span><br><span class="line"><span class="comment">//_cookie.AddCookie(new OpenQA.Selenium.Cookie(&quot;sidebarStatus&quot;, &quot;0&quot;));</span></span><br><span class="line"><span class="comment">//_cookie.AddCookie(new OpenQA.Selenium.Cookie(&quot;Admin-Token&quot;, entity.Cookie));</span></span><br><span class="line">driver.Navigate().GoToUrl(<span class="string">&quot;http://cdcs.qgil.net/index&quot;</span>);</span><br><span class="line">Thread.Sleep(<span class="number">2000</span>);<span class="comment">//2秒后还是这个url表示token没有失效继续可以使用，失效了就重新登录</span></span><br><span class="line"><span class="keyword">if</span> (driver.Url != <span class="string">&quot;http://cdcs.qgil.net/index&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//设置超时等待(隐式等待)时间设置10秒（不用管）</span></span><br><span class="line">driver.Manage().Timeouts().ImplicitWait = TimeSpan.FromSeconds(<span class="number">15</span>);</span><br><span class="line"><span class="comment">//找到用户名输入，如果有ID，直接By.Id(&quot;元素Id&quot;)就行，这些看相关链接文档都有介绍，下面是用不同方式获取页面元素</span></span><br><span class="line"><span class="comment">//元素的XPath可以从浏览器里面F12 代码检查中直接拷贝出来，不会就信息我</span></span><br><span class="line">driver.FindElement(By.TagName(<span class="string">&quot;input&quot;</span>)).SendKeys(<span class="keyword">this</span>._ConfigItem.QG_Account);</span><br><span class="line"><span class="comment">//找到密码输入</span></span><br><span class="line">driver.FindElement(By.XPath(<span class="string">&quot;//*[@id=\&quot;app\&quot;]/div[1]/form/div[2]/div/div/input&quot;</span>)).SendKeys(<span class="keyword">this</span>._ConfigItem.QG_Password);</span><br><span class="line"><span class="comment">//找到按钮点击</span></span><br><span class="line">driver.FindElement(By.XPath(<span class="string">&quot;//*[@id=\&quot;app\&quot;]/div[1]/form/div[4]/div[1]/div/div/button&quot;</span>)).Click();</span><br><span class="line"><span class="comment">//定义鼠标事件</span></span><br><span class="line">Actions tuozhuai = <span class="keyword">new</span> Actions(driver);</span><br><span class="line">Thread.Sleep(<span class="number">1000</span>);<span class="comment">//滑块背景有时候刷新过快受到影响</span></span><br><span class="line"><span class="comment">//找到滑块图片，取出滑块的base64数据</span></span><br><span class="line"><span class="keyword">var</span> huakuai = driver.FindElement(By.XPath(<span class="string">&quot;//*[@id=\&quot;app\&quot;]/div[1]/form/div[3]/div/div[2]/div/div[2]/div/div/div/img&quot;</span>)).GetAttribute(<span class="string">&quot;src&quot;</span>).Replace(<span class="string">&quot;data:image/png;base64,&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="comment">//找到背景，取出背景base64数据</span></span><br><span class="line"><span class="keyword">var</span> beijing = driver.FindElement(By.XPath(<span class="string">&quot;//*[@id=\&quot;app\&quot;]/div[1]/form/div[3]/div/div[2]/div/div[1]/div/img&quot;</span>)).GetAttribute(<span class="string">&quot;src&quot;</span>).Replace(<span class="string">&quot;data:image/png;base64,&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="comment">//多次调用青港接口的情况会出现屏蔽，导致滑块返回的base64为空，正常不会，因此没有做判断</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">region</span> 图片切割，因为背景图片上好多的凹槽块，云码识别大部分会识别失败，为了提高识别率只切割出来滑块对应的那一条背景进行识别</span></span><br><span class="line"><span class="comment">//获取滑块图第一个像素点的y的偏移量</span></span><br><span class="line"><span class="built_in">int</span> offsetY = getHeight(huakuai, <span class="string">&quot;\\UploadFile\\CDQG\\&quot;</span>);</span><br><span class="line"><span class="comment">//把背景切割后重新放置于beijing里面--截取滑块对应位置的同高度一段背景图片</span></span><br><span class="line">beijing = ImgHelper.CapturelmageByBase64(beijing, <span class="number">0</span>, offsetY - <span class="number">1</span>, offsetY + <span class="string">&quot;.png&quot;</span>, <span class="number">310</span>, <span class="number">49</span>, <span class="string">&quot;\\UploadFile\\CDQG\\&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"><span class="comment">//调用云码识别，计算滑动的距离</span></span><br><span class="line"><span class="keyword">var</span> dic = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;() &#123;</span><br><span class="line">&#123; <span class="string">&quot;token&quot;</span>,<span class="string">&quot;Ax7TSY8X&quot;</span>&#125;,</span><br><span class="line">&#123; <span class="string">&quot;slide_image&quot;</span>,huakuai&#125;,</span><br><span class="line">&#123; <span class="string">&quot;background_image&quot;</span>,beijing&#125;,</span><br><span class="line">&#123; <span class="string">&quot;type&quot;</span>,<span class="string">&quot;20111&quot;</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> response = Post_customApi(<span class="string">&quot;https://www.jfbym.com/api/YmServer/customApi&quot;</span>, dic, <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;());</span><br><span class="line"><span class="comment">//找到滑块拖拽返回的像素数</span></span><br><span class="line"><span class="keyword">var</span> huakuaidiv = driver.FindElement(By.ClassName(<span class="string">&quot;verify-move-block&quot;</span>));</span><br><span class="line"><span class="comment">//var result = xs.Match(&quot;&#123;\&quot;msg\&quot;:\&quot;识别成功\&quot;,\&quot;code\&quot;:10000,\&quot;data\&quot;:&#123;\&quot;code\&quot;:0,\&quot;data\&quot;:\&quot;145\&quot;,\&quot;time\&quot;:0.018527507781982422,\&quot;unique_code\&quot;:\&quot;8380dab870ca389c425842e14731048f\&quot;&#125;&#125;&quot;);</span></span><br><span class="line"><span class="comment">//定义正则表达式，匹配滑块识别返回的偏移量&quot;data&quot;:&quot;偏移量&quot;</span></span><br><span class="line">Regex xs = <span class="keyword">new</span> Regex(<span class="string">&quot;\&quot;data\&quot;:\&quot;[0-9]+\&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(response))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">var</span> result = xs.Match(response);</span><br><span class="line"><span class="keyword">if</span> (result.Success)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">var</span> yidongjuli = result.Groups[<span class="number">0</span>].ToString().Split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>].Replace(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="comment">//开始拖拽</span></span><br><span class="line">tuozhuai.DragAndDropToOffset(huakuaidiv, Convert.ToInt32(yidongjuli) + <span class="number">10</span>, <span class="number">0</span>).Build().Perform();</span><br><span class="line"><span class="comment">//最长10秒的判断时间，判断是否进入主页，进入表示登录成功，则跳出循环向下走 //10秒后判断url是否变化如果进入则获取token，否则再次登录</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">Thread.Sleep(<span class="number">2000</span>);<span class="comment">//等待10秒</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (driver.Url == <span class="string">&quot;http://cdcs.qgil.net/index&quot;</span>) <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (driver.Url == <span class="string">&quot;http://cdcs.qgil.net/index&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//url发生了跳转表示登录成功</span></span><br><span class="line"><span class="keyword">var</span> Cookies = driver.Manage().Cookies;</span><br><span class="line"><span class="comment">//拿到token更新存储到数据库</span></span><br><span class="line"><span class="keyword">var</span> cookie = Cookies.GetCookieNamed(<span class="string">&quot;Admin-Token&quot;</span>).Value;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(cookie))</span><br><span class="line">&#123;</span><br><span class="line">List&lt;Fly_ManifestUser&gt; List = db.Queryable&lt;Fly_ManifestUser&gt;().Where(p =&gt; p.Type == <span class="string">&quot;QG青港&quot;</span> &amp;&amp; p.Account == <span class="keyword">this</span>._ConfigItem.QG_Account).ToList();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> List)</span><br><span class="line">&#123;</span><br><span class="line">item.Cookie = cookie;</span><br><span class="line">item.CookieDate = DateTime.Now;</span><br><span class="line">db.Updateable(item).ExecuteCommand();</span><br><span class="line">&#125;</span><br><span class="line">addLog(<span class="string">&quot;青港cookie更新成功------&quot;</span> + DateTime.Now.ToString(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>), <span class="string">&quot;QG-青港&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//请求后关闭后台及浏览器</span></span><br><span class="line">driver.Quit();</span><br><span class="line">driver.Dispose();</span><br><span class="line">service.Dispose();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>发送FTP</title>
      <link href="2023/02/27/SendFTP/"/>
      <url>2023/02/27/SendFTP/</url>
      
        <content type="html"><![CDATA[<blockquote><p>DLL下载:<br>Tiler.Net.dll<br><a href="https://www.aliyundrive.com/s/ip2snLtcv6m">https://www.aliyundrive.com/s/ip2snLtcv6m</a></p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ftpserver = <span class="built_in">string</span>.Format(<span class="string">&quot;ftp://&#123;0&#125;&quot;</span>, <span class="string">&quot;***.***.***.***&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ftp = <span class="keyword">new</span> FtpManager(ftpserver, <span class="string">&quot;HZ&quot;</span>, <span class="string">&quot;20221115&quot;</span>);</span><br><span class="line">ftp.Upload(ftpserver, DecMsgDir);</span><br></pre></td></tr></table></figure><blockquote><p>另附搭建FTP服务器及上传文件参考:<br><a href="https://blog.csdn.net/liulv_yan/article/details/121148484">https://blog.csdn.net/liulv_yan/article/details/121148484</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
            <tag> FTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>表单验证rules</title>
      <link href="2022/05/22/rules/"/>
      <url>2022/05/22/rules/</url>
      
        <content type="html"><![CDATA[<h1 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h1><p>type 标志要使用的validator的数据类型<br>required 必填<br>message 提示内容<br>trigger 触发条件 （change||blur）<br>min 最小值<br>max 最大值<br>len 精准长度 (优先级高于min,max)<br>enum 枚举中存在该值 (type必须为enum类型)<br>whitespace 不能包含空白符<br>pattern 正则 (必须加 required: true)</p><h1 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h1><p>string： 必须是 类型。stringThis is the default type.<br>number： 必须是 类型。number<br>boolean： 必须是 类型。boolean<br>method： 必须是 类型。function<br>regexp：必须是 在创建新 时不生成异常的 实例 或 字符串。RegExpRegExp<br>integer：必须是类型和整数。number<br>float：必须是类型和浮点编号。number<br>array： 必须是 由 确定的数组。Array.isArray<br>object：必须是类型而不是 。objectArray.isArray<br>enum： 值必须存在于 中。enum<br>date： 值必须有效，由Date<br>url： 必须是 类型。url<br>hex： 必须是 类型。hex<br>email： 必须是 类型。email<br>any： 可以是任何类型。</p><h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><p>model绑定对应需要校验的数据，rules绑定校验规则， prop绑定的规则名字必须和model里面的名字一致，例： ruleForm: {name: “”} 而 prop=“name” 不然不起效果</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;ruleForm&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;ruleForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;100px&quot;</span> &gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;活动名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;ruleForm.name&quot;</span> @<span class="attr">foucs</span>=<span class="string">&quot;clearValida(&quot;</span><span class="attr">name</span>&quot;)&quot;&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;submitForm&quot;</span>&gt;</span>确 定&lt;/el-button</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">//自定义校验方式</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">//校验正整数</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> rules = <span class="function">(<span class="params">rule, value, callback</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">     <span class="keyword">if</span>(value)&#123;</span></span><br><span class="line"><span class="javascript"> <span class="keyword">let</span> reg1 = <span class="regexp">/^[1-9]([0-9])*$/</span>; <span class="comment">//正整数</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (!reg1.test(value)) &#123;</span></span><br><span class="line"><span class="javascript">        callback(<span class="string">&quot;请输入正整数&quot;</span>);</span></span><br><span class="line"><span class="javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line">        callback();</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      ruleForm: &#123;</span><br><span class="line"><span class="javascript">        name: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line">      &#125;,</span><br><span class="line">      rules: &#123;</span><br><span class="line">        name: [</span><br><span class="line"><span class="javascript">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入活动名称&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="javascript">          &#123; <span class="attr">min</span>: <span class="number">3</span>, <span class="attr">max</span>: <span class="number">5</span>, <span class="attr">message</span>: <span class="string">&quot;长度在 3 到 5 个字符&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line">          &#123; validator: rules &#125;</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1、手机号码验证正则</span></span><br><span class="line"> &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入手机号&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line"> &#123; <span class="attr">pattern</span>:<span class="regexp">/^1[3456789]\d&#123;9&#125;$/</span>, message: <span class="string">&quot;手机号格式不对&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//2、身份证验证</span></span><br><span class="line"> &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入证件号码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line"> &#123; <span class="attr">pattern</span>: <span class="regexp">/(^[1-9]\d&#123;5&#125;(18|19|([23]\d))\d&#123;2&#125;((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d&#123;3&#125;[0-9Xx]$)|(^[1-9]\d&#123;5&#125;\d&#123;2&#125;((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d&#123;2&#125;$)/</span>,</span><br><span class="line">   message: <span class="string">&#x27;证件号码格式有误！&#x27;</span>,</span><br><span class="line">   trigger: <span class="string">&#x27;blur&#x27;</span>,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//3、校验是否为数字</span></span><br><span class="line">&#123; <span class="attr">pattern</span>:<span class="regexp">/^[0-9]*$/</span> , message:<span class="string">&#x27;请输入数字&#x27;</span> ,<span class="attr">trigger</span>:<span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//4、校验座机号</span></span><br><span class="line"> &#123; <span class="attr">pattern</span>:<span class="regexp">/^\d&#123;3,4&#125;\-\d&#123;7,8&#125;$/</span>,message:<span class="string">&quot;座机不正确,格式为：区号-座机号，例如：07558886666&quot;</span>,<span class="attr">trigger</span>:<span class="string">&quot;blur&quot;</span>&#125;,</span><br><span class="line"> </span><br><span class="line"><span class="comment">//5、校验是否为汉字</span></span><br><span class="line"> &#123; <span class="attr">pattern</span>:<span class="regexp">/^[\u4e00-\u9fa5]&#123;0,&#125;$/</span> ,message:<span class="string">&quot;姓名格式错误,请检查&quot;</span>,<span class="attr">trigger</span>:<span class="string">&quot;blur&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//6、金额校验,允许负数,两位小数</span></span><br><span class="line">&#123; <span class="attr">pattern</span>: <span class="regexp">/(^([-]?)[1-9]([0-9]+)?(\.[0-9]&#123;1,2&#125;)?$)|(^([-]?)(0)&#123;1&#125;$)|(^([-]?)[0-9]\.[0-9]([0-9])?$)/</span>, message:<span class="string">&#x27;请输入正确的金额！&#x27;</span> ,<span class="attr">trigger</span>:<span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//7、金额校验,不允许负数,两位小数</span></span><br><span class="line">&#123; <span class="attr">pattern</span>:<span class="regexp">/^\d+\.?\d&#123;0,2&#125;$/</span> , message:<span class="string">&#x27;请输入正确的金额！&#x27;</span> ,<span class="attr">trigger</span>:<span class="string">&#x27;blur&#x27;</span> &#125;,</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//form表单统一校验</span></span><br><span class="line"><span class="function"><span class="title">submitForm</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">this</span>.$refs[<span class="string">&quot;form&quot;</span>].validate(<span class="function"><span class="params">validate</span>=&gt;</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(validate)&#123;</span><br><span class="line"><span class="comment">//form表单校验通过,可以进行下一步操作</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//form表单输入框获取焦点暂时清除对应的表单校验,提高用户体验</span></span><br><span class="line"><span class="comment">//理解:调用form表单移除校验方法,传入对应的校验名字,在input绑定focus事件</span></span><br><span class="line"><span class="function"><span class="title">clearValida</span>(<span class="params">data</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$refs.form.clearValidate([data]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>发送邮件</title>
      <link href="2022/05/07/SendEmail/"/>
      <url>2022/05/07/SendEmail/</url>
      
        <content type="html"><![CDATA[<h1 id="Explicit-SSL发送邮件"><a href="#Explicit-SSL发送邮件" class="headerlink" title="Explicit SSL发送邮件"></a>Explicit SSL发送邮件</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 发送邮件方法</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;FromMial&quot;&gt;</span>发件人邮箱<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ToMial&quot;&gt;</span>收件人邮箱(多个收件人地址用&quot;;&quot;号隔开)<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;AuthorizationCode&quot;&gt;</span>发件人授权码<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ReplyTo&quot;&gt;</span>对方回复邮件时默认的接收地址（不设置也是可以的）<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;CCMial&quot;&gt;</span>//邮件的抄送者(多个抄送人用&quot;;&quot;号隔开)<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;File_Path&quot;&gt;</span>附件的地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendMail</span>(<span class="params"><span class="built_in">string</span> FromMial, <span class="built_in">string</span> ToMial, <span class="built_in">string</span> AuthorizationCode, <span class="built_in">string</span> ReplyTo, <span class="built_in">string</span> CCMial, <span class="built_in">string</span> File_Path</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//实例化一个发送邮件类。</span></span><br><span class="line">        MailMessage mailMessage = <span class="keyword">new</span> MailMessage();</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//邮件的优先级，分为 Low, Normal, High，通常用 Normal即可</span></span><br><span class="line">        mailMessage.Priority = MailPriority.Normal;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//发件人邮箱地址。</span></span><br><span class="line">        mailMessage.From = <span class="keyword">new</span> MailAddress(FromMial);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//收件人邮箱地址。需要群发就写多个</span></span><br><span class="line">        <span class="comment">//拆分邮箱地址</span></span><br><span class="line">        List&lt;<span class="built_in">string</span>&gt; ToMiallist = ToMial.Split(<span class="string">&#x27;;&#x27;</span>).ToList();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; ToMiallist.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            mailMessage.To.Add(<span class="keyword">new</span> MailAddress(ToMiallist[i]));  <span class="comment">//收件人邮箱地址。</span></span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (ReplyTo == <span class="string">&quot;&quot;</span> || ReplyTo == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ReplyTo = FromMial;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//对方回复邮件时默认的接收地址(不设置也是可以的哟)</span></span><br><span class="line">        mailMessage.ReplyTo = <span class="keyword">new</span> MailAddress(ReplyTo);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (CCMial != <span class="string">&quot;&quot;</span> &amp;&amp; CCMial != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;<span class="built_in">string</span>&gt; CCMiallist = ToMial.Split(<span class="string">&#x27;;&#x27;</span>).ToList();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; CCMiallist.Count; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//邮件的抄送者，支持群发</span></span><br><span class="line">                mailMessage.CC.Add(<span class="keyword">new</span> MailAddress(CCMial));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果你的邮件标题包含中文，这里一定要指定，否则对方收到的极有可能是乱码。</span></span><br><span class="line">        mailMessage.SubjectEncoding = Encoding.GetEncoding(<span class="number">936</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//邮件正文是否是HTML格式</span></span><br><span class="line">        mailMessage.IsBodyHtml = <span class="literal">false</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//邮件标题。</span></span><br><span class="line">        mailMessage.Subject = <span class="string">&quot;发送邮件测试&quot;</span>;</span><br><span class="line">        <span class="comment">//邮件内容。</span></span><br><span class="line">        mailMessage.Body = <span class="string">&quot;测试群发邮件,以及附件邮件！.....&quot;</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//设置邮件的附件，将在客户端选择的附件先上传到服务器保存一个，然后加入到mail中  </span></span><br><span class="line">        <span class="keyword">if</span> (File_Path != <span class="string">&quot;&quot;</span> &amp;&amp; File_Path != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//将附件添加到邮件</span></span><br><span class="line">            mailMessage.Attachments.Add(<span class="keyword">new</span> Attachment(File_Path));</span><br><span class="line">            <span class="comment">//获取或设置此电子邮件的发送通知。</span></span><br><span class="line">            mailMessage.DeliveryNotificationOptions = DeliveryNotificationOptions.OnSuccess;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//实例化一个SmtpClient类。</span></span><br><span class="line">        SmtpClient client = <span class="keyword">new</span> SmtpClient();</span><br><span class="line"> </span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> 设置邮件服务器地址</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">//在这里我使用的是163邮箱，所以是smtp.163.com，如果你使用的是qq邮箱，那么就是smtp.qq.com。</span></span><br><span class="line">        <span class="comment">// client.Host = &quot;smtp.163.com&quot;;</span></span><br><span class="line">        <span class="keyword">if</span> (FromMial.Length != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//根据发件人的邮件地址判断发件服务器地址   默认端口一般是25</span></span><br><span class="line">            <span class="built_in">string</span>[] addressor = FromMial.Trim().Split(<span class="keyword">new</span> Char[] &#123; <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;.&#x27;</span> &#125;);</span><br><span class="line">            <span class="keyword">switch</span> (addressor[<span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;163&quot;</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.163.com&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;126&quot;</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.126.com&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;qq&quot;</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.qq.com&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;gmail&quot;</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.gmail.com&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;hotmail&quot;</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.live.com&quot;</span>;<span class="comment">//outlook邮箱</span></span><br><span class="line">                    <span class="comment">//client.Port = 587;</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;foxmail&quot;</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.foxmail.com&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;sina&quot;</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.sina.com.cn&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    client.Host = <span class="string">&quot;smtp.exmail.qq.com&quot;</span>;<span class="comment">//qq企业邮箱</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">//使用安全加密连接。</span></span><br><span class="line">        client.EnableSsl = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//不和请求一块发送。</span></span><br><span class="line">        client.UseDefaultCredentials = <span class="literal">false</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//验证发件人身份(发件人的邮箱，邮箱里的生成授权码);</span></span><br><span class="line">        client.Credentials = <span class="keyword">new</span> NetworkCredential(FromMial, AuthorizationCode);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//如果发送失败，SMTP 服务器将发送 失败邮件告诉我  </span></span><br><span class="line">        mailMessage.DeliveryNotificationOptions = DeliveryNotificationOptions.OnFailure;</span><br><span class="line">        <span class="comment">//发送</span></span><br><span class="line">        client.Send(mailMessage);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;发送成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    catch (Exception)</span><br><span class="line">    &#123;</span><br><span class="line"> </span><br><span class="line">        Console.WriteLine(<span class="string">&quot;发送失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Implicit-SSL发送邮件"><a href="#Implicit-SSL发送邮件" class="headerlink" title="Implicit SSL发送邮件"></a>Implicit SSL发送邮件</h1><blockquote><p>查阅资料得知，.net 的自带组件System.Net.Mail发送邮件支持Explicit SSL但是不支持Implicit SSL，国内大部门邮件服务器都是Implicit SSL，所以无法通过465端口发邮件<br>有人说了，那干嘛要用呢，我用25不好好的么，为什么不用25呢？<br>这个问题问得好，很多云服务器像阿里、腾讯购买的新机都是把25端口封禁的，想要用25端口需要手动申请解封，据阿里工作客服所说，审核通过率感人<br>那么今天就记录一下如何使用465端口成功发邮件</p></blockquote><p>可以使用CDO.Message发送邮件<br>如何引用CDO.Message？ cod.message的引用位置： C:\Windows\System32\cdosys.dll</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 针对465加密端口 加密协议SSL（Implicit SSL）进行的邮件发送</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;FromMial&quot;&gt;</span>发件人邮箱<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ToMial&quot;&gt;</span>收件人邮箱(多个收件人地址用&quot;;&quot;号隔开)<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;AuthorizationCode&quot;&gt;</span>发件人授权码<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ReplyTo&quot;&gt;</span>对方回复邮件时默认的接收地址（不设置也是可以的）<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;CCMial&quot;&gt;</span>//邮件的抄送者(多个抄送人用&quot;;&quot;号隔开)<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;File_Path&quot;&gt;</span>附件的地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Subject&quot;&gt;</span>邮件标题<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Body&quot;&gt;</span>邮件内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendMailForSSL</span>(<span class="params"><span class="built_in">string</span> FromMial, <span class="built_in">string</span> ToMial, <span class="built_in">string</span> AuthorizationCode, <span class="built_in">string</span> ReplyTo, <span class="built_in">string</span> CCMial, <span class="built_in">string</span> File_Path, <span class="built_in">string</span> Subject = <span class="string">&quot;&quot;</span>, <span class="built_in">string</span> Body = <span class="string">&quot;&quot;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    CDO.Message objMail = <span class="keyword">new</span> CDO.Message();</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        objMail.To = ToMial;<span class="comment">//接收邮件账号</span></span><br><span class="line">        objMail.From = FromMial;<span class="comment">//发送邮件账号</span></span><br><span class="line">        objMail.Subject = Subject;<span class="comment">//邮件主题string strHTML = @&quot;&quot;;</span></span><br><span class="line">        objMail.HTMLBody = Body;<span class="comment">//邮件内容</span></span><br><span class="line">        objMail.AddAttachment(File_Path, FromMial, AuthorizationCode);<span class="comment">//邮件附件</span></span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;</span>].Value = <span class="number">465</span>;<span class="comment">//设置端口</span></span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;</span>].Value = <span class="string">&quot;smtp.qq.com&quot;</span>;</span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendemailaddress&quot;</span>].Value = FromMial;<span class="comment">//发送邮件账号</span></span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpuserreplyemailaddress&quot;</span>].Value = FromMial;<span class="comment">//发送邮件账号</span></span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpaccountname&quot;</span>].Value = FromMial;<span class="comment">//发送邮件账号</span></span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendusername&quot;</span>].Value = FromMial;<span class="comment">//发送邮件账号</span></span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendpassword&quot;</span>].Value = AuthorizationCode;<span class="comment">//发送邮件账号登录密码</span></span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;</span>].Value = <span class="number">2</span>;</span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpauthenticate&quot;</span>].Value = <span class="number">1</span>;</span><br><span class="line">        objMail.Configuration.Fields[<span class="string">&quot;http://schemas.microsoft.com/cdo/configuration/smtpusessl&quot;</span>].Value = <span class="string">&quot;true&quot;</span>;<span class="comment">//这一句指示是否使用ssl</span></span><br><span class="line">        objMail.Configuration.Fields.Update();</span><br><span class="line">        objMail.Send();</span><br><span class="line">    &#125;</span><br><span class="line">    catch (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ex <span class="keyword">is</span> ExceptionEx)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ExceptionEx.ThrowBusinessException(ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sql server 字符串转成日期格式</title>
      <link href="2022/03/03/SqlDate/"/>
      <url>2022/03/03/SqlDate/</url>
      
        <content type="html"><![CDATA[<h1 id="sql-server-字符串转成日期格式"><a href="#sql-server-字符串转成日期格式" class="headerlink" title="sql server 字符串转成日期格式"></a>sql server 字符串转成日期格式</h1><h2 id="字符串转日期时间"><a href="#字符串转日期时间" class="headerlink" title="字符串转日期时间"></a>字符串转日期时间</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert(datetime,&#x27;2017-12-12 00:00:01&#x27;, 20)</span><br></pre></td></tr></table></figure><h2 id="日期时间转字符串"><a href="#日期时间转字符串" class="headerlink" title="日期时间转字符串"></a>日期时间转字符串</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">0</span>): <span class="number">05</span> <span class="number">16</span> <span class="number">2006</span> <span class="number">10</span>:<span class="number">57</span>AM   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">1</span>): <span class="number">05</span>/<span class="number">16</span>/<span class="number">06</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">2</span>): <span class="number">06.05</span><span class="number">.16</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">3</span>): <span class="number">16</span>/<span class="number">05</span>/<span class="number">06</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">4</span>): <span class="number">16.05</span><span class="number">.06</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">5</span>): <span class="number">16</span><span class="number">-05</span><span class="number">-06</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">6</span>): <span class="number">16</span> <span class="number">05</span> <span class="number">06</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">7</span>): <span class="number">05</span> <span class="number">16</span>, <span class="number">06</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">8</span>): <span class="number">10</span>:<span class="number">57</span>:<span class="number">46</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">9</span>): <span class="number">05</span> <span class="number">16</span> <span class="number">2006</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">46</span>:<span class="number">827</span>AM   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">10</span>): <span class="number">05</span><span class="number">-16</span><span class="number">-06</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">11</span>): <span class="number">06</span>/<span class="number">05</span>/<span class="number">16</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">12</span>): <span class="number">060516</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">13</span>): <span class="number">16</span> <span class="number">05</span> <span class="number">2006</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">46</span>:<span class="number">937</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">14</span>): <span class="number">10</span>:<span class="number">57</span>:<span class="number">46</span>:<span class="number">967</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">20</span>): <span class="number">2006</span><span class="number">-05</span><span class="number">-16</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">47</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">21</span>): <span class="number">2006</span><span class="number">-05</span><span class="number">-16</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">47.157</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">22</span>): <span class="number">05</span>/<span class="number">16</span>/<span class="number">06</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">47</span> AM   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">23</span>): <span class="number">2006</span><span class="number">-05</span><span class="number">-16</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">24</span>): <span class="number">10</span>:<span class="number">57</span>:<span class="number">47</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">25</span>): <span class="number">2006</span><span class="number">-05</span><span class="number">-16</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">47.250</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">100</span>): <span class="number">05</span> <span class="number">16</span> <span class="number">2006</span> <span class="number">10</span>:<span class="number">57</span>AM   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">101</span>): <span class="number">05</span>/<span class="number">16</span>/<span class="number">2006</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">102</span>): <span class="number">2006.05</span><span class="number">.16</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">103</span>): <span class="number">16</span>/<span class="number">05</span>/<span class="number">2006</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">104</span>): <span class="number">16.05</span><span class="number">.2006</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">105</span>): <span class="number">16</span><span class="number">-05</span><span class="number">-2006</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">106</span>): <span class="number">16</span> <span class="number">05</span> <span class="number">2006</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">107</span>): <span class="number">05</span> <span class="number">16</span>, <span class="number">2006</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">108</span>): <span class="number">10</span>:<span class="number">57</span>:<span class="number">49</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">109</span>): <span class="number">05</span> <span class="number">16</span> <span class="number">2006</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">49</span>:<span class="number">437</span>AM   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">110</span>): <span class="number">05</span><span class="number">-16</span><span class="number">-2006</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">111</span>): <span class="number">2006</span>/<span class="number">05</span>/<span class="number">16</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">112</span>): <span class="number">20060516</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">113</span>): <span class="number">16</span> <span class="number">05</span> <span class="number">2006</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">49</span>:<span class="number">513</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">114</span>): <span class="number">10</span>:<span class="number">57</span>:<span class="number">49</span>:<span class="number">547</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">120</span>): <span class="number">2006</span><span class="number">-05</span><span class="number">-16</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">49</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">121</span>): <span class="number">2006</span><span class="number">-05</span><span class="number">-16</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">49.700</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">126</span>): <span class="number">2006</span><span class="number">-05</span><span class="number">-16</span>T10:<span class="number">57</span>:<span class="number">49.827</span>   </span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">CONVERT</span>(<span class="built_in">varchar</span>(<span class="number">100</span>), <span class="keyword">GETDATE</span>(), <span class="number">130</span>): <span class="number">18</span> ???? ?????? <span class="number">1427</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">49</span>:<span class="number">907</span>AM  </span><br></pre></td></tr></table></figure><h1 id="Sql-Server日期与时间函数"><a href="#Sql-Server日期与时间函数" class="headerlink" title="Sql Server日期与时间函数:"></a>Sql Server日期与时间函数:</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">1.  当前系统日期、时间 </span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">getdate</span>() </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> <span class="keyword">dateadd</span>  在向指定日期加上一段时间的基础上，返回新的 datetime 值</span><br><span class="line"></span><br><span class="line">例如：向日期加上<span class="number">2</span>天 </span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">dateadd</span>(<span class="keyword">day</span>,<span class="number">2</span>,<span class="string">&#x27;2004-10-15&#x27;</span>)  <span class="comment">--返回：2004-10-17 00:00:00.000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> <span class="keyword">datediff</span> 返回跨两个指定日期的日期和时间边界数。</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">datediff</span>(<span class="keyword">day</span>,<span class="string">&#x27;2004-09-01&#x27;</span>,<span class="string">&#x27;2004-09-18&#x27;</span>)   <span class="comment">--返回：17</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> <span class="keyword">datepart</span> 返回代表指定日期的指定日期部分的整数。</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATEPART</span>(<span class="keyword">month</span>, <span class="string">&#x27;2004-10-15&#x27;</span>)  <span class="comment">--返回 10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> <span class="keyword">datename</span> 返回代表指定日期的指定日期部分的字符串</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">datename</span>(<span class="keyword">weekday</span>, <span class="string">&#x27;2004-10-15&#x27;</span>)  <span class="comment">--返回：星期五</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> <span class="keyword">day</span>(), <span class="keyword">month</span>(),<span class="keyword">year</span>() <span class="comment">--可以与datepart对照一下</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> 当前日期=<span class="keyword">convert</span>(<span class="built_in">varchar</span>(<span class="number">10</span>),<span class="keyword">getdate</span>(),<span class="number">120</span>) ,当前时间=<span class="keyword">convert</span>(<span class="built_in">varchar</span>(<span class="number">8</span>),<span class="keyword">getdate</span>(),<span class="number">114</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">datename</span>(dw,<span class="string">&#x27;2004-10-15&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> 本年第多少周=<span class="keyword">datename</span>(<span class="keyword">week</span>,<span class="string">&#x27;2004-10-15&#x27;</span>),今天是周几=<span class="keyword">datename</span>(<span class="keyword">weekday</span>,<span class="string">&#x27;2004-10-15&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span> <span class="keyword">Server</span>日期函数     参数/功能</span><br><span class="line"></span><br><span class="line"><span class="keyword">GetDate</span>( )    返回系统目前的日期与时间</span><br><span class="line"></span><br><span class="line"><span class="keyword">DateDiff</span> (<span class="built_in">interval</span>,date1,date2)   以<span class="built_in">interval</span> 指定的方式，返回date2 与date1两个日期之间的差值 date2-date1</span><br><span class="line"></span><br><span class="line"><span class="keyword">DateAdd</span> (<span class="built_in">interval</span>,<span class="built_in">number</span>,<span class="built_in">date</span>)   以<span class="built_in">interval</span>指定的方式，加上<span class="built_in">number</span>之后的日期</span><br><span class="line"></span><br><span class="line"><span class="keyword">DatePart</span> (<span class="built_in">interval</span>,<span class="built_in">date</span>)    返回日期<span class="built_in">date</span>中，<span class="built_in">interval</span>指定部分所对应的整数值</span><br><span class="line"></span><br><span class="line"><span class="keyword">DateName</span> (<span class="built_in">interval</span>,<span class="built_in">date</span>)   返回日期<span class="built_in">date</span>中，<span class="built_in">interval</span>指定部分所对应的字符串名称</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">参数<span class="built_in">interval</span>的设定值如下：</span><br><span class="line"></span><br><span class="line">值缩写（<span class="keyword">Sql</span> <span class="keyword">Server</span>） (<span class="keyword">Access</span> 和 ASP) 说明</span><br><span class="line"></span><br><span class="line"><span class="keyword">Year</span> Yy yyyy 年 <span class="number">1753</span> ~ <span class="number">9999</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Quarter</span> Qq q   季 <span class="number">1</span> ~ <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Month</span> Mm m   月<span class="number">1</span> ~ <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Day</span> <span class="keyword">of</span> <span class="keyword">year</span> Dy y  一年的日数,一年中的第几日 <span class="number">1</span><span class="number">-366</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Day</span> Dd d   日，<span class="number">1</span><span class="number">-31</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Weekday</span> Dw w 一周的日数，一周中的第几日 <span class="number">1</span><span class="number">-7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Week</span> Wk ww  周，一年中的第几周 <span class="number">0</span> ~ <span class="number">51</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Hour</span> Hh h   时<span class="number">0</span> ~ <span class="number">23</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Minute</span> Mi n  分钟<span class="number">0</span> ~ <span class="number">59</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Second</span> Ss s 秒 <span class="number">0</span> ~ <span class="number">59</span></span><br><span class="line"></span><br><span class="line">Millisecond Ms - 毫秒 <span class="number">0</span> ~ <span class="number">999</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Access</span> 和Asp中用<span class="built_in">date</span>()和<span class="keyword">now</span>()取得系统日期时间；其中<span class="keyword">DateDiff</span>,<span class="keyword">DateAdd</span>,<span class="keyword">DatePart</span>也同是能用于<span class="keyword">Access</span>和asp中，这些函数的用法也类似。</span><br></pre></td></tr></table></figure><h1 id="SQL-Server日期函数举例"><a href="#SQL-Server日期函数举例" class="headerlink" title="SQL Server日期函数举例"></a>SQL Server日期函数举例</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.GetDate() 用于sql server :<span class="keyword">select</span> <span class="keyword">GetDate</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span><span class="keyword">DateDiff</span>(<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;2005-07-20&#x27;</span>,<span class="string">&#x27;2005-7-25 22:56:32&#x27;</span>)返回值为 <span class="number">514592</span> 秒</span><br><span class="line"></span><br><span class="line"><span class="keyword">DateDiff</span>(<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;2005-07-20&#x27;</span>,<span class="string">&#x27;2005-7-25 22:56:32&#x27;</span>)返回值为 <span class="number">5</span> 天</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span><span class="keyword">DatePart</span>(<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;2005-7-25 22:56:32&#x27;</span>)返回值为 <span class="number">2</span> 即星期一(周日为<span class="number">1</span>，周六为<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">DatePart</span>(<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;2005-7-25 22:56:32&#x27;</span>)返回值为 <span class="number">25</span>即<span class="number">25</span>号</span><br><span class="line"></span><br><span class="line"><span class="keyword">DatePart</span>(<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;2005-7-25 22:56:32&#x27;</span>)返回值为 <span class="number">206</span>即这一年中第<span class="number">206</span>天</span><br><span class="line"></span><br><span class="line"><span class="keyword">DatePart</span>(<span class="string">&#x27;yyyy&#x27;</span>,<span class="string">&#x27;2005-7-25 22:56:32&#x27;</span>)返回值为 <span class="number">2005</span>即<span class="number">2005</span>年</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>C#发送Get、Post请求(带参数)</title>
      <link href="2022/02/19/httpRequest/"/>
      <url>2022/02/19/httpRequest/</url>
      
        <content type="html"><![CDATA[<h1 id="Post请求"><a href="#Post请求" class="headerlink" title="Post请求"></a>Post请求</h1><h2 id="不带参数发送Post请求"><a href="#不带参数发送Post请求" class="headerlink" title="不带参数发送Post请求"></a>不带参数发送Post请求</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 指定Post地址使用Get 方式获取全部字符串</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;url&quot;&gt;</span>请求后台地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Post</span>(<span class="params"><span class="built_in">string</span> url</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">    req.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">    HttpWebResponse resp = (HttpWebResponse)req.GetResponse();</span><br><span class="line">    Stream stream = resp.GetResponseStream();</span><br><span class="line">    <span class="comment">//获取内容</span></span><br><span class="line">    <span class="keyword">using</span> (StreamReader reader = <span class="keyword">new</span> StreamReader(stream, Encoding.UTF8))</span><br><span class="line">    &#123;</span><br><span class="line">        result = reader.ReadToEnd();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="带参数Post请求-指定键值对"><a href="#带参数Post请求-指定键值对" class="headerlink" title="带参数Post请求,指定键值对"></a>带参数Post请求,指定键值对</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 指定Post地址使用Get 方式获取全部字符串</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;url&quot;&gt;</span>请求后台地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Post</span>(<span class="params"><span class="built_in">string</span> url,Dictionary&lt;<span class="built_in">string</span>,<span class="built_in">string</span>&gt; dic</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">    req.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">    req.ContentType = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 添加Post 参数</span></span><br><span class="line">    StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> dic)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span>)</span><br><span class="line">            builder.Append(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">        builder.AppendFormat(<span class="string">&quot;&#123;0&#125;=&#123;1&#125;&quot;</span>, item.Key, item.Value);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">byte</span>[] data = Encoding.UTF8.GetBytes(builder.ToString());</span><br><span class="line">    req.ContentLength = data.Length;</span><br><span class="line">    <span class="keyword">using</span> (Stream reqStream = req.GetRequestStream())</span><br><span class="line">    &#123;</span><br><span class="line">        reqStream.Write(data, <span class="number">0</span>, data.Length);</span><br><span class="line">        reqStream.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">    HttpWebResponse resp = (HttpWebResponse)req.GetResponse();</span><br><span class="line">    Stream stream = resp.GetResponseStream();</span><br><span class="line">    <span class="comment">//获取响应内容</span></span><br><span class="line">    <span class="keyword">using</span> (StreamReader reader = <span class="keyword">new</span> StreamReader(stream, Encoding.UTF8))</span><br><span class="line">    &#123;</span><br><span class="line">        result = reader.ReadToEnd();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="带参数的Post请求，指定发送字符串内容"><a href="#带参数的Post请求，指定发送字符串内容" class="headerlink" title="带参数的Post请求，指定发送字符串内容"></a>带参数的Post请求，指定发送字符串内容</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 指定Post地址使用Get 方式获取全部字符串</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;url&quot;&gt;</span>请求后台地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>Post提交数据内容(utf-8编码的)<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Post</span>(<span class="params"><span class="built_in">string</span> url, <span class="built_in">string</span> content</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">    req.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">    req.ContentType = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 添加Post 参数</span></span><br><span class="line">    <span class="built_in">byte</span>[] data = Encoding.UTF8.GetBytes(content);</span><br><span class="line">    req.ContentLength = data.Length;</span><br><span class="line">    <span class="keyword">using</span> (Stream reqStream = req.GetRequestStream())</span><br><span class="line">    &#123;</span><br><span class="line">        reqStream.Write(data, <span class="number">0</span>, data.Length);</span><br><span class="line">        reqStream.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"> </span><br><span class="line">    HttpWebResponse resp = (HttpWebResponse)req.GetResponse();</span><br><span class="line">    Stream stream = resp.GetResponseStream();</span><br><span class="line">    <span class="comment">//获取响应内容</span></span><br><span class="line">    <span class="keyword">using</span> (StreamReader reader = <span class="keyword">new</span> StreamReader(stream, Encoding.UTF8))</span><br><span class="line">    &#123;</span><br><span class="line">        result = reader.ReadToEnd();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="带参数的Post请求，指定发送文本及文件"><a href="#带参数的Post请求，指定发送文本及文件" class="headerlink" title="带参数的Post请求，指定发送文本及文件"></a>带参数的Post请求，指定发送文本及文件</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 指定Post地址使用Get 方式获取全部字符串</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;url&quot;&gt;</span>请求后台地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;postData&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;files&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">HttpPost</span>(<span class="params"><span class="built_in">string</span> url, Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; postData, Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; files, <span class="built_in">string</span> cookie</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">request.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">request.Headers.Add(<span class="string">&quot;cookie&quot;</span>, cookie);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> boundary = <span class="built_in">string</span>.Format(<span class="string">&quot;----WebKitFormBoundary&#123;0&#125;&quot;</span>, DateTime.Now.Ticks.ToString(<span class="string">&quot;x&quot;</span>));<span class="comment">//分隔符, 随机字符串或者使用 GlobalConfig.MakeShortGuid();</span></span><br><span class="line">request.ContentType = <span class="built_in">string</span>.Format(<span class="string">&quot;multipart/form-data; boundary=&#123;0&#125;&quot;</span>, boundary);</span><br><span class="line"></span><br><span class="line"><span class="comment">//请求流</span></span><br><span class="line"><span class="keyword">var</span> postStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">region</span> 处理Form表单请求内容</span></span><br><span class="line">List&lt;DataItem&gt; diList = <span class="keyword">new</span> List&lt;DataItem&gt;();</span><br><span class="line"><span class="comment">//是否用Form上传文件</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> files)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">var</span> fileStream = <span class="keyword">new</span> FileStream(item.Value, FileMode.Open, FileAccess.Read);</span><br><span class="line">diList.Add(<span class="keyword">new</span> DataItem()</span><br><span class="line">&#123;</span><br><span class="line">IsFile = <span class="literal">true</span>,</span><br><span class="line">FileName = Path.GetFileName(item.Value),</span><br><span class="line">Key = item.Key,</span><br><span class="line">FileContent = fileStream</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> postData)</span><br><span class="line">&#123;</span><br><span class="line">diList.Add(<span class="keyword">new</span> DataItem()</span><br><span class="line">&#123;</span><br><span class="line">IsFile = <span class="literal">false</span>,</span><br><span class="line">Value = item.Value,</span><br><span class="line">Key = item.Key,</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> formUploadFile = diList != <span class="literal">null</span> &amp;&amp; diList.Count &gt; <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (formUploadFile)</span><br><span class="line">&#123;</span><br><span class="line">SetFormPostStream1(postStream, diList, boundary);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">request.ContentType = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">request.ContentLength = postStream.Length;  <span class="comment">// 写入流的长度，需要 Check</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">region</span> 输入二进制流</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (postStream != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">postStream.Position = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//直接写入流</span></span><br><span class="line">Stream requestStream = request.GetRequestStream();</span><br><span class="line"></span><br><span class="line"><span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">1024</span>];</span><br><span class="line"><span class="built_in">int</span> bytesRead = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> ((bytesRead = postStream.Read(buffer, <span class="number">0</span>, buffer.Length)) != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">requestStream.Write(buffer, <span class="number">0</span>, bytesRead);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">postStream.Close();<span class="comment">//关闭文件访问</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取调用结果</span></span><br><span class="line">HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line"><span class="keyword">using</span> (Stream responseStream = response.GetResponseStream())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">using</span> (StreamReader myStreamReader = <span class="keyword">new</span> StreamReader(responseStream, Encoding.UTF8))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> retString = myStreamReader.ReadToEnd();</span><br><span class="line"><span class="keyword">return</span> retString;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">catch (Exception e)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">throw</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SetFormPostStream1</span>(<span class="params">Stream postStream, List&lt;DataItem&gt; diList, <span class="built_in">string</span> boundary</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//文件数据模板</span></span><br><span class="line"><span class="built_in">string</span> fileFormdata =</span><br><span class="line"><span class="string">&quot;\r\n--&quot;</span> + boundary +</span><br><span class="line"><span class="string">&quot;\r\nContent-Disposition: form-data; name=\&quot;&#123;0&#125;\&quot;; filename=\&quot;&#123;1&#125;\&quot;&quot;</span> +</span><br><span class="line"><span class="string">&quot;\r\nContent-Type: application/vnd.ms-excel&quot;</span> +</span><br><span class="line"><span class="string">&quot;\r\n\r\n&quot;</span>;</span><br><span class="line"><span class="comment">//文本数据模板</span></span><br><span class="line"><span class="built_in">string</span> dataFormdata =</span><br><span class="line"><span class="string">&quot;\r\n--&quot;</span> + boundary +</span><br><span class="line"><span class="string">&quot;\r\nContent-Disposition: form-data; name=\&quot;&#123;0&#125;\&quot;&quot;</span> +</span><br><span class="line"><span class="string">&quot;\r\n\r\n&#123;1&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> diList)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> formdata = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (item.IsFile)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//上传文件</span></span><br><span class="line">formdata = <span class="built_in">string</span>.Format(</span><br><span class="line">fileFormdata,</span><br><span class="line">item.Key, <span class="comment">//表单键</span></span><br><span class="line">item.FileName);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//上传文本</span></span><br><span class="line">formdata = <span class="built_in">string</span>.Format(</span><br><span class="line">dataFormdata,</span><br><span class="line">item.Key,</span><br><span class="line">item.Value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//统一处理</span></span><br><span class="line"><span class="built_in">byte</span>[] formdataBytes = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一行不需要换行</span></span><br><span class="line"><span class="keyword">if</span> (postStream.Length == <span class="number">0</span>)</span><br><span class="line">formdataBytes = Encoding.UTF8.GetBytes(formdata.Substring(<span class="number">2</span>, formdata.Length - <span class="number">2</span>));</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">formdataBytes = Encoding.UTF8.GetBytes(formdata);</span><br><span class="line">postStream.Write(formdataBytes, <span class="number">0</span>, formdataBytes.Length);</span><br><span class="line"></span><br><span class="line"><span class="comment">//写入文件内容</span></span><br><span class="line"><span class="keyword">if</span> (item.FileContent != <span class="literal">null</span> &amp;&amp; item.FileContent.Length &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">using</span> (<span class="keyword">var</span> stream = item.FileContent)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">byte</span>[] buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">1024</span>];</span><br><span class="line"><span class="built_in">int</span> bytesRead = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> ((bytesRead = stream.Read(buffer, <span class="number">0</span>, buffer.Length)) != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">postStream.Write(buffer, <span class="number">0</span>, bytesRead);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//结尾</span></span><br><span class="line"><span class="keyword">var</span> footer = Encoding.UTF8.GetBytes(<span class="string">&quot;\r\n--&quot;</span> + boundary + <span class="string">&quot;--\r\n&quot;</span>);</span><br><span class="line">postStream.Write(footer, <span class="number">0</span>, footer.Length);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DataItem</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">bool</span> IsFile &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Key &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> FileName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Value &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"><span class="keyword">public</span> FileStream FileContent &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Get请求"><a href="#Get请求" class="headerlink" title="Get请求"></a>Get请求</h1><h2 id="简单发送Get请求"><a href="#简单发送Get请求" class="headerlink" title="简单发送Get请求"></a>简单发送Get请求</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 指定Url地址使用Get 方式获取全部字符串</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;url&quot;&gt;</span>请求链接地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Get</span>(<span class="params"><span class="built_in">string</span> url</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);</span><br><span class="line">    HttpWebResponse resp = (HttpWebResponse)req.GetResponse();</span><br><span class="line">    Stream stream = resp.GetResponseStream();</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//获取内容</span></span><br><span class="line">        <span class="keyword">using</span> (StreamReader reader = <span class="keyword">new</span> StreamReader(stream))</span><br><span class="line">        &#123;</span><br><span class="line">            result = reader.ReadToEnd();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span></span><br><span class="line">    &#123;</span><br><span class="line">        stream.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="带请求参数的Get方法"><a href="#带请求参数的Get方法" class="headerlink" title="带请求参数的Get方法"></a>带请求参数的Get方法</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 发送Get请求</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;url&quot;&gt;</span>地址<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dic&quot;&gt;</span>请求参数定义<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Get</span>(<span class="params"><span class="built_in">string</span> url, Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; dic</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    builder.Append(url);</span><br><span class="line">    <span class="keyword">if</span> (dic.Count &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        builder.Append(<span class="string">&quot;?&quot;</span>);</span><br><span class="line">        <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> dic)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">0</span>)</span><br><span class="line">                builder.Append(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">            builder.AppendFormat(<span class="string">&quot;&#123;0&#125;=&#123;1&#125;&quot;</span>, item.Key, item.Value);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    HttpWebRequest req = (HttpWebRequest)WebRequest.Create(builder.ToString());</span><br><span class="line">    <span class="comment">//添加参数</span></span><br><span class="line">    HttpWebResponse resp = (HttpWebResponse)req.GetResponse();</span><br><span class="line">    Stream stream = resp.GetResponseStream();</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//获取内容</span></span><br><span class="line">        <span class="keyword">using</span> (StreamReader reader = <span class="keyword">new</span> StreamReader(stream))</span><br><span class="line">        &#123;</span><br><span class="line">            result = reader.ReadToEnd();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span></span><br><span class="line">    &#123;</span><br><span class="line">        stream.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CefSharp请求资源拦截及自定义处理</title>
      <link href="2022/02/18/CefSharpResourceRequest/"/>
      <url>2022/02/18/CefSharpResourceRequest/</url>
      
        <content type="html"><![CDATA[<h2 id="实例化"><a href="#实例化" class="headerlink" title="实例化"></a>实例化</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ChromiumWebBrowser webview = <span class="keyword">new</span> ChromiumWebBrowser(<span class="string">&quot;http://cdcs.qgil.net/login&quot;</span>);</span><br><span class="line">webview.Dock = DockStyle.Fill;</span><br><span class="line">webview.FrameLoadEnd += Browser_FrameLoadEnd;</span><br><span class="line">webview.RequestHandler = <span class="keyword">new</span> WinFormsRequestHandler();<span class="comment">//request请求的具体实现</span></span><br><span class="line">gb_QG.Controls.Add(webview);</span><br></pre></td></tr></table></figure><h2 id="页面加载完成之后"><a href="#页面加载完成之后" class="headerlink" title="页面加载完成之后"></a>页面加载完成之后</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 页面加载结束</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Browser_FrameLoadEnd</span>(<span class="params"><span class="built_in">object</span> sender, FrameLoadEndEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.BeginInvoke(<span class="keyword">new</span> Action(<span class="keyword">async</span> () =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (e.Url)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//联代登录</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;http://uniscoqd.sdland-sea.com/login&quot;</span>:</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; LDwebview.GetBrowser().GetFrameIdentifiers().Count; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    IFrame frame = LDwebview.GetBrowser().GetFrame(LDwebview.GetBrowser().GetFrameIdentifiers()[i]);</span><br><span class="line">                    <span class="keyword">if</span> (frame.Url == <span class="string">&quot;http://uniscoqd.sdland-sea.com/login&quot;</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                        sb.AppendLine(<span class="string">&quot;function tempFunction() &#123;&quot;</span>);</span><br><span class="line">                        <span class="comment">//sb.AppendLine(&quot; return document.body.innerHTML; &quot;); </span></span><br><span class="line">                        sb.AppendLine(<span class="string">&quot; return document.getElementsByTagName(&#x27;html&#x27;)[0].innerHTML; &quot;</span>);</span><br><span class="line">                        sb.AppendLine(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">                        sb.AppendLine(<span class="string">&quot;tempFunction();&quot;</span>);</span><br><span class="line">                        <span class="keyword">var</span> task01 = frame.EvaluateScriptAsync(sb.ToString());</span><br><span class="line">                        task01.ContinueWith(t =&gt;</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span> (!t.IsFaulted)</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="keyword">var</span> response = t.Result;</span><br><span class="line">                                <span class="keyword">if</span> (response.Success == <span class="literal">true</span>)</span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">if</span> (response.Result != <span class="literal">null</span>)</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        <span class="built_in">string</span> resultStr = response.Result.ToString();</span><br><span class="line">                                        <span class="comment">//解析html</span></span><br><span class="line">                                        HtmlAgilityPack.HtmlDocument htmlDoc = <span class="keyword">new</span> HtmlAgilityPack.HtmlDocument();</span><br><span class="line">                                        htmlDoc.LoadHtml(resultStr);</span><br><span class="line">                                        HtmlNode _HtmlNode = htmlDoc.DocumentNode.SelectSingleNode(<span class="string">&quot;//img[@class=&#x27;login-code-img&#x27;]&quot;</span>);</span><br><span class="line">                                        <span class="keyword">var</span> _csrf = _HtmlNode.Attributes[<span class="string">&quot;src&quot;</span>].Value;</span><br><span class="line">                                        <span class="comment">//保存验证码</span></span><br><span class="line">                                        <span class="keyword">var</span> ImageUrl = Base64ToImage(_csrf, <span class="string">&quot;UploadFile\\CDLD\\&quot;</span>, <span class="string">&quot;cdcs_qgil_net&quot;</span>);</span><br><span class="line">                                        <span class="comment">//识别验证码</span></span><br><span class="line">                                        <span class="keyword">var</span> ImageCodeJson = CJY_RecognizeFile(ImageUrl, <span class="string">&quot;15275228345&quot;</span>, MD5String(<span class="string">&quot;feilian777&quot;</span>), <span class="string">&quot;96001&quot;</span>, <span class="string">&quot;6001&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                                        <span class="keyword">var</span> ImageCodeData = JsonConvert.DeserializeObject&lt;ImageCodeRoot&gt;(ImageCodeJson);</span><br><span class="line">                                        <span class="keyword">if</span> (ImageCodeData.err_no == <span class="number">0</span>)</span><br><span class="line">                                        &#123;</span><br><span class="line">                                            <span class="comment">//登录成功之后账号密码赋值</span></span><br><span class="line">                                            frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;.el-input__inner&#x27;).forEach(function(item, index)&#123;if(index==0)&#123;item.value=&#x27;18663935558&#x27;&#125;else if(index==1)&#123;item.value=&#x27;Qd2025data&#x27;&#125;else&#123;item.value=&#x27;&quot;</span> + ImageCodeData.pic_str + <span class="string">&quot;&#x27;&#125;&#125;)&quot;</span>);</span><br><span class="line">                                            frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;.el-input__inner&#x27;).forEach(function(item, index)&#123;item.dispatchEvent(new Event(&#x27;input&#x27;))&#125;)&quot;</span>);</span><br><span class="line">                                            frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;button&#x27;)[0].click()&quot;</span>);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拦截请求"><a href="#拦截请求" class="headerlink" title="拦截请求"></a>拦截请求</h2><h3 id="新建类WinFormsRequestHandler"><a href="#新建类WinFormsRequestHandler" class="headerlink" title="新建类WinFormsRequestHandler"></a>新建类WinFormsRequestHandler</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WinFormsRequestHandler</span> : <span class="title">RequestHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> IResourceRequestHandler <span class="title">GetResourceRequestHandler</span>(<span class="params">IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame, IRequest request, <span class="built_in">bool</span> isNavigation, <span class="built_in">bool</span> isDownload, <span class="built_in">string</span> requestInitiator, <span class="keyword">ref</span> <span class="built_in">bool</span> disableDefaultHandling</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="comment">//<span class="doctag">NOTE:</span> In most cases you examine the request.Url and only handle requests you are interested in</span></span><br><span class="line">        <span class="keyword">if</span> (request.Url.ToLower().Contains(<span class="string">&quot;login&quot;</span>.ToLower()))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (<span class="keyword">var</span> postData = request.PostData)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (postData != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">var</span> elements = postData.Elements;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">var</span> charSet = request.GetCharSet();</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="keyword">var</span> element <span class="keyword">in</span> elements)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (element.Type == PostDataElementType.Bytes)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">var</span> body = element.GetBody(charSet);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> WinFormResourceRequestHandler();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="新建类WinFormResourceRequestHandler"><a href="#新建类WinFormResourceRequestHandler" class="headerlink" title="新建类WinFormResourceRequestHandler"></a>新建类WinFormResourceRequestHandler</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WinFormResourceRequestHandler</span> : <span class="title">ResourceRequestHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">event</span> Action&lt;<span class="built_in">string</span>&gt; msg;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">event</span> Action&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt; msg2;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> IResponseFilter <span class="title">GetResourceResponseFilter</span>(<span class="params">IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame, IRequest request, IResponse response</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> filter = FilterManager.CreateFilter(request.Identifier.ToString());</span><br><span class="line">        <span class="keyword">return</span> filter;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 加载完成之后</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;chromiumWebBrowser&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;browser&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;frame&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;request&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;response&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;status&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;receivedContentLength&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnResourceLoadComplete</span>(<span class="params">IWebBrowser chromiumWebBrowser, IBrowser browser, IFrame frame, IRequest request, IResponse response, UrlRequestStatus status, <span class="built_in">long</span> receivedContentLength</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> filter = FilterManager.GetFileter(request.Identifier.ToString()) <span class="keyword">as</span> TestJsonFilter;</span><br><span class="line">            <span class="comment">//这里截获返回的数据</span></span><br><span class="line">            <span class="keyword">var</span> ResponseData = Encoding.UTF8.GetString(filter.DataAll.ToArray());</span><br><span class="line">            <span class="built_in">string</span> url = request.Url;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">region</span> 青港</span></span><br><span class="line">            <span class="comment">//获取青港验证码</span></span><br><span class="line">            <span class="keyword">if</span> (url.Contains(<span class="string">&quot;http://cdcs.qgil.net/prod-api/captchaImage&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> ResponseJson = JsonConvert.DeserializeObject&lt;captchaImageRoot&gt;(ResponseData);</span><br><span class="line">                <span class="comment">//保存验证码</span></span><br><span class="line">                <span class="keyword">var</span> ImageUrl = Base64ToImage(<span class="string">&quot;data:image/png;base64,&quot;</span> + ResponseJson.img, <span class="string">&quot;UploadFile\\CDQG\\&quot;</span>, <span class="string">&quot;cdcs_qgil_net&quot;</span>);</span><br><span class="line">                <span class="comment">//识别验证码</span></span><br><span class="line">                <span class="keyword">var</span> ImageCodeJson = CJY_RecognizeFile(ImageUrl, <span class="string">&quot;15275228345&quot;</span>, MD5String(<span class="string">&quot;feilian777&quot;</span>), <span class="string">&quot;96001&quot;</span>, <span class="string">&quot;6001&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                <span class="keyword">var</span> ImageCodeData = JsonConvert.DeserializeObject&lt;ImageCodeRoot&gt;(ImageCodeJson);</span><br><span class="line">                <span class="keyword">if</span> (ImageCodeData.err_no == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//登录成功之后账号密码赋值</span></span><br><span class="line">                    frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;.el-input__inner&#x27;).forEach(function(item, index)&#123;if(index==0)&#123;item.value=&#x27;18663935558&#x27;&#125;else if(index==1)&#123;item.value=&#x27;Qd2025data&#x27;&#125;else&#123;item.value=&#x27;&quot;</span> + ImageCodeData.pic_str + <span class="string">&quot;&#x27;&#125;&#125;)&quot;</span>);</span><br><span class="line">                    frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;.el-input__inner&#x27;).forEach(function(item, index)&#123;item.dispatchEvent(new Event(&#x27;input&#x27;))&#125;)&quot;</span>);</span><br><span class="line">                    frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;button&#x27;)[0].click()&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//获取青港cookie</span></span><br><span class="line">            <span class="keyword">if</span> (url.Contains(<span class="string">&quot;http://cdcs.qgil.net/prod-api/login&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> resData = JsonConvert.DeserializeObject&lt;loginRoot&gt;(ResponseData);</span><br><span class="line">                <span class="keyword">if</span> (resData.code == <span class="number">200</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    Fly_ManifestUser entity = db.Queryable&lt;Fly_ManifestUser&gt;().Where(p =&gt; p.Type == <span class="string">&quot;QG青港&quot;</span>).ToList().FirstOrDefault();</span><br><span class="line">                    entity.Cookie = resData.token;</span><br><span class="line">                    entity.CookieDate = DateTime.Now;</span><br><span class="line">                    db.Updateable(entity).ExecuteCommand();</span><br><span class="line">                    addLog(<span class="string">&quot;青港cookie更新成功------&quot;</span> + DateTime.Now.ToString(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">            <span class="meta">#<span class="meta-keyword">region</span> 外运</span></span><br><span class="line">            <span class="comment">//获取外运验证码</span></span><br><span class="line">            <span class="keyword">if</span> (url.Contains(<span class="string">&quot;https://e-sinotrans.sinotrans.com/services2/usercenter/userCenter/sendIdentifyCode&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">using</span> (<span class="keyword">var</span> postData = request.PostData)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (postData != <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> elements = postData.Elements;</span><br><span class="line">                        <span class="keyword">var</span> charSet = request.GetCharSet();</span><br><span class="line">                        <span class="built_in">string</span> body = <span class="built_in">string</span>.Empty;</span><br><span class="line">                        <span class="keyword">foreach</span> (<span class="keyword">var</span> element <span class="keyword">in</span> elements)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span> (element.Type == PostDataElementType.Bytes)</span><br><span class="line">                            &#123;</span><br><span class="line">                                body = element.GetBody(charSet);</span><br><span class="line">                                msg?.Invoke(body);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">var</span> RequestData = JsonConvert.DeserializeObject&lt;IdentifyCodeRoot&gt;(body);</span><br><span class="line">                        <span class="comment">//登录成功之后账号密码赋值</span></span><br><span class="line">                        frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;.el-input__inner&#x27;).forEach(function(item, index)&#123;if(index==0)&#123;item.value=&#x27;QDYJZX&#x27;&#125;else if(index==1)&#123;item.value=&#x27;Qd123456#&#x27;&#125;else&#123;item.value=&#x27;&quot;</span> + RequestData.identifyCode + <span class="string">&quot;&#x27;&#125;&#125;)&quot;</span>);</span><br><span class="line">                        frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;.el-input__inner&#x27;).forEach(function(item, index)&#123;item.dispatchEvent(new Event(&#x27;input&#x27;))&#125;)&quot;</span>);</span><br><span class="line">                        frame.ExecuteJavaScriptAsync(<span class="string">@&quot;document.querySelectorAll(&#x27;button&#x27;)[0].click()&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//获取外运cookie</span></span><br><span class="line">            <span class="keyword">if</span> (url.Contains(<span class="string">&quot;https://e-sinotrans.sinotrans.com/services2/usercenter/EsFunction/getFunctionUrls&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> cookies = request.GetHeaderByName(<span class="string">&quot;Cookie&quot;</span>);</span><br><span class="line">                Fly_ManifestUser entity = db.Queryable&lt;Fly_ManifestUser&gt;().Where(p =&gt; p.Type == <span class="string">&quot;WY外运&quot;</span>).ToList().FirstOrDefault();</span><br><span class="line">                entity.Cookie = cookies;</span><br><span class="line">                entity.CookieDate = DateTime.Now;</span><br><span class="line">                db.Updateable(entity).ExecuteCommand();</span><br><span class="line">                addLog(<span class="string">&quot;外运cookie更新成功------&quot;</span> + DateTime.Now.ToString(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception)</span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//protected override CefReturnValue OnBeforeResourceLoad(IWebBrowser browserControl, IBrowser browser, IFrame frame, IRequest request, IRequestCallback callback)</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    var Method = request.Method;</span></span><br><span class="line">    <span class="comment">//    if (request.Url.Contains(&quot;http://cdcs.qgil.net/prod-api/captchaImage&quot;))</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    msg?.Invoke(request.Url);</span></span><br><span class="line">    <span class="comment">//    msg?.Invoke(Method);</span></span><br><span class="line">    <span class="comment">//    //清单分页查询</span></span><br><span class="line">    <span class="comment">//    return CefReturnValue.Continue;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="新建类FilterManager"><a href="#新建类FilterManager" class="headerlink" title="新建类FilterManager"></a>新建类FilterManager</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestJsonFilter</span> : <span class="title">IResponseFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">List</span>&lt;<span class="title">byte</span>&gt; DataAll</span> = <span class="keyword">new</span> List&lt;<span class="built_in">byte</span>&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterStatus <span class="title">Filter</span>(<span class="params">System.IO.Stream dataIn, <span class="keyword">out</span> <span class="built_in">long</span> dataInRead, System.IO.Stream dataOut, <span class="keyword">out</span> <span class="built_in">long</span> dataOutWritten</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (dataIn == <span class="literal">null</span> || dataIn.Length == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                dataInRead = <span class="number">0</span>;</span><br><span class="line">                dataOutWritten = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> FilterStatus.Done;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            dataInRead = dataIn.Length;</span><br><span class="line">            dataOutWritten = Math.Min(dataInRead, dataOut.Length);</span><br><span class="line"></span><br><span class="line">            dataIn.CopyTo(dataOut);</span><br><span class="line">            dataIn.Seek(<span class="number">0</span>, SeekOrigin.Begin);</span><br><span class="line">            <span class="built_in">byte</span>[] bs = <span class="keyword">new</span> <span class="built_in">byte</span>[dataIn.Length];</span><br><span class="line">            dataIn.Read(bs, <span class="number">0</span>, bs.Length);</span><br><span class="line">            DataAll.AddRange(bs);</span><br><span class="line"></span><br><span class="line">            dataInRead = dataIn.Length;</span><br><span class="line">            dataOutWritten = dataIn.Length;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> FilterStatus.NeedMoreData;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            dataInRead = dataIn.Length;</span><br><span class="line">            dataOutWritten = dataIn.Length;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> FilterStatus.Done;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">InitFilter</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dispose</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FilterManager</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="title">Dictionary</span>&lt;<span class="title">string</span>, <span class="title">IResponseFilter</span>&gt; dataList</span> = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, IResponseFilter&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IResponseFilter <span class="title">CreateFilter</span>(<span class="params"><span class="built_in">string</span> guid</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">lock</span> (dataList)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> filter = <span class="keyword">new</span> TestJsonFilter();</span><br><span class="line">            dataList.Add(guid, filter);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> filter;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IResponseFilter <span class="title">GetFileter</span>(<span class="params"><span class="built_in">string</span> guid</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">lock</span> (dataList)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> dataList[guid];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>FiddlerCore拦截本地请求</title>
      <link href="2021/09/26/Fiddler/"/>
      <url>2021/09/26/Fiddler/</url>
      
        <content type="html"><![CDATA[<h2 id="引用dll"><a href="#引用dll" class="headerlink" title="引用dll"></a>引用dll</h2><blockquote><p><a href="https://pan.baidu.com/s/1bB7IfQceKhpDF_fsrMbplA">FiddlerCore4.dll 下载地址</a><br>提取码:7g07</p></blockquote><h2 id="定义参数"><a href="#定义参数" class="headerlink" title="定义参数"></a>定义参数</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//https代理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Proxy oSecureEndpoint;</span><br><span class="line"><span class="comment">//主机名</span></span><br><span class="line"><span class="built_in">string</span> sSecureEndpointHostname = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="comment">//伪装https服务器（别人这么说，我也没搞明白这个技术细节）</span></span><br><span class="line"><span class="built_in">int</span> iSecureEndpointPort = <span class="number">8877</span>;</span><br><span class="line"><span class="comment">//代理端口</span></span><br><span class="line"><span class="built_in">int</span> iStartPort = <span class="number">9898</span>;</span><br><span class="line"><span class="comment">//FiddlerCore抓取到的会话不会缓存，所以，要自己维护一个会话列表，来保存所关心的请求</span></span><br><span class="line">List&lt;Session&gt; oAllSessions = <span class="keyword">new</span> List&lt;Session&gt;();</span><br><span class="line"><span class="built_in">string</span> cookies;</span><br></pre></td></tr></table></figure><h2 id="初始化Fiddler"><a href="#初始化Fiddler" class="headerlink" title="初始化Fiddler"></a>初始化Fiddler</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitFiddler</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//这个名字随便</span></span><br><span class="line">    FiddlerApplication.SetAppDisplayName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    <span class="comment">//绑定事件处理————当发起请求之前</span></span><br><span class="line">    FiddlerApplication.BeforeRequest += On_BeforeRequest;</span><br><span class="line">    <span class="comment">//绑定事件处理————当会话结束之后</span></span><br><span class="line">    FiddlerApplication.AfterSessionComplete += On_AfterSessionComplete;</span><br><span class="line">    <span class="comment">//绑定事件处理————当会话请求中</span></span><br><span class="line">    FiddlerApplication.BeforeResponse += FiddlerApplication_BeforeResponse;</span><br><span class="line">    <span class="comment">//-----------处理证书-----------</span></span><br><span class="line">    <span class="comment">//伪造的证书</span></span><br><span class="line">    X509Certificate2 oRootCert;</span><br><span class="line">    <span class="comment">//如果没有伪造过证书并把伪造的证书加入本机证书库中</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> == CertMaker.GetRootCertificate())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//创建伪造证书</span></span><br><span class="line">        CertMaker.createRootCert();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//重新获取</span></span><br><span class="line">        oRootCert = CertMaker.GetRootCertificate();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//打开本地证书库</span></span><br><span class="line">        X509Store certStore = <span class="keyword">new</span> X509Store(StoreName.Root, StoreLocation.LocalMachine);</span><br><span class="line">        certStore.Open(OpenFlags.ReadWrite);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//将伪造的证书加入到本地的证书库</span></span><br><span class="line">            certStore.Add(oRootCert);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span></span><br><span class="line">        &#123;</span><br><span class="line">            certStore.Close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> serviceRuntimeUserCertificateStore = <span class="keyword">new</span> X509Store(StoreName.My);</span><br><span class="line">        serviceRuntimeUserCertificateStore.Open(OpenFlags.ReadWrite);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        serviceRuntimeUserCertificateStore.Add(oRootCert);</span><br><span class="line">        serviceRuntimeUserCertificateStore.Close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//以前伪造过证书，并且本地证书库中保存过伪造的证书</span></span><br><span class="line">        oRootCert = CertMaker.GetRootCertificate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//-----------------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定伪造证书</span></span><br><span class="line">    FiddlerApplication.oDefaultClientCertificate = oRootCert;</span><br><span class="line">    <span class="comment">//忽略服务器证书错误</span></span><br><span class="line">    CONFIG.IgnoreServerCertErrors = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//信任证书</span></span><br><span class="line">    CertMaker.trustRootCert();</span><br><span class="line">    <span class="comment">//看字面意思知道是啥，但实际起到啥作用。。。鬼才知道，官方例程里有这句，加上吧，管它呢。</span></span><br><span class="line">    FiddlerApplication.Prefs.SetBoolPref(<span class="string">&quot;fiddler.network.streaming.abortifclientaborts&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//启动代理服务————启动参数1：捕捉https；启动参数2：允许局域网其他终端连入本代理</span></span><br><span class="line">    FiddlerApplication.Startup(iStartPort, FiddlerCoreStartupFlags.DecryptSSL | FiddlerCoreStartupFlags.AllowRemoteClients | FiddlerCoreStartupFlags.Default);</span><br><span class="line">    <span class="comment">//创建https代理</span></span><br><span class="line">    oSecureEndpoint = FiddlerApplication.CreateProxyEndpoint(iSecureEndpointPort, <span class="literal">true</span>, oRootCert);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="封包发送中事件"><a href="#封包发送中事件" class="headerlink" title="封包发送中事件"></a>封包发送中事件</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FiddlerApplication_BeforeResponse</span>(<span class="params">Session oS</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HTTPRequestHeaders headers = oS.oRequest.headers;</span><br><span class="line">    <span class="keyword">if</span> (oS.fullUrl == <span class="string">&quot;http://www.sufeinet.com/&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cookies = headers.AllValues(<span class="string">&quot;cookie&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (oS.fullUrl == <span class="string">&quot;https://www.sditds.gov.cn/sdvplatformserver/swProxy/deskserver/sw/deskIndex?menu_id=spl&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cookies = headers.AllValues(<span class="string">&quot;cookie&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 报关单</span></span><br><span class="line">    <span class="comment">//添加报关单按钮</span></span><br><span class="line">    <span class="keyword">if</span> (oS.fullUrl.Contains(<span class="string">&quot;https://www.sditds.gov.cn:443/sdvplatformserver/swProxy/decserver/sw/dec/cusCiqZhImport&quot;</span>) || oS.fullUrl.Contains(<span class="string">&quot;https://www.sditds.gov.cn/sdvplatformserver/swProxy/decserver/sw/dec/cusCiqZhImport&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        bll_Home.AddDecHeadbtn(oS);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//添加报关单事件</span></span><br><span class="line">    <span class="keyword">if</span> (oS.fullUrl.Contains(<span class="string">&quot;static/js/dec/cusCiqZh/dec.js&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        bll_Home.AddDecHeadevent(oS, AESEncryptHelperAuto.AESDecrypt(ConfigHelper.GetValue(<span class="string">&quot;Account&quot;</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//解密手册对应的商品料号</span></span><br><span class="line">    <span class="keyword">if</span> (oS.fullUrl.Contains(<span class="string">&quot;https://www.sditds.gov.cn/sdvplatformserver/swProxy/invtwebserver/sw/ems/pub/common/EmsListQuery/Npts/&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        cookies = headers.AllValues(<span class="string">&quot;cookie&quot;</span>);</span><br><span class="line">        oS.utilDecodeResponse();</span><br><span class="line">        <span class="built_in">string</span> requestText = System.Text.Encoding.UTF8.GetString(oS.ResponseBody);</span><br><span class="line">        <span class="built_in">string</span> str2 = BGHelper.menuType2(cookies);</span><br><span class="line">        <span class="built_in">string</span> fun = <span class="built_in">string</span>.Format(<span class="string">@&quot;loadMenuTypeStr(&#x27;&#123;0&#125;&#x27;)&quot;</span>, requestText.Replace(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">        <span class="keyword">var</span> data = JsHelper.ExecuteScript(fun, str2);</span><br><span class="line">        oS.utilSetResponseBody(data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">region</span> 随附单据上传格式转换</span></span><br><span class="line">    <span class="keyword">if</span> (oS.fullUrl.Contains(<span class="string">&quot;static/js/dec/cusCiqZh/docUpload.js&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        cookies = headers.AllValues(<span class="string">&quot;cookie&quot;</span>);</span><br><span class="line">        oS.utilDecodeResponse();</span><br><span class="line">        <span class="built_in">string</span> requestText = System.Text.Encoding.UTF8.GetString(oS.ResponseBody);</span><br><span class="line">        requestText = requestText.Replace(<span class="string">&quot;choosePdfFile();&quot;</span>, <span class="string">&quot;keepFile(1);&quot;</span>) + <span class="string">&quot;function keepFile(type) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var cusCiqNo = $(\&quot;#cusCiqNo\&quot;).val();&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var attTypeCode = $(\&quot;#attTypeCode\&quot;).val();&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var attTypeCodeName = $(\&quot;#attTypeCodeName\&quot;).val();&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    if (!cusCiqNo) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        layerMsg(&#x27;请先保存基本信息！&#x27;, 2, 3000);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        return false;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    if (!attTypeCode) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        layerMsg(&#x27;请选择随附单据文件类别！&#x27;, 2, 3000);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        return false;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var attEdocNo = $(\&quot;#dec_doc_form input[id=attEdocNo]\&quot;).val();&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var begin = attTypeCode.substring(0, 1);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var attFmtTypeCode = \&quot;US\&quot;;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var docType = \&quot;所有文件 | *.* \&quot;;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var docSize = \&quot;4M\&quot;;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var attSeqNo = \&quot;\&quot;;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    $(\&quot;#i_select_files\&quot;).prop(\&quot;disabled\&quot;, true);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    var ws = new WebSocket(\&quot;ws://127.0.0.1:12581\&quot;);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    ws.onopen = function () &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        ws.send(\&quot;1\&quot;);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    ws.onmessage = function (evt) &#123; &quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        if (evt.data.toString() == \&quot;当前文件类型不可转换\&quot;) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        else if (evt.data.toString() == \&quot;用户已取消\&quot;) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        else if (evt.data.toString() == \&quot;图片压缩失败\&quot;) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            layer.alert(\&quot;图片压缩失败\&quot;);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        else if (evt.data.toString() == \&quot;文件压缩后大于4M\&quot;) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            layer.alert(\&quot;文件压缩后大于4M\&quot;);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        else if (evt.data.toString() == \&quot;文件单页超过400kb\&quot;) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            layer.alert(\&quot;文件单页超过400kb\&quot;);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        else if (evt.data.toString() == \&quot;文件名称含有不规则符号请修改，例如 = 和 &amp;。\&quot;) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            layer.alert(\&quot;文件名称含有不规则符号请修改，例如 = 和 &amp;。\&quot;);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        &#125; else if (evt.data.toString() == \&quot;文件转换出错！请联系管理员\&quot;) &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\nlayer.alert(\&quot;文件转换出错！请联系管理员\&quot;);       &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        else &#123; var attEdocPath = evt.data.toString(); attEdocPath = attEdocPath.replace(/(\\\\)/g, &#x27;/&#x27;); var entOrigFileName = attEdocPath.substr(attEdocPath.lastIndexOf(\&quot;/\&quot;) + 1);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            var docType = attEdocPath.substr(attEdocPath.lastIndexOf(\&quot;.\&quot;) + 1);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            var addRow = &#123;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attSeqNo\&quot;: attSeqNo,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;cusCiqNo\&quot;: cusCiqNo,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attTypeCode\&quot;: attTypeCode,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attTypeCodeName\&quot;: attTypeCodeName,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attEdocNo\&quot;: attEdocNo,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;entOrigFileName\&quot;: entOrigFileName,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attFmtTypeCode\&quot;: attFmtTypeCode,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attEdocId\&quot;: \&quot;\&quot;,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attEdocPath\&quot;: attEdocPath,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;attEdocStatus\&quot;: \&quot;\&quot;,&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n                \&quot;docType\&quot;: docType&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            &#125;;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n            $(\&quot;#decDocTable\&quot;).bootstrapTable(\&quot;append\&quot;, [addRow]); decDocFormReset(); $(&#x27;#attTypeCodeName&#x27;).focus(); $(\&quot;#i_select_files\&quot;).prop(\&quot;disabled\&quot;, false);&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n        ws.close();&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    &#125;;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n    ws.onerror = function (env) &#123;   if (env.target.readyState == 3) &#123;      choosePdfFile(type);   &#125;    ws.close();    &#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;\r\n&#125;&quot;</span> +</span><br><span class="line">           <span class="string">&quot;&quot;</span>;</span><br><span class="line">        oS.utilSetResponseBody(requestText);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="封包发送之前事件"><a href="#封包发送之前事件" class="headerlink" title="封包发送之前事件"></a>封包发送之前事件</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">On_BeforeRequest</span>(<span class="params">Session oS</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        oS.fullUrl.Contains(<span class="string">&quot;static/js/dec/cusCiqZh/docUpload.js&quot;</span>)</span><br><span class="line">        || oS.fullUrl.Contains(<span class="string">&quot;static/js/dec/cusCiqZh/dec.js&quot;</span>)</span><br><span class="line">        || oS.fullUrl.Contains(<span class="string">&quot;https://www.sditds.gov.cn:443/sdvplatformserver/swProxy/decserver/sw/dec/cusCiqZhImport&quot;</span>)</span><br><span class="line">        || oS.fullUrl.Contains(<span class="string">&quot;https://www.sditds.gov.cn/sdvplatformserver/swProxy/decserver/sw/dec/cusCiqZhImport&quot;</span>)</span><br><span class="line">        || oS.fullUrl.Contains(<span class="string">&quot;https://www.sditds.gov.cn/sdvplatformserver/swProxy/invtwebserver/sw/ems/pub/common/EmsListQuery/Npts/&quot;</span>)</span><br><span class="line">        )</span><br><span class="line">        oS.bBufferResponse = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="封包响应结束事件"><a href="#封包响应结束事件" class="headerlink" title="封包响应结束事件"></a>封包响应结束事件</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">On_AfterSessionComplete</span>(<span class="params">Session oS</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="几个关键的方法和变量"><a href="#几个关键的方法和变量" class="headerlink" title="几个关键的方法和变量"></a>几个关键的方法和变量</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获得Request体</span></span><br><span class="line"></span><br><span class="line">oSession.GetRequestBodyAsString()      </span><br><span class="line"></span><br><span class="line"><span class="comment">//获得Response内容</span></span><br><span class="line"></span><br><span class="line">oSession.GetResponseBodyAsString()</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 修改session中的显示样式</span></span><br><span class="line"></span><br><span class="line"> oSession[<span class="string">&quot;ui-color&quot;</span>] = <span class="string">&quot;orange&quot;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 移除http头部中的MQB-X5-Referer字段</span></span><br><span class="line"></span><br><span class="line"> oSession.oRequest.headers.Remove(<span class="string">&quot;MQB-X5-Referer&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 修改http头部中的Cache-Control字段</span></span><br><span class="line"></span><br><span class="line"> oSession.oRequest[<span class="string">&quot;Cache-Control&quot;</span>] = <span class="string">&quot;no-cache&quot;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 修改host</span></span><br><span class="line"></span><br><span class="line"> oSession.host = <span class="string">&quot;example.domain&quot;</span>; </span><br><span class="line"></span><br><span class="line"> <span class="comment">// 修改Origin字段</span></span><br><span class="line"></span><br><span class="line"> oSession.oRequest[<span class="string">&quot;Origin&quot;</span>] = <span class="string">&quot;http://domain&quot;</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 删除所有的cookie</span></span><br><span class="line"></span><br><span class="line"> oSession.oRequest.headers.Remove(<span class="string">&quot;Cookie&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 新建cookie</span></span><br><span class="line"></span><br><span class="line"> oSession.oRequest.headers.Add(<span class="string">&quot;Cookie&quot;</span>, <span class="string">&quot;username=cookiename;&quot;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 修改Referer字段</span></span><br><span class="line"></span><br><span class="line"> oSession.oRequest[<span class="string">&quot;Referer&quot;</span>] = <span class="string">&quot;https://yoururl&quot;</span>;</span><br><span class="line"></span><br><span class="line"> 拦截websockets请求</span><br><span class="line"></span><br><span class="line"> FiddlerApplication_OnWebSocketMessage  </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>layui表格单击行勾选复选框</title>
      <link href="2021/06/10/layuiCheckbox/"/>
      <url>2021/06/10/layuiCheckbox/</url>
      
        <content type="html"><![CDATA[<blockquote><p>实现思路<br>直接修改复选框选中状态和伪复选框（DIV）Class<br>但是调用checkStatus获取不到选中的行<br>查看底层源代码checkStatus方法的实现是缓存数据中的属性来判断是否选中<br>所以循环缓存数据，用index找到操作数据修改，再次获取选中行就可以获取到了</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">table.on(<span class="string">&#x27;row(userTable)&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">　　<span class="keyword">var</span> flag = !obj.tr.find(<span class="string">&#x27;:checkbox:first&#x27;</span>).prop(<span class="string">&#x27;checked&#x27;</span>);</span><br><span class="line">　　obj.tr.find(<span class="string">&#x27;:checkbox&#x27;</span>).prop(<span class="string">&#x27;checked&#x27;</span>,flag);</span><br><span class="line">　　<span class="keyword">if</span>(flag)&#123;</span><br><span class="line">　　　　obj.tr.find(<span class="string">&#x27;.layui-form-checkbox&#x27;</span>).addClass(<span class="string">&#x27;layui-form-checked&#x27;</span>);</span><br><span class="line">　　&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">　　　　obj.tr.find(<span class="string">&#x27;.layui-form-checkbox&#x27;</span>).removeClass(<span class="string">&#x27;layui-form-checked&#x27;</span>);</span><br><span class="line">　　&#125;</span><br><span class="line">　　layui.each(table.cache.userTable,<span class="function"><span class="keyword">function</span>(<span class="params">i,item</span>)</span>&#123;</span><br><span class="line">　　　　<span class="keyword">if</span>(obj.tr.index()==item.LAY_TABLE_INDEX)&#123;</span><br><span class="line">　　　　　　item.LAY_CHECKED=flag;</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>div区域样式</title>
      <link href="2021/06/01/divbor/"/>
      <url>2021/06/01/divbor/</url>
      
        <content type="html"><![CDATA[<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;widgets-recordgrp-crm circleBox&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height:120px;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;circleContent&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;grp-title-box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;Areatitle&quot;</span>&gt;</span>1.进港<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;recordgrp-table&quot;</span>&gt;</span></span><br><span class="line">          </span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Areatitle</span> &#123;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">padding-right</span>: <span class="number">2px</span>;</span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="number">2px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">       </span><br><span class="line">  <span class="selector-class">.recordgrp-table</span> &#123;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">10px</span> <span class="number">10px</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">       </span><br><span class="line">  <span class="selector-class">.grp-title-box</span> &#123;</span><br><span class="line">      <span class="attribute">font-family</span>: <span class="string">&quot;微软雅黑&quot;</span>;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#4b86fc</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">float</span>: left;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">      <span class="attribute">margin</span>: -<span class="number">15px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">19px</span>;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">font-weight</span>: bold;</span><br><span class="line">      <span class="attribute">width</span>: auto;</span><br><span class="line">      <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">25px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">       </span><br><span class="line">  <span class="selector-class">.circleContent</span> &#123;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#4b86fc</span>;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">position</span>: relative;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#3d5266</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">       </span><br><span class="line">  <span class="selector-class">.widgets-recordgrp-crm</span><span class="selector-class">.circleBox</span> &#123;</span><br><span class="line">      <span class="attribute">min-width</span>: <span class="number">152px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">       </span><br><span class="line">  <span class="selector-class">.widgets-recordgrp-crm</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">9px</span> <span class="number">0</span> <span class="number">8px</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://z3.ax1x.com/2021/06/01/2u54ET.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>解决 viewer.js 动态更新图片导致无法预览的问题</title>
      <link href="2021/04/08/viewerbug/"/>
      <url>2021/04/08/viewerbug/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://pan.baidu.com/s/1MB1byEjNH7wph4eq4UczIw">viewer.js 下载地址</a><br>提取码:a1ns</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化 viewer.js</span></span><br><span class="line"><span class="keyword">var</span> viewer = <span class="keyword">new</span> Viewer(<span class="built_in">document</span>.getElementById(<span class="string">&#x27;upllist&#x27;</span>), &#123;</span><br><span class="line">    toolbar: <span class="literal">true</span>, <span class="comment">//显示工具条</span></span><br><span class="line">    <span class="function"><span class="title">viewed</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        viewer.zoomTo(<span class="number">0.75</span>); <span class="comment">// 图片显示比例 75%</span></span><br><span class="line">    &#125;,</span><br><span class="line">    show: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  <span class="comment">// 动态加载图片后，更新实例</span></span><br><span class="line">        viewer.update();</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JS刷新当前iframe页面</title>
      <link href="2021/01/19/jsRefreshiframe/"/>
      <url>2021/01/19/jsRefreshiframe/</url>
      
        <content type="html"><![CDATA[<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> frameId = (<span class="built_in">window</span>.frameElement &amp;&amp; <span class="built_in">window</span>.frameElement.id) || <span class="string">&quot;&quot;</span>; <span class="comment">//获取当前页面的Id</span></span><br><span class="line">parent.document.getElementById(frameId).contentWindow.location.reload(); <span class="comment">//刷新iframe</span></span><br></pre></td></tr></table></figure><h1 id="layer-调用子页面方法"><a href="#layer-调用子页面方法" class="headerlink" title="layer 调用子页面方法"></a>layer 调用子页面方法</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iframeWin = <span class="built_in">window</span>[layero.find(<span class="string">&quot;iframe&quot;</span>)[<span class="number">0</span>][<span class="string">&quot;name&quot;</span>]];</span><br><span class="line">iframeWin.acceptClick(page.search);</span><br></pre></td></tr></table></figure><h1 id="layer-关闭当前页面方法"><a href="#layer-关闭当前页面方法" class="headerlink" title="layer 关闭当前页面方法"></a>layer 关闭当前页面方法</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Iframe = parent.layer.getFrameIndex(<span class="built_in">window</span>.name); <span class="comment">//获取当前窗口的name</span></span><br><span class="line">parent.layer.close(Iframe); <span class="comment">//关闭窗口</span></span><br></pre></td></tr></table></figure><h1 id="layer-调用父窗口方法"><a href="#layer-调用父窗口方法" class="headerlink" title="layer 调用父窗口方法"></a>layer 调用父窗口方法</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> frame = learun.frameTab.currentIframe(); <span class="comment">//获取父窗口</span></span><br><span class="line">frame.refreshGirdData();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NPOI读取Excel</title>
      <link href="2021/01/11/NPOIreadExcel/"/>
      <url>2021/01/11/NPOIreadExcel/</url>
      
        <content type="html"><![CDATA[<h1 id="读取Excel"><a href="#读取Excel" class="headerlink" title="读取Excel"></a>读取Excel</h1><blockquote><p>本文导出Excel表格是基于NPOI</p></blockquote><p>NPOI是指构建在POI 3.x版本之上的一个程序，NPOI可以在没有安装Office的情况下对Word或Excel文档进行读写操作。</p><p>NPOI的下载与引用:<a href="https://kezhanw.github.io/2020/12/30/ExportExcel/">https://kezhanw.github.io/2020/12/30/ExportExcel/</a></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">      <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>  </span></span><br><span class="line">      <span class="comment"><span class="doctag">///</span> 将excel导入到datatable  </span></span><br><span class="line">      <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span>  </span></span><br><span class="line">      <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filePath&quot;&gt;</span>excel路径<span class="doctag">&lt;/param&gt;</span>  </span></span><br><span class="line">      <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;isColumnName&quot;&gt;</span>第一行是否是列名<span class="doctag">&lt;/param&gt;</span>  </span></span><br><span class="line">      <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回datatable<span class="doctag">&lt;/returns&gt;</span>  </span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataTable <span class="title">ExcelToDataTable</span>(<span class="params"><span class="built_in">string</span> filePath, <span class="built_in">bool</span> isColumnName</span>)</span></span><br><span class="line"><span class="function"></span>      &#123;</span><br><span class="line">          DataTable dataTable = <span class="literal">null</span>;</span><br><span class="line">          FileStream fs = <span class="literal">null</span>;</span><br><span class="line">          DataColumn column = <span class="literal">null</span>;</span><br><span class="line">          DataRow dataRow = <span class="literal">null</span>;</span><br><span class="line">          IWorkbook workbook = <span class="literal">null</span>;</span><br><span class="line">          ISheet sheet = <span class="literal">null</span>;</span><br><span class="line">          IRow row = <span class="literal">null</span>;</span><br><span class="line">          ICell cell = <span class="literal">null</span>;</span><br><span class="line">          <span class="built_in">int</span> startRow = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">try</span></span><br><span class="line">          &#123;</span><br><span class="line">              fs = File.OpenRead(filePath);</span><br><span class="line">              <span class="comment">// 2007版本  </span></span><br><span class="line">              <span class="keyword">if</span> (filePath.IndexOf(<span class="string">&quot;.xlsx&quot;</span>) &gt; <span class="number">0</span>)</span><br><span class="line">                  workbook = <span class="keyword">new</span> XSSFWorkbook(fs);</span><br><span class="line">              <span class="comment">// 2003版本  </span></span><br><span class="line">              <span class="keyword">else</span> <span class="keyword">if</span> (filePath.IndexOf(<span class="string">&quot;.xls&quot;</span>) &gt; <span class="number">0</span>)</span><br><span class="line">                  workbook = <span class="keyword">new</span> HSSFWorkbook(fs);</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (workbook != <span class="literal">null</span>)</span><br><span class="line">              &#123;</span><br><span class="line">                  sheet = workbook.GetSheetAt(<span class="number">0</span>);<span class="comment">//读取第一个sheet，当然也可以循环读取每个sheet  </span></span><br><span class="line">                  dataTable = <span class="keyword">new</span> DataTable();</span><br><span class="line">                  <span class="keyword">if</span> (sheet != <span class="literal">null</span>)</span><br><span class="line">                  &#123;</span><br><span class="line">                      <span class="built_in">int</span> rowCount = sheet.LastRowNum;<span class="comment">//总行数  </span></span><br><span class="line">                      <span class="keyword">if</span> (rowCount &gt; <span class="number">0</span>)</span><br><span class="line">                      &#123;</span><br><span class="line">                          IRow firstRow = sheet.GetRow(<span class="number">0</span>);<span class="comment">//第一行  </span></span><br><span class="line">                          <span class="built_in">int</span> cellCount = firstRow.LastCellNum;<span class="comment">//列数  </span></span><br><span class="line"></span><br><span class="line">                          <span class="comment">//构建datatable的列  </span></span><br><span class="line">                          <span class="keyword">if</span> (isColumnName)</span><br><span class="line">                          &#123;</span><br><span class="line">                              startRow = <span class="number">1</span>;<span class="comment">//如果第一行是列名，则从第二行开始读取  </span></span><br><span class="line">                              <span class="keyword">for</span> (<span class="built_in">int</span> i = firstRow.FirstCellNum; i &lt; cellCount; ++i)</span><br><span class="line">                              &#123;</span><br><span class="line">                                  cell = firstRow.GetCell(i);</span><br><span class="line">                                  <span class="keyword">if</span> (cell != <span class="literal">null</span>)</span><br><span class="line">                                  &#123;</span><br><span class="line">                                      <span class="keyword">if</span> (cell.StringCellValue != <span class="literal">null</span>)</span><br><span class="line">                                      &#123;</span><br><span class="line">                                          column = <span class="keyword">new</span> DataColumn(cell.StringCellValue);</span><br><span class="line">                                          dataTable.Columns.Add(column);</span><br><span class="line">                                      &#125;</span><br><span class="line">                                  &#125;</span><br><span class="line">                              &#125;</span><br><span class="line">                          &#125;</span><br><span class="line">                          <span class="keyword">else</span></span><br><span class="line">                          &#123;</span><br><span class="line">                              <span class="keyword">for</span> (<span class="built_in">int</span> i = firstRow.FirstCellNum; i &lt; cellCount; ++i)</span><br><span class="line">                              &#123;</span><br><span class="line">                                  column = <span class="keyword">new</span> DataColumn(<span class="string">&quot;column&quot;</span> + (i + <span class="number">1</span>));</span><br><span class="line">                                  dataTable.Columns.Add(column);</span><br><span class="line">                              &#125;</span><br><span class="line">                          &#125;</span><br><span class="line"></span><br><span class="line">                          <span class="comment">//填充行  </span></span><br><span class="line">                          <span class="keyword">for</span> (<span class="built_in">int</span> i = startRow; i &lt;= rowCount; ++i)</span><br><span class="line">                          &#123;</span><br><span class="line">                              row = sheet.GetRow(i);</span><br><span class="line">                              <span class="keyword">if</span> (row == <span class="literal">null</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">                              dataRow = dataTable.NewRow();</span><br><span class="line">                              <span class="keyword">for</span> (<span class="built_in">int</span> j = row.FirstCellNum; j &lt; cellCount; ++j)</span><br><span class="line">                              &#123;</span><br><span class="line">                                  cell = row.GetCell(j);</span><br><span class="line">                                  <span class="keyword">if</span> (cell == <span class="literal">null</span>)</span><br><span class="line">                                  &#123;</span><br><span class="line">                                      dataRow[j] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                  &#125;</span><br><span class="line">                                  <span class="keyword">else</span></span><br><span class="line">                                  &#123;</span><br><span class="line"><span class="comment">//是否是单元格合并</span></span><br><span class="line"><span class="keyword">if</span> (cell.IsMergedCell)</span><br><span class="line">&#123;</span><br><span class="line">cell = MergedCell(cell);</span><br><span class="line">&#125;</span><br><span class="line">                                      <span class="comment">//CellType(Unknown = -1,Numeric = 0,String = 1,Formula = 2,Blank = 3,Boolean = 4,Error = 5,)  </span></span><br><span class="line">                                      <span class="keyword">switch</span> (cell.CellType)</span><br><span class="line">                                      &#123;</span><br><span class="line">                                          <span class="keyword">case</span> CellType.Blank:</span><br><span class="line">                                              dataRow[j] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                              <span class="keyword">break</span>;</span><br><span class="line">                                          <span class="keyword">case</span> CellType.Numeric:</span><br><span class="line">                                              <span class="built_in">short</span> format = cell.CellStyle.DataFormat;</span><br><span class="line">                                              <span class="comment">//对时间格式（2015.12.5、2015/12/5、2015-12-5等）的处理  </span></span><br><span class="line">                                              <span class="keyword">if</span> (format == <span class="number">14</span> || format == <span class="number">31</span> || format == <span class="number">57</span> || format == <span class="number">58</span>)</span><br><span class="line">                                                  dataRow[j] = cell.DateCellValue;</span><br><span class="line">                                              <span class="keyword">else</span></span><br><span class="line">                                                  dataRow[j] = cell.NumericCellValue;</span><br><span class="line">                                              <span class="keyword">break</span>;</span><br><span class="line">                                          <span class="keyword">case</span> CellType.String:</span><br><span class="line">                                              dataRow[j] = cell.StringCellValue;</span><br><span class="line">                                              <span class="keyword">break</span>;</span><br><span class="line">                                          <span class="comment">//单元格函数计算</span></span><br><span class="line">                                          <span class="keyword">case</span> CellType.Formula:</span><br><span class="line">                                              dataRow[j] = cell.NumericCellValue;</span><br><span class="line">                                              <span class="keyword">break</span>;</span><br><span class="line">                                      &#125;</span><br><span class="line">                                  &#125;</span><br><span class="line">                              &#125;</span><br><span class="line">                              dataTable.Rows.Add(dataRow);</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">return</span> dataTable;</span><br><span class="line">          &#125;</span><br><span class="line">          catch (Exception)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">if</span> (fs != <span class="literal">null</span>)</span><br><span class="line">              &#123;</span><br><span class="line">                  fs.Close();</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 读取合并单元格的值</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;cell&quot;&gt;</span>查询的单元格<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回有数值的单元格<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> ICell <span class="title">MergedCell</span>(<span class="params">ICell cell</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (cell.IsMergedCell)<span class="comment">//是否是合并单元格</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; cell.Sheet.NumMergedRegions; i++)<span class="comment">//遍历所有的合并单元格</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">var</span> cellRange = cell.Sheet.GetMergedRegion(i);</span><br><span class="line"><span class="keyword">if</span> (cell.ColumnIndex &gt;= cellRange.FirstColumn &amp;&amp; cell.ColumnIndex &lt;= cellRange.LastColumn</span><br><span class="line">&amp;&amp; cell.RowIndex &gt;= cellRange.FirstRow &amp;&amp; cell.RowIndex &lt;= cellRange.LastRow)<span class="comment">//判断查询的单元格是否在合并单元格内</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> cell.Sheet.GetRow(cellRange.FirstRow).GetCell(cellRange.FirstColumn);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>本文源于 <a href="https://download.csdn.net/detail/coderk2014/9328779">https://download.csdn.net/detail/coderk2014/9328779</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
            <tag> Excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NPOI导出Excel</title>
      <link href="2020/12/30/ExportExcel/"/>
      <url>2020/12/30/ExportExcel/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文导出Excel表格是基于NPOI</p></blockquote><p>NPOI是指构建在POI 3.x版本之上的一个程序，NPOI可以在没有安装Office的情况下对Word或Excel文档进行读写操作。</p><h1 id="NPOI的下载、引用"><a href="#NPOI的下载、引用" class="headerlink" title="NPOI的下载、引用"></a>NPOI的下载、引用</h1><p>下载地址<a href="https://github.com/KezhanW/NPOI">https://github.com/KezhanW/NPOI</a><br>然后我们打开解压好的文件，看到有dotnet2和dotnet4文件夹，这里我们打开dotnet4，引入全部的dll<br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/30/rOh3E8.png"><br>接下来using</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> NPOI;</span><br><span class="line"><span class="keyword">using</span> NPOI.SS.UserModel;</span><br><span class="line"><span class="keyword">using</span> NPOI.HSSF.UserModel;</span><br><span class="line"><span class="keyword">using</span> NPOI.XSSF.UserModel;</span><br><span class="line"><span class="keyword">using</span> NPOI.HSSF.Util;</span><br><span class="line"><span class="keyword">using</span> NPOI.SS.Util;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>下面就可以开始我们的项目了</p><h1 id="导出Excel表格"><a href="#导出Excel表格" class="headerlink" title="导出Excel表格"></a>导出Excel表格</h1><blockquote><p>注：可以添加单元格样式、合并单元格等操作 如无需删除即可</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 导出Excel</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ids&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> JsonResult <span class="title">ExportExcel</span>(<span class="params"><span class="built_in">string</span> ids</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//创建工作簿对象</span></span><br><span class="line">    IWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook(); <span class="comment">//创建Workbook</span></span><br><span class="line">    workbook.CreateSheet(<span class="string">&quot;sheet1&quot;</span>); <span class="comment">//创建sheet</span></span><br><span class="line">    ISheet sheet1 = workbook.GetSheet(<span class="string">&quot;sheet1&quot;</span>); <span class="comment">//获取一个名为Sheet1的工作表</span></span><br><span class="line">    <span class="comment">//设置列宽</span></span><br><span class="line">    sheet1.SetColumnWidth(<span class="number">0</span>, <span class="number">100</span> * <span class="number">50</span>);</span><br><span class="line">    sheet1.SetColumnWidth(<span class="number">1</span>, <span class="number">100</span> * <span class="number">50</span>);</span><br><span class="line">    sheet1.SetColumnWidth(<span class="number">2</span>, <span class="number">100</span> * <span class="number">50</span>);</span><br><span class="line">    sheet1.SetColumnWidth(<span class="number">3</span>, <span class="number">100</span> * <span class="number">50</span>);</span><br><span class="line">    sheet1.SetColumnWidth(<span class="number">4</span>, <span class="number">100</span> * <span class="number">50</span>);</span><br><span class="line">    sheet1.SetColumnWidth(<span class="number">5</span>, <span class="number">100</span> * <span class="number">50</span>);</span><br><span class="line">    sheet1.SetColumnWidth(<span class="number">6</span>, <span class="number">100</span> * <span class="number">50</span>);</span><br><span class="line">    <span class="comment">//创建样式</span></span><br><span class="line">    ICellStyle style = workbook.CreateCellStyle();</span><br><span class="line">    style.BorderBottom = BorderStyle.Thin; ;</span><br><span class="line">    style.BorderTop = BorderStyle.Thin;</span><br><span class="line">    style.BorderLeft = BorderStyle.Thin;</span><br><span class="line">    style.BorderRight = BorderStyle.Thin;</span><br><span class="line">    style.BottomBorderColor = HSSFColor.Black.Index;<span class="comment">//下边框为细线边框</span></span><br><span class="line">    style.LeftBorderColor = HSSFColor.Black.Index;<span class="comment">//左边框</span></span><br><span class="line">    style.RightBorderColor = HSSFColor.Black.Index;<span class="comment">//上边框</span></span><br><span class="line">    style.TopBorderColor = HSSFColor.Black.Index;<span class="comment">//右边框</span></span><br><span class="line">    style.Alignment = HorizontalAlignment.CenterSelection;<span class="comment">//居中</span></span><br><span class="line">    <span class="comment">//查询数据</span></span><br><span class="line">    KCMS_EF kef = <span class="keyword">new</span> KCMS_EF();<span class="comment">//实例化数据库操作上下文</span></span><br><span class="line">    List&lt;SysAdmin&gt; userLogin = kef.SysAdmin.Where(p =&gt; p.IsLogin == <span class="number">1</span>).ToList();</span><br><span class="line">    <span class="comment">//创建数据</span></span><br><span class="line">    IRow row = sheet1.CreateRow(<span class="number">0</span>);</span><br><span class="line">    row.HeightInPoints = <span class="number">16</span>; <span class="comment">//行高</span></span><br><span class="line">    row.CreateCell(<span class="number">0</span>).SetCellValue(<span class="string">&quot;Excel的导出&quot;</span>);</span><br><span class="line">    row.GetCell(<span class="number">0</span>).CellStyle = style;</span><br><span class="line">             </span><br><span class="line">    IRow row1 = sheet1.CreateRow(<span class="number">1</span>);</span><br><span class="line">    row1.HeightInPoints = <span class="number">16</span>; <span class="comment">//行高</span></span><br><span class="line">    row1.CreateCell(<span class="number">0</span>).SetCellValue(<span class="string">&quot;账号&quot;</span>);</span><br><span class="line">    row1.GetCell(<span class="number">0</span>).CellStyle = style;</span><br><span class="line">    row1.CreateCell(<span class="number">1</span>).SetCellValue(<span class="string">&quot;姓名&quot;</span>);</span><br><span class="line">    row1.GetCell(<span class="number">1</span>).CellStyle = style;</span><br><span class="line">    row1.CreateCell(<span class="number">2</span>).SetCellValue(<span class="string">&quot;邮箱&quot;</span>);</span><br><span class="line">    row1.GetCell(<span class="number">2</span>).CellStyle = style;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> userLogin)</span><br><span class="line">    &#123;</span><br><span class="line">        IRow row2 = sheet1.CreateRow(i);</span><br><span class="line">        row2.HeightInPoints = <span class="number">16</span>; <span class="comment">//行高</span></span><br><span class="line">        row2.CreateCell(<span class="number">0</span>).SetCellValue(item.LoginName);</span><br><span class="line">        row2.GetCell(<span class="number">0</span>).CellStyle = style;</span><br><span class="line">        row2.CreateCell(<span class="number">1</span>).SetCellValue(item.RealName);</span><br><span class="line">        row2.GetCell(<span class="number">1</span>).CellStyle = style;</span><br><span class="line">        row2.CreateCell(<span class="number">2</span>).SetCellValue(item.Email);</span><br><span class="line">        row2.GetCell(<span class="number">2</span>).CellStyle = style;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//合并单元格</span></span><br><span class="line">    <span class="comment">//第一个参数：从第几行开始合并</span></span><br><span class="line">    <span class="comment">//第二个参数：到第几行结束合并</span></span><br><span class="line">    <span class="comment">//第三个参数：从第几列开始合并</span></span><br><span class="line">    <span class="comment">//第四个参数：到第几列结束合并</span></span><br><span class="line">    CellRangeAddress region = <span class="keyword">new</span> CellRangeAddress(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">    sheet1.AddMergedRegion(region);</span><br><span class="line">    <span class="comment">//强制Excel重新计算表中所有的公式</span></span><br><span class="line">    sheet1.ForceFormulaRecalculation = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//生成表格</span></span><br><span class="line">    <span class="built_in">string</span> str = <span class="string">&quot;Task List-&quot;</span> + DateTime.Now.ToString(<span class="string">&quot;yyyyMMddHHmmss&quot;</span>) + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">    DateTime now = DateTime.Now;</span><br><span class="line">    <span class="built_in">string</span> text = <span class="built_in">string</span>.Concat(<span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">    &#123;</span><br><span class="line">                <span class="string">&quot;/UpFiles/ExcelFiles/&quot;</span>,</span><br><span class="line">                now.Year.ToString(),</span><br><span class="line">                <span class="string">&quot;/&quot;</span>,</span><br><span class="line">                now.Month.ToString(),</span><br><span class="line">                <span class="string">&quot;/&quot;</span>,</span><br><span class="line">                now.Day.ToString(),</span><br><span class="line">                <span class="string">&quot;/&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">string</span> text2 = Server.MapPath(text);</span><br><span class="line">    <span class="keyword">if</span> (!Directory.Exists(text2))</span><br><span class="line">    &#123;</span><br><span class="line">        Directory.CreateDirectory(text2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">byte</span>[] buffer;</span><br><span class="line">    MemoryStream ms = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">    workbook.Write(ms);</span><br><span class="line">    buffer = ms.ToArray();</span><br><span class="line">    System.IO.File.WriteAllBytes(text2 + str, buffer);</span><br><span class="line">    <span class="keyword">return</span> Json(<span class="keyword">new</span> &#123; code = <span class="number">200</span>, msg = text + str &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>前台请求方法及下载</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.post(<span class="string">&quot;/practice/ExportExcel&quot;</span>, &#123;&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="comment">//需要下载的数据内容,我这里放的就是BLOB，如果你有下载链接就不需要了</span></span><br><span class="line">    <span class="keyword">var</span> filename = <span class="string">&#x27;分票数据导出.xlsx&#x27;</span>;</span><br><span class="line">    a.href = data.msg;</span><br><span class="line">    a.download = filename;</span><br><span class="line">    a.click();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>插入行</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @param startRow the row to start shifting</span></span><br><span class="line"><span class="comment">                    （从下标为startRow的行开始移动）</span></span><br><span class="line"><span class="comment">     * @param endRow the row to end shifting</span></span><br><span class="line"><span class="comment">                    （到下标为endRow的行结束移动）</span></span><br><span class="line"><span class="comment">     * @param n the number of rows to shift</span></span><br><span class="line"><span class="comment">                    （有多少行需要移动）</span></span><br><span class="line"><span class="comment">     * @param copyRowHeight whether to copy the row height during the shift</span></span><br><span class="line"><span class="comment">     * @param resetOriginalRowHeight whether to set the original row&#x27;s height to the default</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ShiftRows</span>(<span class="params"><span class="built_in">int</span> startRow, <span class="built_in">int</span> endRow, <span class="built_in">int</span> n, boolean copyRowHeight, boolean resetOriginalRowHeight</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    例：sheet.ShiftRows(insertRow,sheet.LastRowNum,<span class="number">1</span>,<span class="literal">true</span>,<span class="literal">false</span>);</span><br><span class="line">        sheet.CreateRow(insertRow);</span><br></pre></td></tr></table></figure><blockquote><p>添加单元格背景色</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ICellStyle style = workbook.CreateCellStyle();</span><br><span class="line">style.FillForegroundColor = NPOI.HSSF.Util.HSSFColor.Red.Index;</span><br><span class="line">style.FillPattern = FillPattern.SolidForeground;</span><br><span class="line"> </span><br><span class="line">ICell cell = workbook.CreateSheet().CreateRow(<span class="number">0</span>).CreateCell(<span class="number">0</span>);</span><br><span class="line">cell.CellStyle = style;</span><br></pre></td></tr></table></figure><blockquote><p>组合行</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sheet.GroupRow(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">sheet.SetRowGroupCollapsed(<span class="number">0</span>, <span class="literal">true</span>)<span class="comment">//Excel文件默认收缩第一行到第10行</span></span><br></pre></td></tr></table></figure><p>导出表格样式<br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/30/rObnmj.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
            <tag> Excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET数字与字母的相互转换</title>
      <link href="2020/12/28/numzab/"/>
      <url>2020/12/28/numzab/</url>
      
        <content type="html"><![CDATA[<h1 id="字母转换成数字"><a href="#字母转换成数字" class="headerlink" title="字母转换成数字"></a>字母转换成数字</h1><blockquote><p>byte[] array = new byte[1];   //定义一组数组array<br>array = System.Text.Encoding.ASCII.GetBytes(string); //string转换的字母<br>int asciicode = (short)(array[0]);<br>ASCII码 = Convert.ToString(asciicode); //将转换一的ASCII码转换成string型</p></blockquote><h1 id="数字转换成字母"><a href="#数字转换成字母" class="headerlink" title="数字转换成字母"></a>数字转换成字母</h1><blockquote><p>byte[] array = new byte[1];<br>array[0] = (byte)(Convert.ToInt32(ASCII码)); //ASCII码强制转换二进制<br>转换后的字母= Convert.ToString(System.Text.Encoding.ASCII.GetString(array));</p></blockquote><p>在编码的过程中很多时候会用到将某些数字的索引转化为字母，比方说Excel的单元格的列数在Excel中就用大写字母来表示，要把数字转换成字母可以使用C#的ASCIIEncoding类里的GetString方法。请参见以下示例：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 数字转字母</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 要转换成字母的数字（数字范围在闭区间[65,90]）</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">NunToChar</span>(<span class="params"><span class="built_in">int</span> number</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="number">65</span> &lt;= number &amp;&amp; <span class="number">90</span> &gt;= number)</span><br><span class="line">         &#123;</span><br><span class="line">                System.Text.ASCIIEncoding asciiEncoding = <span class="keyword">new</span> System.Text.ASCIIEncoding();</span><br><span class="line">                <span class="built_in">byte</span>[] btNumber = <span class="keyword">new</span> <span class="built_in">byte</span>[] &#123; (<span class="built_in">byte</span>)number &#125;;</span><br><span class="line">                <span class="keyword">return</span> asciiEncoding.GetString(btNumber);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;数字不在转换范围内&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 把1,2,3,...,35,36转换成A,B,C,...,Y,Z</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 要转换成字母的数字（数字范围在闭区间[1,36]）</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">NunberToChar</span>(<span class="params"><span class="built_in">int</span> number</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> &lt;= number &amp;&amp; <span class="number">36</span> &gt;= number)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">int</span> num = number+<span class="number">64</span>;</span><br><span class="line">                System.Text.ASCIIEncoding asciiEncoding = <span class="keyword">new</span> System.Text.ASCIIEncoding();</span><br><span class="line">                <span class="built_in">byte</span>[] btNumber = <span class="keyword">new</span> <span class="built_in">byte</span>[] &#123; (<span class="built_in">byte</span>)num &#125;;</span><br><span class="line">                <span class="keyword">return</span> asciiEncoding.GetString(btNumber);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;数字不在转换范围内&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>转自：<a href="https://www.cnblogs.com/roucheng/p/csascii.html">https://www.cnblogs.com/roucheng/p/csascii.html</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET小方法</title>
      <link href="2020/12/28/netSmallMethod/"/>
      <url>2020/12/28/netSmallMethod/</url>
      
        <content type="html"><![CDATA[<h1 id="List取并集、交集、差集"><a href="#List取并集、交集、差集" class="headerlink" title="List取并集、交集、差集"></a>List取并集、交集、差集</h1><ul><li>并集：Union</li><li>交集：Intersect</li><li>差集：Except</li></ul><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">List&lt;T&gt; list1 = <span class="keyword">new</span> List&lt;T&gt;();</span><br><span class="line">List&lt;T&gt; list2 = <span class="keyword">new</span> List&lt;T&gt;();</span><br><span class="line"></span><br><span class="line">List&lt;T&gt; list = <span class="keyword">new</span> List&lt;T&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//并集, 包含1、2全部</span></span><br><span class="line">list = list1.Union(list2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//交集，1、2相同部分</span></span><br><span class="line">list = list1.Intersect(list2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//差集，1中存在但2中不存在</span></span><br><span class="line">list = list1.Except(list2)</span><br></pre></td></tr></table></figure><h1 id="Trim-–去除首尾字符"><a href="#Trim-–去除首尾字符" class="headerlink" title="Trim()–去除首尾字符"></a>Trim()–去除首尾字符</h1><ul><li><code>Trim()</code> 删除字符串头部及尾部出现的空格</li><li><code>TrimStart()</code> 只删除字符串的头部的空格</li><li><code>TrimEnd()</code> 只删除字符串尾部的空格</li></ul><p>定义和用法:</p><blockquote><p>Trim() 方法删除字符串头部及尾部出现的空格，删除的过程为从外到内，直到碰到一个非空格的字符为止，所以不管前后有多少个连续的空格都会被删除掉。<br>Trim() 方法不会改变原始字符串。<br>Trim() 方法不适用于 null, undefined, Number 类型。</p></blockquote><p>语法：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.Trim()</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;       Runoob        &quot;</span>;</span><br><span class="line"><span class="keyword">var</span> resData = str.Trim();</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Runoob</span><br></pre></td></tr></table></figure><p>扩展：<br>去除末尾无效零<br>先去除零 如果最后有小数点则转化为<code>Decimal</code>去除掉</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">item.Quantity = item.Quantity.ToString().TrimEnd(<span class="string">&#x27;0&#x27;</span>).ToDecimal();</span><br></pre></td></tr></table></figure><h1 id="Substring-–截取字符串"><a href="#Substring-–截取字符串" class="headerlink" title="Substring()–截取字符串"></a>Substring()–截取字符串</h1><p>定义和用法:</p><blockquote><p>Substring() 方法用于提取字符串中介于两个指定下标之间的字符。</p></blockquote><p>语法：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stringObject.Substring(start,stop)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>start</td><td>必需。一个非负的整数，规定要提取的子串的第一个字符在 stringObject 中的位置。</td></tr><tr><td>stop</td><td>可选。一个非负的整数，比要提取的子串的最后一个字符在 stringObject 中的位置多 1。如果省略该参数，那么返回的子串会一直到字符串的结尾。</td></tr></tbody></table><p>示例：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;Hello world!&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> resData = str.Substring(<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llo world!</span><br></pre></td></tr></table></figure><p>扩展：<br>用<code>IndexOf()</code>获取到字符串某个单词的位置<br>加上单词本身的长度 就是从这个单词后开始截取<br>示例：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;Hello world!&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> resData = str.Substring(str.IndexOf(<span class="string">&quot;Hello&quot;</span>) + <span class="number">5</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wo</span><br></pre></td></tr></table></figure><h1 id="Replace-–替换字符"><a href="#Replace-–替换字符" class="headerlink" title="Replace()–替换字符"></a>Replace()–替换字符</h1><p>定义和用法:</p><blockquote><p>Replace() 方法用于在字符串中用一些字符替换另一些字符，或替换一个与正则表达式匹配的子串。</p></blockquote><p>语法：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stringObject.Replace(regexp/substr,replacement)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>regexp/substr</td><td>必需。规定子字符串或要替换的模式的 RegExp 对象。请注意，如果该值是一个字符串，则将它作为要检索的直接量文本模式，而不是首先被转换为 RegExp 对象。</td></tr><tr><td>replacement</td><td>必需。一个字符串值。规定了替换文本或生成替换文本的函数。</td></tr></tbody></table><p>示例：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;Visit Microsoft!&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> resData = str.Replace(<span class="string">&quot;Microsoft&quot;</span>, <span class="string">&quot;W3School&quot;</span>);</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Visit W3School!</span><br></pre></td></tr></table></figure><h1 id="Split-–字符串转数组"><a href="#Split-–字符串转数组" class="headerlink" title="Split()–字符串转数组"></a>Split()–字符串转数组</h1><p>定义和用法:</p><blockquote><p>Split() 方法用于把一个字符串分割成字符串数组。<br>提示： 如果把空字符串 (“”) 用作 separator，那么 stringObject 中的每个字符之间都会被分割。<br>注意： Split() 方法不改变原始字符串。</p></blockquote><p>语法：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.Split(separator,limit)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>separator</td><td>可选。字符串或正则表达式，从该参数指定的地方分割 string Object。</td></tr><tr><td>limit</td><td>可选。该参数可指定返回的数组的最大长度。如果设置了该参数，返回的子串不会多于这个参数指定的数组。如果没有设置该参数，整个字符串都会被分割，不考虑它的长度。</td></tr></tbody></table><p>示例：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;How are you doing today?&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> n=str.Split();</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">How</span><br><span class="line">are</span><br><span class="line">you</span><br><span class="line">doing</span><br><span class="line">today?</span><br></pre></td></tr></table></figure><h1 id="Join-–数组转字符串"><a href="#Join-–数组转字符串" class="headerlink" title="Join()–数组转字符串"></a>Join()–数组转字符串</h1><p>定义和用法:</p><blockquote><p>Join() 方法连接一个字符串数组中的所有元素，使用指定的分隔符分隔每个元素</p></blockquote><p>示例：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>[] sarray = &#123; <span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;From&quot;</span>, <span class="string">&quot;Tutorials&quot;</span>, <span class="string">&quot;Point&quot;</span> &#125;;</span><br><span class="line"><span class="built_in">string</span> message = String.Join(<span class="string">&quot;,&quot;</span>, sarray);</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello,From,Tutorials,Point</span><br></pre></td></tr></table></figure><h1 id="加减乘除精度"><a href="#加减乘除精度" class="headerlink" title="加减乘除精度"></a>加减乘除精度</h1><h2 id="综合封装"><a href="#综合封装" class="headerlink" title="综合封装"></a>综合封装</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** method **</span></span><br><span class="line"><span class="comment"> *  add / subtract / multiply /divide</span></span><br><span class="line"><span class="comment"> * floatObj.add(0.1, 0.2) &gt;&gt; 0.3</span></span><br><span class="line"><span class="comment"> * floatObj.multiply(19.9, 100) &gt;&gt; 1990</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> floatObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 判断obj是否为一个整数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isInteger</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.floor(obj) === obj</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 将一个浮点数转成整数，返回整数和倍数。如 3.14 &gt;&gt; 314，倍数是 100</span></span><br><span class="line"><span class="comment">     * @param floatNum &#123;number&#125; 小数</span></span><br><span class="line"><span class="comment">     * @return &#123;object&#125;</span></span><br><span class="line"><span class="comment">     *   &#123;times:100, num: 314&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">toInteger</span>(<span class="params">floatNum</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = &#123;<span class="attr">times</span>: <span class="number">1</span>, <span class="attr">num</span>: <span class="number">0</span>&#125;</span><br><span class="line">        <span class="keyword">if</span> (isInteger(floatNum)) &#123;</span><br><span class="line">            ret.num = floatNum</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> strfi  = floatNum + <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">var</span> dotPos = strfi.indexOf(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> len    = strfi.substr(dotPos+<span class="number">1</span>).length</span><br><span class="line">        <span class="keyword">var</span> times  = <span class="built_in">Math</span>.pow(<span class="number">10</span>, len)</span><br><span class="line">        <span class="keyword">var</span> intNum = <span class="built_in">Number</span>(floatNum.toString().replace(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">        ret.times  = times</span><br><span class="line">        ret.num    = intNum</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 核心方法，实现加减乘除运算，确保不丢失精度</span></span><br><span class="line"><span class="comment">     * 思路：把小数放大为整数（乘），进行算术运算，再缩小为小数（除）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param a &#123;number&#125; 运算数1</span></span><br><span class="line"><span class="comment">     * @param b &#123;number&#125; 运算数2</span></span><br><span class="line"><span class="comment">     * @param digits &#123;number&#125; 精度，保留的小数点数，比如 2, 即保留为两位小数</span></span><br><span class="line"><span class="comment">     * @param op &#123;string&#125; 运算类型，有加减乘除（add/subtract/multiply/divide）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">operation</span>(<span class="params">a, b, digits, op</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> o1 = toInteger(a)</span><br><span class="line">        <span class="keyword">var</span> o2 = toInteger(b)</span><br><span class="line">        <span class="keyword">var</span> n1 = o1.num</span><br><span class="line">        <span class="keyword">var</span> n2 = o2.num</span><br><span class="line">        <span class="keyword">var</span> t1 = o1.times</span><br><span class="line">        <span class="keyword">var</span> t2 = o2.times</span><br><span class="line">        <span class="keyword">var</span> max = t1 &gt; t2 ? t1 : t2</span><br><span class="line">        <span class="keyword">var</span> result = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">switch</span> (op) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;add&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (t1 === t2) &#123; <span class="comment">// 两个小数位数相同</span></span><br><span class="line">                    result = n1 + n2</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t1 &gt; t2) &#123; <span class="comment">// o1 小数位 大于 o2</span></span><br><span class="line">                    result = n1 + n2 * (t1 / t2)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123; <span class="comment">// o1 小数位 小于 o2</span></span><br><span class="line">                    result = n1 * (t2 / t1) + n2</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> result / max</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;subtract&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (t1 === t2) &#123;</span><br><span class="line">                    result = n1 - n2</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t1 &gt; t2) &#123;</span><br><span class="line">                    result = n1 - n2 * (t1 / t2)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    result = n1 * (t2 / t1) - n2</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> result / max</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;multiply&#x27;</span>:</span><br><span class="line">                result = (n1 * n2) / (t1 * t2)</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;divide&#x27;</span>:</span><br><span class="line">                result = (n1 / n2) * (t2 / t1)</span><br><span class="line">                <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加减乘除的四个接口</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b, digits</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> operation(a, b, digits, <span class="string">&#x27;add&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">subtract</span>(<span class="params">a, b, digits</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> operation(a, b, digits, <span class="string">&#x27;subtract&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">a, b, digits</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> operation(a, b, digits, <span class="string">&#x27;multiply&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b, digits</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> operation(a, b, digits, <span class="string">&#x27;divide&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// exports</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        add: add,</span><br><span class="line">        subtract: subtract,</span><br><span class="line">        multiply: multiply,</span><br><span class="line">        divide: divide</span><br><span class="line">    &#125;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><blockquote><p>toFixed的修复如下：</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// toFixed 修复</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toFixed</span>(<span class="params">num, s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> times = <span class="built_in">Math</span>.pow(<span class="number">10</span>, s)</span><br><span class="line">    <span class="keyword">var</span> des = num * times + <span class="number">0.5</span></span><br><span class="line">    des = <span class="built_in">parseInt</span>(des, <span class="number">10</span>) / times</span><br><span class="line">    <span class="keyword">return</span> des + <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="加法运算"><a href="#加法运算" class="headerlink" title="加法运算"></a>加法运算</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 加法运算，避免数据相加小数点后产生多位数和计算精度损失。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>num1加数1 | num2加数2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numAdd</span>(<span class="params">arg1, arg2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r1, r2, m, c;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        r1 = arg1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        r1 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        r2 = arg2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        r2 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    c = <span class="built_in">Math</span>.abs(r1 - r2);</span><br><span class="line">    m = <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="built_in">Math</span>.max(r1, r2));</span><br><span class="line">    <span class="keyword">if</span> (c &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> cm = <span class="built_in">Math</span>.pow(<span class="number">10</span>, c);</span><br><span class="line">        <span class="keyword">if</span> (r1 &gt; r2) &#123;</span><br><span class="line">            arg1 = <span class="built_in">Number</span>(arg1.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">            arg2 = <span class="built_in">Number</span>(arg2.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>)) * cm;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            arg1 = <span class="built_in">Number</span>(arg1.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>)) * cm;</span><br><span class="line">            arg2 = <span class="built_in">Number</span>(arg2.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        arg1 = <span class="built_in">Number</span>(arg1.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">        arg2 = <span class="built_in">Number</span>(arg2.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (arg1 + arg2) / m;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//给Number类型增加一个add方法，调用起来更加方便。</span></span><br><span class="line"><span class="built_in">Number</span>.prototype.add = <span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> accAdd(arg, <span class="built_in">this</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 加法运算，避免数据相加小数点后产生多位数和计算精度损失。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>num1加数1 | num2加数2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numAdd</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> baseNum, baseNum1, baseNum2;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum1 = num1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        baseNum1 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum2 = num2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        baseNum2 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    baseNum = <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="built_in">Math</span>.max(baseNum1, baseNum2));</span><br><span class="line">    <span class="keyword">return</span> (num1 * baseNum + num2 * baseNum) / baseNum;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="减法运算"><a href="#减法运算" class="headerlink" title="减法运算"></a>减法运算</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 减法运算，避免数据相减小数点后产生多位数和计算精度损失。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>num1被减数  |  num2减数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numSub</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> baseNum, baseNum1, baseNum2;</span><br><span class="line">    <span class="keyword">var</span> precision;<span class="comment">// 精度</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum1 = num1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        baseNum1 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum2 = num2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        baseNum2 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    baseNum = <span class="built_in">Math</span>.pow(<span class="number">10</span>, <span class="built_in">Math</span>.max(baseNum1, baseNum2));</span><br><span class="line">    precision = (baseNum1 &gt;= baseNum2) ? baseNum1 : baseNum2;</span><br><span class="line">    <span class="keyword">return</span> ((num1 * baseNum - num2 * baseNum) / baseNum).toFixed(precision);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="乘法运算"><a href="#乘法运算" class="headerlink" title="乘法运算"></a>乘法运算</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 乘法运算，避免数据相乘小数点后产生多位数和计算精度损失。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>num1被乘数 | num2乘数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numMulti</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> baseNum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum += num1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum += num2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Number</span>(num1.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>)) * <span class="built_in">Number</span>(num2.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>)) / <span class="built_in">Math</span>.pow(<span class="number">10</span>, baseNum);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="除法运算"><a href="#除法运算" class="headerlink" title="除法运算"></a>除法运算</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 除法运算，避免数据相除小数点后产生多位数和计算精度损失。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>num1被除数 | num2除数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numDiv</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> baseNum1 = <span class="number">0</span>, baseNum2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> baseNum3, baseNum4;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum1 = num1.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        baseNum1 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        baseNum2 = num2.toString().split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>].length;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        baseNum2 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">with</span> (<span class="built_in">Math</span>) &#123;</span><br><span class="line">        baseNum3 = <span class="built_in">Number</span>(num1.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">        baseNum4 = <span class="built_in">Number</span>(num2.toString().replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> (baseNum3 / baseNum4) * pow(<span class="number">10</span>, baseNum2 - baseNum1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>力软框架--表格</title>
      <link href="2020/12/26/lrjfGrid/"/>
      <url>2020/12/26/lrjfGrid/</url>
      
        <content type="html"><![CDATA[<h1 id="获取数据渲染数据"><a href="#获取数据渲染数据" class="headerlink" title="获取数据渲染数据"></a>获取数据渲染数据</h1><ul><li>获取表格全部数据：<code>$(&#39;#&#39;+id).jfGridGet(&#39;rowdatas&#39;);</code></li><li>获取表格选中行数据：<code>$(&#39;#&#39;+id).jfGridGet(&#39;rowdata&#39;);</code></li><li>渲染表格数据： <code>$(&#39;#&#39;+id).jfGridSet(&#39;refreshdata&#39;, data);</code></li><li>刷新表格一行数据  <code>$(&#39;#&#39;+id).jfGridSet(&#39;updateRow&#39;, index);</code></li><li>刷新表格数据  <code> $(&#39;#&#39;+id).jfGridSet(&#39;reload&#39;);</code></li><li>获取选中行某字段值  <code> $(&#39;#&#39;+id).jfGridValue(&#39;Id&#39;);</code></li></ul><h1 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h1><p>方法：<code>$(&#39;#&#39;+id).jfGrid(op);</code><br>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th><th>默认</th></tr></thead><tbody><tr><td>url</td><td>数据服务地址</td><td></td></tr><tr><td>param</td><td>请求参数</td><td></td></tr><tr><td>rowdatas</td><td>列表数据</td><td></td></tr><tr><td>datatype</td><td>数据类型</td><td>array</td></tr><tr><td>headData</td><td>表格列数据</td><td></td></tr><tr><td>isShowNum</td><td>是否显示序号</td><td>true</td></tr><tr><td>isMultiselect</td><td>是否允许多选</td><td>false</td></tr><tr><td>multiselectfield</td><td>多选绑定字段</td><td></td></tr><tr><td>isSubGrid</td><td>是否有子表</td><td>false</td></tr><tr><td>subGridRowExpanded</td><td>子表展开后回调函数</td><td></td></tr><tr><td>subGridHeight</td><td>子表高度</td><td></td></tr><tr><td>onSelectRow</td><td>选中一行后回调函数</td><td></td></tr><tr><td>onRenderComplete</td><td>表格加载完后调用</td><td></td></tr><tr><td>isPage</td><td>是否分页</td><td>false</td></tr><tr><td>sidx</td><td>排序字段</td><td>‘’</td></tr><tr><td>sord</td><td>排序方式</td><td>ASC</td></tr><tr><td>isTree</td><td>是否树形显示（没有分页的情况下才支持）</td><td>false</td></tr><tr><td>mainId</td><td>关联的主键</td><td>id</td></tr><tr><td>parentId</td><td>树形关联字段</td><td>parentId</td></tr><tr><td>reloadSelected</td><td>刷新后是否还选择之前选中的,只支持单选</td><td>false</td></tr><tr><td>isAutoHeight</td><td>自动适应表格高度</td><td>false</td></tr><tr><td>footerrow</td><td>底部合计条</td><td>false</td></tr><tr><td>isEidt</td><td>是否编辑</td><td>false</td></tr><tr><td>minheight</td><td>最低高度</td><td>0</td></tr><tr><td>height</td><td>高度</td><td>0</td></tr><tr><td>onAddRow</td><td>添加一行数据后执行</td><td>false</td></tr><tr><td>onMinusRow</td><td>删除一行数据后执行</td><td>false</td></tr><tr><td>beforeMinusRow</td><td>删除一行数据前执行</td><td>false</td></tr><tr><td>ishide</td><td>是否隐藏</td><td>false</td></tr><tr><td>rows</td><td>表格每页行数</td><td>100</td></tr><tr><td>isStatistics</td><td>统计条</td><td>false</td></tr></tbody></table><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#LR_DJ_DetaSalary&#x27;</span>).jfGrid(&#123;</span><br><span class="line">headData: [</span><br><span class="line">&#123;</span><br><span class="line">label: <span class="string">&#x27;Material Code&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;MaterialNumber&#x27;</span>, <span class="attr">width</span>: <span class="number">180</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>, <span class="attr">frozen</span>: <span class="literal">true</span></span><br><span class="line">, <span class="attr">edit</span>: &#123;</span><br><span class="line">type: <span class="string">&#x27;layer&#x27;</span>,</span><br><span class="line">change: <span class="function"><span class="keyword">function</span> (<span class="params">rowData, rowIndex, item, seletes</span>) </span>&#123;<span class="comment">//seletes为选中行的数据</span></span><br><span class="line"><span class="comment">//获取数据</span></span><br><span class="line"><span class="comment">//如果是选择单行更新当前行数据</span></span><br><span class="line"><span class="keyword">if</span> (seletes.length == <span class="number">1</span>) &#123;</span><br><span class="line">rowData.MaterialNumber = item.FNumber;</span><br><span class="line">rowData.MaterialName = item.FName;</span><br><span class="line">rowData.FMaterialId = item.FMATERIALID;</span><br><span class="line">$(<span class="string">&#x27;#LR_DJ_DetaSalary&#x27;</span>).jfGridSet(<span class="string">&#x27;updateRow&#x27;</span>, rowIndex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;<span class="comment">//如果是多行直接添加数据    </span></span><br><span class="line"><span class="keyword">var</span> rows = $(<span class="string">&#x27;#LR_DJ_DetaSalary&#x27;</span>).jfGridGet(<span class="string">&#x27;rowdatas&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> addRows = [];</span><br><span class="line">$.each(seletes, <span class="function"><span class="keyword">function</span> (<span class="params">i, n</span>) </span>&#123;</span><br><span class="line">rows.push(&#123;</span><br><span class="line">MaterialNumber: n.FNumber,</span><br><span class="line">MaterialName: n.FName,</span><br><span class="line">FMaterialId: n.FMATERIALID</span><br><span class="line">&#125;);</span><br><span class="line">&#125;);</span><br><span class="line">$.each(rows, <span class="function"><span class="keyword">function</span> (<span class="params">i, item</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (item.MaterialNumber != <span class="literal">undefined</span> &amp;&amp; item.MaterialNumber != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">addRows.push(item);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">&#x27;#LR_DJ_DetaSalary&#x27;</span>).jfGridSet(<span class="string">&#x27;refreshdata&#x27;</span>, addRows);</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">op: &#123;</span><br><span class="line">width: <span class="number">700</span>,</span><br><span class="line">height: <span class="number">500</span>,</span><br><span class="line">colData: [</span><br><span class="line">&#123; <span class="attr">label</span>: <span class="string">&quot;ID&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;FMATERIALID&quot;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span>, <span class="attr">ishide</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">&#123; <span class="attr">label</span>: <span class="string">&quot;Material Code&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;FNumber&quot;</span>, <span class="attr">width</span>: <span class="number">200</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">label</span>: <span class="string">&quot;物料名称&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;FName&quot;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;</span><br><span class="line">],</span><br><span class="line">url: top.$.rootUrl + <span class="string">&#x27;/JD_BasicModule/LR_DJ_MrEndCustomer/GetwlZPpany?number=&#x27;</span> + data.text + <span class="string">&quot;&amp;companyNumber=&quot;</span> + $(<span class="string">&quot;#F_Company&quot;</span>).val(),</span><br><span class="line">isPage: <span class="literal">true</span>,</span><br><span class="line">reloadSelected: <span class="literal">true</span>,</span><br><span class="line">mainId: <span class="string">&#x27;FMATERIALID&#x27;</span>,</span><br><span class="line">sidx: <span class="string">&#x27;FMATERIALID&#x27;</span>,</span><br><span class="line">isMultiselect: <span class="literal">true</span>,</span><br><span class="line">type: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">label: <span class="string">&#x27;Material Code&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;WuLiao&#x27;</span>, <span class="attr">width</span>: <span class="number">130</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>,</span><br><span class="line">edit: &#123;</span><br><span class="line">type: <span class="string">&#x27;layer&#x27;</span>,</span><br><span class="line">change: <span class="function"><span class="keyword">function</span> (<span class="params">rowData, rowIndex, item</span>) </span>&#123;</span><br><span class="line">rowData.WuLiao = item.FNumber;</span><br><span class="line">rowData.WuLiaoName = item.FName;</span><br><span class="line">rowData.F_RTA_HavePPN = item.F_RTA_HavePPN;</span><br><span class="line">rowData.FMaterialId = item.FMATERIALID;</span><br><span class="line">$(<span class="string">&#x27;#LR_DJ_ExpensePurDetailed&#x27;</span>).jfGridSet(<span class="string">&#x27;updateRow&#x27;</span>, rowIndex);</span><br><span class="line">&#125;,</span><br><span class="line">op: &#123;</span><br><span class="line">width: <span class="number">700</span>,</span><br><span class="line">height: <span class="number">500</span>,</span><br><span class="line">colData: [</span><br><span class="line">&#123; <span class="attr">label</span>: <span class="string">&quot;ID&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;FMATERIALID&quot;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span>, <span class="attr">ishide</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">&#123; <span class="attr">label</span>: <span class="string">&quot;Material Code&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;FNumber&quot;</span>, <span class="attr">width</span>: <span class="number">200</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">label</span>: <span class="string">&quot;物料名称&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;FName&quot;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;</span><br><span class="line">],</span><br><span class="line">url: top.$.rootUrl + <span class="string">&#x27;/JD_BasicModule/LR_DJ_MrEndCustomer/Getdbwlpany?F_RTA_TYPEOFSPF=&#x27;</span> + data.text + <span class="string">&quot;&amp;companyNumber=&quot;</span> + $(<span class="string">&quot;#F_Company&quot;</span>).val(),</span><br><span class="line">isPage: <span class="literal">true</span>,</span><br><span class="line">reloadSelected: <span class="literal">true</span>,</span><br><span class="line">mainId: <span class="string">&#x27;F_UserId&#x27;</span>,</span><br><span class="line">sidx: <span class="string">&#x27;FMATERIALID&#x27;</span>,</span><br><span class="line">type: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">label: <span class="string">&#x27;部门&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;FDepartmentName&#x27;</span>, <span class="attr">width</span>: <span class="number">120</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>, <span class="attr">bk</span>: <span class="string">&#x27;#e0e0e0&#x27;</span></span><br><span class="line">  ,<span class="attr">edit</span>: &#123;</span><br><span class="line">            type: <span class="string">&#x27;select&#x27;</span>,</span><br><span class="line">            datatype: <span class="string">&#x27;dataSource&#x27;</span>,</span><br><span class="line">            code: <span class="string">&#x27;YD_JFFS&#x27;</span>,</span><br><span class="line">            op: &#123;</span><br><span class="line">                value: <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">                text: <span class="string">&#x27;designaname&#x27;</span>,</span><br><span class="line">                title: <span class="string">&#x27;designaname&#x27;</span></span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">label: <span class="string">&#x27;部门编码&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;FDepartment&#x27;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>, <span class="attr">ishide</span>: <span class="literal">true</span></span><br><span class="line">  , <span class="attr">edit</span>: &#123;</span><br><span class="line">            type: <span class="string">&#x27;select&#x27;</span>,</span><br><span class="line">            datatype: <span class="string">&#x27;dataItem&#x27;</span>,</span><br><span class="line">            code: <span class="string">&#x27;BZ&#x27;</span></span><br><span class="line">             &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">label: <span class="string">&#x27;金额&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;FMoney&#x27;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>, <span class="attr">statistics</span>: <span class="literal">true</span></span><br><span class="line">, <span class="attr">edit</span>: &#123;</span><br><span class="line">type: <span class="string">&#x27;input&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">label: <span class="string">&#x27;说明&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;FExplain&#x27;</span>, <span class="attr">width</span>: <span class="number">300</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span></span><br><span class="line">, <span class="attr">edit</span>: &#123;</span><br><span class="line">type: <span class="string">&#x27;input&#x27;</span>,</span><br><span class="line">change: <span class="function"><span class="keyword">function</span> (<span class="params">rowData, index, $edit</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (rowData.FExplain.length &gt; <span class="number">300</span>) &#123;</span><br><span class="line">$edit.val(rowData.FExplain.substring(<span class="number">0</span>, <span class="number">300</span>));</span><br><span class="line">rowData.FExplain = $edit.val();</span><br><span class="line">$(<span class="string">&#x27;#LR_DJ_DetaSalary&#x27;</span>).jfGridSet(<span class="string">&#x27;updateRow&#x27;</span>, index);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">label: <span class="string">&#x27;部门ID&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;FDepartId&#x27;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span>, <span class="attr">ishide</span>: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line">],</span><br><span class="line">isEdit: <span class="literal">true</span>,</span><br><span class="line">height: <span class="number">200</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="含有子页面"><a href="#含有子页面" class="headerlink" title="含有子页面"></a>含有子页面</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//表格</span></span><br><span class="line">$(<span class="string">&#x27;#gridtable&#x27;</span>).jfGrid(&#123;</span><br><span class="line">    url: top.$.rootUrl + <span class="string">&#x27;/Fly_TZ/Fly_TZ_Opmaster/GetPageList&#x27;</span>,</span><br><span class="line">    headData: [</span><br><span class="line">        &#123;<span class="attr">label</span>: <span class="string">&quot;台账号&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;TZnumber&quot;</span>, <span class="attr">width</span>: <span class="number">150</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">label</span>: <span class="string">&quot;创建人&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;F_CreateUserName&quot;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span></span><br><span class="line">        , <span class="attr">formatterAsync</span>: <span class="function"><span class="keyword">function</span> (<span class="params">callback, value, row, op, $cell</span>) </span>&#123;</span><br><span class="line">                learun.clientdata.getAsync(<span class="string">&#x27;custmerData&#x27;</span>, &#123;</span><br><span class="line">                     url: <span class="string">&#x27;/LR_SystemModule/DataSource/GetDataTable?code=&#x27;</span> + <span class="string">&#x27;ZYWHB&#x27;</span>,</span><br><span class="line">                     key: value,</span><br><span class="line">                     keyId: <span class="string">&#x27;portid&#x27;</span>,</span><br><span class="line">                     callback: <span class="function"><span class="keyword">function</span> (<span class="params">_data</span>) </span>&#123;</span><br><span class="line">                           callback(_data[<span class="string">&#x27;businesspartnername&#x27;</span>]);</span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;)</span><br><span class="line">             &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123; <span class="attr">label</span>: <span class="string">&quot;业务状态&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;StateName&quot;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> </span><br><span class="line">             , <span class="attr">formatterAsync</span>: <span class="function"><span class="keyword">function</span> (<span class="params">callback, value, row, op,$cell</span>) </span>&#123;</span><br><span class="line">                 learun.clientdata.getAsync(<span class="string">&#x27;dataItem&#x27;</span>, &#123;</span><br><span class="line">                     key: value,</span><br><span class="line">                     code: <span class="string">&#x27;9005&#x27;</span>,</span><br><span class="line">                     callback: <span class="function"><span class="keyword">function</span> (<span class="params">_data</span>) </span>&#123;</span><br><span class="line">                         callback(_data.text);</span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    mainId: <span class="string">&#x27;Id&#x27;</span>,</span><br><span class="line">    isPage: <span class="literal">true</span>,</span><br><span class="line">    sord: <span class="string">&quot;DESC&quot;</span>,</span><br><span class="line">    sidx: <span class="string">&#x27;F_CreateDate&#x27;</span>,</span><br><span class="line">    isMultiselect: <span class="literal">true</span>,</span><br><span class="line">    isSubGrid: <span class="literal">true</span>,</span><br><span class="line">    subGridHeight: <span class="number">250</span>,</span><br><span class="line">    subGridExpanded: <span class="function"><span class="keyword">function</span> (<span class="params">subid, rowdata</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> TZId = rowdata.Id;</span><br><span class="line">        $(<span class="string">&#x27;#&#x27;</span> + subid).jfGrid(&#123;</span><br><span class="line">            url: top.$.rootUrl + <span class="string">&#x27;/Fly_TZ/Fly_TZ_Opmaster/Expensesubpagelist&#x27;</span>,</span><br><span class="line">            headData: [</span><br><span class="line">                &#123; <span class="attr">label</span>: <span class="string">&quot;应收&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;yingshou&quot;</span>, <span class="attr">width</span>: <span class="number">120</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">label</span>: <span class="string">&quot;应付&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;yingfu&quot;</span>, <span class="attr">width</span>: <span class="number">140</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">label</span>: <span class="string">&quot;实收&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;&quot;</span>, <span class="attr">width</span>: <span class="number">120</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">label</span>: <span class="string">&quot;实付&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;&quot;</span>, <span class="attr">width</span>: <span class="number">140</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">label</span>: <span class="string">&quot;利润&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;lirun&quot;</span>, <span class="attr">width</span>: <span class="number">140</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line">            ],</span><br><span class="line">            mainId: <span class="string">&#x27;yingshou&#x27;</span>,</span><br><span class="line">            sord: <span class="string">&quot;ASC&quot;</span>,</span><br><span class="line">            sidx: <span class="string">&#x27;yingshou&#x27;</span>,</span><br><span class="line">            isEdit: <span class="literal">true</span></span><br><span class="line">        &#125;);</span><br><span class="line">        $(<span class="string">&#x27;#&#x27;</span> + subid).jfGridSet(<span class="string">&#x27;reload&#x27;</span>, &#123; <span class="attr">TZId</span>: TZId &#125;);</span><br><span class="line">    &#125;<span class="comment">// 子表展开后调用函数</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="监听单元格事件"><a href="#监听单元格事件" class="headerlink" title="监听单元格事件"></a>监听单元格事件</h1><p>方法： <code>formatter</code><br>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    label: <span class="string">&#x27;操作&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;caozuo&#x27;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span></span><br><span class="line">    , <span class="attr">formatter</span>: <span class="function"><span class="keyword">function</span> (<span class="params">cellvalue, row, dfop, $dcell</span>) </span>&#123;</span><br><span class="line">        $dcell.on(<span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">            <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                top.layer.open(&#123;</span><br><span class="line">                    type: <span class="number">2</span>,</span><br><span class="line">                    title: <span class="string">&#x27;打印展示&#x27;</span>,</span><br><span class="line">                    shadeClose: <span class="literal">true</span>,</span><br><span class="line">                    shade: <span class="literal">false</span>,</span><br><span class="line">                    maxmin: <span class="literal">true</span>, <span class="comment">//开启最大化最小化按钮</span></span><br><span class="line">                    area: [<span class="string">&#x27;1000px&#x27;</span>, <span class="string">&#x27;650px&#x27;</span>],</span><br><span class="line">                    content: <span class="string">&#x27;/Fly_ZD/Fly_ZD_Head/Print&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;span class=&quot;label label-success&quot; style=&quot;text-align:center&quot; title=&quot;预览&quot;&gt;待收支列齐&lt;/span&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：<code>formatter</code>方法必须要有返回值</p><h1 id="判断是否选中行"><a href="#判断是否选中行" class="headerlink" title="判断是否选中行"></a>判断是否选中行</h1><p>方法：<code>checkrow</code><br>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> keyValue = $(<span class="string">&#x27;#gridtable&#x27;</span>).jfGridValue(<span class="string">&#x27;Id&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (learun.checkrow(keyValue)) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="表格上传附件"><a href="#表格上传附件" class="headerlink" title="表格上传附件"></a>表格上传附件</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> &#123;</span><br><span class="line">    label: <span class="string">&#x27;签名&#x27;</span>,</span><br><span class="line">    name: <span class="string">&#x27;EXT11&#x27;</span>,</span><br><span class="line">    width: <span class="number">100</span>,</span><br><span class="line">    align: <span class="string">&#x27;left&#x27;</span>,</span><br><span class="line">    formatter: <span class="function"><span class="keyword">function</span> (<span class="params">cellvalue, row, dfop, $dcell</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (row.EXT1 != <span class="literal">undefined</span> &amp;&amp; row.EXT1 != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> res = learun.httpGet(</span><br><span class="line">                top.$.rootUrl +</span><br><span class="line">                <span class="string">&#x27;/LR_SystemModule/Annexes/GetFileNames?folderId=&#x27;</span> +</span><br><span class="line">                row.EXT1);</span><br><span class="line">            <span class="keyword">if</span> (res.code == <span class="number">200</span> &amp;&amp; res.info != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">                $dcell.on(<span class="string">&#x27;click&#x27;</span>, <span class="comment">//对应参数附件列数据，行号，列明</span></span><br><span class="line">                    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                        cellDown(row.EXT1, $dcell.attr(<span class="string">&quot;rownum&quot;</span>), <span class="string">&#x27;EXT1&#x27;</span>);</span><br><span class="line">                    &#125;);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&lt;span&gt;查看签名&lt;/span&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $dcell.on(<span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">                <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    cellDown(row.EXT1, $dcell.attr(<span class="string">&quot;rownum&quot;</span>), <span class="string">&#x27;EXT1&#x27;</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&lt;span&gt;&lt;/span&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    label: <span class="string">&#x27;签名上传&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;EXT1&#x27;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&#x27;left&#x27;</span></span><br><span class="line">    , <span class="attr">formatter</span>: <span class="function"><span class="keyword">function</span> (<span class="params">cellvalue, row, dfop, $dcell</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> _data = dfop.rowdatas; <span class="comment">//获取所有数据</span></span><br><span class="line">        $dcell.on(<span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">            <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;<span class="comment">//对应参数表格id，当前行的索引，附件列数据，当前行号，列名，文件路径（文件夹（单据类型）），单元格对象</span></span><br><span class="line">                cellClick(<span class="string">&#x27;#&#x27;</span> + <span class="string">&quot;gridtable&quot;</span>, _data.indexOf(row), row.EXT1, $dcell.attr(<span class="string">&quot;rownum&quot;</span>), <span class="string">&#x27;EXT1&#x27;</span>, <span class="string">&quot;/UploadFiles/&quot;</span>, $dcell);</span><br><span class="line">            &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;span class=&quot;btn btn-success lrUploader-input-btn&quot; style=&quot;cursor:pointer;height: 90%;line-height: 90%;font-size: 12px;position: relative;bottom: 1px;&quot;&gt;Upload&lt;/span&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="流程列表双击事件"><a href="#流程列表双击事件" class="headerlink" title="流程列表双击事件"></a>流程列表双击事件</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">$.get(top.$.rootUrl + <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/GetNewProcessById&#x27;</span>,</span><br><span class="line">&#123; <span class="attr">processId</span>: row.Id &#125;,</span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    res = <span class="built_in">eval</span>(<span class="string">&#x27;(&#x27;</span> + res + <span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (res.code == <span class="number">400</span>) &#123;</span><br><span class="line">        <span class="comment">//Tips:查询是否是草稿   2021-10-08 wkz</span></span><br><span class="line">        $.post(<span class="string">&quot;/LR_NewWorkFlow/NWFProcess/GetDraftProcessById&quot;</span>, &#123; <span class="attr">processId</span>: row.Id &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">resData</span>) </span>&#123;</span><br><span class="line">            resData = <span class="built_in">JSON</span>.parse(resData);</span><br><span class="line">            <span class="keyword">if</span> (resData.code == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> data = resData.data;</span><br><span class="line">                <span class="comment">// 关闭草稿页</span></span><br><span class="line">                learun.frameTab.closeByParam(<span class="string">&#x27;tabProcessId&#x27;</span>, data.F_Id);</span><br><span class="line">                learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: data.F_Id, <span class="attr">F_Icon</span>: <span class="string">&#x27;fa magic&#x27;</span>, <span class="attr">F_FullName</span>: <span class="string">&#x27;创建流程-&#x27;</span> + data.F_SchemeName, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/NWFContainerForm?processId=&#x27;</span> + data.F_Id + <span class="string">&#x27;&amp;tabIframeId=&#x27;</span> + data.F_Id + <span class="string">&#x27;&amp;type=draftCreate&#x27;</span> + <span class="string">&quot;&amp;IsProduce=&quot;</span> + row.IsProduce + <span class="string">&quot;&amp;keyValue=&quot;</span> + row.DesignateId + <span class="string">&quot;&amp;Isdraft=&quot;</span> + row.StatementNo &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> processId = res.data.F_Id || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> taskId = res.data.F_TaskId || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> title = res.data.F_Title;</span><br><span class="line">    <span class="keyword">var</span> schemeName = res.data.F_SchemeName;</span><br><span class="line">    <span class="keyword">var</span> taskType = res.data.F_TaskType;</span><br><span class="line">    <span class="keyword">var</span> taskName = res.data.F_TaskName;</span><br><span class="line">    <span class="keyword">var</span> F_IsAgain = res.data.F_IsAgain;</span><br><span class="line">    <span class="keyword">if</span> (schemeName != title &amp;&amp; title) &#123;</span><br><span class="line">        title = schemeName + <span class="string">&quot;(&quot;</span> + title + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        title = schemeName;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> enabledMark = res.data.F_EnabledMark;</span><br><span class="line">    <span class="keyword">if</span> (enabledMark == <span class="number">2</span>) &#123;<span class="comment">// draft不允许查看进度</span></span><br><span class="line">        learun.alert.warning(<span class="string">&quot;Draft cannot check the progress&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (res.data.F_IsFinished != <span class="number">1</span>) &#123;</span><br><span class="line">        $.get(top.$.rootUrl + <span class="string">&#x27;/Fly_YD/Fly_YD_Waybill/Whether&#x27;</span>, &#123;</span><br><span class="line">            taskId: taskId, processId, processId</span><br><span class="line">        &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">JSON</span>.parse(res).data) &#123;</span><br><span class="line">                <span class="comment">//重新发起</span></span><br><span class="line">                <span class="keyword">if</span> (taskType == <span class="string">&#x27;5&#x27;</span>) &#123;</span><br><span class="line">                    learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: taskId, <span class="attr">F_Icon</span>: <span class="string">&#x27;fa magic&#x27;</span>, <span class="attr">F_FullName</span>: <span class="string">&#x27;重新发起-&#x27;</span> + title + <span class="string">&#x27;/&#x27;</span> + taskName, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/NWFContainerForm?tabIframeId=&#x27;</span> + taskId + <span class="string">&#x27;&amp;type=againCreate&#x27;</span> + <span class="string">&quot;&amp;processId=&quot;</span> + processId + <span class="string">&quot;&amp;taskId=&quot;</span> + taskId + <span class="string">&#x27;&amp;checkIds=&#x27;</span> + row.ReconciliaId + <span class="string">&quot;&amp;IsProduce=&quot;</span> + row.IsProduce + <span class="string">&quot;&amp;keyValue=&quot;</span> + row.DesignateId + <span class="string">&quot;&amp;Isdraft=&quot;</span> + row.StatementNo &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: taskId, <span class="attr">F_Icon</span>: <span class="string">&#x27;fa magic&#x27;</span>, <span class="attr">F_FullName</span>: <span class="string">&#x27;审批-&#x27;</span> + title + <span class="string">&#x27;/&#x27;</span> + taskName, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/NWFContainerForm?tabIframeId=&#x27;</span> + taskId + <span class="string">&#x27;&amp;type=audit&#x27;</span> + <span class="string">&quot;&amp;processId=&quot;</span> + processId + <span class="string">&quot;&amp;taskId=&quot;</span> + taskId + <span class="string">&#x27;&amp;checkIds=&#x27;</span> + row.ReconciliaId + <span class="string">&quot;&amp;IsProduce=&quot;</span> + row.IsProduce + <span class="string">&quot;&amp;keyValue=&quot;</span> + row.DesignateId + <span class="string">&quot;&amp;Isdraft=&quot;</span> + row.StatementNo &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (taskType == <span class="string">&#x27;4&#x27;</span> || taskType == <span class="string">&#x27;6&#x27;</span>) &#123;</span><br><span class="line">                    learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: processId + taskId, <span class="attr">F_Icon</span>: <span class="string">&#x27;fa magic&#x27;</span>, <span class="attr">F_FullName</span>: <span class="string">&#x27;Check the progress of the process【&#x27;</span> + title + <span class="string">&#x27;】&#x27;</span>, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/NWFContainerForm?tabIframeId=&#x27;</span> + processId + taskId + <span class="string">&#x27;&amp;type=childlook&#x27;</span> + <span class="string">&quot;&amp;processId=&quot;</span> + processId + <span class="string">&quot;&amp;taskId=&quot;</span> + taskId + <span class="string">&#x27;&amp;checkIds=&#x27;</span> + row.ReconciliaId + <span class="string">&quot;&amp;IsProduce=&quot;</span> + row.IsProduce + <span class="string">&quot;&amp;keyValue=&quot;</span> + row.DesignateId + <span class="string">&quot;&amp;Isdraft=&quot;</span> + row.StatementNo &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: processId + taskId, <span class="attr">F_Icon</span>: <span class="string">&#x27;fa magic&#x27;</span>, <span class="attr">F_FullName</span>: <span class="string">&#x27;Check the progress of the process【&#x27;</span> + title + <span class="string">&#x27;】&#x27;</span>, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/NWFContainerForm?tabIframeId=&#x27;</span> + processId + taskId + <span class="string">&#x27;&amp;type=look&#x27;</span> + <span class="string">&quot;&amp;processId=&quot;</span> + processId + <span class="string">&quot;&amp;taskId=&quot;</span> + taskId + <span class="string">&#x27;&amp;checkIds=&#x27;</span> + row.ReconciliaId + <span class="string">&quot;&amp;IsProduce=&quot;</span> + row.IsProduce + <span class="string">&quot;&amp;keyValue=&quot;</span> + row.DesignateId + <span class="string">&quot;&amp;Isdraft=&quot;</span> + row.StatementNo &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (taskType == <span class="string">&#x27;4&#x27;</span> || taskType == <span class="string">&#x27;6&#x27;</span>) &#123;</span><br><span class="line">            learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: processId + taskId, <span class="attr">F_Icon</span>: <span class="string">&#x27;fa magic&#x27;</span>, <span class="attr">F_FullName</span>: <span class="string">&#x27;Check the progress of the process【&#x27;</span> + title + <span class="string">&#x27;】&#x27;</span>, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/NWFContainerForm?tabIframeId=&#x27;</span> + processId + taskId + <span class="string">&#x27;&amp;type=childlook&#x27;</span> + <span class="string">&quot;&amp;processId=&quot;</span> + processId + <span class="string">&quot;&amp;taskId=&quot;</span> + taskId + <span class="string">&#x27;&amp;checkIds=&#x27;</span> + row.ReconciliaId + <span class="string">&quot;&amp;IsProduce=&quot;</span> + row.IsProduce + <span class="string">&quot;&amp;keyValue=&quot;</span> + row.DesignateId + <span class="string">&quot;&amp;Isdraft=&quot;</span> + row.StatementNo &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: processId + taskId, <span class="attr">F_Icon</span>: <span class="string">&#x27;fa magic&#x27;</span>, <span class="attr">F_FullName</span>: <span class="string">&#x27;Check the progress of the process【&#x27;</span> + title + <span class="string">&#x27;】&#x27;</span>, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/LR_NewWorkFlow/NWFProcess/NWFContainerForm?tabIframeId=&#x27;</span> + processId + taskId + <span class="string">&#x27;&amp;type=look&#x27;</span> + <span class="string">&quot;&amp;processId=&quot;</span> + processId + <span class="string">&quot;&amp;taskId=&quot;</span> + taskId + <span class="string">&#x27;&amp;checkIds=&#x27;</span> + row.ReconciliaId + <span class="string">&quot;&amp;IsProduce=&quot;</span> + row.IsProduce + <span class="string">&quot;&amp;keyValue=&quot;</span> + row.DesignateId + <span class="string">&quot;&amp;Isdraft=&quot;</span> + row.StatementNo &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 力软 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>力软框架--选择框</title>
      <link href="2020/12/26/lrselect/"/>
      <url>2020/12/26/lrselect/</url>
      
        <content type="html"><![CDATA[<h1 id="下拉选择"><a href="#下拉选择" class="headerlink" title="下拉选择"></a>下拉选择</h1><blockquote><p>获取值：$(‘#’+id).lrselectGet();<br>赋值：$(‘#’+id).lrselectSet(“”);<br>重新渲染：$(‘#’+id).lrselectRefresh(op);</p></blockquote><p>方法：<code>$(&#39;#&#39;+id).lrselect(op);</code><br>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th><th>默认</th></tr></thead><tbody><tr><td>placeholder</td><td>占位符</td><td>请选择</td></tr><tr><td>type</td><td>数据展示类型：1.default：普通；2.tree：树形数据；3. treemultiple：树形多选；multiple：普通多选</td><td>default</td></tr><tr><td>value</td><td>数据值字段名</td><td>id</td></tr><tr><td>text</td><td>数据显示字段名</td><td>text</td></tr><tr><td>title</td><td>数据标题字段名</td><td>title</td></tr><tr><td>maxHeight</td><td>下拉框最大高度</td><td>200</td></tr><tr><td>width</td><td>下拉框宽度</td><td>跟随输入框宽度</td></tr><tr><td>allowSearch</td><td>是否允许搜索</td><td>false</td></tr><tr><td>url</td><td>获取数据地址</td><td>false</td></tr><tr><td>data</td><td>下拉选择数据</td><td>false</td></tr><tr><td>param</td><td>请求后台参数</td><td>Null</td></tr><tr><td>method</td><td>请求后台方法：GET、POST</td><td>GET</td></tr><tr><td>select</td><td>选择后触发方法</td><td>false</td></tr></tbody></table><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#customerId&#x27;</span>).lrselect(&#123;</span><br><span class="line"> url: top.$.rootUrl + <span class="string">&#x27;/LR_CRMModule/Customer/GetList&#x27;</span>,</span><br><span class="line"> text: <span class="string">&#x27;F_FullName&#x27;</span>,</span><br><span class="line"> value: <span class="string">&#x27;F_CustomerId&#x27;</span>,</span><br><span class="line"> allowSearch: <span class="literal">true</span>,</span><br><span class="line"> maxHeight: <span class="number">400</span></span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><h1 id="数据字典下拉选择框"><a href="#数据字典下拉选择框" class="headerlink" title="数据字典下拉选择框"></a>数据字典下拉选择框</h1><p>方法：<code>$(&#39;#&#39;+id).lrDataItemSelect(op);</code><br>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th><th>默认</th></tr></thead><tbody><tr><td>code</td><td>字典编码</td><td></td></tr><tr><td>allowSearch</td><td>是否允许搜索</td><td>false</td></tr><tr><td>select</td><td>选择后触发方法</td><td>false</td></tr></tbody></table><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#F_Process&#x27;</span>).lrDataItemSelect(&#123; <span class="attr">code</span>: <span class="string">&#x27;Process&#x27;</span> &#125;);</span><br></pre></td></tr></table></figure><h1 id="数据源下拉选择框"><a href="#数据源下拉选择框" class="headerlink" title="数据源下拉选择框"></a>数据源下拉选择框</h1><p>方法：<code>$(&#39;#&#39;+id).lrDataSourceSelect(op);</code><br>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th><th>默认</th></tr></thead><tbody><tr><td>code</td><td>数据源编码</td><td></td></tr><tr><td>value</td><td>数据值字段名</td><td>id</td></tr><tr><td>text</td><td>数据显示字段名</td><td>text</td></tr><tr><td>title</td><td>数据标题字段名</td><td>title</td></tr><tr><td>maxHeight</td><td>下拉框最大高度</td><td>200</td></tr><tr><td>width</td><td>下拉框宽度</td><td>跟随输入框宽度</td></tr><tr><td>allowSearch</td><td>是否允许搜索</td><td>false</td></tr><tr><td>select</td><td>选择后触发方法</td><td>false</td></tr></tbody></table><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#F_text&#x27;</span>).lrDataSourceSelect(&#123; <span class="attr">code</span>: <span class="string">&#x27;userdata&#x27;</span>,</span><br><span class="line">value: <span class="string">&#x27;f_userid&#x27;</span>,</span><br><span class="line">text: <span class="string">&#x27;f_realname&#x27;</span> &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h1 id="表格选择框插件"><a href="#表格选择框插件" class="headerlink" title="表格选择框插件"></a>表格选择框插件</h1><blockquote><p>获取值：$(‘#’+id).lrGirdSelectGet();<br>赋值：$(‘#’+id).lrGirdSelectSet(“”);</p></blockquote><p>方法：<code>$(&#39;#&#39;+id).lrGirdSelect(op);</code><br>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th><th>默认</th></tr></thead><tbody><tr><td>placeholder</td><td>占位符</td><td>请选择</td></tr><tr><td>icon</td><td>选择图标</td><td>‘fa-plus’</td></tr><tr><td>selectWord</td><td>查询字段</td><td>‘’</td></tr><tr><td>headData</td><td>表格列数据</td><td></td></tr><tr><td>value</td><td>选择后得到的值字段</td><td></td></tr><tr><td>text</td><td>选择后显示的字段</td><td></td></tr><tr><td>url</td><td>获取弹出表格数据的地址</td><td></td></tr><tr><td>param</td><td>参数</td><td>false</td></tr><tr><td>width</td><td>弹框宽度</td><td>600</td></tr><tr><td>height</td><td>弹框高度</td><td>400</td></tr><tr><td>select</td><td>选择事件</td><td>false</td></tr></tbody></table><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#select5&#x27;</span>).lrGirdSelect(&#123;</span><br><span class="line"> <span class="comment">// 字段</span></span><br><span class="line"> url: top.$.rootUrl + <span class="string">&#x27;/LR_SystemModule/DataItem/GetDetailList&#x27;</span>,</span><br><span class="line"> param: &#123; <span class="attr">itemCode</span>: <span class="string">&#x27;Client_ProductInfo&#x27;</span> &#125;,</span><br><span class="line"> selectWord: <span class="string">&#x27;F_ItemName&#x27;</span>,</span><br><span class="line"> value: <span class="string">&#x27;F_ItemValue&#x27;</span>,</span><br><span class="line"> text: <span class="string">&#x27;F_ItemName&#x27;</span>,</span><br><span class="line"> headData: [&#123; <span class="attr">label</span>: <span class="string">&quot;商品编号&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;F_ItemValue&quot;</span>, <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;,</span><br><span class="line"> &#123; <span class="attr">label</span>: <span class="string">&quot;商品名称&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;F_ItemName&quot;</span>, <span class="attr">width</span>: <span class="number">450</span>, <span class="attr">align</span>: <span class="string">&quot;left&quot;</span> &#125;],</span><br><span class="line"> select: <span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"> &#125;,</span><br><span class="line"> isPage: <span class="literal">true</span>,</span><br><span class="line"> reloadSelected: <span class="literal">true</span>,</span><br><span class="line"> mainId: <span class="string">&#x27;F_ItemValue&#x27;</span>,</span><br><span class="line"> sidx: <span class="string">&#x27;F_ItemValue&#x27;</span>,</span><br><span class="line"> type: <span class="number">1</span></span><br><span class="line"> &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 力软 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>力软框架</title>
      <link href="2020/12/26/learun/"/>
      <url>2020/12/26/learun/</url>
      
        <content type="html"><![CDATA[<h1 id="null转义符"><a href="#null转义符" class="headerlink" title="null转义符"></a>null转义符</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;nbsp;</span><br></pre></td></tr></table></figure><h1 id="Loading遮罩层"><a href="#Loading遮罩层" class="headerlink" title="Loading遮罩层"></a>Loading遮罩层</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">learun.loading(<span class="literal">true</span>, <span class="string">&#x27;Loading……&#x27;</span>);</span><br><span class="line">learun.loading(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure><h1 id="打开新的iframe界面"><a href="#打开新的iframe界面" class="headerlink" title="打开新的iframe界面"></a>打开新的iframe界面</h1><blockquote><p>F_ModuleId : 页面ID<br>F_FullName : 页面名称<br>F_UrlAddress : 页面地址</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">learun.frameTab.open(&#123; <span class="attr">F_ModuleId</span>: learun.newGuid(), <span class="attr">F_FullName</span>: <span class="string">&#x27;通用制单&#x27;</span>, <span class="attr">F_UrlAddress</span>: <span class="string">&#x27;/Fly_ZD/Fly_ZD_Head/Form&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure><h1 id="时间查询框"><a href="#时间查询框" class="headerlink" title="时间查询框"></a>时间查询框</h1><p>方法：<code>$(&#39;#&#39;+id).lrdate(op);</code><br>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th><th>默认</th></tr></thead><tbody><tr><td>dfdata</td><td>自定义数据</td><td>[]</td></tr><tr><td>mShow</td><td>是否显示当月按钮</td><td>true</td></tr><tr><td>premShow</td><td>是否显示上月按钮</td><td>true</td></tr><tr><td>jShow</td><td>是否显示当季度按钮</td><td>true</td></tr><tr><td>prejShow</td><td>是否显示上季度按钮</td><td>true</td></tr><tr><td>ysShow</td><td>是否显示上半年按钮</td><td>true</td></tr><tr><td>yxShow</td><td>是否显示下半年按钮</td><td>true</td></tr><tr><td>preyShow</td><td>是否显示去年按钮</td><td>true</td></tr><tr><td>yShow</td><td>是否显示今年按钮</td><td>true</td></tr><tr><td>dfvalue</td><td>默认选择值</td><td>未选择</td></tr><tr><td>selectfn</td><td>选择后回调函数</td><td>false</td></tr><tr><td>minDate</td><td>最小日期</td><td>‘’</td></tr><tr><td>maxDate</td><td>最大日期</td><td>‘’</td></tr></tbody></table><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">this</span>).lrdate(&#123;</span><br><span class="line"> dfdata: [</span><br><span class="line"> &#123; <span class="attr">name</span>: <span class="string">&#x27;今天&#x27;</span>, <span class="attr">begin</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd</span></span><br><span class="line"><span class="string">00:00:00&#x27;</span>) &#125;, <span class="attr">end</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd 23:59:59&#x27;</span>) &#125; &#125;,</span><br><span class="line"> &#123; <span class="attr">name</span>: <span class="string">&#x27;近7天&#x27;</span>, <span class="attr">begin</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd</span></span><br><span class="line"><span class="string">00:00:00&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, -<span class="number">6</span>) &#125;, <span class="attr">end</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd 23:59:59&#x27;</span>) &#125; &#125;,</span><br><span class="line"> &#123; <span class="attr">name</span>: <span class="string">&#x27;近1个月&#x27;</span>, <span class="attr">begin</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd</span></span><br><span class="line"><span class="string">00:00:00&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, -<span class="number">1</span>) &#125;, <span class="attr">end</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd 23:59:59&#x27;</span>) &#125; &#125;,</span><br><span class="line"> &#123; <span class="attr">name</span>: <span class="string">&#x27;近3个月&#x27;</span>, <span class="attr">begin</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd</span></span><br><span class="line"><span class="string">00:00:00&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, -<span class="number">3</span>) &#125;, <span class="attr">end</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> learun.getDate(<span class="string">&#x27;yyyy-MM-dd 23:59:59&#x27;</span>) &#125; &#125;,</span><br><span class="line"> ],</span><br><span class="line"> <span class="comment">// 月</span></span><br><span class="line"> mShow: <span class="literal">false</span>,</span><br><span class="line"> premShow: <span class="literal">false</span>,</span><br><span class="line"> <span class="comment">// 季度</span></span><br><span class="line"> jShow: <span class="literal">false</span>,</span><br><span class="line"> prejShow: <span class="literal">false</span>,</span><br><span class="line"> <span class="comment">// 年</span></span><br><span class="line"> ysShow: <span class="literal">false</span>,</span><br><span class="line"> yxShow: <span class="literal">false</span>,</span><br><span class="line"> preyShow: <span class="literal">false</span>,</span><br><span class="line"> yShow: <span class="literal">false</span>,</span><br><span class="line"> <span class="comment">// 默认</span></span><br><span class="line"> dfvalue: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line"> selectfn: <span class="function"><span class="keyword">function</span> (<span class="params">begin, end</span>) </span>&#123;</span><br><span class="line"> logbegin = begin;</span><br><span class="line"> logend = end;</span><br><span class="line"> page.search();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><h1 id="弹层"><a href="#弹层" class="headerlink" title="弹层"></a>弹层</h1><p>方法：<code>learun. layerForm(op);</code><br>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th><th>默认</th></tr></thead><tbody><tr><td>Id</td><td>窗体 id</td><td>Null</td></tr><tr><td>title</td><td>窗体标题</td><td>系统窗口</td></tr><tr><td>width</td><td>窗体宽</td><td>550</td></tr><tr><td>height</td><td>窗体高</td><td>400</td></tr><tr><td>url</td><td>窗口地址</td><td>error</td></tr><tr><td>btn</td><td>按钮名称</td><td>[‘确认’, ‘关闭’]</td></tr><tr><td>callBack</td><td>第一个按钮点击回调函数</td><td></td></tr><tr><td>maxmin</td><td>窗体是否允许最大最小</td><td></td></tr><tr><td>end</td><td>窗体关闭后执行</td><td></td></tr></tbody></table><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  learun.layerForm(&#123;</span><br><span class="line">id: <span class="string">&#x27;form&#x27;</span>,</span><br><span class="line">title: <span class="string">&#x27;系统窗口&#x27;</span>,</span><br><span class="line">url: top.$.rootUrl + <span class="string">&#x27;/Fly_TZ/Fly_TZ_Opmaster/Exportbysea&#x27;</span>,</span><br><span class="line">width: <span class="number">1000</span>,</span><br><span class="line">height: <span class="number">900</span>,</span><br><span class="line">callBack: <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> top[id].acceptClick(refreshGirdData);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="询问框"><a href="#询问框" class="headerlink" title="询问框"></a>询问框</h1><p>方法：<code>learun. layerConfirm(op);</code><br>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">learun.layerConfirm(<span class="string">&#x27;是否确认删除该项！&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (res) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="获取时间及格式转换"><a href="#获取时间及格式转换" class="headerlink" title="获取时间及格式转换"></a>获取时间及格式转换</h1><ul><li><a href="#parseDate">字串转化成日期</a> <code>parseDate(strDate)</code></li><li><a href="#formatDate">日期格式化v日期,format:格式</a> <code>formatDate(v, format)</code></li><li><a href="#getDate">获取当前时间;format为格式</a> <code>getDate(format, strInterval, Number)</code></li><li>月 <code>getMonth</code></li><li>季度 <code>getQuarter</code></li><li>年 <code>getYear</code></li><li><a href="#DateAdd">日期计算</a> <code>Date.prototype.DateAdd(strInterval, Number)</code></li><li><a href="#DateDiff">比较日期差 dtEnd 格式为日期型或者 有效日期格式字符串</a>  <code>Date.prototype.DateDiff(strInterval, dtEnd)</code></li><li>取得当前日期所在月的最大天数 <code>Date.prototype.MaxDayOfDate</code></li></ul><h2 id="字串转化成日期-parseDate"><a href="#字串转化成日期-parseDate" class="headerlink" title="字串转化成日期 parseDate"></a><a id="parseDate">字串转化成日期 parseDate</a></h2><p>方法:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字串转化成日期</span></span><br><span class="line">parseDate: <span class="function"><span class="keyword">function</span> (<span class="params">strDate</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> myDate;</span><br><span class="line"><span class="keyword">if</span> (strDate.indexOf(<span class="string">&quot;/Date(&quot;</span>) &gt; -<span class="number">1</span>)</span><br><span class="line">myDate = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(strDate.replace(<span class="string">&quot;/Date(&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;)/&quot;</span>, <span class="string">&quot;&quot;</span>), <span class="number">10</span>));</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">myDate = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(strDate.replace(<span class="regexp">/-/g</span>, <span class="string">&quot;/&quot;</span>).replace(<span class="string">&quot;T&quot;</span>, <span class="string">&quot; &quot;</span>).split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>]));<span class="comment">//.split(&quot;.&quot;)[0] 用来处理出现毫秒的情况，截取掉.xxx，否则会出错</span></span><br><span class="line"><span class="keyword">return</span> myDate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="日期格式化-formatDate"><a href="#日期格式化-formatDate" class="headerlink" title="日期格式化 formatDate"></a><a id="formatDate">日期格式化 formatDate</a></h2><p>方法:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 日期格式化v日期,format:格式</span></span><br><span class="line">formatDate: <span class="function"><span class="keyword">function</span> (<span class="params">v, format</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!v) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> d = v;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> v === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v.indexOf(<span class="string">&quot;/Date(&quot;</span>) &gt; -<span class="number">1</span>)</span><br><span class="line">            d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">parseInt</span>(v.replace(<span class="string">&quot;/Date(&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;)/&quot;</span>, <span class="string">&quot;&quot;</span>), <span class="number">10</span>));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(v.replace(<span class="regexp">/-/g</span>, <span class="string">&quot;/&quot;</span>).replace(<span class="string">&quot;T&quot;</span>, <span class="string">&quot; &quot;</span>).split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>]));<span class="comment">//.split(&quot;.&quot;)[0] 用来处理出现毫秒的情况，截取掉.xxx，否则会出错</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> o = &#123;</span><br><span class="line">        <span class="string">&quot;M+&quot;</span>: d.getMonth() + <span class="number">1</span>,  <span class="comment">//month</span></span><br><span class="line">        <span class="string">&quot;d+&quot;</span>: d.getDate(),       <span class="comment">//day</span></span><br><span class="line">        <span class="string">&quot;h+&quot;</span>: d.getHours(),      <span class="comment">//hour</span></span><br><span class="line">        <span class="string">&quot;m+&quot;</span>: d.getMinutes(),    <span class="comment">//minute</span></span><br><span class="line">        <span class="string">&quot;s+&quot;</span>: d.getSeconds(),    <span class="comment">//second</span></span><br><span class="line">        <span class="string">&quot;q+&quot;</span>: <span class="built_in">Math</span>.floor((d.getMonth() + <span class="number">3</span>) / <span class="number">3</span>),  <span class="comment">//quarter</span></span><br><span class="line">        <span class="string">&quot;S&quot;</span>: d.getMilliseconds() <span class="comment">//millisecond</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.test(format)) &#123;</span><br><span class="line">        format = format.replace(<span class="built_in">RegExp</span>.$1, (d.getFullYear() + <span class="string">&quot;&quot;</span>).substr(<span class="number">4</span> - <span class="built_in">RegExp</span>.$1.length));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;(&quot;</span> + k + <span class="string">&quot;)&quot;</span>).test(format)) &#123;</span><br><span class="line">            format = format.replace(<span class="built_in">RegExp</span>.$1, <span class="built_in">RegExp</span>.$1.length == <span class="number">1</span> ? o[k] : (<span class="string">&quot;00&quot;</span> + o[k]).substr((<span class="string">&quot;&quot;</span> + o[k]).length));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> format;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">learun.formatDate(<span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="string">&#x27;yyyy-MM-dd hh:mm:ss&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="获取当前时间-getDate"><a href="#获取当前时间-getDate" class="headerlink" title="获取当前时间 getDate"></a><a id="getDate">获取当前时间 getDate</a></h2><p>方法:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前时间;format为格式</span></span><br><span class="line">getDate: <span class="function"><span class="keyword">function</span> (<span class="params">format, strInterval, <span class="built_in">Number</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> myDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (!!strInterval) &#123;</span><br><span class="line">        myDate = myDate.DateAdd(strInterval, <span class="built_in">Number</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> res = learun.formatDate(myDate, format);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">learun.getDate(<span class="string">&#x27;yyyy-MM-dd 00:00:00&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, -<span class="number">6</span>)</span><br></pre></td></tr></table></figure><h2 id="日期计算-DateAdd"><a href="#日期计算-DateAdd" class="headerlink" title="日期计算 DateAdd"></a><a id="DateAdd">日期计算 DateAdd</a></h2><p>方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//+---------------------------------------------------  </span></span><br><span class="line"><span class="comment">//| 日期计算  </span></span><br><span class="line"><span class="comment">//+---------------------------------------------------  </span></span><br><span class="line"><span class="built_in">Date</span>.prototype.DateAdd = <span class="function"><span class="keyword">function</span> (<span class="params">strInterval, <span class="built_in">Number</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dtTmp = <span class="built_in">this</span>;</span><br><span class="line">    <span class="keyword">switch</span> (strInterval) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(dtTmp) + (<span class="number">1000</span> * <span class="built_in">Number</span>));<span class="comment">// 秒</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(dtTmp) + (<span class="number">60000</span> * <span class="built_in">Number</span>));<span class="comment">// 分</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(dtTmp) + (<span class="number">3600000</span> * <span class="built_in">Number</span>));<span class="comment">// 小时</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(dtTmp) + (<span class="number">86400000</span> * <span class="built_in">Number</span>));<span class="comment">// 天</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(dtTmp) + ((<span class="number">86400000</span> * <span class="number">7</span>) * <span class="built_in">Number</span>));<span class="comment">// 星期</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;q&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(dtTmp.getFullYear(), (dtTmp.getMonth()) + <span class="built_in">Number</span> * <span class="number">3</span>, dtTmp.getDate(), dtTmp.getHours(), dtTmp.getMinutes(), dtTmp.getSeconds());<span class="comment">// 季度</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;m&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(dtTmp.getFullYear(), (dtTmp.getMonth()) + <span class="built_in">Number</span>, dtTmp.getDate(), dtTmp.getHours(), dtTmp.getMinutes(), dtTmp.getSeconds());<span class="comment">// 月</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>: <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>((dtTmp.getFullYear() + <span class="built_in">Number</span>), dtTmp.getMonth(), dtTmp.getDate(), dtTmp.getHours(), dtTmp.getMinutes(), dtTmp.getSeconds());<span class="comment">// 年</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>().DateAdd(<span class="string">&#x27;d&#x27;</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure><h2 id="比较日期差-DateDiff"><a href="#比较日期差-DateDiff" class="headerlink" title="比较日期差 DateDiff"></a><a id="DateDiff">比较日期差 DateDiff</a></h2><p>方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//+---------------------------------------------------  </span></span><br><span class="line"><span class="comment">//| 比较日期差 dtEnd 格式为日期型或者 有效日期格式字符串  </span></span><br><span class="line"><span class="comment">//+---------------------------------------------------  </span></span><br><span class="line"><span class="built_in">Date</span>.prototype.DateDiff = <span class="function"><span class="keyword">function</span> (<span class="params">strInterval, dtEnd</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dtStart = <span class="built_in">this</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> dtEnd == <span class="string">&#x27;string&#x27;</span>)<span class="comment">//如果是字符串转换为日期型  </span></span><br><span class="line">    &#123;</span><br><span class="line">        dtEnd = learun.parseDate(dtEnd);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">switch</span> (strInterval) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>: <span class="keyword">return</span> <span class="built_in">parseInt</span>((dtEnd - dtStart) / <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>: <span class="keyword">return</span> <span class="built_in">parseInt</span>((dtEnd - dtStart) / <span class="number">60000</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>: <span class="keyword">return</span> <span class="built_in">parseInt</span>((dtEnd - dtStart) / <span class="number">3600000</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>: <span class="keyword">return</span> <span class="built_in">parseInt</span>((dtEnd - dtStart) / <span class="number">86400000</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>: <span class="keyword">return</span> <span class="built_in">parseInt</span>((dtEnd - dtStart) / (<span class="number">86400000</span> * <span class="number">7</span>));</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;m&#x27;</span>: <span class="keyword">return</span> (dtEnd.getMonth() + <span class="number">1</span>) + ((dtEnd.getFullYear() - dtStart.getFullYear()) * <span class="number">12</span>) - (dtStart.getMonth() + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;y&#x27;</span>: <span class="keyword">return</span> dtEnd.getFullYear() - dtStart.getFullYear();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date1.DateDiff(<span class="string">&#x27;d&#x27;</span>, date2);</span><br></pre></td></tr></table></figure><h1 id="获取及设置表单数据"><a href="#获取及设置表单数据" class="headerlink" title="获取及设置表单数据"></a>获取及设置表单数据</h1><h2 id="获取表单数据"><a href="#获取表单数据" class="headerlink" title="获取表单数据"></a>获取表单数据</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">$.fn.lrGetFormData = <span class="function"><span class="keyword">function</span> (<span class="params">keyValue</span>) </span>&#123;<span class="comment">// 获取表单数据</span></span><br><span class="line">    <span class="keyword">var</span> resdata = &#123;&#125;;</span><br><span class="line">    $(<span class="built_in">this</span>).find(<span class="string">&#x27;input,select,textarea,.lr-select,.lr-formselect,.lrUploader-wrap,.lr-radio,.lr-checkbox,.edui-default&#x27;</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params">r</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> id = $(<span class="built_in">this</span>).attr(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">        <span class="keyword">if</span> (!!id) &#123;</span><br><span class="line">            <span class="keyword">var</span> type = $(<span class="built_in">this</span>).attr(<span class="string">&#x27;type&#x27;</span>);</span><br><span class="line">            <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;radio&quot;</span>:</span><br><span class="line">                    <span class="keyword">if</span> ($(<span class="string">&quot;#&quot;</span> + id).is(<span class="string">&quot;:checked&quot;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">var</span> _name = $(<span class="string">&quot;#&quot;</span> + id).attr(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">                        resdata[_name] = $(<span class="string">&quot;#&quot;</span> + id).val();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;checkbox&quot;</span>:</span><br><span class="line">                    <span class="keyword">if</span> ($(<span class="string">&quot;#&quot;</span> + id).is(<span class="string">&quot;:checked&quot;</span>)) &#123;</span><br><span class="line">                        resdata[id] = <span class="number">1</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        resdata[id] = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lrselect&quot;</span>:</span><br><span class="line">                    resdata[id] = $(<span class="built_in">this</span>).lrselectGet();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;formselect&quot;</span>:</span><br><span class="line">                    resdata[id] = $(<span class="built_in">this</span>).lrformselectGet();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lrGirdSelect&quot;</span>:</span><br><span class="line">                    resdata[id] = $(<span class="built_in">this</span>).lrGirdSelectGet();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lr-Uploader&quot;</span>:</span><br><span class="line">                    resdata[id] = $(<span class="built_in">this</span>).lrUploaderGet();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lr-radio&quot;</span>:</span><br><span class="line">                    resdata[id] = $(<span class="built_in">this</span>).find(<span class="string">&#x27;input:checked&#x27;</span>).val();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lr-checkbox&quot;</span>:</span><br><span class="line">                    <span class="keyword">var</span> _idlist = [];</span><br><span class="line">                    $(<span class="built_in">this</span>).find(<span class="string">&#x27;input:checked&#x27;</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                        _idlist.push($(<span class="built_in">this</span>).val());</span><br><span class="line">                    &#125;);</span><br><span class="line">                    resdata[id] = <span class="built_in">String</span>(_idlist);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">if</span> ($(<span class="string">&quot;#&quot;</span> + id).hasClass(<span class="string">&#x27;currentInfo&#x27;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">var</span> value = $(<span class="string">&quot;#&quot;</span> + id)[<span class="number">0</span>].lrvalue;</span><br><span class="line">                        <span class="keyword">if</span> (value == <span class="literal">undefined</span>) &#123;</span><br><span class="line">                            value = $(<span class="string">&#x27;#&#x27;</span> + id).val();</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        resdata[id] = $.trim(value);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> ($(<span class="built_in">this</span>).hasClass(<span class="string">&#x27;edui-default&#x27;</span>)) &#123;</span><br><span class="line">                        <span class="keyword">if</span> ($(<span class="built_in">this</span>)[<span class="number">0</span>].ue) &#123;</span><br><span class="line">                            resdata[id] = $(<span class="built_in">this</span>)[<span class="number">0</span>].ue.getContent(<span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">true</span>).replace(<span class="regexp">/[&lt;&gt;&amp;&quot;]/g</span>, <span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123; <span class="keyword">return</span> &#123; <span class="string">&#x27;&lt;&#x27;</span>: <span class="string">&#x27;&amp;lt;&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>: <span class="string">&#x27;&amp;gt;&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>: <span class="string">&#x27;&amp;amp;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>: <span class="string">&#x27;&amp;quot;&#x27;</span> &#125;[c]; &#125;);<span class="comment">//</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">var</span> value = $(<span class="string">&quot;#&quot;</span> + id).val();</span><br><span class="line">                        <span class="keyword">if</span> (value != <span class="literal">undefined</span> &amp;&amp; value != <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">                            resdata[id] = $.trim(value);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (resdata[id] != <span class="literal">undefined</span>) &#123;</span><br><span class="line">                resdata[id] += <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span> (resdata[id] == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">                    resdata[id] = <span class="string">&#x27;&amp;nbsp;&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (resdata[id] == <span class="string">&#x27;&amp;nbsp;&#x27;</span> &amp;&amp; !keyValue) &#123;</span><br><span class="line">                    resdata[id] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> resdata;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="设置表单数据"><a href="#设置表单数据" class="headerlink" title="设置表单数据"></a>设置表单数据</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">$.fn.lrSetFormData = <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;<span class="comment">// 设置表单数据</span></span><br><span class="line">    <span class="keyword">var</span> $this = $(<span class="built_in">this</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> id <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="keyword">var</span> value = data[id];</span><br><span class="line">        <span class="keyword">var</span> $obj = $this.find(<span class="string">&#x27;#&#x27;</span> + id);</span><br><span class="line">        <span class="keyword">if</span> ($obj.length == <span class="number">0</span> &amp;&amp; value != <span class="literal">null</span>) &#123;</span><br><span class="line">            $obj = $this.find(<span class="string">&#x27;[name=&quot;&#x27;</span> + id + <span class="string">&#x27;&quot;][value=&quot;&#x27;</span> + value + <span class="string">&#x27;&quot;]&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ($obj.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!$obj.is(<span class="string">&quot;:checked&quot;</span>)) &#123;</span><br><span class="line">                    $obj.trigger(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> type = $obj.attr(<span class="string">&#x27;type&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ($obj.hasClass(<span class="string">&quot;lr-input-wdatepicker&quot;</span>)) &#123;</span><br><span class="line">                type = <span class="string">&quot;datepicker&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;checkbox&quot;</span>:</span><br><span class="line">                    <span class="keyword">var</span> isck = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">if</span> ($obj.is(<span class="string">&quot;:checked&quot;</span>)) &#123;</span><br><span class="line">                        isck = <span class="number">1</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        isck = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (isck != <span class="built_in">parseInt</span>(value)) &#123;</span><br><span class="line">                        $obj.trigger(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lrselect&quot;</span>:</span><br><span class="line">                    $obj.lrselectSet(value);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;formselect&quot;</span>:</span><br><span class="line">                    $obj.lrformselectSet(value);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lrGirdSelect&quot;</span>:</span><br><span class="line">                    $obj.lrGirdSelectSet(value);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;datepicker&quot;</span>:</span><br><span class="line">                    <span class="keyword">var</span> _dateFmt = $obj.attr(<span class="string">&#x27;data-dateFmt&#x27;</span>) || <span class="string">&#x27;yyyy-MM-dd hh:mm&#x27;</span>;</span><br><span class="line">                    $obj.val(learun.formatDate(value, _dateFmt));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lr-Uploader&quot;</span>:</span><br><span class="line">                    $obj.lrUploaderSet(value);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lr-radio&quot;</span>:</span><br><span class="line">                    <span class="keyword">if</span> (!$obj.find(<span class="string">&#x27;input[value=&quot;&#x27;</span> + value + <span class="string">&#x27;&quot;]&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>)) &#123;</span><br><span class="line">                        $obj.find(<span class="string">&#x27;input[value=&quot;&#x27;</span> + value + <span class="string">&#x27;&quot;]&#x27;</span>).trigger(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;lr-checkbox&quot;</span>:</span><br><span class="line">                    <span class="comment">//Fly:修改如果复选框值是空会报错   2020-11-2   wkz </span></span><br><span class="line">                    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">                        <span class="keyword">var</span> values = value.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                        $.each(values, <span class="function"><span class="keyword">function</span> (<span class="params">index, val</span>) </span>&#123;</span><br><span class="line">                            <span class="keyword">if</span> (!$obj.find(<span class="string">&#x27;input[value=&quot;&#x27;</span> + val + <span class="string">&#x27;&quot;]&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>)) &#123;</span><br><span class="line">                                $obj.find(<span class="string">&#x27;input[value=&quot;&#x27;</span> + val + <span class="string">&#x27;&quot;]&#x27;</span>).trigger(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">var</span> _idlist = [];</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">if</span> ($obj.hasClass(<span class="string">&#x27;currentInfo&#x27;</span>)) &#123;</span><br><span class="line">                        $obj[<span class="number">0</span>].lrvalue = value;</span><br><span class="line">                        <span class="keyword">if</span> ($obj.hasClass(<span class="string">&#x27;lr-currentInfo-user&#x27;</span>)) &#123;</span><br><span class="line">                            $obj.val(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                            learun.clientdata.getAsync(<span class="string">&#x27;user&#x27;</span>, &#123;</span><br><span class="line">                                key: value,</span><br><span class="line">                                callback: <span class="function"><span class="keyword">function</span> (<span class="params">item, op</span>) </span>&#123;</span><br><span class="line">                                    op.obj.val(item.name);</span><br><span class="line">                                &#125;,</span><br><span class="line">                                obj: $obj</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> ($obj.hasClass(<span class="string">&#x27;lr-currentInfo-company&#x27;</span>)) &#123;</span><br><span class="line">                            $obj.val(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                            learun.clientdata.getAsync(<span class="string">&#x27;company&#x27;</span>, &#123;</span><br><span class="line">                                key: value,</span><br><span class="line">                                callback: <span class="function"><span class="keyword">function</span> (<span class="params">_data, op</span>) </span>&#123;</span><br><span class="line">                                    op.obj.val(_data.name);</span><br><span class="line">                                &#125;,</span><br><span class="line">                                obj: $obj</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> ($obj.hasClass(<span class="string">&#x27;lr-currentInfo-department&#x27;</span>)) &#123;</span><br><span class="line">                            $obj.val(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                            learun.clientdata.getAsync(<span class="string">&#x27;department&#x27;</span>, &#123;</span><br><span class="line">                                key: value,</span><br><span class="line">                                callback: <span class="function"><span class="keyword">function</span> (<span class="params">_data, op</span>) </span>&#123;</span><br><span class="line">                                    op.obj.val(_data.name);</span><br><span class="line">                                &#125;,</span><br><span class="line">                                obj: $obj</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            $obj.val(value);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> ($obj[<span class="number">0</span>] &amp;&amp; $obj[<span class="number">0</span>].ue) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!!value) &#123;</span><br><span class="line">                            <span class="keyword">var</span> ue = $obj[<span class="number">0</span>].ue;</span><br><span class="line">                            setUe(ue, value);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        $obj.val(value);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><blockquote><p>重置</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $content = $(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> query = $content.lrGetFormData();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> id <span class="keyword">in</span> query) &#123;</span><br><span class="line">    query[id] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$content.lrSetFormData(query);</span><br></pre></td></tr></table></figure><blockquote><p>查询及保存获取所有元素值</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formData = $(<span class="string">&#x27;[data-table=&quot;Fly_YD_WabcoValuation&quot;]&#x27;</span>).lrGetFormData();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 力软 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>重裝系統後重新部署恢復 Hexo blog</title>
      <link href="2020/12/26/RecoveryHexo/"/>
      <url>2020/12/26/RecoveryHexo/</url>
      
        <content type="html"><![CDATA[<blockquote><p>以下方法只适用于没有删除 hexo blog文件夹</p></blockquote><p>因为重装系统后，Hexo 相关依赖插件/软件和在 C 盘的缓存资料都会被删除，以至于 Hexo 的相关命令都无法运行。所有，在重装系统后，都要重新部署 Hexo。但是重新部署并不难，只需要几个步骤就行。<br>因为我的 hexo blog 文件夹不存储于 C 盘，并没有因为重装系统被删掉。所有重新部署很容易。</p><h1 id="安裝-git-和-node"><a href="#安裝-git-和-node" class="headerlink" title="安裝 git 和 node"></a>安裝 git 和 node</h1><ul><li>git for windows: <a href="https://git-scm.com/">https://git-scm.com/</a></li><li>Node.js: <a href="https://nodejs.org/en/">https://nodejs.org/en/</a></li></ul><h1 id="生成-ssh-密钥"><a href="#生成-ssh-密钥" class="headerlink" title="生成 ssh 密钥"></a>生成 ssh 密钥</h1><p>配置 git 个人信息和生成 ssh 密钥<br>打开 git bash，输入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;xxxxx&quot;</span><br><span class="line">git config --global user.email &quot;xxxxxx@xx.com&quot;</span><br><span class="line">ssh-keygen -t rsa -C &quot;xxxxxx@xx.com&quot;</span><br></pre></td></tr></table></figure><p>把上面的 xxxx 换成自己的资料，然后一直 Enter 就行。</p><h1 id="设置-Github-的-ssh-密钥"><a href="#设置-Github-的-ssh-密钥" class="headerlink" title="设置 Github 的 ssh 密钥"></a>设置 Github 的 ssh 密钥</h1><p>当上面的运行完成后，会在 <code>C:\Users\主用户</code>里出现<code>.ssh</code>文件夹，里面有 id_rsa 和 id_rsa.pub 两个文件，複製 id_rsa.pub 的内容。<br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/26/rhQr3n.png"></p><p>打开 Github 网页，依次是 <code>右上角Settings - SSH and GPG keys - New SSH key</code> 把複製的内容粘贴到 <code>Key</code>栏，然后保存。<br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/26/rhQXUe.png"><br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/26/rhQj4H.png"><br>PS：如果你有把 blog 同步到 coding 的，记得同样把 id_rsa.pub 的内容複製到 coding 的 ssh 公钥去，具体为<code>右上角个人设置 － SSH公钥 - 新增公钥</code><br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/26/rhlyPH.png"></p><h1 id="安裝-Hexo"><a href="#安裝-Hexo" class="headerlink" title="安裝 Hexo"></a>安裝 Hexo</h1><p>git bash 上 输入 <code>npm install hexo-cli -g</code></p><h1 id="刪掉原-blog-文件夹部分文件"><a href="#刪掉原-blog-文件夹部分文件" class="headerlink" title="刪掉原 blog 文件夹部分文件"></a>刪掉原 blog 文件夹部分文件</h1><p>打开你原有的 blog 文件夹，只需保留<code>_config.yml，theme/，source/，scaffolds/，package.json，.gitignore</code> 这些项目，删除其他的文件。</p><h1 id="安装依赖文件"><a href="#安装依赖文件" class="headerlink" title="安装依赖文件"></a>安装依赖文件</h1><p>git bash 上 输入 <code>npm install</code></p><h1 id="安装部署插件"><a href="#安装部署插件" class="headerlink" title="安装部署插件"></a>安装部署插件</h1><p>git bash 上 输入 <code>npm install hexo-deployer-git --save</code><br>最后 运行 <code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code> 看看是否成功。</p><blockquote><p>本文参考 <a href="https://jerryc.me/posts/dda8c81b">https://jerryc.me/posts/dda8c81b</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>支付宝PC网站支付</title>
      <link href="2020/12/25/AlipayPayment/"/>
      <url>2020/12/25/AlipayPayment/</url>
      
        <content type="html"><![CDATA[<h2 id="生成秘钥"><a href="#生成秘钥" class="headerlink" title="生成秘钥"></a>生成秘钥</h2><p>可以去<a href="https://opendocs.alipay.com/open/291/105971">支付宝开放平台-开发文档</a>下载秘钥生成器<br>运行可以直接生成长度为2048标准为PKCS1的公钥和私钥。</p><h2 id="设置应用公钥"><a href="#设置应用公钥" class="headerlink" title="设置应用公钥"></a>设置应用公钥</h2><p>我们生成密钥之后，需要到支付宝后台设置应用公钥，就是我们生成的公钥。<br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfXcgP.png"><br>设置之后，支付宝会给我们一个支付宝公钥，保存这个支付宝公钥<br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/26/rfXRu8.png"><br>这个支付宝公钥和我们自己生成的公钥是不一样的，我们在配置SDK时用的公钥就是支付宝公钥</p><h2 id="配置SDK"><a href="#配置SDK" class="headerlink" title="配置SDK"></a>配置SDK</h2><p>新建一个<code>Config</code>类，在里面存储我们的配置。<br>其他信息不变只需要配置</p><ul><li>应用ID</li><li>商户私钥</li><li>支付宝公钥</li></ul><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> SDK配置</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ZFBPayconfig</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 应用ID,您的APPID</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> app_id = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 支付宝网关</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> gatewayUrl = <span class="string">&quot;https://openapi.alipay.com/gateway.do&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 商户私钥，您的原始格式RSA私钥</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> private_key = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 支付宝公钥,查看地址：https://openhome.alipay.com/platform/keyManage.htm 对应APPID下的支付宝公钥。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> alipay_public_key = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 签名方式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> sign_type = <span class="string">&quot;RSA2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 编码格式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> charset = <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>下载官网demo 并将SDK引入到自己的项目中<br><a href="https://opendocs.alipay.com/open/54/104506">支付宝当面付demo</a></p></blockquote><p>直接将demo中的dll复制到项目中直接引用就行<br><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/27/r5AIwd.png"></p><h2 id="支付"><a href="#支付" class="headerlink" title="支付"></a>支付</h2><p>成功之后会返回一个<code>form</code>表单会直接提交<br>打开一个新页面将要支付的金额传过去</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.open(<span class="string">&quot;/Fly_Fp/Fly_Fp_Rechargelog/Recharge?money=&quot;</span> <span class="number">1000</span>;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 支付宝充值</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Recharge</span>(<span class="params"><span class="built_in">string</span> money</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        DefaultAopClient client = <span class="keyword">new</span> DefaultAopClient(ZFBPayconfig.gatewayUrl, ZFBPayconfig.app_id, ZFBPayconfig.private_key, <span class="string">&quot;json&quot;</span>, <span class="string">&quot;1.0&quot;</span>, ZFBPayconfig.sign_type, ZFBPayconfig.alipay_public_key, ZFBPayconfig.charset, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 外部订单号，商户网站订单系统中唯一的订单号</span></span><br><span class="line">        <span class="built_in">string</span> out_trade_no = DateTime.Now.ToString(<span class="string">&quot;yyyyMMddHHmmss&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 订单名称</span></span><br><span class="line">        <span class="built_in">string</span> subject = <span class="string">&quot;发票抬头查询&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 付款金额</span></span><br><span class="line">        <span class="built_in">string</span> total_amout = money;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 商品描述</span></span><br><span class="line">        <span class="built_in">string</span> body = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 组装业务参数model</span></span><br><span class="line">        AlipayTradePagePayModel model = <span class="keyword">new</span> AlipayTradePagePayModel();</span><br><span class="line">        model.Body = body;</span><br><span class="line">        model.Subject = subject;</span><br><span class="line">        model.TotalAmount = total_amout;</span><br><span class="line">        model.OutTradeNo = out_trade_no;</span><br><span class="line">        model.ProductCode = <span class="string">&quot;FAST_INSTANT_TRADE_PAY&quot;</span>;</span><br><span class="line"></span><br><span class="line">        AlipayTradePagePayRequest request = <span class="keyword">new</span> AlipayTradePagePayRequest();</span><br><span class="line">        <span class="comment">// 设置同步回调地址</span></span><br><span class="line">        request.SetReturnUrl(<span class="string">&quot;http://hc.feiliankeji.cn/Fly_Fp_Rechargelog/Return_url&quot;</span>);</span><br><span class="line">        <span class="comment">// 设置异步通知接收地址</span></span><br><span class="line">        request.SetNotifyUrl(<span class="string">&quot;http://hc.feiliankeji.cn/Utility/Notify_url&quot;</span>);</span><br><span class="line">        <span class="comment">// 将业务model载入到request</span></span><br><span class="line">        request.SetBizModel(model);</span><br><span class="line"></span><br><span class="line">        AlipayTradePagePayResponse response = <span class="literal">null</span>;</span><br><span class="line">        response = client.pageExecute(request, <span class="literal">null</span>, <span class="string">&quot;post&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> response.Body;</span><br><span class="line">    &#125;</span><br><span class="line">    catch (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ex <span class="keyword">is</span> ExceptionEx)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> ExceptionEx.ThrowServiceException(ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>运行</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/26/rhVnvF.png"></p><h3 id="异步回调"><a href="#异步回调" class="headerlink" title="异步回调"></a>异步回调</h3><p>支付宝同步回调通知（支付成功后跳转到商户网站），是不可靠的，所以这里必须使用异步通知来获取支付结果，异步通知即支付宝主动请求我们提供的地址，我们根据请求数据来校验，获取支付结果。</p><blockquote><p>切记：异步回调请求的方法一定要可以外网访问的不能有过滤器 切记切记</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 设置异步通知接收地址</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">Notify_url</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">/* 实际验证过程建议商户添加以下校验。</span></span><br><span class="line"><span class="comment">1、商户需要验证该通知数据中的out_trade_no是否为商户系统中创建的订单号，</span></span><br><span class="line"><span class="comment">2、判断total_amount是否确实为该订单的实际金额（即商户订单创建时的金额），</span></span><br><span class="line"><span class="comment">3、校验通知中的seller_id（或者seller_email) 是否为out_trade_no这笔单据的对应的操作方（有的时候，一个商户可能有多个seller_id/seller_email）</span></span><br><span class="line"><span class="comment">4、验证app_id是否为该商户本身。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; sArray = GetRequestPost();</span><br><span class="line">    <span class="keyword">if</span> (sArray.Count != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">bool</span> flag = AlipaySignature.RSACheckV1(sArray, ZFBPayconfig.alipay_public_key, ZFBPayconfig.charset, ZFBPayconfig.sign_type, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (flag)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//交易状态</span></span><br><span class="line">            <span class="comment">//判断该笔订单是否在商户网站中已经做过处理</span></span><br><span class="line">            <span class="comment">//如果没有做过处理，根据订单号（out_trade_no）在商户网站的订单系统中查到该笔订单的详细，并执行商户的业务程序</span></span><br><span class="line">            <span class="comment">//请务必判断请求时的total_amount与通知时获取的total_fee为一致的</span></span><br><span class="line">            <span class="comment">//如果有做过处理，不执行商户的业务程序</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//注意：</span></span><br><span class="line">            <span class="comment">//退款日期超过可退款期限后（如三个月可退款），支付宝系统发送该交易状态通知</span></span><br><span class="line">            <span class="built_in">string</span> trade_status = Request.Form[<span class="string">&quot;trade_status&quot;</span>];</span><br><span class="line"></span><br><span class="line">            res = <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            res = <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Content(res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 设置异步通知接收地址</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; <span class="title">GetRequestPost</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">    Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; sArray = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">    NameValueCollection coll;</span><br><span class="line">    <span class="comment">//coll = Request.Form;</span></span><br><span class="line">    coll = Request.Form;</span><br><span class="line">    String[] requestItem = coll.AllKeys;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; requestItem.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sArray.Add(requestItem[i], Request.Form[requestItem[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sArray;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="同步回调"><a href="#同步回调" class="headerlink" title="同步回调"></a>同步回调</h3><blockquote><p>同步回调即支付成功跳转回商户网站</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> 设置同步回调地址</span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ActionResult <span class="title">Return_url</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">      <span class="keyword">var</span> res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">      <span class="comment">/* 实际验证过程建议商户添加以下校验。</span></span><br><span class="line"><span class="comment">1、商户需要验证该通知数据中的out_trade_no是否为商户系统中创建的订单号，</span></span><br><span class="line"><span class="comment">2、判断total_amount是否确实为该订单的实际金额（即商户订单创建时的金额），</span></span><br><span class="line"><span class="comment">3、校验通知中的seller_id（或者seller_email) 是否为out_trade_no这笔单据的对应的操作方（有的时候，一个商户可能有多个seller_id/seller_email）</span></span><br><span class="line"><span class="comment">4、验证app_id是否为该商户本身。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">      Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; sArray = GetRequestGet();</span><br><span class="line">      <span class="keyword">if</span> (sArray.Count != <span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="built_in">bool</span> flag = AlipaySignature.RSACheckV1(sArray, ZFBPayconfig.alipay_public_key, ZFBPayconfig.charset, ZFBPayconfig.sign_type, <span class="literal">false</span>);</span><br><span class="line">          <span class="keyword">if</span> (flag)</span><br><span class="line">          &#123;</span><br><span class="line">              res = <span class="string">&quot;同步验证通过&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">              res = <span class="string">&quot;同步验证失败&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> Content(res);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 设置同步回调地址</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; <span class="title">GetRequestGet</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">    Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; sArray = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">    NameValueCollection coll;</span><br><span class="line">    <span class="comment">//coll = Request.Form;</span></span><br><span class="line">    coll = Request.QueryString;</span><br><span class="line">    String[] requestItem = coll.AllKeys;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; requestItem.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sArray.Add(requestItem[i], Request.QueryString[requestItem[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sArray;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 支付宝 </tag>
            
            <tag> 支付 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信小程序给用户发送消息</title>
      <link href="2020/12/25/WXSendMessage/"/>
      <url>2020/12/25/WXSendMessage/</url>
      
        <content type="html"><![CDATA[<h2 id="基本参数"><a href="#基本参数" class="headerlink" title="基本参数"></a>基本参数</h2><ul><li>用户的<code>openid</code></li><li><code>access_token</code></li><li>公众号和小程序的<code>appid</code></li><li>模板ID</li></ul><hr><p><code>openid</code>获取方法之前的文章有提到过<br>公众号和小程序的<code>appid</code>和模板ID都可以在<a href="https://mp.weixin.qq.com/">微信公众号平台</a>获取到<br><a href="https://imgchr.com/i/rfVgSO"><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/25/rfVgSO.png" alt="rfVgSO.png"></a></p><p>下面我们就讲讲<code>access_token</code>的获取方式<br>将AppID和AppSecret(小程序密钥)调用接口即可<br>注意：<code>access_token</code>是有时间限制的最好存到缓存里</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取accessToken</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">JsCode2Session</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> appid = <span class="string">&quot;wx************&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> secret = <span class="string">&quot;************************&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> JsCode2SessionUrl = <span class="string">&quot;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=&#123;0&#125;&amp;secret=&#123;1&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> url = <span class="built_in">string</span>.Format(JsCode2SessionUrl, appid, secret);</span><br><span class="line">    <span class="keyword">var</span> str = GetFunction(url);</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        JObject jo = (JObject)JsonConvert.DeserializeObject(str);</span><br><span class="line">        <span class="built_in">string</span> access_token = jo[<span class="string">&quot;access_token&quot;</span>].ToString();</span><br><span class="line">        <span class="keyword">return</span> access_token;</span><br><span class="line">    &#125;</span><br><span class="line">    catch (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetFunction</span>(<span class="params"><span class="built_in">string</span> url</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> serviceAddress = url;</span><br><span class="line">    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(serviceAddress);</span><br><span class="line">    request.Method = <span class="string">&quot;GET&quot;</span>;</span><br><span class="line">    request.ContentType = <span class="string">&quot;textml;charset=UTF-8&quot;</span>;</span><br><span class="line">    HttpWebResponse response = (HttpWebResponse)request.GetResponse();</span><br><span class="line">    Stream myResponseStream = response.GetResponseStream();</span><br><span class="line">    StreamReader myStreamReader = <span class="keyword">new</span> StreamReader(myResponseStream, Encoding.UTF8);</span><br><span class="line">    <span class="built_in">string</span> retString = myStreamReader.ReadToEnd();</span><br><span class="line">    myStreamReader.Close();</span><br><span class="line">    myResponseStream.Close();</span><br><span class="line">    <span class="comment">//Response.Write(retString);</span></span><br><span class="line">    <span class="keyword">return</span> retString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="发送消息"><a href="#发送消息" class="headerlink" title="发送消息"></a>发送消息</h2><p>首先找到该模板找到详细信息里面分别对应的参数<code>first</code> <code>keyword1</code> <code>keyword2</code> <code>keyword3</code><br>备注有的话就显示没有的话就不显示<br>注意：详细信息前面的标语是不变的所以找模板的时候要找对应的<br><a href="https://imgchr.com/i/rfei5t"><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/25/rfei5t.png" alt="rfei5t.png"></a></p><p>第一个appid是公众号的<br>第二个是微信小程序的<br>因为微信之前取消了小程序发送消息现在只基于公众号所以用户也必须关注该公众号</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 开票内容的退回并发送信息</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ID&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;yuanyi&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;zhuID&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">approvalcontent</span>(<span class="params"><span class="built_in">string</span> openid, <span class="built_in">string</span> createdate, <span class="built_in">string</span> createUsername, <span class="built_in">string</span> Reason</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> accesstoken = fly_Fp_ApplyForIBLL.JsCode2Session();</span><br><span class="line">    <span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;touser\&quot;: \&quot;&quot;</span> + openid + <span class="string">&quot;\&quot;, &quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;mp_template_msg\&quot;: &#123; &quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;appid\&quot;: \&quot;wx************\&quot;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;template_id\&quot;: \&quot;X82CtoGmegLQpGZAV6lDpT3uBcVA7vZNJhx52fwVBpg\&quot;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;url\&quot;: \&quot;http://weixin.qq.com/download\&quot;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;miniprogram\&quot;: &#123; &quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;appid\&quot;: \&quot;wx**************\&quot;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;pagepath\&quot;: \&quot;pages/login\&quot; &#125;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;data\&quot;: &#123;&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;first\&quot;: &#123; \&quot;value\&quot;: \&quot;审批退回！\&quot;&#125;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;keyword1\&quot;: &#123; \&quot;value\&quot;: \&quot;开票内容\&quot;, \&quot;color\&quot;: \&quot;#173177\&quot;&#125;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;keyword2\&quot;: &#123; \&quot;value\&quot;: \&quot;&quot;</span> + createdate + <span class="string">&quot;\&quot;,\&quot;color\&quot;: \&quot;#173177\&quot;&#125;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;keyword3\&quot;: &#123; \&quot;value\&quot;: \&quot;&quot;</span> + createUsername + <span class="string">&quot;\&quot;, \&quot;color\&quot;: \&quot;#173177\&quot;&#125;,&quot;</span> +</span><br><span class="line">                  <span class="string">&quot;\&quot;remark\&quot;: &#123; \&quot;value\&quot;: \&quot;&quot;</span> + Reason + <span class="string">&quot;\&quot;,\&quot;color\&quot;: \&quot;#173177\&quot;&#125;&#125;&#125;&#125;&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> wxapi.SendTemplateMsg(json, accesstoken);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 发送模板消息</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;accessToken&quot;&gt;</span>AccessToken<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span>发送的模板数据<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">SendTemplateMsg</span>(<span class="params"><span class="built_in">string</span> data,<span class="built_in">string</span> accesstoken</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> url = <span class="built_in">string</span>.Format(<span class="string">&quot;https://api.weixin.qq.com/cgi-bin/message/wxopen/template/uniform_send?access_token=&#123;0&#125;&quot;</span>, accesstoken);</span><br><span class="line">    HttpWebRequest hwr = System.Net.WebRequest.Create(url) <span class="keyword">as</span> HttpWebRequest;</span><br><span class="line">    hwr.Method = <span class="string">&quot;POST&quot;</span>;</span><br><span class="line">    hwr.ContentType = <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>;</span><br><span class="line">    <span class="built_in">byte</span>[] payload;</span><br><span class="line">    payload = System.Text.Encoding.UTF8.GetBytes(data); <span class="comment">//通过UTF-8编码</span></span><br><span class="line">    hwr.ContentLength = payload.Length;</span><br><span class="line">    Stream writer = hwr.GetRequestStream();</span><br><span class="line">    writer.Write(payload, <span class="number">0</span>, payload.Length);</span><br><span class="line">    writer.Close();</span><br><span class="line">    <span class="keyword">var</span> result = hwr.GetResponse() <span class="keyword">as</span> HttpWebResponse; <span class="comment">//此句是获得上面URl返回的数据</span></span><br><span class="line">    <span class="built_in">string</span> strMsg = WebResponseGet(result);</span><br><span class="line">    <span class="comment">//如果token失效则重新获取</span></span><br><span class="line">    <span class="keyword">if</span> (strMsg.IndexOf(<span class="string">&quot;42001&quot;</span>) != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">string</span> token = wxapi.JsCode2Session();</span><br><span class="line">        <span class="keyword">return</span> SendTemplateMsg(data, token);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> strMsg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取Response</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;webResponse&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">WebResponseGet</span>(<span class="params">HttpWebResponse webResponse</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    StreamReader responseReader = <span class="literal">null</span>;</span><br><span class="line">    <span class="built_in">string</span> responseData = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        responseReader = <span class="keyword">new</span> StreamReader(webResponse.GetResponseStream());</span><br><span class="line">        responseData = responseReader.ReadToEnd();</span><br><span class="line">    &#125;</span><br><span class="line">    catch</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span></span><br><span class="line">    &#123;</span><br><span class="line">        webResponse.GetResponseStream().Close();</span><br><span class="line">        responseReader.Close();</span><br><span class="line">        responseReader = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> responseData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 微信 </tag>
            
            <tag> 小程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用正则表达式</title>
      <link href="2020/12/25/regular/"/>
      <url>2020/12/25/regular/</url>
      
        <content type="html"><![CDATA[<h2 id="校验数字的表达式"><a href="#校验数字的表达式" class="headerlink" title="校验数字的表达式"></a>校验数字的表达式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">数字：^[0-9]*$</span><br><span class="line">n位的数字：^\d&#123;n&#125;$</span><br><span class="line">至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line">m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line">零和非零开头的数字：^(0|[1-9][0-9]*)$</span><br><span class="line">非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">带1-2位小数的正数或负数：^(\-)?\d+(\.\d&#123;1,2&#125;)?$</span><br><span class="line">正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$</span><br><span class="line">有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line">非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^\+?[1-9][0-9]*$</span><br><span class="line">非零的负整数：^\-[1-9][]0-9&quot;*$ 或 ^-[1-9]\d*$</span><br><span class="line">非负整数：^\d+$ 或 ^[1-9]\d*|0$</span><br><span class="line">非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</span><br><span class="line">非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$</span><br><span class="line">非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$</span><br><span class="line">正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</span><br><span class="line">负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span><br><span class="line">浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</span><br></pre></td></tr></table></figure><h2 id="校验字符的表达式"><a href="#校验字符的表达式" class="headerlink" title="校验字符的表达式"></a>校验字符的表达式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">汉字：^[\u4e00-\u9fa5]&#123;0,&#125;$</span><br><span class="line">英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]&#123;4,40&#125;$</span><br><span class="line">长度为3-20的所有字符：^.&#123;3,20&#125;$</span><br><span class="line">由26个英文字母组成的字符串：^[A-Za-z]+$</span><br><span class="line">由26个大写英文字母组成的字符串：^[A-Z]+$</span><br><span class="line">由26个小写英文字母组成的字符串：^[a-z]+$</span><br><span class="line">由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</span><br><span class="line">由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w&#123;3,20&#125;$</span><br><span class="line">中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$</span><br><span class="line">中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]&#123;2,20&#125;$</span><br><span class="line">可以输入含有^%&amp;&#39;,;&#x3D;?$\&quot;等字符：[^%&amp;&#39;,;&#x3D;?$\x22]+</span><br><span class="line">禁止输入含有~的字符：[^~\x22]+</span><br></pre></td></tr></table></figure><h2 id="特殊需求表达式"><a href="#特殊需求表达式" class="headerlink" title="特殊需求表达式"></a>特殊需求表达式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span><br><span class="line">域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(&#x2F;.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+&#x2F;.?</span><br><span class="line">InternetURL：[a-zA-z]+:&#x2F;&#x2F;[^\s]* 或 ^http:&#x2F;&#x2F;([\w-]+\.)+[\w-]+(&#x2F;[\w-.&#x2F;?%&amp;&#x3D;]*)?$</span><br><span class="line">手机号码：^(13[0-9]|14[0-9]|15[0-9]|16[0-9]|17[0-9]|18[0-9]|19[0-9])\d&#123;8&#125;$ (由于工信部放号段不定时，所以建议使用泛解析 ^([1][3,4,5,6,7,8,9])\d&#123;9&#125;$)</span><br><span class="line">电话号码(&quot;XXX-XXXXXXX&quot;、&quot;XXXX-XXXXXXXX&quot;、&quot;XXX-XXXXXXX&quot;、&quot;XXX-XXXXXXXX&quot;、&quot;XXXXXXX&quot;和&quot;XXXXXXXX)：^(\(\d&#123;3,4&#125;-)|\d&#123;3.4&#125;-)?\d&#123;7,8&#125;$ </span><br><span class="line">国内电话号码(0511-4405222、021-87888822)：\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125; </span><br><span class="line">18位身份证号码(数字、字母x结尾)：^((\d&#123;18&#125;)|([0-9x]&#123;18&#125;)|([0-9X]&#123;18&#125;))$</span><br><span class="line">帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$</span><br><span class="line">密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w&#123;5,17&#125;$</span><br><span class="line">强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?&#x3D;.*\d)(?&#x3D;.*[a-z])(?&#x3D;.*[A-Z]).&#123;8,10&#125;$  </span><br><span class="line">日期格式：^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;</span><br><span class="line">一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</span><br><span class="line">一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$ </span><br><span class="line">钱的输入格式：</span><br><span class="line">  1.有四种钱的表示形式我们可以接受:&quot;10000.00&quot; 和 &quot;10,000.00&quot;, 和没有 &quot;分&quot; 的 &quot;10000&quot; 和 &quot;10,000&quot;：^[1-9][0-9]*$ </span><br><span class="line">  2.这表示任意一个不以0开头的数字,但是,这也意味着一个字符&quot;0&quot;不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$ </span><br><span class="line">  3.一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$ </span><br><span class="line">  4.这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$ </span><br><span class="line">  5.必须说明的是,小数点后面至少应该有1位数,所以&quot;10.&quot;是不通过的,但是 &quot;10&quot; 和 &quot;10.2&quot; 是通过的：^[0-9]+(.[0-9]&#123;2&#125;)?$ </span><br><span class="line">  6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[0-9]+(.[0-9]&#123;1,2&#125;)?$ </span><br><span class="line">  7.这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$ </span><br><span class="line">  8.1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$ </span><br><span class="line">备注：这就是最终结果了,别忘了&quot;+&quot;可以用&quot;*&quot;替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</span><br><span class="line">xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$</span><br><span class="line">中文字符的正则表达式：[\u4e00-\u9fa5]</span><br><span class="line">双字节字符：[^\x00-\xff]    (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))</span><br><span class="line">空白行的正则表达式：\n\s*\r    (可以用来删除空白行)</span><br><span class="line">HTML标记的正则表达式：&lt;(\S*?)[^&gt;]*&gt;.*?&lt;&#x2F;\1&gt;|&lt;.*? &#x2F;&gt;    (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line">首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$)    (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line">腾讯QQ号：[1-9][0-9]&#123;4,&#125;    (腾讯QQ号从10000开始)</span><br><span class="line">中国邮政编码：[1-9]\d&#123;5&#125;(?!\d)    (中国邮政编码为6位数字)</span><br><span class="line">IP地址：\d+\.\d+\.\d+\.\d+    (提取IP地址时有用)</span><br><span class="line">IP地址：((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.)&#123;3&#125;(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 正则表达式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>获取微信小程序OpenId</title>
      <link href="2020/12/25/GetWXOpenId/"/>
      <url>2020/12/25/GetWXOpenId/</url>
      
        <content type="html"><![CDATA[<h2 id="基本参数"><a href="#基本参数" class="headerlink" title="基本参数"></a>基本参数</h2><ul><li>获取<code>appid</code>及<code>secret</code></li><li>获取登录凭证code</li></ul><hr><p>登陆你的微信小程序在开发设置里面可以直接看到appid和secret<br><a href="https://imgchr.com/i/rRzDMV"><img src= "/img/loading.gif" data-lazy-src="https://s3.ax1x.com/2020/12/25/rRzDMV.jpg" alt="rRzDMV.jpg"></a><br>获取登录凭证</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取openid</span></span><br><span class="line">uni.login(&#123;</span><br><span class="line">success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">var</span> code=res.code;<span class="comment">//登录凭证</span></span><br><span class="line"> <span class="keyword">if</span>(code) &#123;</span><br><span class="line"> uni.request(&#123;</span><br><span class="line"> url: that.apiRoot + <span class="string">&#x27;/Fly_Fp/Fly_Fp_ApplyFor/getuseropenid&#x27;</span>,</span><br><span class="line"> method: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line"> data: &#123; ...that.auth,</span><br><span class="line"> data: res.code</span><br><span class="line"> &#125;,</span><br><span class="line"> success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="comment">//openid</span></span><br><span class="line"> <span class="keyword">var</span> openId = res.data;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="请求微信API"><a href="#请求微信API" class="headerlink" title="请求微信API"></a>请求微信API</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取openid</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;code&quot;&gt;</span>登录凭证<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;iv&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;encryptedData&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">ProcessRequest</span>(<span class="params"><span class="built_in">string</span> code, <span class="built_in">string</span> iv, <span class="built_in">string</span> encryptedData</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> Appid = <span class="string">&quot;wx****************&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> Secret = <span class="string">&quot;****************************&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> grant_type = <span class="string">&quot;authorization_code&quot;</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">//向微信服务端 使用登录凭证 code 获取 session_key 和 openid  </span></span><br><span class="line">    <span class="built_in">string</span> url = <span class="string">&quot;https://api.weixin.qq.com/sns/jscode2session?appid=&quot;</span> + Appid + <span class="string">&quot;&amp;secret=&quot;</span> + Secret + <span class="string">&quot;&amp;js_code=&quot;</span> + code + <span class="string">&quot;&amp;grant_type=&quot;</span> + grant_type;</span><br><span class="line">    <span class="built_in">string</span> type = <span class="string">&quot;utf-8&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> resData = <span class="keyword">this</span>.GetUrltoHtml(url, type);</span><br><span class="line">    <span class="keyword">return</span> resData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 获取链接返回数据 </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Url&quot;&gt;</span>链接<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;type&quot;&gt;</span>请求类型<span class="doctag">&lt;/param&gt;</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">GetUrltoHtml</span>(<span class="params"><span class="built_in">string</span> Url, <span class="built_in">string</span> type</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.Net.WebRequest wReq = System.Net.WebRequest.Create(Url);</span><br><span class="line">        <span class="comment">// Get the response instance. </span></span><br><span class="line">        System.Net.WebResponse wResp = wReq.GetResponse();</span><br><span class="line">        System.IO.Stream respStream = wResp.GetResponseStream();</span><br><span class="line">        <span class="comment">// Dim reader As StreamReader = New StreamReader(respStream) </span></span><br><span class="line">        <span class="keyword">using</span> (System.IO.StreamReader reader = <span class="keyword">new</span> System.IO.StreamReader(respStream, Encoding.GetEncoding(type)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> reader.ReadToEnd();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    catch (System.Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ex.Message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 微信 </tag>
            
            <tag> 小程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>上传/读取不规则数据的Excel</title>
      <link href="2020/12/24/ReadExcel/"/>
      <url>2020/12/24/ReadExcel/</url>
      
        <content type="html"><![CDATA[<h1 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h1><hr><p>定义一个文件选择器隐藏和一个导入按钮</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;lr_import&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-default&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-sign-in&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="symbol">&amp;nbsp;</span>导入<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;filed&quot;</span> <span class="attr">name</span>=<span class="string">&quot;filed&quot;</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;.xls,.xlsx&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>重新定义一个导入按钮的目的在于便于添加额外逻辑  例如：选择不同的模板向后台传参</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入</span></span><br><span class="line">           $(<span class="string">&quot;#lr_import&quot;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">               learun.layerForm(&#123;</span><br><span class="line">                   id: <span class="string">&#x27;form7&#x27;</span>,</span><br><span class="line">                   title: <span class="string">&#x27;导入类型 &#x27;</span>,</span><br><span class="line">                   url: <span class="string">&#x27;/Fly_ZD/Fly_ZD_Head/ImportType&#x27;</span>,</span><br><span class="line">                   width: <span class="number">500</span>,</span><br><span class="line">                   height: <span class="number">300</span>,</span><br><span class="line">                   callBack: <span class="function"><span class="keyword">function</span> (<span class="params">id, index</span>) </span>&#123;</span><br><span class="line">                       <span class="keyword">var</span> resData = top[id].acceptClick();</span><br><span class="line">                       <span class="keyword">if</span> (resData) &#123;</span><br><span class="line">                           ImportType = resData;</span><br><span class="line">                           $(<span class="string">&quot;#filed&quot;</span>).trigger(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">                           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                           learun.alert.error(<span class="string">&quot;请选择导入类型&quot;</span>);</span><br><span class="line">                       &#125;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;);</span><br><span class="line">           &#125;)</span><br><span class="line">           $(<span class="string">&quot;#filed&quot;</span>).on(<span class="string">&quot;change&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">               <span class="keyword">var</span> fileM = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#filed&quot;</span>);</span><br><span class="line">               <span class="comment">//获取文件对象，files是文件选取控件的属性，存储的是文件选取控件选取的文件对象，类型是一个数组</span></span><br><span class="line">               <span class="keyword">var</span> fileObj = fileM.files[<span class="number">0</span>];</span><br><span class="line">               <span class="comment">//创建formdata对象，formData用来存储表单的数据，表单数据时以键值对形式存储的。</span></span><br><span class="line">               <span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">               formData.append(<span class="string">&#x27;filed&#x27;</span>, fileObj);</span><br><span class="line">               learun.loading(<span class="literal">true</span>, <span class="string">&#x27;正在导入……&#x27;</span>);</span><br><span class="line">               $.ajax(&#123;</span><br><span class="line">                   url: <span class="string">&quot;/Fly_ZD/Fly_ZD_Head/Import?ImportType=&quot;</span> + ImportType,</span><br><span class="line">                   type: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">                   dataType: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">                   data: formData,</span><br><span class="line">                   <span class="keyword">async</span>: <span class="literal">false</span>,</span><br><span class="line">                   cache: <span class="literal">false</span>,</span><br><span class="line">                   contentType: <span class="literal">false</span>,</span><br><span class="line">                   processData: <span class="literal">false</span>,</span><br><span class="line">                   success: <span class="function"><span class="keyword">function</span> (<span class="params">json_data</span>) </span>&#123;</span><br><span class="line">                       learun.loading(<span class="literal">false</span>);</span><br><span class="line">                       $(<span class="string">&quot;#filed&quot;</span>).val(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                   &#125;,</span><br><span class="line">               &#125;);</span><br><span class="line">           &#125;);</span><br></pre></td></tr></table></figure><hr><h1 id="读取文件及存储数据"><a href="#读取文件及存储数据" class="headerlink" title="读取文件及存储数据"></a>读取文件及存储数据</h1><p>先将选择的文件上传到服务器 再读取该Excel</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 毕勤制单导入</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filed&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">Import</span>(<span class="params">HttpPostedFileBase filed, <span class="built_in">string</span> ImportType</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//服务器上的UpLoadFile文件夹必须有读写权限</span></span><br><span class="line">    <span class="built_in">string</span> target = Server.MapPath(<span class="string">&quot;/&quot;</span>) + (<span class="string">$&quot;/UploadFile/biqin/<span class="subst">&#123;DateTime.Now.Year&#125;</span>/<span class="subst">&#123;DateTime.Now.Month&#125;</span>/&quot;</span>);<span class="comment">//取得存储文件夹的路径</span></span><br><span class="line">    <span class="built_in">string</span> filename = filed.FileName;<span class="comment">//取得文件名字</span></span><br><span class="line">    <span class="built_in">string</span> path = target + filename;<span class="comment">//获取存储的目标地址</span></span><br><span class="line">    <span class="comment">//判断该文件路径是否存在没有则创建文件夹</span></span><br><span class="line">    <span class="keyword">if</span> (!Directory.Exists(target))</span><br><span class="line">    &#123;</span><br><span class="line">        Directory.CreateDirectory(target);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将文件保存到指定位置</span></span><br><span class="line">    filed.SaveAs(path);</span><br><span class="line">    <span class="comment">//读取数据 存储数据</span></span><br><span class="line">    GetHeadData(path, ImportType);</span><br><span class="line">    <span class="keyword">return</span> Success(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>GetHeadData()</code> 方法对读取到的数据存到数据库</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 毕勤制单获取数据</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filepath&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetHeadData</span>(<span class="params"><span class="built_in">string</span> filepath, <span class="built_in">string</span> ImportType</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">DataSet gongsi = ReadExcelData(filepath);</span><br><span class="line"><span class="comment">//定义两个datatable，并将传递来的dataset集中的两个表分别赋值给datatable</span></span><br><span class="line"><span class="comment">//发票</span></span><br><span class="line">DataTable fp_data = gongsi.Tables[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//箱单</span></span><br><span class="line">DataTable xd_data = gongsi.Tables[<span class="number">1</span>];</span><br><span class="line"><span class="comment">//主表信息</span></span><br><span class="line">Fly_ZD_ImportMainEntity HeadEntity = <span class="keyword">new</span> Fly_ZD_ImportMainEntity();</span><br><span class="line"><span class="comment">//发票商品信息</span></span><br><span class="line">List&lt;Fly_ZD_ImportfapiaoEntity&gt; fp_xx = <span class="keyword">new</span> List&lt;Fly_ZD_ImportfapiaoEntity&gt;();</span><br><span class="line"><span class="comment">//箱单商品信息</span></span><br><span class="line">List&lt;Fly_ZD_ImportxiangdanEntity&gt; xd_xx = <span class="keyword">new</span> List&lt;Fly_ZD_ImportxiangdanEntity&gt;();</span><br><span class="line"><span class="keyword">if</span> (ImportType == <span class="string">&quot;VN&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">HeadEntity = <span class="keyword">this</span>.VNmain_xx(gongsi.Tables[<span class="number">0</span>]);</span><br><span class="line">fp_xx = <span class="keyword">this</span>.VNfp_xx(fp_data);</span><br><span class="line">xd_xx = <span class="keyword">this</span>.VNxd_xx(xd_data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ImportType == <span class="string">&quot;VNBI&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">HeadEntity = <span class="keyword">this</span>.VNBImain_xx(gongsi.Tables[<span class="number">0</span>]);</span><br><span class="line">fp_xx = <span class="keyword">this</span>.VNBIfp_xx(fp_data);</span><br><span class="line">xd_xx = <span class="keyword">this</span>.VNBIxd_xx(xd_data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (ImportType == <span class="string">&quot;VA&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">HeadEntity = <span class="keyword">this</span>.VAmain_xx(gongsi.Tables[<span class="number">0</span>]);</span><br><span class="line">fp_xx = <span class="keyword">this</span>.VNfp_xx(fp_data);</span><br><span class="line">xd_xx = <span class="keyword">this</span>.VNxd_xx(xd_data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//保存到数据库中</span></span><br><span class="line">fly_ZD_HeadIBLL.SaveImport(HeadEntity, fp_xx, xd_xx);</span><br><span class="line">&#125;</span><br><span class="line">catch (Exception e)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ReadExcelData()</code> 方法读取Excel 注意工作表要加$例如下文INV$，PK$</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 读取不规则的EXcel数据</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;filepath&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSet <span class="title">ReadExcelData</span>(<span class="params"><span class="built_in">string</span> filepath</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DataSet ds = <span class="keyword">new</span> DataSet();<span class="comment">//定义一个dataset用来存储查询到的数据</span></span><br><span class="line">    <span class="built_in">string</span> connStr = <span class="string">&quot;Provider=Microsoft.Jet.OleDb.4.0;&quot;</span> + <span class="string">&quot;Data Source=&quot;</span> + filepath + <span class="string">&quot;;Extended Properties=&#x27;Excel 8.0; HDR=YES; IMEX=1&#x27;&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> sql_F = <span class="string">&quot;SELECT * FROM [&#123;0&#125;]&quot;</span>;</span><br><span class="line">    System.Data.OleDb.OleDbConnection conn = <span class="literal">null</span>;</span><br><span class="line">    System.Data.OleDb.OleDbDataAdapter xd_da = <span class="literal">null</span>;</span><br><span class="line">    System.Data.OleDb.OleDbDataAdapter fp_da = <span class="literal">null</span>;</span><br><span class="line">    System.Data.DataTable tblSchema = <span class="literal">null</span>;<span class="comment">//实例化一个数据表用来存储表名</span></span><br><span class="line">    System.Collections.Generic.IList&lt;<span class="built_in">string</span>&gt; xd_tblNames = <span class="literal">null</span>;<span class="comment">//定义一个List&lt;string&gt;变量 用来存储原始箱单表名</span></span><br><span class="line">    System.Collections.Generic.IList&lt;<span class="built_in">string</span>&gt; fp_tblNames = <span class="literal">null</span>;<span class="comment">//定义一个List&lt;string&gt;变量 用来存储原始发票表名</span></span><br><span class="line">    conn = <span class="keyword">new</span> System.Data.OleDb.OleDbConnection(connStr);</span><br><span class="line">    conn.Open();</span><br><span class="line">    tblSchema = conn.GetOleDbSchemaTable(System.Data.OleDb.OleDbSchemaGuid.Tables, <span class="keyword">new</span> <span class="built_in">object</span>[] &#123; <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="string">&quot;TABLE&quot;</span> &#125;);<span class="comment">//获取所有表名</span></span><br><span class="line">    xd_tblNames = <span class="keyword">new</span> System.Collections.Generic.List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">    fp_tblNames = <span class="keyword">new</span> System.Collections.Generic.List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">    <span class="built_in">string</span> xd_tblname = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">string</span> fp_tblname = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> tblname = <span class="number">0</span>; tblname &lt; tblSchema.Rows.Count; tblname++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (tblSchema.Rows[tblname][<span class="number">2</span>].ToString() == <span class="string">&quot;INV$&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            xd_tblname = tblSchema.Rows[tblname][<span class="number">2</span>].ToString();<span class="comment">//获取原始箱单表名</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tblSchema.Rows[tblname][<span class="number">2</span>].ToString() == <span class="string">&quot;PK$&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            fp_tblname = tblSchema.Rows[tblname][<span class="number">2</span>].ToString();<span class="comment">//获取原始发票表名</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">string</span>[] xd_tblnames = &#123; xd_tblname &#125;;<span class="comment">//将原始箱单表名储存到数组里</span></span><br><span class="line">    <span class="built_in">string</span>[] fp_tblnames = &#123; fp_tblname &#125;;<span class="comment">//将原始发票表名储存到数组里</span></span><br><span class="line">    xd_tblNames = <span class="keyword">new</span> List&lt;System.String&gt;(xd_tblnames);<span class="comment">//将原始箱单表名赋值给xd_tblNames</span></span><br><span class="line">    fp_tblNames = <span class="keyword">new</span> List&lt;System.String&gt;(fp_tblnames);<span class="comment">//将原始发票表名赋值给xd_tblNames</span></span><br><span class="line"></span><br><span class="line">    xd_da = <span class="keyword">new</span> System.Data.OleDb.OleDbDataAdapter();</span><br><span class="line">    fp_da = <span class="keyword">new</span> System.Data.OleDb.OleDbDataAdapter();</span><br><span class="line">    <span class="comment">//循环获取全部的原始箱单数据</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">string</span> tblName <span class="keyword">in</span> xd_tblNames)</span><br><span class="line">    &#123;</span><br><span class="line">        xd_da.SelectCommand = <span class="keyword">new</span> System.Data.OleDb.OleDbCommand(String.Format(sql_F, tblName), conn);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            xd_da.Fill(ds, tblName);</span><br><span class="line">        &#125;</span><br><span class="line">        catch</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (conn.State == ConnectionState.Open)</span><br><span class="line">            &#123;</span><br><span class="line">                conn.Close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//循环获取全部的原始发票数据</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">string</span> fp_tblName <span class="keyword">in</span> fp_tblNames)</span><br><span class="line">    &#123;</span><br><span class="line">        xd_da.SelectCommand = <span class="keyword">new</span> System.Data.OleDb.OleDbCommand(String.Format(sql_F, fp_tblName), conn);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            xd_da.Fill(ds, fp_tblName);</span><br><span class="line">        &#125;</span><br><span class="line">        catch</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (conn.State == ConnectionState.Open)</span><br><span class="line">            &#123;</span><br><span class="line">                conn.Close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ds;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> .NET </tag>
            
            <tag> Excel </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
